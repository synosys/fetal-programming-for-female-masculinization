(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=r(l);fetch(l.href,c)}})();var wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$h={exports:{}},So={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg;function yw(){if(mg)return So;mg=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function r(i,l,c){var f=null;if(c!==void 0&&(f=""+c),l.key!==void 0&&(f=""+l.key),"key"in l){c={};for(var d in l)d!=="key"&&(c[d]=l[d])}else c=l;return l=c.ref,{$$typeof:t,type:i,key:f,ref:l!==void 0?l:null,props:c}}return So.Fragment=n,So.jsx=r,So.jsxs=r,So}var gg;function vw(){return gg||(gg=1,$h.exports=yw()),$h.exports}var _=vw(),Gh={exports:{}},Ce={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg;function _w(){if(yg)return Ce;yg=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function v(P){return P===null||typeof P!="object"?null:(P=y&&P[y]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,b={};function E(P,I,R){this.props=P,this.context=I,this.refs=b,this.updater=R||w}E.prototype.isReactComponent={},E.prototype.setState=function(P,I){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,I,"setState")},E.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function A(){}A.prototype=E.prototype;function O(P,I,R){this.props=P,this.context=I,this.refs=b,this.updater=R||w}var C=O.prototype=new A;C.constructor=O,S(C,E.prototype),C.isPureReactComponent=!0;var U=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},V=Object.prototype.hasOwnProperty;function k(P,I,R,Y,z,W){return R=W.ref,{$$typeof:t,type:P,key:I,ref:R!==void 0?R:null,props:W}}function F(P,I){return k(P.type,I,void 0,void 0,void 0,P.props)}function T(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function N(P){var I={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(R){return I[R]})}var D=/\/+/g;function L(P,I){return typeof P=="object"&&P!==null&&P.key!=null?N(""+P.key):I.toString(36)}function K(){}function ft(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(K,K):(P.status="pending",P.then(function(I){P.status==="pending"&&(P.status="fulfilled",P.value=I)},function(I){P.status==="pending"&&(P.status="rejected",P.reason=I)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function dt(P,I,R,Y,z){var W=typeof P;(W==="undefined"||W==="boolean")&&(P=null);var tt=!1;if(P===null)tt=!0;else switch(W){case"bigint":case"string":case"number":tt=!0;break;case"object":switch(P.$$typeof){case t:case n:tt=!0;break;case m:return tt=P._init,dt(tt(P._payload),I,R,Y,z)}}if(tt)return z=z(P),tt=Y===""?"."+L(P,0):Y,U(z)?(R="",tt!=null&&(R=tt.replace(D,"$&/")+"/"),dt(z,I,R,"",function(q){return q})):z!=null&&(T(z)&&(z=F(z,R+(z.key==null||P&&P.key===z.key?"":(""+z.key).replace(D,"$&/")+"/")+tt)),I.push(z)),1;tt=0;var nt=Y===""?".":Y+":";if(U(P))for(var j=0;j<P.length;j++)Y=P[j],W=nt+L(Y,j),tt+=dt(Y,I,R,W,z);else if(j=v(P),typeof j=="function")for(P=j.call(P),j=0;!(Y=P.next()).done;)Y=Y.value,W=nt+L(Y,j++),tt+=dt(Y,I,R,W,z);else if(W==="object"){if(typeof P.then=="function")return dt(ft(P),I,R,Y,z);throw I=String(P),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return tt}function J(P,I,R){if(P==null)return P;var Y=[],z=0;return dt(P,Y,"","",function(W){return I.call(R,W,z++)}),Y}function gt(P){if(P._status===-1){var I=P._result;I=I(),I.then(function(R){(P._status===0||P._status===-1)&&(P._status=1,P._result=R)},function(R){(P._status===0||P._status===-1)&&(P._status=2,P._result=R)}),P._status===-1&&(P._status=0,P._result=I)}if(P._status===1)return P._result.default;throw P._result}var wt=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function bt(){}return Ce.Children={map:J,forEach:function(P,I,R){J(P,function(){I.apply(this,arguments)},R)},count:function(P){var I=0;return J(P,function(){I++}),I},toArray:function(P){return J(P,function(I){return I})||[]},only:function(P){if(!T(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ce.Component=E,Ce.Fragment=r,Ce.Profiler=l,Ce.PureComponent=O,Ce.StrictMode=i,Ce.Suspense=p,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(P){return B.H.useMemoCache(P)}},Ce.cache=function(P){return function(){return P.apply(null,arguments)}},Ce.cloneElement=function(P,I,R){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Y=S({},P.props),z=P.key,W=void 0;if(I!=null)for(tt in I.ref!==void 0&&(W=void 0),I.key!==void 0&&(z=""+I.key),I)!V.call(I,tt)||tt==="key"||tt==="__self"||tt==="__source"||tt==="ref"&&I.ref===void 0||(Y[tt]=I[tt]);var tt=arguments.length-2;if(tt===1)Y.children=R;else if(1<tt){for(var nt=Array(tt),j=0;j<tt;j++)nt[j]=arguments[j+2];Y.children=nt}return k(P.type,z,void 0,void 0,W,Y)},Ce.createContext=function(P){return P={$$typeof:f,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:c,_context:P},P},Ce.createElement=function(P,I,R){var Y,z={},W=null;if(I!=null)for(Y in I.key!==void 0&&(W=""+I.key),I)V.call(I,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(z[Y]=I[Y]);var tt=arguments.length-2;if(tt===1)z.children=R;else if(1<tt){for(var nt=Array(tt),j=0;j<tt;j++)nt[j]=arguments[j+2];z.children=nt}if(P&&P.defaultProps)for(Y in tt=P.defaultProps,tt)z[Y]===void 0&&(z[Y]=tt[Y]);return k(P,W,void 0,void 0,null,z)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(P){return{$$typeof:d,render:P}},Ce.isValidElement=T,Ce.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:gt}},Ce.memo=function(P,I){return{$$typeof:h,type:P,compare:I===void 0?null:I}},Ce.startTransition=function(P){var I=B.T,R={};B.T=R;try{var Y=P(),z=B.S;z!==null&&z(R,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(bt,wt)}catch(W){wt(W)}finally{B.T=I}},Ce.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Ce.use=function(P){return B.H.use(P)},Ce.useActionState=function(P,I,R){return B.H.useActionState(P,I,R)},Ce.useCallback=function(P,I){return B.H.useCallback(P,I)},Ce.useContext=function(P){return B.H.useContext(P)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(P,I){return B.H.useDeferredValue(P,I)},Ce.useEffect=function(P,I,R){var Y=B.H;if(typeof R=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(P,I)},Ce.useId=function(){return B.H.useId()},Ce.useImperativeHandle=function(P,I,R){return B.H.useImperativeHandle(P,I,R)},Ce.useInsertionEffect=function(P,I){return B.H.useInsertionEffect(P,I)},Ce.useLayoutEffect=function(P,I){return B.H.useLayoutEffect(P,I)},Ce.useMemo=function(P,I){return B.H.useMemo(P,I)},Ce.useOptimistic=function(P,I){return B.H.useOptimistic(P,I)},Ce.useReducer=function(P,I,R){return B.H.useReducer(P,I,R)},Ce.useRef=function(P){return B.H.useRef(P)},Ce.useState=function(P){return B.H.useState(P)},Ce.useSyncExternalStore=function(P,I,R){return B.H.useSyncExternalStore(P,I,R)},Ce.useTransition=function(){return B.H.useTransition()},Ce.version="19.1.0",Ce}var vg;function Kd(){return vg||(vg=1,Gh.exports=_w()),Gh.exports}var Z=Kd(),Ph={exports:{}},Eo={},Yh={exports:{}},Vh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _g;function bw(){return _g||(_g=1,function(t){function n(J,gt){var wt=J.length;J.push(gt);t:for(;0<wt;){var bt=wt-1>>>1,P=J[bt];if(0<l(P,gt))J[bt]=gt,J[wt]=P,wt=bt;else break t}}function r(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var gt=J[0],wt=J.pop();if(wt!==gt){J[0]=wt;t:for(var bt=0,P=J.length,I=P>>>1;bt<I;){var R=2*(bt+1)-1,Y=J[R],z=R+1,W=J[z];if(0>l(Y,wt))z<P&&0>l(W,Y)?(J[bt]=W,J[z]=wt,bt=z):(J[bt]=Y,J[R]=wt,bt=R);else if(z<P&&0>l(W,wt))J[bt]=W,J[z]=wt,bt=z;else break t}}return gt}function l(J,gt){var wt=J.sortIndex-gt.sortIndex;return wt!==0?wt:J.id-gt.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var f=Date,d=f.now();t.unstable_now=function(){return f.now()-d}}var p=[],h=[],m=1,y=null,v=3,w=!1,S=!1,b=!1,E=!1,A=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function U(J){for(var gt=r(h);gt!==null;){if(gt.callback===null)i(h);else if(gt.startTime<=J)i(h),gt.sortIndex=gt.expirationTime,n(p,gt);else break;gt=r(h)}}function B(J){if(b=!1,U(J),!S)if(r(p)!==null)S=!0,V||(V=!0,L());else{var gt=r(h);gt!==null&&dt(B,gt.startTime-J)}}var V=!1,k=-1,F=5,T=-1;function N(){return E?!0:!(t.unstable_now()-T<F)}function D(){if(E=!1,V){var J=t.unstable_now();T=J;var gt=!0;try{t:{S=!1,b&&(b=!1,O(k),k=-1),w=!0;var wt=v;try{e:{for(U(J),y=r(p);y!==null&&!(y.expirationTime>J&&N());){var bt=y.callback;if(typeof bt=="function"){y.callback=null,v=y.priorityLevel;var P=bt(y.expirationTime<=J);if(J=t.unstable_now(),typeof P=="function"){y.callback=P,U(J),gt=!0;break e}y===r(p)&&i(p),U(J)}else i(p);y=r(p)}if(y!==null)gt=!0;else{var I=r(h);I!==null&&dt(B,I.startTime-J),gt=!1}}break t}finally{y=null,v=wt,w=!1}gt=void 0}}finally{gt?L():V=!1}}}var L;if(typeof C=="function")L=function(){C(D)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ft=K.port2;K.port1.onmessage=D,L=function(){ft.postMessage(null)}}else L=function(){A(D,0)};function dt(J,gt){k=A(function(){J(t.unstable_now())},gt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(J){switch(v){case 1:case 2:case 3:var gt=3;break;default:gt=v}var wt=v;v=gt;try{return J()}finally{v=wt}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(J,gt){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var wt=v;v=J;try{return gt()}finally{v=wt}},t.unstable_scheduleCallback=function(J,gt,wt){var bt=t.unstable_now();switch(typeof wt=="object"&&wt!==null?(wt=wt.delay,wt=typeof wt=="number"&&0<wt?bt+wt:bt):wt=bt,J){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=wt+P,J={id:m++,callback:gt,priorityLevel:J,startTime:wt,expirationTime:P,sortIndex:-1},wt>bt?(J.sortIndex=wt,n(h,J),r(p)===null&&J===r(h)&&(b?(O(k),k=-1):b=!0,dt(B,wt-bt))):(J.sortIndex=P,n(p,J),S||w||(S=!0,V||(V=!0,L()))),J},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(J){var gt=v;return function(){var wt=v;v=gt;try{return J.apply(this,arguments)}finally{v=wt}}}}(Vh)),Vh}var bg;function ww(){return bg||(bg=1,Yh.exports=bw()),Yh.exports}var Xh={exports:{}},lr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wg;function Sw(){if(wg)return lr;wg=1;var t=Kd();function n(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(n(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(p,h,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:y==null?null:""+y,children:p,containerInfo:h,implementation:m}}var f=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return lr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,lr.createPortal=function(p,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(n(299));return c(p,h,null,m)},lr.flushSync=function(p){var h=f.T,m=i.p;try{if(f.T=null,i.p=2,p)return p()}finally{f.T=h,i.p=m,i.d.f()}},lr.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(p,h))},lr.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},lr.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var m=h.as,y=d(m,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,w=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?i.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:w}):m==="script"&&i.d.X(p,{crossOrigin:y,integrity:v,fetchPriority:w,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},lr.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=d(h.as,h.crossOrigin);i.d.M(p,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(p)},lr.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,y=d(m,h.crossOrigin);i.d.L(p,m,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},lr.preloadModule=function(p,h){if(typeof p=="string")if(h){var m=d(h.as,h.crossOrigin);i.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(p)},lr.requestFormReset=function(p){i.d.r(p)},lr.unstable_batchedUpdates=function(p,h){return p(h)},lr.useFormState=function(p,h,m){return f.H.useFormState(p,h,m)},lr.useFormStatus=function(){return f.H.useHostTransitionStatus()},lr.version="19.1.0",lr}var Sg;function Ew(){if(Sg)return Xh.exports;Sg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Xh.exports=Sw(),Xh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eg;function Tw(){if(Eg)return Eo;Eg=1;var t=ww(),n=Kd(),r=Ew();function i(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function c(a){var s=a,o=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(o=s.return),a=s.return;while(a)}return s.tag===3?o:null}function f(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function d(a){if(c(a)!==a)throw Error(i(188))}function p(a){var s=a.alternate;if(!s){if(s=c(a),s===null)throw Error(i(188));return s!==a?null:a}for(var o=a,u=s;;){var x=o.return;if(x===null)break;var g=x.alternate;if(g===null){if(u=x.return,u!==null){o=u;continue}break}if(x.child===g.child){for(g=x.child;g;){if(g===o)return d(x),a;if(g===u)return d(x),s;g=g.sibling}throw Error(i(188))}if(o.return!==u.return)o=x,u=g;else{for(var M=!1,X=x.child;X;){if(X===o){M=!0,o=x,u=g;break}if(X===u){M=!0,u=x,o=g;break}X=X.sibling}if(!M){for(X=g.child;X;){if(X===o){M=!0,o=g,u=x;break}if(X===u){M=!0,u=g,o=x;break}X=X.sibling}if(!M)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?a:s}function h(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=h(a),s!==null)return s;a=a.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),O=Symbol.for("react.consumer"),C=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function L(a){return a===null||typeof a!="object"?null:(a=D&&a[D]||a["@@iterator"],typeof a=="function"?a:null)}var K=Symbol.for("react.client.reference");function ft(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===K?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case E:return"Profiler";case b:return"StrictMode";case B:return"Suspense";case V:return"SuspenseList";case T:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case w:return"Portal";case C:return(a.displayName||"Context")+".Provider";case O:return(a._context.displayName||"Context")+".Consumer";case U:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case k:return s=a.displayName||null,s!==null?s:ft(a.type)||"Memo";case F:s=a._payload,a=a._init;try{return ft(a(s))}catch{}}return null}var dt=Array.isArray,J=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wt={pending:!1,data:null,method:null,action:null},bt=[],P=-1;function I(a){return{current:a}}function R(a){0>P||(a.current=bt[P],bt[P]=null,P--)}function Y(a,s){P++,bt[P]=a.current,a.current=s}var z=I(null),W=I(null),tt=I(null),nt=I(null);function j(a,s){switch(Y(tt,s),Y(W,a),Y(z,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?P1(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=P1(s),a=Y1(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}R(z),Y(z,a)}function q(){R(z),R(W),R(tt)}function lt(a){a.memoizedState!==null&&Y(nt,a);var s=z.current,o=Y1(s,a.type);s!==o&&(Y(W,a),Y(z,o))}function Ct(a){W.current===a&&(R(z),R(W)),nt.current===a&&(R(nt),yo._currentValue=wt)}var vt=Object.prototype.hasOwnProperty,Zt=t.unstable_scheduleCallback,Gt=t.unstable_cancelCallback,Kt=t.unstable_shouldYield,Yt=t.unstable_requestPaint,Et=t.unstable_now,Mt=t.unstable_getCurrentPriorityLevel,Ot=t.unstable_ImmediatePriority,Dt=t.unstable_UserBlockingPriority,ie=t.unstable_NormalPriority,xe=t.unstable_LowPriority,ue=t.unstable_IdlePriority,ge=t.log,ut=t.unstable_setDisableYieldValue,rt=null,ct=null;function pt(a){if(typeof ge=="function"&&ut(a),ct&&typeof ct.setStrictMode=="function")try{ct.setStrictMode(rt,a)}catch{}}var G=Math.clz32?Math.clz32:xt,st=Math.log,St=Math.LN2;function xt(a){return a>>>=0,a===0?32:31-(st(a)/St|0)|0}var mt=256,yt=4194304;function Ut(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function te(a,s,o){var u=a.pendingLanes;if(u===0)return 0;var x=0,g=a.suspendedLanes,M=a.pingedLanes;a=a.warmLanes;var X=u&134217727;return X!==0?(u=X&~g,u!==0?x=Ut(u):(M&=X,M!==0?x=Ut(M):o||(o=X&~a,o!==0&&(x=Ut(o))))):(X=u&~g,X!==0?x=Ut(X):M!==0?x=Ut(M):o||(o=u&~a,o!==0&&(x=Ut(o)))),x===0?0:s!==0&&s!==x&&(s&g)===0&&(g=x&-x,o=s&-s,g>=o||g===32&&(o&4194048)!==0)?s:x}function Bt(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function At(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pt(){var a=mt;return mt<<=1,(mt&4194048)===0&&(mt=256),a}function Tt(){var a=yt;return yt<<=1,(yt&62914560)===0&&(yt=4194304),a}function ae(a){for(var s=[],o=0;31>o;o++)s.push(a);return s}function pe(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function be(a,s,o,u,x,g){var M=a.pendingLanes;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=o,a.entangledLanes&=o,a.errorRecoveryDisabledLanes&=o,a.shellSuspendCounter=0;var X=a.entanglements,ht=a.expirationTimes,zt=a.hiddenUpdates;for(o=M&~o;0<o;){var Wt=31-G(o),Qt=1<<Wt;X[Wt]=0,ht[Wt]=-1;var It=zt[Wt];if(It!==null)for(zt[Wt]=null,Wt=0;Wt<It.length;Wt++){var $t=It[Wt];$t!==null&&($t.lane&=-536870913)}o&=~Qt}u!==0&&Ee(a,u,0),g!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=g&~(M&~s))}function Ee(a,s,o){a.pendingLanes|=s,a.suspendedLanes&=~s;var u=31-G(s);a.entangledLanes|=s,a.entanglements[u]=a.entanglements[u]|1073741824|o&4194090}function Le(a,s){var o=a.entangledLanes|=s;for(a=a.entanglements;o;){var u=31-G(o),x=1<<u;x&s|a[u]&s&&(a[u]|=s),o&=~x}}function Ue(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function $e(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function pn(){var a=gt.p;return a!==0?a:(a=window.event,a===void 0?32:fg(a.type))}function $n(a,s){var o=gt.p;try{return gt.p=a,s()}finally{gt.p=o}}var dr=Math.random().toString(36).slice(2),xn="__reactFiber$"+dr,qe="__reactProps$"+dr,pr="__reactContainer$"+dr,ka="__reactEvents$"+dr,Fa="__reactListeners$"+dr,H="__reactHandles$"+dr,it="__reactResources$"+dr,Q="__reactMarker$"+dr;function et(a){delete a[xn],delete a[qe],delete a[ka],delete a[Fa],delete a[H]}function at(a){var s=a[xn];if(s)return s;for(var o=a.parentNode;o;){if(s=o[pr]||o[xn]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(a=q1(a);a!==null;){if(o=a[xn])return o;a=q1(a)}return s}a=o,o=a.parentNode}return null}function ot(a){if(a=a[xn]||a[pr]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function Lt(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(i(33))}function Vt(a){var s=a[it];return s||(s=a[it]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function kt(a){a[Q]=!0}var jt=new Set,Ht={};function re(a,s){le(a,s),le(a+"Capture",s)}function le(a,s){for(Ht[a]=s,a=0;a<s.length;a++)jt.add(s[a])}var me=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),se={},de={};function Fe(a){return vt.call(de,a)?!0:vt.call(se,a)?!1:me.test(a)?de[a]=!0:(se[a]=!0,!1)}function rn(a,s,o){if(Fe(s))if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+o)}}function an(a,s,o){if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+o)}}function hn(a,s,o,u){if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttributeNS(s,o,""+u)}}var Ca,ai;function Ur(a){if(Ca===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Ca=s&&s[1]||"",ai=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ca+a+ai}var Jr=!1;function Bi(a,s){if(!a||Jr)return"";Jr=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var Qt=function(){throw Error()};if(Object.defineProperty(Qt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qt,[])}catch($t){var It=$t}Reflect.construct(a,[],Qt)}else{try{Qt.call()}catch($t){It=$t}a.call(Qt.prototype)}}else{try{throw Error()}catch($t){It=$t}(Qt=a())&&typeof Qt.catch=="function"&&Qt.catch(function(){})}}catch($t){if($t&&It&&typeof $t.stack=="string")return[$t.stack,It.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),M=g[0],X=g[1];if(M&&X){var ht=M.split(`
`),zt=X.split(`
`);for(x=u=0;u<ht.length&&!ht[u].includes("DetermineComponentFrameRoot");)u++;for(;x<zt.length&&!zt[x].includes("DetermineComponentFrameRoot");)x++;if(u===ht.length||x===zt.length)for(u=ht.length-1,x=zt.length-1;1<=u&&0<=x&&ht[u]!==zt[x];)x--;for(;1<=u&&0<=x;u--,x--)if(ht[u]!==zt[x]){if(u!==1||x!==1)do if(u--,x--,0>x||ht[u]!==zt[x]){var Wt=`
`+ht[u].replace(" at new "," at ");return a.displayName&&Wt.includes("<anonymous>")&&(Wt=Wt.replace("<anonymous>",a.displayName)),Wt}while(1<=u&&0<=x);break}}}finally{Jr=!1,Error.prepareStackTrace=o}return(o=a?a.displayName||a.name:"")?Ur(o):""}function ta(a){switch(a.tag){case 26:case 27:case 5:return Ur(a.type);case 16:return Ur("Lazy");case 13:return Ur("Suspense");case 19:return Ur("SuspenseList");case 0:case 15:return Bi(a.type,!1);case 11:return Bi(a.type.render,!1);case 1:return Bi(a.type,!0);case 31:return Ur("Activity");default:return""}}function jp(a){try{var s="";do s+=ta(a),a=a.return;while(a);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Hr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ip(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function db(a){var s=Ip(a)?"checked":"value",o=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),u=""+a[s];if(!a.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var x=o.get,g=o.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return x.call(this)},set:function(M){u=""+M,g.call(this,M)}}),Object.defineProperty(a,s,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(M){u=""+M},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function dc(a){a._valueTracker||(a._valueTracker=db(a))}function Up(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return a&&(u=Ip(a)?a.checked?"true":"false":a.value),a=u,a!==o?(s.setValue(a),!0):!1}function pc(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var pb=/[\n"\\]/g;function $r(a){return a.replace(pb,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function I0(a,s,o,u,x,g,M,X){a.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?a.type=M:a.removeAttribute("type"),s!=null?M==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Hr(s)):a.value!==""+Hr(s)&&(a.value=""+Hr(s)):M!=="submit"&&M!=="reset"||a.removeAttribute("value"),s!=null?U0(a,M,Hr(s)):o!=null?U0(a,M,Hr(o)):u!=null&&a.removeAttribute("value"),x==null&&g!=null&&(a.defaultChecked=!!g),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?a.name=""+Hr(X):a.removeAttribute("name")}function Hp(a,s,o,u,x,g,M,X){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(a.type=g),s!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||s!=null))return;o=o!=null?""+Hr(o):"",s=s!=null?""+Hr(s):o,X||s===a.value||(a.value=s),a.defaultValue=s}u=u??x,u=typeof u!="function"&&typeof u!="symbol"&&!!u,a.checked=X?a.checked:!!u,a.defaultChecked=!!u,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(a.name=M)}function U0(a,s,o){s==="number"&&pc(a.ownerDocument)===a||a.defaultValue===""+o||(a.defaultValue=""+o)}function ws(a,s,o,u){if(a=a.options,s){s={};for(var x=0;x<o.length;x++)s["$"+o[x]]=!0;for(o=0;o<a.length;o++)x=s.hasOwnProperty("$"+a[o].value),a[o].selected!==x&&(a[o].selected=x),x&&u&&(a[o].defaultSelected=!0)}else{for(o=""+Hr(o),s=null,x=0;x<a.length;x++){if(a[x].value===o){a[x].selected=!0,u&&(a[x].defaultSelected=!0);return}s!==null||a[x].disabled||(s=a[x])}s!==null&&(s.selected=!0)}}function $p(a,s,o){if(s!=null&&(s=""+Hr(s),s!==a.value&&(a.value=s),o==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=o!=null?""+Hr(o):""}function Gp(a,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(dt(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=Hr(s),a.defaultValue=o,u=a.textContent,u===o&&u!==""&&u!==null&&(a.value=u)}function Ss(a,s){if(s){var o=a.firstChild;if(o&&o===a.lastChild&&o.nodeType===3){o.nodeValue=s;return}}a.textContent=s}var xb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pp(a,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":u?a.setProperty(s,o):typeof o!="number"||o===0||xb.has(s)?s==="float"?a.cssFloat=o:a[s]=(""+o).trim():a[s]=o+"px"}function Yp(a,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(a=a.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="");for(var x in s)u=s[x],s.hasOwnProperty(x)&&o[x]!==u&&Pp(a,x,u)}else for(var g in s)s.hasOwnProperty(g)&&Pp(a,g,s[g])}function H0(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xc(a){return gb.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var $0=null;function G0(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Es=null,Ts=null;function Vp(a){var s=ot(a);if(s&&(a=s.stateNode)){var o=a[qe]||null;t:switch(a=s.stateNode,s.type){case"input":if(I0(a,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=a;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+$r(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==a&&u.form===a.form){var x=u[qe]||null;if(!x)throw Error(i(90));I0(u,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===a.form&&Up(u)}break t;case"textarea":$p(a,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&ws(a,!!o.multiple,s,!1)}}}var P0=!1;function Xp(a,s,o){if(P0)return a(s,o);P0=!0;try{var u=a(s);return u}finally{if(P0=!1,(Es!==null||Ts!==null)&&(tf(),Es&&(s=Es,a=Ts,Ts=Es=null,Vp(s),a)))for(s=0;s<a.length;s++)Vp(a[s])}}function Fl(a,s){var o=a.stateNode;if(o===null)return null;var u=o[qe]||null;if(u===null)return null;o=u[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(a=a.type,u=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!u;break t;default:a=!1}if(a)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Ra=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Y0=!1;if(Ra)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){Y0=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{Y0=!1}var ii=null,V0=null,mc=null;function Wp(){if(mc)return mc;var a,s=V0,o=s.length,u,x="value"in ii?ii.value:ii.textContent,g=x.length;for(a=0;a<o&&s[a]===x[a];a++);var M=o-a;for(u=1;u<=M&&s[o-u]===x[g-u];u++);return mc=x.slice(a,1<u?1-u:void 0)}function gc(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function yc(){return!0}function qp(){return!1}function vr(a){function s(o,u,x,g,M){this._reactName=o,this._targetInst=x,this.type=u,this.nativeEvent=g,this.target=M,this.currentTarget=null;for(var X in a)a.hasOwnProperty(X)&&(o=a[X],this[X]=o?o(g):g[X]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?yc:qp,this.isPropagationStopped=qp,this}return m(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=yc)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=yc)},persist:function(){},isPersistent:yc}),s}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vc=vr(ji),Rl=m({},ji,{view:0,detail:0}),yb=vr(Rl),X0,W0,Ml,_c=m({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:K0,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ml&&(Ml&&a.type==="mousemove"?(X0=a.screenX-Ml.screenX,W0=a.screenY-Ml.screenY):W0=X0=0,Ml=a),X0)},movementY:function(a){return"movementY"in a?a.movementY:W0}}),Kp=vr(_c),vb=m({},_c,{dataTransfer:0}),_b=vr(vb),bb=m({},Rl,{relatedTarget:0}),q0=vr(bb),wb=m({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),Sb=vr(wb),Eb=m({},ji,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Tb=vr(Eb),Ab=m({},ji,{data:0}),Zp=vr(Ab),Db={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fb(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=kb[a])?!!s[a]:!1}function K0(){return Fb}var Cb=m({},Rl,{key:function(a){if(a.key){var s=Db[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=gc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Nb[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:K0,charCode:function(a){return a.type==="keypress"?gc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?gc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Rb=vr(Cb),Mb=m({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qp=vr(Mb),Ob=m({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:K0}),zb=vr(Ob),Lb=m({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bb=vr(Lb),jb=m({},_c,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Ib=vr(jb),Ub=m({},ji,{newState:0,oldState:0}),Hb=vr(Ub),$b=[9,13,27,32],Z0=Ra&&"CompositionEvent"in window,Ol=null;Ra&&"documentMode"in document&&(Ol=document.documentMode);var Gb=Ra&&"TextEvent"in window&&!Ol,Jp=Ra&&(!Z0||Ol&&8<Ol&&11>=Ol),tx=" ",ex=!1;function nx(a,s){switch(a){case"keyup":return $b.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var As=!1;function Pb(a,s){switch(a){case"compositionend":return rx(s);case"keypress":return s.which!==32?null:(ex=!0,tx);case"textInput":return a=s.data,a===tx&&ex?null:a;default:return null}}function Yb(a,s){if(As)return a==="compositionend"||!Z0&&nx(a,s)?(a=Wp(),mc=V0=ii=null,As=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Jp&&s.locale!=="ko"?null:s.data;default:return null}}var Vb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ax(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Vb[a.type]:s==="textarea"}function ix(a,s,o,u){Es?Ts?Ts.push(u):Ts=[u]:Es=u,s=lf(s,"onChange"),0<s.length&&(o=new vc("onChange","change",null,o,u),a.push({event:o,listeners:s}))}var zl=null,Ll=null;function Xb(a){I1(a,0)}function bc(a){var s=Lt(a);if(Up(s))return a}function sx(a,s){if(a==="change")return s}var lx=!1;if(Ra){var Q0;if(Ra){var J0="oninput"in document;if(!J0){var ox=document.createElement("div");ox.setAttribute("oninput","return;"),J0=typeof ox.oninput=="function"}Q0=J0}else Q0=!1;lx=Q0&&(!document.documentMode||9<document.documentMode)}function cx(){zl&&(zl.detachEvent("onpropertychange",fx),Ll=zl=null)}function fx(a){if(a.propertyName==="value"&&bc(Ll)){var s=[];ix(s,Ll,a,G0(a)),Xp(Xb,s)}}function Wb(a,s,o){a==="focusin"?(cx(),zl=s,Ll=o,zl.attachEvent("onpropertychange",fx)):a==="focusout"&&cx()}function qb(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return bc(Ll)}function Kb(a,s){if(a==="click")return bc(s)}function Zb(a,s){if(a==="input"||a==="change")return bc(s)}function Qb(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Dr=typeof Object.is=="function"?Object.is:Qb;function Bl(a,s){if(Dr(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var o=Object.keys(a),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var x=o[u];if(!vt.call(s,x)||!Dr(a[x],s[x]))return!1}return!0}function ux(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function hx(a,s){var o=ux(a);a=0;for(var u;o;){if(o.nodeType===3){if(u=a+o.textContent.length,a<=s&&u>=s)return{node:o,offset:s-a};a=u}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=ux(o)}}function dx(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?dx(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function px(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=pc(a.document);s instanceof a.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)a=s.contentWindow;else break;s=pc(a.document)}return s}function tu(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var Jb=Ra&&"documentMode"in document&&11>=document.documentMode,Ds=null,eu=null,jl=null,nu=!1;function xx(a,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;nu||Ds==null||Ds!==pc(u)||(u=Ds,"selectionStart"in u&&tu(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),jl&&Bl(jl,u)||(jl=u,u=lf(eu,"onSelect"),0<u.length&&(s=new vc("onSelect","select",null,s,o),a.push({event:s,listeners:u}),s.target=Ds)))}function Ii(a,s){var o={};return o[a.toLowerCase()]=s.toLowerCase(),o["Webkit"+a]="webkit"+s,o["Moz"+a]="moz"+s,o}var Ns={animationend:Ii("Animation","AnimationEnd"),animationiteration:Ii("Animation","AnimationIteration"),animationstart:Ii("Animation","AnimationStart"),transitionrun:Ii("Transition","TransitionRun"),transitionstart:Ii("Transition","TransitionStart"),transitioncancel:Ii("Transition","TransitionCancel"),transitionend:Ii("Transition","TransitionEnd")},ru={},mx={};Ra&&(mx=document.createElement("div").style,"AnimationEvent"in window||(delete Ns.animationend.animation,delete Ns.animationiteration.animation,delete Ns.animationstart.animation),"TransitionEvent"in window||delete Ns.transitionend.transition);function Ui(a){if(ru[a])return ru[a];if(!Ns[a])return a;var s=Ns[a],o;for(o in s)if(s.hasOwnProperty(o)&&o in mx)return ru[a]=s[o];return a}var gx=Ui("animationend"),yx=Ui("animationiteration"),vx=Ui("animationstart"),t4=Ui("transitionrun"),e4=Ui("transitionstart"),n4=Ui("transitioncancel"),_x=Ui("transitionend"),bx=new Map,au="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");au.push("scrollEnd");function ea(a,s){bx.set(a,s),re(s,[a])}var wx=new WeakMap;function Gr(a,s){if(typeof a=="object"&&a!==null){var o=wx.get(a);return o!==void 0?o:(s={value:a,source:s,stack:jp(s)},wx.set(a,s),s)}return{value:a,source:s,stack:jp(s)}}var Pr=[],ks=0,iu=0;function wc(){for(var a=ks,s=iu=ks=0;s<a;){var o=Pr[s];Pr[s++]=null;var u=Pr[s];Pr[s++]=null;var x=Pr[s];Pr[s++]=null;var g=Pr[s];if(Pr[s++]=null,u!==null&&x!==null){var M=u.pending;M===null?x.next=x:(x.next=M.next,M.next=x),u.pending=x}g!==0&&Sx(o,x,g)}}function Sc(a,s,o,u){Pr[ks++]=a,Pr[ks++]=s,Pr[ks++]=o,Pr[ks++]=u,iu|=u,a.lanes|=u,a=a.alternate,a!==null&&(a.lanes|=u)}function su(a,s,o,u){return Sc(a,s,o,u),Ec(a)}function Fs(a,s){return Sc(a,null,null,s),Ec(a)}function Sx(a,s,o){a.lanes|=o;var u=a.alternate;u!==null&&(u.lanes|=o);for(var x=!1,g=a.return;g!==null;)g.childLanes|=o,u=g.alternate,u!==null&&(u.childLanes|=o),g.tag===22&&(a=g.stateNode,a===null||a._visibility&1||(x=!0)),a=g,g=g.return;return a.tag===3?(g=a.stateNode,x&&s!==null&&(x=31-G(o),a=g.hiddenUpdates,u=a[x],u===null?a[x]=[s]:u.push(s),s.lane=o|536870912),g):null}function Ec(a){if(50<co)throw co=0,hh=null,Error(i(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Cs={};function r4(a,s,o,u){this.tag=a,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(a,s,o,u){return new r4(a,s,o,u)}function lu(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ma(a,s){var o=a.alternate;return o===null?(o=Nr(a.tag,s,a.key,a.mode),o.elementType=a.elementType,o.type=a.type,o.stateNode=a.stateNode,o.alternate=a,a.alternate=o):(o.pendingProps=s,o.type=a.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=a.flags&65011712,o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,s=a.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=a.sibling,o.index=a.index,o.ref=a.ref,o.refCleanup=a.refCleanup,o}function Ex(a,s){a.flags&=65011714;var o=a.alternate;return o===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,s=o.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function Tc(a,s,o,u,x,g){var M=0;if(u=a,typeof a=="function")lu(a)&&(M=1);else if(typeof a=="string")M=iw(a,o,z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case T:return a=Nr(31,o,s,x),a.elementType=T,a.lanes=g,a;case S:return Hi(o.children,x,g,s);case b:M=8,x|=24;break;case E:return a=Nr(12,o,s,x|2),a.elementType=E,a.lanes=g,a;case B:return a=Nr(13,o,s,x),a.elementType=B,a.lanes=g,a;case V:return a=Nr(19,o,s,x),a.elementType=V,a.lanes=g,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case A:case C:M=10;break t;case O:M=9;break t;case U:M=11;break t;case k:M=14;break t;case F:M=16,u=null;break t}M=29,o=Error(i(130,a===null?"null":typeof a,"")),u=null}return s=Nr(M,o,s,x),s.elementType=a,s.type=u,s.lanes=g,s}function Hi(a,s,o,u){return a=Nr(7,a,u,s),a.lanes=o,a}function ou(a,s,o){return a=Nr(6,a,null,s),a.lanes=o,a}function cu(a,s,o){return s=Nr(4,a.children!==null?a.children:[],a.key,s),s.lanes=o,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var Rs=[],Ms=0,Ac=null,Dc=0,Yr=[],Vr=0,$i=null,Oa=1,za="";function Gi(a,s){Rs[Ms++]=Dc,Rs[Ms++]=Ac,Ac=a,Dc=s}function Tx(a,s,o){Yr[Vr++]=Oa,Yr[Vr++]=za,Yr[Vr++]=$i,$i=a;var u=Oa;a=za;var x=32-G(u)-1;u&=~(1<<x),o+=1;var g=32-G(s)+x;if(30<g){var M=x-x%5;g=(u&(1<<M)-1).toString(32),u>>=M,x-=M,Oa=1<<32-G(s)+x|o<<x|u,za=g+a}else Oa=1<<g|o<<x|u,za=a}function fu(a){a.return!==null&&(Gi(a,1),Tx(a,1,0))}function uu(a){for(;a===Ac;)Ac=Rs[--Ms],Rs[Ms]=null,Dc=Rs[--Ms],Rs[Ms]=null;for(;a===$i;)$i=Yr[--Vr],Yr[Vr]=null,za=Yr[--Vr],Yr[Vr]=null,Oa=Yr[--Vr],Yr[Vr]=null}var xr=null,Sn=null,Ve=!1,Pi=null,xa=!1,hu=Error(i(519));function Yi(a){var s=Error(i(418,""));throw Hl(Gr(s,a)),hu}function Ax(a){var s=a.stateNode,o=a.type,u=a.memoizedProps;switch(s[xn]=a,s[qe]=u,o){case"dialog":je("cancel",s),je("close",s);break;case"iframe":case"object":case"embed":je("load",s);break;case"video":case"audio":for(o=0;o<uo.length;o++)je(uo[o],s);break;case"source":je("error",s);break;case"img":case"image":case"link":je("error",s),je("load",s);break;case"details":je("toggle",s);break;case"input":je("invalid",s),Hp(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),dc(s);break;case"select":je("invalid",s);break;case"textarea":je("invalid",s),Gp(s,u.value,u.defaultValue,u.children),dc(s)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||G1(s.textContent,o)?(u.popover!=null&&(je("beforetoggle",s),je("toggle",s)),u.onScroll!=null&&je("scroll",s),u.onScrollEnd!=null&&je("scrollend",s),u.onClick!=null&&(s.onclick=of),s=!0):s=!1,s||Yi(a)}function Dx(a){for(xr=a.return;xr;)switch(xr.tag){case 5:case 13:xa=!1;return;case 27:case 3:xa=!0;return;default:xr=xr.return}}function Il(a){if(a!==xr)return!1;if(!Ve)return Dx(a),Ve=!0,!1;var s=a.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=a.type,o=!(o!=="form"&&o!=="button")||Nh(a.type,a.memoizedProps)),o=!o),o&&Sn&&Yi(a),Dx(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));t:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(o=a.data,o==="/$"){if(s===0){Sn=ra(a.nextSibling);break t}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;a=a.nextSibling}Sn=null}}else s===27?(s=Sn,bi(a.type)?(a=Rh,Rh=null,Sn=a):Sn=s):Sn=xr?ra(a.stateNode.nextSibling):null;return!0}function Ul(){Sn=xr=null,Ve=!1}function Nx(){var a=Pi;return a!==null&&(wr===null?wr=a:wr.push.apply(wr,a),Pi=null),a}function Hl(a){Pi===null?Pi=[a]:Pi.push(a)}var du=I(null),Vi=null,La=null;function si(a,s,o){Y(du,s._currentValue),s._currentValue=o}function Ba(a){a._currentValue=du.current,R(du)}function pu(a,s,o){for(;a!==null;){var u=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),a===o)break;a=a.return}}function xu(a,s,o,u){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var g=x.dependencies;if(g!==null){var M=x.child;g=g.firstContext;t:for(;g!==null;){var X=g;g=x;for(var ht=0;ht<s.length;ht++)if(X.context===s[ht]){g.lanes|=o,X=g.alternate,X!==null&&(X.lanes|=o),pu(g.return,o,a),u||(M=null);break t}g=X.next}}else if(x.tag===18){if(M=x.return,M===null)throw Error(i(341));M.lanes|=o,g=M.alternate,g!==null&&(g.lanes|=o),pu(M,o,a),M=null}else M=x.child;if(M!==null)M.return=x;else for(M=x;M!==null;){if(M===a){M=null;break}if(x=M.sibling,x!==null){x.return=M.return,M=x;break}M=M.return}x=M}}function $l(a,s,o,u){a=null;for(var x=s,g=!1;x!==null;){if(!g){if((x.flags&524288)!==0)g=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var M=x.alternate;if(M===null)throw Error(i(387));if(M=M.memoizedProps,M!==null){var X=x.type;Dr(x.pendingProps.value,M.value)||(a!==null?a.push(X):a=[X])}}else if(x===nt.current){if(M=x.alternate,M===null)throw Error(i(387));M.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(yo):a=[yo])}x=x.return}a!==null&&xu(s,a,o,u),s.flags|=262144}function Nc(a){for(a=a.firstContext;a!==null;){if(!Dr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Xi(a){Vi=a,La=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function sr(a){return kx(Vi,a)}function kc(a,s){return Vi===null&&Xi(a),kx(a,s)}function kx(a,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},La===null){if(a===null)throw Error(i(308));La=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else La=La.next=s;return o}var a4=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(o,u){a.push(u)}};this.abort=function(){s.aborted=!0,a.forEach(function(o){return o()})}},i4=t.unstable_scheduleCallback,s4=t.unstable_NormalPriority,jn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mu(){return{controller:new a4,data:new Map,refCount:0}}function Gl(a){a.refCount--,a.refCount===0&&i4(s4,function(){a.controller.abort()})}var Pl=null,gu=0,Os=0,zs=null;function l4(a,s){if(Pl===null){var o=Pl=[];gu=0,Os=vh(),zs={status:"pending",value:void 0,then:function(u){o.push(u)}}}return gu++,s.then(Fx,Fx),s}function Fx(){if(--gu===0&&Pl!==null){zs!==null&&(zs.status="fulfilled");var a=Pl;Pl=null,Os=0,zs=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function o4(a,s){var o=[],u={status:"pending",value:null,reason:null,then:function(x){o.push(x)}};return a.then(function(){u.status="fulfilled",u.value=s;for(var x=0;x<o.length;x++)(0,o[x])(s)},function(x){for(u.status="rejected",u.reason=x,x=0;x<o.length;x++)(0,o[x])(void 0)}),u}var Cx=J.S;J.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&l4(a,s),Cx!==null&&Cx(a,s)};var Wi=I(null);function yu(){var a=Wi.current;return a!==null?a:dn.pooledCache}function Fc(a,s){s===null?Y(Wi,Wi.current):Y(Wi,s.pool)}function Rx(){var a=yu();return a===null?null:{parent:jn._currentValue,pool:a}}var Yl=Error(i(460)),Mx=Error(i(474)),Cc=Error(i(542)),vu={then:function(){}};function Ox(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Rc(){}function zx(a,s,o){switch(o=a[o],o===void 0?a.push(s):o!==s&&(s.then(Rc,Rc),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Bx(a),a;default:if(typeof s.status=="string")s.then(Rc,Rc);else{if(a=dn,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=s,a.status="pending",a.then(function(u){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=u}},function(u){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Bx(a),a}throw Vl=s,Yl}}var Vl=null;function Lx(){if(Vl===null)throw Error(i(459));var a=Vl;return Vl=null,a}function Bx(a){if(a===Yl||a===Cc)throw Error(i(483))}var li=!1;function _u(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bu(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function oi(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ci(a,s,o){var u=a.updateQueue;if(u===null)return null;if(u=u.shared,(Ke&2)!==0){var x=u.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),u.pending=s,s=Ec(a),Sx(a,null,o),s}return Sc(a,u,s,o),Ec(a)}function Xl(a,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,Le(a,o)}}function wu(a,s){var o=a.updateQueue,u=a.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var x=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var M={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?x=g=M:g=g.next=M,o=o.next}while(o!==null);g===null?x=g=s:g=g.next=s}else x=g=s;o={baseState:u.baseState,firstBaseUpdate:x,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},a.updateQueue=o;return}a=o.lastBaseUpdate,a===null?o.firstBaseUpdate=s:a.next=s,o.lastBaseUpdate=s}var Su=!1;function Wl(){if(Su){var a=zs;if(a!==null)throw a}}function ql(a,s,o,u){Su=!1;var x=a.updateQueue;li=!1;var g=x.firstBaseUpdate,M=x.lastBaseUpdate,X=x.shared.pending;if(X!==null){x.shared.pending=null;var ht=X,zt=ht.next;ht.next=null,M===null?g=zt:M.next=zt,M=ht;var Wt=a.alternate;Wt!==null&&(Wt=Wt.updateQueue,X=Wt.lastBaseUpdate,X!==M&&(X===null?Wt.firstBaseUpdate=zt:X.next=zt,Wt.lastBaseUpdate=ht))}if(g!==null){var Qt=x.baseState;M=0,Wt=zt=ht=null,X=g;do{var It=X.lane&-536870913,$t=It!==X.lane;if($t?(He&It)===It:(u&It)===It){It!==0&&It===Os&&(Su=!0),Wt!==null&&(Wt=Wt.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});t:{var Ne=a,Ae=X;It=s;var on=o;switch(Ae.tag){case 1:if(Ne=Ae.payload,typeof Ne=="function"){Qt=Ne.call(on,Qt,It);break t}Qt=Ne;break t;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=Ae.payload,It=typeof Ne=="function"?Ne.call(on,Qt,It):Ne,It==null)break t;Qt=m({},Qt,It);break t;case 2:li=!0}}It=X.callback,It!==null&&(a.flags|=64,$t&&(a.flags|=8192),$t=x.callbacks,$t===null?x.callbacks=[It]:$t.push(It))}else $t={lane:It,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Wt===null?(zt=Wt=$t,ht=Qt):Wt=Wt.next=$t,M|=It;if(X=X.next,X===null){if(X=x.shared.pending,X===null)break;$t=X,X=$t.next,$t.next=null,x.lastBaseUpdate=$t,x.shared.pending=null}}while(!0);Wt===null&&(ht=Qt),x.baseState=ht,x.firstBaseUpdate=zt,x.lastBaseUpdate=Wt,g===null&&(x.shared.lanes=0),gi|=M,a.lanes=M,a.memoizedState=Qt}}function jx(a,s){if(typeof a!="function")throw Error(i(191,a));a.call(s)}function Ix(a,s){var o=a.callbacks;if(o!==null)for(a.callbacks=null,a=0;a<o.length;a++)jx(o[a],s)}var Ls=I(null),Mc=I(0);function Ux(a,s){a=Pa,Y(Mc,a),Y(Ls,s),Pa=a|s.baseLanes}function Eu(){Y(Mc,Pa),Y(Ls,Ls.current)}function Tu(){Pa=Mc.current,R(Ls),R(Mc)}var fi=0,Oe=null,sn=null,Mn=null,Oc=!1,Bs=!1,qi=!1,zc=0,Kl=0,js=null,c4=0;function Nn(){throw Error(i(321))}function Au(a,s){if(s===null)return!1;for(var o=0;o<s.length&&o<a.length;o++)if(!Dr(a[o],s[o]))return!1;return!0}function Du(a,s,o,u,x,g){return fi=g,Oe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,J.H=a===null||a.memoizedState===null?Sm:Em,qi=!1,g=o(u,x),qi=!1,Bs&&(g=$x(s,o,u,x)),Hx(a),g}function Hx(a){J.H=Hc;var s=sn!==null&&sn.next!==null;if(fi=0,Mn=sn=Oe=null,Oc=!1,Kl=0,js=null,s)throw Error(i(300));a===null||Gn||(a=a.dependencies,a!==null&&Nc(a)&&(Gn=!0))}function $x(a,s,o,u){Oe=a;var x=0;do{if(Bs&&(js=null),Kl=0,Bs=!1,25<=x)throw Error(i(301));if(x+=1,Mn=sn=null,a.updateQueue!=null){var g=a.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}J.H=m4,g=s(o,u)}while(Bs);return g}function f4(){var a=J.H,s=a.useState()[0];return s=typeof s.then=="function"?Zl(s):s,a=a.useState()[0],(sn!==null?sn.memoizedState:null)!==a&&(Oe.flags|=1024),s}function Nu(){var a=zc!==0;return zc=0,a}function ku(a,s,o){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~o}function Fu(a){if(Oc){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Oc=!1}fi=0,Mn=sn=Oe=null,Bs=!1,Kl=zc=0,js=null}function _r(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?Oe.memoizedState=Mn=a:Mn=Mn.next=a,Mn}function On(){if(sn===null){var a=Oe.alternate;a=a!==null?a.memoizedState:null}else a=sn.next;var s=Mn===null?Oe.memoizedState:Mn.next;if(s!==null)Mn=s,sn=a;else{if(a===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));sn=a,a={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},Mn===null?Oe.memoizedState=Mn=a:Mn=Mn.next=a}return Mn}function Cu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zl(a){var s=Kl;return Kl+=1,js===null&&(js=[]),a=zx(js,a,s),s=Oe,(Mn===null?s.memoizedState:Mn.next)===null&&(s=s.alternate,J.H=s===null||s.memoizedState===null?Sm:Em),a}function Lc(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Zl(a);if(a.$$typeof===C)return sr(a)}throw Error(i(438,String(a)))}function Ru(a){var s=null,o=Oe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=Oe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Cu(),Oe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(a),u=0;u<a;u++)o[u]=N;return s.index++,o}function ja(a,s){return typeof s=="function"?s(a):s}function Bc(a){var s=On();return Mu(s,sn,a)}function Mu(a,s,o){var u=a.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var x=a.baseQueue,g=u.pending;if(g!==null){if(x!==null){var M=x.next;x.next=g.next,g.next=M}s.baseQueue=x=g,u.pending=null}if(g=a.baseState,x===null)a.memoizedState=g;else{s=x.next;var X=M=null,ht=null,zt=s,Wt=!1;do{var Qt=zt.lane&-536870913;if(Qt!==zt.lane?(He&Qt)===Qt:(fi&Qt)===Qt){var It=zt.revertLane;if(It===0)ht!==null&&(ht=ht.next={lane:0,revertLane:0,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),Qt===Os&&(Wt=!0);else if((fi&It)===It){zt=zt.next,It===Os&&(Wt=!0);continue}else Qt={lane:0,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},ht===null?(X=ht=Qt,M=g):ht=ht.next=Qt,Oe.lanes|=It,gi|=It;Qt=zt.action,qi&&o(g,Qt),g=zt.hasEagerState?zt.eagerState:o(g,Qt)}else It={lane:Qt,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},ht===null?(X=ht=It,M=g):ht=ht.next=It,Oe.lanes|=Qt,gi|=Qt;zt=zt.next}while(zt!==null&&zt!==s);if(ht===null?M=g:ht.next=X,!Dr(g,a.memoizedState)&&(Gn=!0,Wt&&(o=zs,o!==null)))throw o;a.memoizedState=g,a.baseState=M,a.baseQueue=ht,u.lastRenderedState=g}return x===null&&(u.lanes=0),[a.memoizedState,u.dispatch]}function Ou(a){var s=On(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=a;var u=o.dispatch,x=o.pending,g=s.memoizedState;if(x!==null){o.pending=null;var M=x=x.next;do g=a(g,M.action),M=M.next;while(M!==x);Dr(g,s.memoizedState)||(Gn=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),o.lastRenderedState=g}return[g,u]}function Gx(a,s,o){var u=Oe,x=On(),g=Ve;if(g){if(o===void 0)throw Error(i(407));o=o()}else o=s();var M=!Dr((sn||x).memoizedState,o);M&&(x.memoizedState=o,Gn=!0),x=x.queue;var X=Vx.bind(null,u,x,a);if(Ql(2048,8,X,[a]),x.getSnapshot!==s||M||Mn!==null&&Mn.memoizedState.tag&1){if(u.flags|=2048,Is(9,jc(),Yx.bind(null,u,x,o,s),null),dn===null)throw Error(i(349));g||(fi&124)!==0||Px(u,s,o)}return o}function Px(a,s,o){a.flags|=16384,a={getSnapshot:s,value:o},s=Oe.updateQueue,s===null?(s=Cu(),Oe.updateQueue=s,s.stores=[a]):(o=s.stores,o===null?s.stores=[a]:o.push(a))}function Yx(a,s,o,u){s.value=o,s.getSnapshot=u,Xx(s)&&Wx(a)}function Vx(a,s,o){return o(function(){Xx(s)&&Wx(a)})}function Xx(a){var s=a.getSnapshot;a=a.value;try{var o=s();return!Dr(a,o)}catch{return!0}}function Wx(a){var s=Fs(a,2);s!==null&&Mr(s,a,2)}function zu(a){var s=_r();if(typeof a=="function"){var o=a;if(a=o(),qi){pt(!0);try{o()}finally{pt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:a},s}function qx(a,s,o,u){return a.baseState=o,Mu(a,sn,typeof u=="function"?u:ja)}function u4(a,s,o,u,x){if(Uc(a))throw Error(i(485));if(a=s.action,a!==null){var g={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){g.listeners.push(M)}};J.T!==null?o(!0):g.isTransition=!1,u(g),o=s.pending,o===null?(g.next=s.pending=g,Kx(s,g)):(g.next=o.next,s.pending=o.next=g)}}function Kx(a,s){var o=s.action,u=s.payload,x=a.state;if(s.isTransition){var g=J.T,M={};J.T=M;try{var X=o(x,u),ht=J.S;ht!==null&&ht(M,X),Zx(a,s,X)}catch(zt){Lu(a,s,zt)}finally{J.T=g}}else try{g=o(x,u),Zx(a,s,g)}catch(zt){Lu(a,s,zt)}}function Zx(a,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Qx(a,s,u)},function(u){return Lu(a,s,u)}):Qx(a,s,o)}function Qx(a,s,o){s.status="fulfilled",s.value=o,Jx(s),a.state=o,s=a.pending,s!==null&&(o=s.next,o===s?a.pending=null:(o=o.next,s.next=o,Kx(a,o)))}function Lu(a,s,o){var u=a.pending;if(a.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,Jx(s),s=s.next;while(s!==u)}a.action=null}function Jx(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function tm(a,s){return s}function em(a,s){if(Ve){var o=dn.formState;if(o!==null){t:{var u=Oe;if(Ve){if(Sn){e:{for(var x=Sn,g=xa;x.nodeType!==8;){if(!g){x=null;break e}if(x=ra(x.nextSibling),x===null){x=null;break e}}g=x.data,x=g==="F!"||g==="F"?x:null}if(x){Sn=ra(x.nextSibling),u=x.data==="F!";break t}}Yi(u)}u=!1}u&&(s=o[0])}}return o=_r(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tm,lastRenderedState:s},o.queue=u,o=_m.bind(null,Oe,u),u.dispatch=o,u=zu(!1),g=Hu.bind(null,Oe,!1,u.queue),u=_r(),x={state:s,dispatch:null,action:a,pending:null},u.queue=x,o=u4.bind(null,Oe,x,g,o),x.dispatch=o,u.memoizedState=a,[s,o,!1]}function nm(a){var s=On();return rm(s,sn,a)}function rm(a,s,o){if(s=Mu(a,s,tm)[0],a=Bc(ja)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=Zl(s)}catch(M){throw M===Yl?Cc:M}else u=s;s=On();var x=s.queue,g=x.dispatch;return o!==s.memoizedState&&(Oe.flags|=2048,Is(9,jc(),h4.bind(null,x,o),null)),[u,g,a]}function h4(a,s){a.action=s}function am(a){var s=On(),o=sn;if(o!==null)return rm(s,o,a);On(),s=s.memoizedState,o=On();var u=o.queue.dispatch;return o.memoizedState=a,[s,u,!1]}function Is(a,s,o,u){return a={tag:a,create:o,deps:u,inst:s,next:null},s=Oe.updateQueue,s===null&&(s=Cu(),Oe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=a.next=a:(u=o.next,o.next=a,a.next=u,s.lastEffect=a),a}function jc(){return{destroy:void 0,resource:void 0}}function im(){return On().memoizedState}function Ic(a,s,o,u){var x=_r();u=u===void 0?null:u,Oe.flags|=a,x.memoizedState=Is(1|s,jc(),o,u)}function Ql(a,s,o,u){var x=On();u=u===void 0?null:u;var g=x.memoizedState.inst;sn!==null&&u!==null&&Au(u,sn.memoizedState.deps)?x.memoizedState=Is(s,g,o,u):(Oe.flags|=a,x.memoizedState=Is(1|s,g,o,u))}function sm(a,s){Ic(8390656,8,a,s)}function lm(a,s){Ql(2048,8,a,s)}function om(a,s){return Ql(4,2,a,s)}function cm(a,s){return Ql(4,4,a,s)}function fm(a,s){if(typeof s=="function"){a=a();var o=s(a);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function um(a,s,o){o=o!=null?o.concat([a]):null,Ql(4,4,fm.bind(null,s,a),o)}function Bu(){}function hm(a,s){var o=On();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Au(s,u[1])?u[0]:(o.memoizedState=[a,s],a)}function dm(a,s){var o=On();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Au(s,u[1]))return u[0];if(u=a(),qi){pt(!0);try{a()}finally{pt(!1)}}return o.memoizedState=[u,s],u}function ju(a,s,o){return o===void 0||(fi&1073741824)!==0?a.memoizedState=s:(a.memoizedState=o,a=m1(),Oe.lanes|=a,gi|=a,o)}function pm(a,s,o,u){return Dr(o,s)?o:Ls.current!==null?(a=ju(a,o,u),Dr(a,s)||(Gn=!0),a):(fi&42)===0?(Gn=!0,a.memoizedState=o):(a=m1(),Oe.lanes|=a,gi|=a,s)}function xm(a,s,o,u,x){var g=gt.p;gt.p=g!==0&&8>g?g:8;var M=J.T,X={};J.T=X,Hu(a,!1,s,o);try{var ht=x(),zt=J.S;if(zt!==null&&zt(X,ht),ht!==null&&typeof ht=="object"&&typeof ht.then=="function"){var Wt=o4(ht,u);Jl(a,s,Wt,Rr(a))}else Jl(a,s,u,Rr(a))}catch(Qt){Jl(a,s,{then:function(){},status:"rejected",reason:Qt},Rr())}finally{gt.p=g,J.T=M}}function d4(){}function Iu(a,s,o,u){if(a.tag!==5)throw Error(i(476));var x=mm(a).queue;xm(a,x,s,wt,o===null?d4:function(){return gm(a),o(u)})}function mm(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:wt,baseState:wt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:wt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:o},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function gm(a){var s=mm(a).next.queue;Jl(a,s,{},Rr())}function Uu(){return sr(yo)}function ym(){return On().memoizedState}function vm(){return On().memoizedState}function p4(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var o=Rr();a=oi(o);var u=ci(s,a,o);u!==null&&(Mr(u,s,o),Xl(u,s,o)),s={cache:mu()},a.payload=s;return}s=s.return}}function x4(a,s,o){var u=Rr();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Uc(a)?bm(s,o):(o=su(a,s,o,u),o!==null&&(Mr(o,a,u),wm(o,s,u)))}function _m(a,s,o){var u=Rr();Jl(a,s,o,u)}function Jl(a,s,o,u){var x={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Uc(a))bm(s,x);else{var g=a.alternate;if(a.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var M=s.lastRenderedState,X=g(M,o);if(x.hasEagerState=!0,x.eagerState=X,Dr(X,M))return Sc(a,s,x,0),dn===null&&wc(),!1}catch{}finally{}if(o=su(a,s,x,u),o!==null)return Mr(o,a,u),wm(o,s,u),!0}return!1}function Hu(a,s,o,u){if(u={lane:2,revertLane:vh(),action:u,hasEagerState:!1,eagerState:null,next:null},Uc(a)){if(s)throw Error(i(479))}else s=su(a,o,u,2),s!==null&&Mr(s,a,2)}function Uc(a){var s=a.alternate;return a===Oe||s!==null&&s===Oe}function bm(a,s){Bs=Oc=!0;var o=a.pending;o===null?s.next=s:(s.next=o.next,o.next=s),a.pending=s}function wm(a,s,o){if((o&4194048)!==0){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,Le(a,o)}}var Hc={readContext:sr,use:Lc,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useLayoutEffect:Nn,useInsertionEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useSyncExternalStore:Nn,useId:Nn,useHostTransitionStatus:Nn,useFormState:Nn,useActionState:Nn,useOptimistic:Nn,useMemoCache:Nn,useCacheRefresh:Nn},Sm={readContext:sr,use:Lc,useCallback:function(a,s){return _r().memoizedState=[a,s===void 0?null:s],a},useContext:sr,useEffect:sm,useImperativeHandle:function(a,s,o){o=o!=null?o.concat([a]):null,Ic(4194308,4,fm.bind(null,s,a),o)},useLayoutEffect:function(a,s){return Ic(4194308,4,a,s)},useInsertionEffect:function(a,s){Ic(4,2,a,s)},useMemo:function(a,s){var o=_r();s=s===void 0?null:s;var u=a();if(qi){pt(!0);try{a()}finally{pt(!1)}}return o.memoizedState=[u,s],u},useReducer:function(a,s,o){var u=_r();if(o!==void 0){var x=o(s);if(qi){pt(!0);try{o(s)}finally{pt(!1)}}}else x=s;return u.memoizedState=u.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},u.queue=a,a=a.dispatch=x4.bind(null,Oe,a),[u.memoizedState,a]},useRef:function(a){var s=_r();return a={current:a},s.memoizedState=a},useState:function(a){a=zu(a);var s=a.queue,o=_m.bind(null,Oe,s);return s.dispatch=o,[a.memoizedState,o]},useDebugValue:Bu,useDeferredValue:function(a,s){var o=_r();return ju(o,a,s)},useTransition:function(){var a=zu(!1);return a=xm.bind(null,Oe,a.queue,!0,!1),_r().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,o){var u=Oe,x=_r();if(Ve){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),dn===null)throw Error(i(349));(He&124)!==0||Px(u,s,o)}x.memoizedState=o;var g={value:o,getSnapshot:s};return x.queue=g,sm(Vx.bind(null,u,g,a),[a]),u.flags|=2048,Is(9,jc(),Yx.bind(null,u,g,o,s),null),o},useId:function(){var a=_r(),s=dn.identifierPrefix;if(Ve){var o=za,u=Oa;o=(u&~(1<<32-G(u)-1)).toString(32)+o,s="«"+s+"R"+o,o=zc++,0<o&&(s+="H"+o.toString(32)),s+="»"}else o=c4++,s="«"+s+"r"+o.toString(32)+"»";return a.memoizedState=s},useHostTransitionStatus:Uu,useFormState:em,useActionState:em,useOptimistic:function(a){var s=_r();s.memoizedState=s.baseState=a;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=Hu.bind(null,Oe,!0,o),o.dispatch=s,[a,s]},useMemoCache:Ru,useCacheRefresh:function(){return _r().memoizedState=p4.bind(null,Oe)}},Em={readContext:sr,use:Lc,useCallback:hm,useContext:sr,useEffect:lm,useImperativeHandle:um,useInsertionEffect:om,useLayoutEffect:cm,useMemo:dm,useReducer:Bc,useRef:im,useState:function(){return Bc(ja)},useDebugValue:Bu,useDeferredValue:function(a,s){var o=On();return pm(o,sn.memoizedState,a,s)},useTransition:function(){var a=Bc(ja)[0],s=On().memoizedState;return[typeof a=="boolean"?a:Zl(a),s]},useSyncExternalStore:Gx,useId:ym,useHostTransitionStatus:Uu,useFormState:nm,useActionState:nm,useOptimistic:function(a,s){var o=On();return qx(o,sn,a,s)},useMemoCache:Ru,useCacheRefresh:vm},m4={readContext:sr,use:Lc,useCallback:hm,useContext:sr,useEffect:lm,useImperativeHandle:um,useInsertionEffect:om,useLayoutEffect:cm,useMemo:dm,useReducer:Ou,useRef:im,useState:function(){return Ou(ja)},useDebugValue:Bu,useDeferredValue:function(a,s){var o=On();return sn===null?ju(o,a,s):pm(o,sn.memoizedState,a,s)},useTransition:function(){var a=Ou(ja)[0],s=On().memoizedState;return[typeof a=="boolean"?a:Zl(a),s]},useSyncExternalStore:Gx,useId:ym,useHostTransitionStatus:Uu,useFormState:am,useActionState:am,useOptimistic:function(a,s){var o=On();return sn!==null?qx(o,sn,a,s):(o.baseState=a,[a,o.queue.dispatch])},useMemoCache:Ru,useCacheRefresh:vm},Us=null,to=0;function $c(a){var s=to;return to+=1,Us===null&&(Us=[]),zx(Us,a,s)}function eo(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Gc(a,s){throw s.$$typeof===y?Error(i(525)):(a=Object.prototype.toString.call(s),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function Tm(a){var s=a._init;return s(a._payload)}function Am(a){function s(Nt,_t){if(a){var Rt=Nt.deletions;Rt===null?(Nt.deletions=[_t],Nt.flags|=16):Rt.push(_t)}}function o(Nt,_t){if(!a)return null;for(;_t!==null;)s(Nt,_t),_t=_t.sibling;return null}function u(Nt){for(var _t=new Map;Nt!==null;)Nt.key!==null?_t.set(Nt.key,Nt):_t.set(Nt.index,Nt),Nt=Nt.sibling;return _t}function x(Nt,_t){return Nt=Ma(Nt,_t),Nt.index=0,Nt.sibling=null,Nt}function g(Nt,_t,Rt){return Nt.index=Rt,a?(Rt=Nt.alternate,Rt!==null?(Rt=Rt.index,Rt<_t?(Nt.flags|=67108866,_t):Rt):(Nt.flags|=67108866,_t)):(Nt.flags|=1048576,_t)}function M(Nt){return a&&Nt.alternate===null&&(Nt.flags|=67108866),Nt}function X(Nt,_t,Rt,qt){return _t===null||_t.tag!==6?(_t=ou(Rt,Nt.mode,qt),_t.return=Nt,_t):(_t=x(_t,Rt),_t.return=Nt,_t)}function ht(Nt,_t,Rt,qt){var ye=Rt.type;return ye===S?Wt(Nt,_t,Rt.props.children,qt,Rt.key):_t!==null&&(_t.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===F&&Tm(ye)===_t.type)?(_t=x(_t,Rt.props),eo(_t,Rt),_t.return=Nt,_t):(_t=Tc(Rt.type,Rt.key,Rt.props,null,Nt.mode,qt),eo(_t,Rt),_t.return=Nt,_t)}function zt(Nt,_t,Rt,qt){return _t===null||_t.tag!==4||_t.stateNode.containerInfo!==Rt.containerInfo||_t.stateNode.implementation!==Rt.implementation?(_t=cu(Rt,Nt.mode,qt),_t.return=Nt,_t):(_t=x(_t,Rt.children||[]),_t.return=Nt,_t)}function Wt(Nt,_t,Rt,qt,ye){return _t===null||_t.tag!==7?(_t=Hi(Rt,Nt.mode,qt,ye),_t.return=Nt,_t):(_t=x(_t,Rt),_t.return=Nt,_t)}function Qt(Nt,_t,Rt){if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return _t=ou(""+_t,Nt.mode,Rt),_t.return=Nt,_t;if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case v:return Rt=Tc(_t.type,_t.key,_t.props,null,Nt.mode,Rt),eo(Rt,_t),Rt.return=Nt,Rt;case w:return _t=cu(_t,Nt.mode,Rt),_t.return=Nt,_t;case F:var qt=_t._init;return _t=qt(_t._payload),Qt(Nt,_t,Rt)}if(dt(_t)||L(_t))return _t=Hi(_t,Nt.mode,Rt,null),_t.return=Nt,_t;if(typeof _t.then=="function")return Qt(Nt,$c(_t),Rt);if(_t.$$typeof===C)return Qt(Nt,kc(Nt,_t),Rt);Gc(Nt,_t)}return null}function It(Nt,_t,Rt,qt){var ye=_t!==null?_t.key:null;if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return ye!==null?null:X(Nt,_t,""+Rt,qt);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case v:return Rt.key===ye?ht(Nt,_t,Rt,qt):null;case w:return Rt.key===ye?zt(Nt,_t,Rt,qt):null;case F:return ye=Rt._init,Rt=ye(Rt._payload),It(Nt,_t,Rt,qt)}if(dt(Rt)||L(Rt))return ye!==null?null:Wt(Nt,_t,Rt,qt,null);if(typeof Rt.then=="function")return It(Nt,_t,$c(Rt),qt);if(Rt.$$typeof===C)return It(Nt,_t,kc(Nt,Rt),qt);Gc(Nt,Rt)}return null}function $t(Nt,_t,Rt,qt,ye){if(typeof qt=="string"&&qt!==""||typeof qt=="number"||typeof qt=="bigint")return Nt=Nt.get(Rt)||null,X(_t,Nt,""+qt,ye);if(typeof qt=="object"&&qt!==null){switch(qt.$$typeof){case v:return Nt=Nt.get(qt.key===null?Rt:qt.key)||null,ht(_t,Nt,qt,ye);case w:return Nt=Nt.get(qt.key===null?Rt:qt.key)||null,zt(_t,Nt,qt,ye);case F:var ze=qt._init;return qt=ze(qt._payload),$t(Nt,_t,Rt,qt,ye)}if(dt(qt)||L(qt))return Nt=Nt.get(Rt)||null,Wt(_t,Nt,qt,ye,null);if(typeof qt.then=="function")return $t(Nt,_t,Rt,$c(qt),ye);if(qt.$$typeof===C)return $t(Nt,_t,Rt,kc(_t,qt),ye);Gc(_t,qt)}return null}function Ne(Nt,_t,Rt,qt){for(var ye=null,ze=null,we=_t,De=_t=0,Yn=null;we!==null&&De<Rt.length;De++){we.index>De?(Yn=we,we=null):Yn=we.sibling;var Ge=It(Nt,we,Rt[De],qt);if(Ge===null){we===null&&(we=Yn);break}a&&we&&Ge.alternate===null&&s(Nt,we),_t=g(Ge,_t,De),ze===null?ye=Ge:ze.sibling=Ge,ze=Ge,we=Yn}if(De===Rt.length)return o(Nt,we),Ve&&Gi(Nt,De),ye;if(we===null){for(;De<Rt.length;De++)we=Qt(Nt,Rt[De],qt),we!==null&&(_t=g(we,_t,De),ze===null?ye=we:ze.sibling=we,ze=we);return Ve&&Gi(Nt,De),ye}for(we=u(we);De<Rt.length;De++)Yn=$t(we,Nt,De,Rt[De],qt),Yn!==null&&(a&&Yn.alternate!==null&&we.delete(Yn.key===null?De:Yn.key),_t=g(Yn,_t,De),ze===null?ye=Yn:ze.sibling=Yn,ze=Yn);return a&&we.forEach(function(Ai){return s(Nt,Ai)}),Ve&&Gi(Nt,De),ye}function Ae(Nt,_t,Rt,qt){if(Rt==null)throw Error(i(151));for(var ye=null,ze=null,we=_t,De=_t=0,Yn=null,Ge=Rt.next();we!==null&&!Ge.done;De++,Ge=Rt.next()){we.index>De?(Yn=we,we=null):Yn=we.sibling;var Ai=It(Nt,we,Ge.value,qt);if(Ai===null){we===null&&(we=Yn);break}a&&we&&Ai.alternate===null&&s(Nt,we),_t=g(Ai,_t,De),ze===null?ye=Ai:ze.sibling=Ai,ze=Ai,we=Yn}if(Ge.done)return o(Nt,we),Ve&&Gi(Nt,De),ye;if(we===null){for(;!Ge.done;De++,Ge=Rt.next())Ge=Qt(Nt,Ge.value,qt),Ge!==null&&(_t=g(Ge,_t,De),ze===null?ye=Ge:ze.sibling=Ge,ze=Ge);return Ve&&Gi(Nt,De),ye}for(we=u(we);!Ge.done;De++,Ge=Rt.next())Ge=$t(we,Nt,De,Ge.value,qt),Ge!==null&&(a&&Ge.alternate!==null&&we.delete(Ge.key===null?De:Ge.key),_t=g(Ge,_t,De),ze===null?ye=Ge:ze.sibling=Ge,ze=Ge);return a&&we.forEach(function(gw){return s(Nt,gw)}),Ve&&Gi(Nt,De),ye}function on(Nt,_t,Rt,qt){if(typeof Rt=="object"&&Rt!==null&&Rt.type===S&&Rt.key===null&&(Rt=Rt.props.children),typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case v:t:{for(var ye=Rt.key;_t!==null;){if(_t.key===ye){if(ye=Rt.type,ye===S){if(_t.tag===7){o(Nt,_t.sibling),qt=x(_t,Rt.props.children),qt.return=Nt,Nt=qt;break t}}else if(_t.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===F&&Tm(ye)===_t.type){o(Nt,_t.sibling),qt=x(_t,Rt.props),eo(qt,Rt),qt.return=Nt,Nt=qt;break t}o(Nt,_t);break}else s(Nt,_t);_t=_t.sibling}Rt.type===S?(qt=Hi(Rt.props.children,Nt.mode,qt,Rt.key),qt.return=Nt,Nt=qt):(qt=Tc(Rt.type,Rt.key,Rt.props,null,Nt.mode,qt),eo(qt,Rt),qt.return=Nt,Nt=qt)}return M(Nt);case w:t:{for(ye=Rt.key;_t!==null;){if(_t.key===ye)if(_t.tag===4&&_t.stateNode.containerInfo===Rt.containerInfo&&_t.stateNode.implementation===Rt.implementation){o(Nt,_t.sibling),qt=x(_t,Rt.children||[]),qt.return=Nt,Nt=qt;break t}else{o(Nt,_t);break}else s(Nt,_t);_t=_t.sibling}qt=cu(Rt,Nt.mode,qt),qt.return=Nt,Nt=qt}return M(Nt);case F:return ye=Rt._init,Rt=ye(Rt._payload),on(Nt,_t,Rt,qt)}if(dt(Rt))return Ne(Nt,_t,Rt,qt);if(L(Rt)){if(ye=L(Rt),typeof ye!="function")throw Error(i(150));return Rt=ye.call(Rt),Ae(Nt,_t,Rt,qt)}if(typeof Rt.then=="function")return on(Nt,_t,$c(Rt),qt);if(Rt.$$typeof===C)return on(Nt,_t,kc(Nt,Rt),qt);Gc(Nt,Rt)}return typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint"?(Rt=""+Rt,_t!==null&&_t.tag===6?(o(Nt,_t.sibling),qt=x(_t,Rt),qt.return=Nt,Nt=qt):(o(Nt,_t),qt=ou(Rt,Nt.mode,qt),qt.return=Nt,Nt=qt),M(Nt)):o(Nt,_t)}return function(Nt,_t,Rt,qt){try{to=0;var ye=on(Nt,_t,Rt,qt);return Us=null,ye}catch(we){if(we===Yl||we===Cc)throw we;var ze=Nr(29,we,null,Nt.mode);return ze.lanes=qt,ze.return=Nt,ze}finally{}}}var Hs=Am(!0),Dm=Am(!1),Xr=I(null),ma=null;function ui(a){var s=a.alternate;Y(In,In.current&1),Y(Xr,a),ma===null&&(s===null||Ls.current!==null||s.memoizedState!==null)&&(ma=a)}function Nm(a){if(a.tag===22){if(Y(In,In.current),Y(Xr,a),ma===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(ma=a)}}else hi()}function hi(){Y(In,In.current),Y(Xr,Xr.current)}function Ia(a){R(Xr),ma===a&&(ma=null),R(In)}var In=I(0);function Pc(a){for(var s=a;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||Ch(o)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function $u(a,s,o,u){s=a.memoizedState,o=o(u,s),o=o==null?s:m({},s,o),a.memoizedState=o,a.lanes===0&&(a.updateQueue.baseState=o)}var Gu={enqueueSetState:function(a,s,o){a=a._reactInternals;var u=Rr(),x=oi(u);x.payload=s,o!=null&&(x.callback=o),s=ci(a,x,u),s!==null&&(Mr(s,a,u),Xl(s,a,u))},enqueueReplaceState:function(a,s,o){a=a._reactInternals;var u=Rr(),x=oi(u);x.tag=1,x.payload=s,o!=null&&(x.callback=o),s=ci(a,x,u),s!==null&&(Mr(s,a,u),Xl(s,a,u))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var o=Rr(),u=oi(o);u.tag=2,s!=null&&(u.callback=s),s=ci(a,u,o),s!==null&&(Mr(s,a,o),Xl(s,a,o))}};function km(a,s,o,u,x,g,M){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(u,g,M):s.prototype&&s.prototype.isPureReactComponent?!Bl(o,u)||!Bl(x,g):!0}function Fm(a,s,o,u){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==a&&Gu.enqueueReplaceState(s,s.state,null)}function Ki(a,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(a=a.defaultProps){o===s&&(o=m({},o));for(var x in a)o[x]===void 0&&(o[x]=a[x])}return o}var Yc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function Cm(a){Yc(a)}function Rm(a){console.error(a)}function Mm(a){Yc(a)}function Vc(a,s){try{var o=a.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function Om(a,s,o){try{var u=a.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Pu(a,s,o){return o=oi(o),o.tag=3,o.payload={element:null},o.callback=function(){Vc(a,s)},o}function zm(a){return a=oi(a),a.tag=3,a}function Lm(a,s,o,u){var x=o.type.getDerivedStateFromError;if(typeof x=="function"){var g=u.value;a.payload=function(){return x(g)},a.callback=function(){Om(s,o,u)}}var M=o.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(a.callback=function(){Om(s,o,u),typeof x!="function"&&(yi===null?yi=new Set([this]):yi.add(this));var X=u.stack;this.componentDidCatch(u.value,{componentStack:X!==null?X:""})})}function g4(a,s,o,u,x){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&$l(s,o,x,!0),o=Xr.current,o!==null){switch(o.tag){case 13:return ma===null?ph():o.alternate===null&&En===0&&(En=3),o.flags&=-257,o.flags|=65536,o.lanes=x,u===vu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),mh(a,u,x)),!1;case 22:return o.flags|=65536,u===vu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),mh(a,u,x)),!1}throw Error(i(435,o.tag))}return mh(a,u,x),ph(),!1}if(Ve)return s=Xr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,u!==hu&&(a=Error(i(422),{cause:u}),Hl(Gr(a,o)))):(u!==hu&&(s=Error(i(423),{cause:u}),Hl(Gr(s,o))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,u=Gr(u,o),x=Pu(a.stateNode,u,x),wu(a,x),En!==4&&(En=2)),!1;var g=Error(i(520),{cause:u});if(g=Gr(g,o),oo===null?oo=[g]:oo.push(g),En!==4&&(En=2),s===null)return!0;u=Gr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,a=x&-x,o.lanes|=a,a=Pu(o.stateNode,u,a),wu(o,a),!1;case 1:if(s=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(yi===null||!yi.has(g))))return o.flags|=65536,x&=-x,o.lanes|=x,x=zm(x),Lm(x,a,o,u),wu(o,x),!1}o=o.return}while(o!==null);return!1}var Bm=Error(i(461)),Gn=!1;function Zn(a,s,o,u){s.child=a===null?Dm(s,null,o,u):Hs(s,a.child,o,u)}function jm(a,s,o,u,x){o=o.render;var g=s.ref;if("ref"in u){var M={};for(var X in u)X!=="ref"&&(M[X]=u[X])}else M=u;return Xi(s),u=Du(a,s,o,M,g,x),X=Nu(),a!==null&&!Gn?(ku(a,s,x),Ua(a,s,x)):(Ve&&X&&fu(s),s.flags|=1,Zn(a,s,u,x),s.child)}function Im(a,s,o,u,x){if(a===null){var g=o.type;return typeof g=="function"&&!lu(g)&&g.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=g,Um(a,s,g,u,x)):(a=Tc(o.type,null,u,s,s.mode,x),a.ref=s.ref,a.return=s,s.child=a)}if(g=a.child,!Qu(a,x)){var M=g.memoizedProps;if(o=o.compare,o=o!==null?o:Bl,o(M,u)&&a.ref===s.ref)return Ua(a,s,x)}return s.flags|=1,a=Ma(g,u),a.ref=s.ref,a.return=s,s.child=a}function Um(a,s,o,u,x){if(a!==null){var g=a.memoizedProps;if(Bl(g,u)&&a.ref===s.ref)if(Gn=!1,s.pendingProps=u=g,Qu(a,x))(a.flags&131072)!==0&&(Gn=!0);else return s.lanes=a.lanes,Ua(a,s,x)}return Yu(a,s,o,u,x)}function Hm(a,s,o){var u=s.pendingProps,x=u.children,g=a!==null?a.memoizedState:null;if(u.mode==="hidden"){if((s.flags&128)!==0){if(u=g!==null?g.baseLanes|o:o,a!==null){for(x=s.child=a.child,g=0;x!==null;)g=g|x.lanes|x.childLanes,x=x.sibling;s.childLanes=g&~u}else s.childLanes=0,s.child=null;return $m(a,s,u,o)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&Fc(s,g!==null?g.cachePool:null),g!==null?Ux(s,g):Eu(),Nm(s);else return s.lanes=s.childLanes=536870912,$m(a,s,g!==null?g.baseLanes|o:o,o)}else g!==null?(Fc(s,g.cachePool),Ux(s,g),hi(),s.memoizedState=null):(a!==null&&Fc(s,null),Eu(),hi());return Zn(a,s,x,o),s.child}function $m(a,s,o,u){var x=yu();return x=x===null?null:{parent:jn._currentValue,pool:x},s.memoizedState={baseLanes:o,cachePool:x},a!==null&&Fc(s,null),Eu(),Nm(s),a!==null&&$l(a,s,u,!0),null}function Xc(a,s){var o=s.ref;if(o===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(a===null||a.ref!==o)&&(s.flags|=4194816)}}function Yu(a,s,o,u,x){return Xi(s),o=Du(a,s,o,u,void 0,x),u=Nu(),a!==null&&!Gn?(ku(a,s,x),Ua(a,s,x)):(Ve&&u&&fu(s),s.flags|=1,Zn(a,s,o,x),s.child)}function Gm(a,s,o,u,x,g){return Xi(s),s.updateQueue=null,o=$x(s,u,o,x),Hx(a),u=Nu(),a!==null&&!Gn?(ku(a,s,g),Ua(a,s,g)):(Ve&&u&&fu(s),s.flags|=1,Zn(a,s,o,g),s.child)}function Pm(a,s,o,u,x){if(Xi(s),s.stateNode===null){var g=Cs,M=o.contextType;typeof M=="object"&&M!==null&&(g=sr(M)),g=new o(u,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Gu,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=u,g.state=s.memoizedState,g.refs={},_u(s),M=o.contextType,g.context=typeof M=="object"&&M!==null?sr(M):Cs,g.state=s.memoizedState,M=o.getDerivedStateFromProps,typeof M=="function"&&($u(s,o,M,u),g.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(M=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),M!==g.state&&Gu.enqueueReplaceState(g,g.state,null),ql(s,u,g,x),Wl(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(a===null){g=s.stateNode;var X=s.memoizedProps,ht=Ki(o,X);g.props=ht;var zt=g.context,Wt=o.contextType;M=Cs,typeof Wt=="object"&&Wt!==null&&(M=sr(Wt));var Qt=o.getDerivedStateFromProps;Wt=typeof Qt=="function"||typeof g.getSnapshotBeforeUpdate=="function",X=s.pendingProps!==X,Wt||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(X||zt!==M)&&Fm(s,g,u,M),li=!1;var It=s.memoizedState;g.state=It,ql(s,u,g,x),Wl(),zt=s.memoizedState,X||It!==zt||li?(typeof Qt=="function"&&($u(s,o,Qt,u),zt=s.memoizedState),(ht=li||km(s,o,ht,u,It,zt,M))?(Wt||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=zt),g.props=u,g.state=zt,g.context=M,u=ht):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{g=s.stateNode,bu(a,s),M=s.memoizedProps,Wt=Ki(o,M),g.props=Wt,Qt=s.pendingProps,It=g.context,zt=o.contextType,ht=Cs,typeof zt=="object"&&zt!==null&&(ht=sr(zt)),X=o.getDerivedStateFromProps,(zt=typeof X=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(M!==Qt||It!==ht)&&Fm(s,g,u,ht),li=!1,It=s.memoizedState,g.state=It,ql(s,u,g,x),Wl();var $t=s.memoizedState;M!==Qt||It!==$t||li||a!==null&&a.dependencies!==null&&Nc(a.dependencies)?(typeof X=="function"&&($u(s,o,X,u),$t=s.memoizedState),(Wt=li||km(s,o,Wt,u,It,$t,ht)||a!==null&&a.dependencies!==null&&Nc(a.dependencies))?(zt||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,$t,ht),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,$t,ht)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||M===a.memoizedProps&&It===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||M===a.memoizedProps&&It===a.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=$t),g.props=u,g.state=$t,g.context=ht,u=Wt):(typeof g.componentDidUpdate!="function"||M===a.memoizedProps&&It===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||M===a.memoizedProps&&It===a.memoizedState||(s.flags|=1024),u=!1)}return g=u,Xc(a,s),u=(s.flags&128)!==0,g||u?(g=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,a!==null&&u?(s.child=Hs(s,a.child,null,x),s.child=Hs(s,null,o,x)):Zn(a,s,o,x),s.memoizedState=g.state,a=s.child):a=Ua(a,s,x),a}function Ym(a,s,o,u){return Ul(),s.flags|=256,Zn(a,s,o,u),s.child}var Vu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xu(a){return{baseLanes:a,cachePool:Rx()}}function Wu(a,s,o){return a=a!==null?a.childLanes&~o:0,s&&(a|=Wr),a}function Vm(a,s,o){var u=s.pendingProps,x=!1,g=(s.flags&128)!==0,M;if((M=g)||(M=a!==null&&a.memoizedState===null?!1:(In.current&2)!==0),M&&(x=!0,s.flags&=-129),M=(s.flags&32)!==0,s.flags&=-33,a===null){if(Ve){if(x?ui(s):hi(),Ve){var X=Sn,ht;if(ht=X){t:{for(ht=X,X=xa;ht.nodeType!==8;){if(!X){X=null;break t}if(ht=ra(ht.nextSibling),ht===null){X=null;break t}}X=ht}X!==null?(s.memoizedState={dehydrated:X,treeContext:$i!==null?{id:Oa,overflow:za}:null,retryLane:536870912,hydrationErrors:null},ht=Nr(18,null,null,0),ht.stateNode=X,ht.return=s,s.child=ht,xr=s,Sn=null,ht=!0):ht=!1}ht||Yi(s)}if(X=s.memoizedState,X!==null&&(X=X.dehydrated,X!==null))return Ch(X)?s.lanes=32:s.lanes=536870912,null;Ia(s)}return X=u.children,u=u.fallback,x?(hi(),x=s.mode,X=Wc({mode:"hidden",children:X},x),u=Hi(u,x,o,null),X.return=s,u.return=s,X.sibling=u,s.child=X,x=s.child,x.memoizedState=Xu(o),x.childLanes=Wu(a,M,o),s.memoizedState=Vu,u):(ui(s),qu(s,X))}if(ht=a.memoizedState,ht!==null&&(X=ht.dehydrated,X!==null)){if(g)s.flags&256?(ui(s),s.flags&=-257,s=Ku(a,s,o)):s.memoizedState!==null?(hi(),s.child=a.child,s.flags|=128,s=null):(hi(),x=u.fallback,X=s.mode,u=Wc({mode:"visible",children:u.children},X),x=Hi(x,X,o,null),x.flags|=2,u.return=s,x.return=s,u.sibling=x,s.child=u,Hs(s,a.child,null,o),u=s.child,u.memoizedState=Xu(o),u.childLanes=Wu(a,M,o),s.memoizedState=Vu,s=x);else if(ui(s),Ch(X)){if(M=X.nextSibling&&X.nextSibling.dataset,M)var zt=M.dgst;M=zt,u=Error(i(419)),u.stack="",u.digest=M,Hl({value:u,source:null,stack:null}),s=Ku(a,s,o)}else if(Gn||$l(a,s,o,!1),M=(o&a.childLanes)!==0,Gn||M){if(M=dn,M!==null&&(u=o&-o,u=(u&42)!==0?1:Ue(u),u=(u&(M.suspendedLanes|o))!==0?0:u,u!==0&&u!==ht.retryLane))throw ht.retryLane=u,Fs(a,u),Mr(M,a,u),Bm;X.data==="$?"||ph(),s=Ku(a,s,o)}else X.data==="$?"?(s.flags|=192,s.child=a.child,s=null):(a=ht.treeContext,Sn=ra(X.nextSibling),xr=s,Ve=!0,Pi=null,xa=!1,a!==null&&(Yr[Vr++]=Oa,Yr[Vr++]=za,Yr[Vr++]=$i,Oa=a.id,za=a.overflow,$i=s),s=qu(s,u.children),s.flags|=4096);return s}return x?(hi(),x=u.fallback,X=s.mode,ht=a.child,zt=ht.sibling,u=Ma(ht,{mode:"hidden",children:u.children}),u.subtreeFlags=ht.subtreeFlags&65011712,zt!==null?x=Ma(zt,x):(x=Hi(x,X,o,null),x.flags|=2),x.return=s,u.return=s,u.sibling=x,s.child=u,u=x,x=s.child,X=a.child.memoizedState,X===null?X=Xu(o):(ht=X.cachePool,ht!==null?(zt=jn._currentValue,ht=ht.parent!==zt?{parent:zt,pool:zt}:ht):ht=Rx(),X={baseLanes:X.baseLanes|o,cachePool:ht}),x.memoizedState=X,x.childLanes=Wu(a,M,o),s.memoizedState=Vu,u):(ui(s),o=a.child,a=o.sibling,o=Ma(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,a!==null&&(M=s.deletions,M===null?(s.deletions=[a],s.flags|=16):M.push(a)),s.child=o,s.memoizedState=null,o)}function qu(a,s){return s=Wc({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Wc(a,s){return a=Nr(22,a,null,s),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Ku(a,s,o){return Hs(s,a.child,null,o),a=qu(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function Xm(a,s,o){a.lanes|=s;var u=a.alternate;u!==null&&(u.lanes|=s),pu(a.return,s,o)}function Zu(a,s,o,u,x){var g=a.memoizedState;g===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:x}:(g.isBackwards=s,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=o,g.tailMode=x)}function Wm(a,s,o){var u=s.pendingProps,x=u.revealOrder,g=u.tail;if(Zn(a,s,u.children,o),u=In.current,(u&2)!==0)u=u&1|2,s.flags|=128;else{if(a!==null&&(a.flags&128)!==0)t:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Xm(a,o,s);else if(a.tag===19)Xm(a,o,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break t;for(;a.sibling===null;){if(a.return===null||a.return===s)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}u&=1}switch(Y(In,u),x){case"forwards":for(o=s.child,x=null;o!==null;)a=o.alternate,a!==null&&Pc(a)===null&&(x=o),o=o.sibling;o=x,o===null?(x=s.child,s.child=null):(x=o.sibling,o.sibling=null),Zu(s,!1,x,o,g);break;case"backwards":for(o=null,x=s.child,s.child=null;x!==null;){if(a=x.alternate,a!==null&&Pc(a)===null){s.child=x;break}a=x.sibling,x.sibling=o,o=x,x=a}Zu(s,!0,o,null,g);break;case"together":Zu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ua(a,s,o){if(a!==null&&(s.dependencies=a.dependencies),gi|=s.lanes,(o&s.childLanes)===0)if(a!==null){if($l(a,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(i(153));if(s.child!==null){for(a=s.child,o=Ma(a,a.pendingProps),s.child=o,o.return=s;a.sibling!==null;)a=a.sibling,o=o.sibling=Ma(a,a.pendingProps),o.return=s;o.sibling=null}return s.child}function Qu(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&Nc(a)))}function y4(a,s,o){switch(s.tag){case 3:j(s,s.stateNode.containerInfo),si(s,jn,a.memoizedState.cache),Ul();break;case 27:case 5:lt(s);break;case 4:j(s,s.stateNode.containerInfo);break;case 10:si(s,s.type,s.memoizedProps.value);break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(ui(s),s.flags|=128,null):(o&s.child.childLanes)!==0?Vm(a,s,o):(ui(s),a=Ua(a,s,o),a!==null?a.sibling:null);ui(s);break;case 19:var x=(a.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||($l(a,s,o,!1),u=(o&s.childLanes)!==0),x){if(u)return Wm(a,s,o);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Y(In,In.current),u)break;return null;case 22:case 23:return s.lanes=0,Hm(a,s,o);case 24:si(s,jn,a.memoizedState.cache)}return Ua(a,s,o)}function qm(a,s,o){if(a!==null)if(a.memoizedProps!==s.pendingProps)Gn=!0;else{if(!Qu(a,o)&&(s.flags&128)===0)return Gn=!1,y4(a,s,o);Gn=(a.flags&131072)!==0}else Gn=!1,Ve&&(s.flags&1048576)!==0&&Tx(s,Dc,s.index);switch(s.lanes=0,s.tag){case 16:t:{a=s.pendingProps;var u=s.elementType,x=u._init;if(u=x(u._payload),s.type=u,typeof u=="function")lu(u)?(a=Ki(u,a),s.tag=1,s=Pm(null,s,u,a,o)):(s.tag=0,s=Yu(null,s,u,a,o));else{if(u!=null){if(x=u.$$typeof,x===U){s.tag=11,s=jm(null,s,u,a,o);break t}else if(x===k){s.tag=14,s=Im(null,s,u,a,o);break t}}throw s=ft(u)||u,Error(i(306,s,""))}}return s;case 0:return Yu(a,s,s.type,s.pendingProps,o);case 1:return u=s.type,x=Ki(u,s.pendingProps),Pm(a,s,u,x,o);case 3:t:{if(j(s,s.stateNode.containerInfo),a===null)throw Error(i(387));u=s.pendingProps;var g=s.memoizedState;x=g.element,bu(a,s),ql(s,u,null,o);var M=s.memoizedState;if(u=M.cache,si(s,jn,u),u!==g.cache&&xu(s,[jn],o,!0),Wl(),u=M.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:M.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=Ym(a,s,u,o);break t}else if(u!==x){x=Gr(Error(i(424)),s),Hl(x),s=Ym(a,s,u,o);break t}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Sn=ra(a.firstChild),xr=s,Ve=!0,Pi=null,xa=!0,o=Dm(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Ul(),u===x){s=Ua(a,s,o);break t}Zn(a,s,u,o)}s=s.child}return s;case 26:return Xc(a,s),a===null?(o=J1(s.type,null,s.pendingProps,null))?s.memoizedState=o:Ve||(o=s.type,a=s.pendingProps,u=cf(tt.current).createElement(o),u[xn]=s,u[qe]=a,Jn(u,o,a),kt(u),s.stateNode=u):s.memoizedState=J1(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return lt(s),a===null&&Ve&&(u=s.stateNode=K1(s.type,s.pendingProps,tt.current),xr=s,xa=!0,x=Sn,bi(s.type)?(Rh=x,Sn=ra(u.firstChild)):Sn=x),Zn(a,s,s.pendingProps.children,o),Xc(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Ve&&((x=u=Sn)&&(u=V4(u,s.type,s.pendingProps,xa),u!==null?(s.stateNode=u,xr=s,Sn=ra(u.firstChild),xa=!1,x=!0):x=!1),x||Yi(s)),lt(s),x=s.type,g=s.pendingProps,M=a!==null?a.memoizedProps:null,u=g.children,Nh(x,g)?u=null:M!==null&&Nh(x,M)&&(s.flags|=32),s.memoizedState!==null&&(x=Du(a,s,f4,null,null,o),yo._currentValue=x),Xc(a,s),Zn(a,s,u,o),s.child;case 6:return a===null&&Ve&&((a=o=Sn)&&(o=X4(o,s.pendingProps,xa),o!==null?(s.stateNode=o,xr=s,Sn=null,a=!0):a=!1),a||Yi(s)),null;case 13:return Vm(a,s,o);case 4:return j(s,s.stateNode.containerInfo),u=s.pendingProps,a===null?s.child=Hs(s,null,u,o):Zn(a,s,u,o),s.child;case 11:return jm(a,s,s.type,s.pendingProps,o);case 7:return Zn(a,s,s.pendingProps,o),s.child;case 8:return Zn(a,s,s.pendingProps.children,o),s.child;case 12:return Zn(a,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,si(s,s.type,u.value),Zn(a,s,u.children,o),s.child;case 9:return x=s.type._context,u=s.pendingProps.children,Xi(s),x=sr(x),u=u(x),s.flags|=1,Zn(a,s,u,o),s.child;case 14:return Im(a,s,s.type,s.pendingProps,o);case 15:return Um(a,s,s.type,s.pendingProps,o);case 19:return Wm(a,s,o);case 31:return u=s.pendingProps,o=s.mode,u={mode:u.mode,children:u.children},a===null?(o=Wc(u,o),o.ref=s.ref,s.child=o,o.return=s,s=o):(o=Ma(a.child,u),o.ref=s.ref,s.child=o,o.return=s,s=o),s;case 22:return Hm(a,s,o);case 24:return Xi(s),u=sr(jn),a===null?(x=yu(),x===null&&(x=dn,g=mu(),x.pooledCache=g,g.refCount++,g!==null&&(x.pooledCacheLanes|=o),x=g),s.memoizedState={parent:u,cache:x},_u(s),si(s,jn,x)):((a.lanes&o)!==0&&(bu(a,s),ql(s,null,null,o),Wl()),x=a.memoizedState,g=s.memoizedState,x.parent!==u?(x={parent:u,cache:u},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),si(s,jn,u)):(u=g.cache,si(s,jn,u),u!==x.cache&&xu(s,[jn],o,!0))),Zn(a,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ha(a){a.flags|=4}function Km(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!ag(s)){if(s=Xr.current,s!==null&&((He&4194048)===He?ma!==null:(He&62914560)!==He&&(He&536870912)===0||s!==ma))throw Vl=vu,Mx;a.flags|=8192}}function qc(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Tt():536870912,a.lanes|=s,Ys|=s)}function no(a,s){if(!Ve)switch(a.tailMode){case"hidden":s=a.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?a.tail=null:o.sibling=null;break;case"collapsed":o=a.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:u.sibling=null}}function bn(a){var s=a.alternate!==null&&a.alternate.child===a.child,o=0,u=0;if(s)for(var x=a.child;x!==null;)o|=x.lanes|x.childLanes,u|=x.subtreeFlags&65011712,u|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)o|=x.lanes|x.childLanes,u|=x.subtreeFlags,u|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=u,a.childLanes=o,s}function v4(a,s,o){var u=s.pendingProps;switch(uu(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(s),null;case 1:return bn(s),null;case 3:return o=s.stateNode,u=null,a!==null&&(u=a.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ba(jn),q(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(a===null||a.child===null)&&(Il(s)?Ha(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Nx())),bn(s),null;case 26:return o=s.memoizedState,a===null?(Ha(s),o!==null?(bn(s),Km(s,o)):(bn(s),s.flags&=-16777217)):o?o!==a.memoizedState?(Ha(s),bn(s),Km(s,o)):(bn(s),s.flags&=-16777217):(a.memoizedProps!==u&&Ha(s),bn(s),s.flags&=-16777217),null;case 27:Ct(s),o=tt.current;var x=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==u&&Ha(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return bn(s),null}a=z.current,Il(s)?Ax(s):(a=K1(x,u,o),s.stateNode=a,Ha(s))}return bn(s),null;case 5:if(Ct(s),o=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==u&&Ha(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return bn(s),null}if(a=z.current,Il(s))Ax(s);else{switch(x=cf(tt.current),a){case 1:a=x.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:a=x.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":a=x.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":a=x.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":a=x.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof u.is=="string"?x.createElement("select",{is:u.is}):x.createElement("select"),u.multiple?a.multiple=!0:u.size&&(a.size=u.size);break;default:a=typeof u.is=="string"?x.createElement(o,{is:u.is}):x.createElement(o)}}a[xn]=s,a[qe]=u;t:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)a.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break t;for(;x.sibling===null;){if(x.return===null||x.return===s)break t;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=a;t:switch(Jn(a,o,u),o){case"button":case"input":case"select":case"textarea":a=!!u.autoFocus;break t;case"img":a=!0;break t;default:a=!1}a&&Ha(s)}}return bn(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==u&&Ha(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(a=tt.current,Il(s)){if(a=s.stateNode,o=s.memoizedProps,u=null,x=xr,x!==null)switch(x.tag){case 27:case 5:u=x.memoizedProps}a[xn]=s,a=!!(a.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||G1(a.nodeValue,o)),a||Yi(s)}else a=cf(a).createTextNode(u),a[xn]=s,s.stateNode=a}return bn(s),null;case 13:if(u=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=Il(s),u!==null&&u.dehydrated!==null){if(a===null){if(!x)throw Error(i(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[xn]=s}else Ul(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;bn(s),x=!1}else x=Nx(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return s.flags&256?(Ia(s),s):(Ia(s),null)}if(Ia(s),(s.flags&128)!==0)return s.lanes=o,s;if(o=u!==null,a=a!==null&&a.memoizedState!==null,o){u=s.child,x=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(x=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==x&&(u.flags|=2048)}return o!==a&&o&&(s.child.flags|=8192),qc(s,s.updateQueue),bn(s),null;case 4:return q(),a===null&&Sh(s.stateNode.containerInfo),bn(s),null;case 10:return Ba(s.type),bn(s),null;case 19:if(R(In),x=s.memoizedState,x===null)return bn(s),null;if(u=(s.flags&128)!==0,g=x.rendering,g===null)if(u)no(x,!1);else{if(En!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(g=Pc(a),g!==null){for(s.flags|=128,no(x,!1),a=g.updateQueue,s.updateQueue=a,qc(s,a),s.subtreeFlags=0,a=o,o=s.child;o!==null;)Ex(o,a),o=o.sibling;return Y(In,In.current&1|2),s.child}a=a.sibling}x.tail!==null&&Et()>Qc&&(s.flags|=128,u=!0,no(x,!1),s.lanes=4194304)}else{if(!u)if(a=Pc(g),a!==null){if(s.flags|=128,u=!0,a=a.updateQueue,s.updateQueue=a,qc(s,a),no(x,!0),x.tail===null&&x.tailMode==="hidden"&&!g.alternate&&!Ve)return bn(s),null}else 2*Et()-x.renderingStartTime>Qc&&o!==536870912&&(s.flags|=128,u=!0,no(x,!1),s.lanes=4194304);x.isBackwards?(g.sibling=s.child,s.child=g):(a=x.last,a!==null?a.sibling=g:s.child=g,x.last=g)}return x.tail!==null?(s=x.tail,x.rendering=s,x.tail=s.sibling,x.renderingStartTime=Et(),s.sibling=null,a=In.current,Y(In,u?a&1|2:a&1),s):(bn(s),null);case 22:case 23:return Ia(s),Tu(),u=s.memoizedState!==null,a!==null?a.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(bn(s),s.subtreeFlags&6&&(s.flags|=8192)):bn(s),o=s.updateQueue,o!==null&&qc(s,o.retryQueue),o=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),a!==null&&R(Wi),null;case 24:return o=null,a!==null&&(o=a.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ba(jn),bn(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function _4(a,s){switch(uu(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Ba(jn),q(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Ct(s),null;case 13:if(Ia(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Ul()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return R(In),null;case 4:return q(),null;case 10:return Ba(s.type),null;case 22:case 23:return Ia(s),Tu(),a!==null&&R(Wi),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Ba(jn),null;case 25:return null;default:return null}}function Zm(a,s){switch(uu(s),s.tag){case 3:Ba(jn),q();break;case 26:case 27:case 5:Ct(s);break;case 4:q();break;case 13:Ia(s);break;case 19:R(In);break;case 10:Ba(s.type);break;case 22:case 23:Ia(s),Tu(),a!==null&&R(Wi);break;case 24:Ba(jn)}}function ro(a,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var x=u.next;o=x;do{if((o.tag&a)===a){u=void 0;var g=o.create,M=o.inst;u=g(),M.destroy=u}o=o.next}while(o!==x)}}catch(X){fn(s,s.return,X)}}function di(a,s,o){try{var u=s.updateQueue,x=u!==null?u.lastEffect:null;if(x!==null){var g=x.next;u=g;do{if((u.tag&a)===a){var M=u.inst,X=M.destroy;if(X!==void 0){M.destroy=void 0,x=s;var ht=o,zt=X;try{zt()}catch(Wt){fn(x,ht,Wt)}}}u=u.next}while(u!==g)}}catch(Wt){fn(s,s.return,Wt)}}function Qm(a){var s=a.updateQueue;if(s!==null){var o=a.stateNode;try{Ix(s,o)}catch(u){fn(a,a.return,u)}}}function Jm(a,s,o){o.props=Ki(a.type,a.memoizedProps),o.state=a.memoizedState;try{o.componentWillUnmount()}catch(u){fn(a,s,u)}}function ao(a,s){try{var o=a.ref;if(o!==null){switch(a.tag){case 26:case 27:case 5:var u=a.stateNode;break;case 30:u=a.stateNode;break;default:u=a.stateNode}typeof o=="function"?a.refCleanup=o(u):o.current=u}}catch(x){fn(a,s,x)}}function ga(a,s){var o=a.ref,u=a.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(x){fn(a,s,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(x){fn(a,s,x)}else o.current=null}function t1(a){var s=a.type,o=a.memoizedProps,u=a.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break t;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(x){fn(a,a.return,x)}}function Ju(a,s,o){try{var u=a.stateNode;H4(u,a.type,o,s),u[qe]=s}catch(x){fn(a,a.return,x)}}function e1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&bi(a.type)||a.tag===4}function th(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||e1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&bi(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function eh(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(a,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(a),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=of));else if(u!==4&&(u===27&&bi(a.type)&&(o=a.stateNode,s=null),a=a.child,a!==null))for(eh(a,s,o),a=a.sibling;a!==null;)eh(a,s,o),a=a.sibling}function Kc(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?o.insertBefore(a,s):o.appendChild(a);else if(u!==4&&(u===27&&bi(a.type)&&(o=a.stateNode),a=a.child,a!==null))for(Kc(a,s,o),a=a.sibling;a!==null;)Kc(a,s,o),a=a.sibling}function n1(a){var s=a.stateNode,o=a.memoizedProps;try{for(var u=a.type,x=s.attributes;x.length;)s.removeAttributeNode(x[0]);Jn(s,u,o),s[xn]=a,s[qe]=o}catch(g){fn(a,a.return,g)}}var $a=!1,kn=!1,nh=!1,r1=typeof WeakSet=="function"?WeakSet:Set,Pn=null;function b4(a,s){if(a=a.containerInfo,Ah=xf,a=px(a),tu(a)){if("selectionStart"in a)var o={start:a.selectionStart,end:a.selectionEnd};else t:{o=(o=a.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var x=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break t}var M=0,X=-1,ht=-1,zt=0,Wt=0,Qt=a,It=null;e:for(;;){for(var $t;Qt!==o||x!==0&&Qt.nodeType!==3||(X=M+x),Qt!==g||u!==0&&Qt.nodeType!==3||(ht=M+u),Qt.nodeType===3&&(M+=Qt.nodeValue.length),($t=Qt.firstChild)!==null;)It=Qt,Qt=$t;for(;;){if(Qt===a)break e;if(It===o&&++zt===x&&(X=M),It===g&&++Wt===u&&(ht=M),($t=Qt.nextSibling)!==null)break;Qt=It,It=Qt.parentNode}Qt=$t}o=X===-1||ht===-1?null:{start:X,end:ht}}else o=null}o=o||{start:0,end:0}}else o=null;for(Dh={focusedElem:a,selectionRange:o},xf=!1,Pn=s;Pn!==null;)if(s=Pn,a=s.child,(s.subtreeFlags&1024)!==0&&a!==null)a.return=s,Pn=a;else for(;Pn!==null;){switch(s=Pn,g=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&g!==null){a=void 0,o=s,x=g.memoizedProps,g=g.memoizedState,u=o.stateNode;try{var Ne=Ki(o.type,x,o.elementType===o.type);a=u.getSnapshotBeforeUpdate(Ne,g),u.__reactInternalSnapshotBeforeUpdate=a}catch(Ae){fn(o,o.return,Ae)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,o=a.nodeType,o===9)Fh(a);else if(o===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Fh(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=s.sibling,a!==null){a.return=s.return,Pn=a;break}Pn=s.return}}function a1(a,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:pi(a,o),u&4&&ro(5,o);break;case 1:if(pi(a,o),u&4)if(a=o.stateNode,s===null)try{a.componentDidMount()}catch(M){fn(o,o.return,M)}else{var x=Ki(o.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(x,s,a.__reactInternalSnapshotBeforeUpdate)}catch(M){fn(o,o.return,M)}}u&64&&Qm(o),u&512&&ao(o,o.return);break;case 3:if(pi(a,o),u&64&&(a=o.updateQueue,a!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{Ix(a,s)}catch(M){fn(o,o.return,M)}}break;case 27:s===null&&u&4&&n1(o);case 26:case 5:pi(a,o),s===null&&u&4&&t1(o),u&512&&ao(o,o.return);break;case 12:pi(a,o);break;case 13:pi(a,o),u&4&&l1(a,o),u&64&&(a=o.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(o=F4.bind(null,o),W4(a,o))));break;case 22:if(u=o.memoizedState!==null||$a,!u){s=s!==null&&s.memoizedState!==null||kn,x=$a;var g=kn;$a=u,(kn=s)&&!g?xi(a,o,(o.subtreeFlags&8772)!==0):pi(a,o),$a=x,kn=g}break;case 30:break;default:pi(a,o)}}function i1(a){var s=a.alternate;s!==null&&(a.alternate=null,i1(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&et(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var yn=null,br=!1;function Ga(a,s,o){for(o=o.child;o!==null;)s1(a,s,o),o=o.sibling}function s1(a,s,o){if(ct&&typeof ct.onCommitFiberUnmount=="function")try{ct.onCommitFiberUnmount(rt,o)}catch{}switch(o.tag){case 26:kn||ga(o,s),Ga(a,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:kn||ga(o,s);var u=yn,x=br;bi(o.type)&&(yn=o.stateNode,br=!1),Ga(a,s,o),po(o.stateNode),yn=u,br=x;break;case 5:kn||ga(o,s);case 6:if(u=yn,x=br,yn=null,Ga(a,s,o),yn=u,br=x,yn!==null)if(br)try{(yn.nodeType===9?yn.body:yn.nodeName==="HTML"?yn.ownerDocument.body:yn).removeChild(o.stateNode)}catch(g){fn(o,s,g)}else try{yn.removeChild(o.stateNode)}catch(g){fn(o,s,g)}break;case 18:yn!==null&&(br?(a=yn,W1(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,o.stateNode),wo(a)):W1(yn,o.stateNode));break;case 4:u=yn,x=br,yn=o.stateNode.containerInfo,br=!0,Ga(a,s,o),yn=u,br=x;break;case 0:case 11:case 14:case 15:kn||di(2,o,s),kn||di(4,o,s),Ga(a,s,o);break;case 1:kn||(ga(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Jm(o,s,u)),Ga(a,s,o);break;case 21:Ga(a,s,o);break;case 22:kn=(u=kn)||o.memoizedState!==null,Ga(a,s,o),kn=u;break;default:Ga(a,s,o)}}function l1(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{wo(a)}catch(o){fn(s,s.return,o)}}function w4(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new r1),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new r1),s;default:throw Error(i(435,a.tag))}}function rh(a,s){var o=w4(a);s.forEach(function(u){var x=C4.bind(null,a,u);o.has(u)||(o.add(u),u.then(x,x))})}function kr(a,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var x=o[u],g=a,M=s,X=M;t:for(;X!==null;){switch(X.tag){case 27:if(bi(X.type)){yn=X.stateNode,br=!1;break t}break;case 5:yn=X.stateNode,br=!1;break t;case 3:case 4:yn=X.stateNode.containerInfo,br=!0;break t}X=X.return}if(yn===null)throw Error(i(160));s1(g,M,x),yn=null,br=!1,g=x.alternate,g!==null&&(g.return=null),x.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)o1(s,a),s=s.sibling}var na=null;function o1(a,s){var o=a.alternate,u=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:kr(s,a),Fr(a),u&4&&(di(3,a,a.return),ro(3,a),di(5,a,a.return));break;case 1:kr(s,a),Fr(a),u&512&&(kn||o===null||ga(o,o.return)),u&64&&$a&&(a=a.updateQueue,a!==null&&(u=a.callbacks,u!==null&&(o=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var x=na;if(kr(s,a),Fr(a),u&512&&(kn||o===null||ga(o,o.return)),u&4){var g=o!==null?o.memoizedState:null;if(u=a.memoizedState,o===null)if(u===null)if(a.stateNode===null){t:{u=a.type,o=a.memoizedProps,x=x.ownerDocument||x;e:switch(u){case"title":g=x.getElementsByTagName("title")[0],(!g||g[Q]||g[xn]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=x.createElement(u),x.head.insertBefore(g,x.querySelector("head > title"))),Jn(g,u,o),g[xn]=a,kt(g),u=g;break t;case"link":var M=ng("link","href",x).get(u+(o.href||""));if(M){for(var X=0;X<M.length;X++)if(g=M[X],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){M.splice(X,1);break e}}g=x.createElement(u),Jn(g,u,o),x.head.appendChild(g);break;case"meta":if(M=ng("meta","content",x).get(u+(o.content||""))){for(X=0;X<M.length;X++)if(g=M[X],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){M.splice(X,1);break e}}g=x.createElement(u),Jn(g,u,o),x.head.appendChild(g);break;default:throw Error(i(468,u))}g[xn]=a,kt(g),u=g}a.stateNode=u}else rg(x,a.type,a.stateNode);else a.stateNode=eg(x,u,a.memoizedProps);else g!==u?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,u===null?rg(x,a.type,a.stateNode):eg(x,u,a.memoizedProps)):u===null&&a.stateNode!==null&&Ju(a,a.memoizedProps,o.memoizedProps)}break;case 27:kr(s,a),Fr(a),u&512&&(kn||o===null||ga(o,o.return)),o!==null&&u&4&&Ju(a,a.memoizedProps,o.memoizedProps);break;case 5:if(kr(s,a),Fr(a),u&512&&(kn||o===null||ga(o,o.return)),a.flags&32){x=a.stateNode;try{Ss(x,"")}catch($t){fn(a,a.return,$t)}}u&4&&a.stateNode!=null&&(x=a.memoizedProps,Ju(a,x,o!==null?o.memoizedProps:x)),u&1024&&(nh=!0);break;case 6:if(kr(s,a),Fr(a),u&4){if(a.stateNode===null)throw Error(i(162));u=a.memoizedProps,o=a.stateNode;try{o.nodeValue=u}catch($t){fn(a,a.return,$t)}}break;case 3:if(hf=null,x=na,na=ff(s.containerInfo),kr(s,a),na=x,Fr(a),u&4&&o!==null&&o.memoizedState.isDehydrated)try{wo(s.containerInfo)}catch($t){fn(a,a.return,$t)}nh&&(nh=!1,c1(a));break;case 4:u=na,na=ff(a.stateNode.containerInfo),kr(s,a),Fr(a),na=u;break;case 12:kr(s,a),Fr(a);break;case 13:kr(s,a),Fr(a),a.child.flags&8192&&a.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(ch=Et()),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,rh(a,u)));break;case 22:x=a.memoizedState!==null;var ht=o!==null&&o.memoizedState!==null,zt=$a,Wt=kn;if($a=zt||x,kn=Wt||ht,kr(s,a),kn=Wt,$a=zt,Fr(a),u&8192)t:for(s=a.stateNode,s._visibility=x?s._visibility&-2:s._visibility|1,x&&(o===null||ht||$a||kn||Zi(a)),o=null,s=a;;){if(s.tag===5||s.tag===26){if(o===null){ht=o=s;try{if(g=ht.stateNode,x)M=g.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{X=ht.stateNode;var Qt=ht.memoizedProps.style,It=Qt!=null&&Qt.hasOwnProperty("display")?Qt.display:null;X.style.display=It==null||typeof It=="boolean"?"":(""+It).trim()}}catch($t){fn(ht,ht.return,$t)}}}else if(s.tag===6){if(o===null){ht=s;try{ht.stateNode.nodeValue=x?"":ht.memoizedProps}catch($t){fn(ht,ht.return,$t)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break t;for(;s.sibling===null;){if(s.return===null||s.return===a)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=a.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,rh(a,o))));break;case 19:kr(s,a),Fr(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,rh(a,u)));break;case 30:break;case 21:break;default:kr(s,a),Fr(a)}}function Fr(a){var s=a.flags;if(s&2){try{for(var o,u=a.return;u!==null;){if(e1(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var x=o.stateNode,g=th(a);Kc(a,g,x);break;case 5:var M=o.stateNode;o.flags&32&&(Ss(M,""),o.flags&=-33);var X=th(a);Kc(a,X,M);break;case 3:case 4:var ht=o.stateNode.containerInfo,zt=th(a);eh(a,zt,ht);break;default:throw Error(i(161))}}catch(Wt){fn(a,a.return,Wt)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function c1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;c1(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function pi(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)a1(a,s.alternate,s),s=s.sibling}function Zi(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:di(4,s,s.return),Zi(s);break;case 1:ga(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Jm(s,s.return,o),Zi(s);break;case 27:po(s.stateNode);case 26:case 5:ga(s,s.return),Zi(s);break;case 22:s.memoizedState===null&&Zi(s);break;case 30:Zi(s);break;default:Zi(s)}a=a.sibling}}function xi(a,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,x=a,g=s,M=g.flags;switch(g.tag){case 0:case 11:case 15:xi(x,g,o),ro(4,g);break;case 1:if(xi(x,g,o),u=g,x=u.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(zt){fn(u,u.return,zt)}if(u=g,x=u.updateQueue,x!==null){var X=u.stateNode;try{var ht=x.shared.hiddenCallbacks;if(ht!==null)for(x.shared.hiddenCallbacks=null,x=0;x<ht.length;x++)jx(ht[x],X)}catch(zt){fn(u,u.return,zt)}}o&&M&64&&Qm(g),ao(g,g.return);break;case 27:n1(g);case 26:case 5:xi(x,g,o),o&&u===null&&M&4&&t1(g),ao(g,g.return);break;case 12:xi(x,g,o);break;case 13:xi(x,g,o),o&&M&4&&l1(x,g);break;case 22:g.memoizedState===null&&xi(x,g,o),ao(g,g.return);break;case 30:break;default:xi(x,g,o)}s=s.sibling}}function ah(a,s){var o=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==o&&(a!=null&&a.refCount++,o!=null&&Gl(o))}function ih(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Gl(a))}function ya(a,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)f1(a,s,o,u),s=s.sibling}function f1(a,s,o,u){var x=s.flags;switch(s.tag){case 0:case 11:case 15:ya(a,s,o,u),x&2048&&ro(9,s);break;case 1:ya(a,s,o,u);break;case 3:ya(a,s,o,u),x&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Gl(a)));break;case 12:if(x&2048){ya(a,s,o,u),a=s.stateNode;try{var g=s.memoizedProps,M=g.id,X=g.onPostCommit;typeof X=="function"&&X(M,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ht){fn(s,s.return,ht)}}else ya(a,s,o,u);break;case 13:ya(a,s,o,u);break;case 23:break;case 22:g=s.stateNode,M=s.alternate,s.memoizedState!==null?g._visibility&2?ya(a,s,o,u):io(a,s):g._visibility&2?ya(a,s,o,u):(g._visibility|=2,$s(a,s,o,u,(s.subtreeFlags&10256)!==0)),x&2048&&ah(M,s);break;case 24:ya(a,s,o,u),x&2048&&ih(s.alternate,s);break;default:ya(a,s,o,u)}}function $s(a,s,o,u,x){for(x=x&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var g=a,M=s,X=o,ht=u,zt=M.flags;switch(M.tag){case 0:case 11:case 15:$s(g,M,X,ht,x),ro(8,M);break;case 23:break;case 22:var Wt=M.stateNode;M.memoizedState!==null?Wt._visibility&2?$s(g,M,X,ht,x):io(g,M):(Wt._visibility|=2,$s(g,M,X,ht,x)),x&&zt&2048&&ah(M.alternate,M);break;case 24:$s(g,M,X,ht,x),x&&zt&2048&&ih(M.alternate,M);break;default:$s(g,M,X,ht,x)}s=s.sibling}}function io(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=a,u=s,x=u.flags;switch(u.tag){case 22:io(o,u),x&2048&&ah(u.alternate,u);break;case 24:io(o,u),x&2048&&ih(u.alternate,u);break;default:io(o,u)}s=s.sibling}}var so=8192;function Gs(a){if(a.subtreeFlags&so)for(a=a.child;a!==null;)u1(a),a=a.sibling}function u1(a){switch(a.tag){case 26:Gs(a),a.flags&so&&a.memoizedState!==null&&lw(na,a.memoizedState,a.memoizedProps);break;case 5:Gs(a);break;case 3:case 4:var s=na;na=ff(a.stateNode.containerInfo),Gs(a),na=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=so,so=16777216,Gs(a),so=s):Gs(a));break;default:Gs(a)}}function h1(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function lo(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];Pn=u,p1(u,a)}h1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)d1(a),a=a.sibling}function d1(a){switch(a.tag){case 0:case 11:case 15:lo(a),a.flags&2048&&di(9,a,a.return);break;case 3:lo(a);break;case 12:lo(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,Zc(a)):lo(a);break;default:lo(a)}}function Zc(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];Pn=u,p1(u,a)}h1(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:di(8,s,s.return),Zc(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Zc(s));break;default:Zc(s)}a=a.sibling}}function p1(a,s){for(;Pn!==null;){var o=Pn;switch(o.tag){case 0:case 11:case 15:di(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Gl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Pn=u;else t:for(o=a;Pn!==null;){u=Pn;var x=u.sibling,g=u.return;if(i1(u),u===o){Pn=null;break t}if(x!==null){x.return=g,Pn=x;break t}Pn=g}}}var S4={getCacheForType:function(a){var s=sr(jn),o=s.data.get(a);return o===void 0&&(o=a(),s.data.set(a,o)),o}},E4=typeof WeakMap=="function"?WeakMap:Map,Ke=0,dn=null,Be=null,He=0,Ze=0,Cr=null,mi=!1,Ps=!1,sh=!1,Pa=0,En=0,gi=0,Qi=0,lh=0,Wr=0,Ys=0,oo=null,wr=null,oh=!1,ch=0,Qc=1/0,Jc=null,yi=null,Qn=0,vi=null,Vs=null,Xs=0,fh=0,uh=null,x1=null,co=0,hh=null;function Rr(){if((Ke&2)!==0&&He!==0)return He&-He;if(J.T!==null){var a=Os;return a!==0?a:vh()}return pn()}function m1(){Wr===0&&(Wr=(He&536870912)===0||Ve?Pt():536870912);var a=Xr.current;return a!==null&&(a.flags|=32),Wr}function Mr(a,s,o){(a===dn&&(Ze===2||Ze===9)||a.cancelPendingCommit!==null)&&(Ws(a,0),_i(a,He,Wr,!1)),pe(a,o),((Ke&2)===0||a!==dn)&&(a===dn&&((Ke&2)===0&&(Qi|=o),En===4&&_i(a,He,Wr,!1)),va(a))}function g1(a,s,o){if((Ke&6)!==0)throw Error(i(327));var u=!o&&(s&124)===0&&(s&a.expiredLanes)===0||Bt(a,s),x=u?D4(a,s):xh(a,s,!0),g=u;do{if(x===0){Ps&&!u&&_i(a,s,0,!1);break}else{if(o=a.current.alternate,g&&!T4(o)){x=xh(a,s,!1),g=!1;continue}if(x===2){if(g=s,a.errorRecoveryDisabledLanes&g)var M=0;else M=a.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){s=M;t:{var X=a;x=oo;var ht=X.current.memoizedState.isDehydrated;if(ht&&(Ws(X,M).flags|=256),M=xh(X,M,!1),M!==2){if(sh&&!ht){X.errorRecoveryDisabledLanes|=g,Qi|=g,x=4;break t}g=wr,wr=x,g!==null&&(wr===null?wr=g:wr.push.apply(wr,g))}x=M}if(g=!1,x!==2)continue}}if(x===1){Ws(a,0),_i(a,s,0,!0);break}t:{switch(u=a,g=x,g){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:_i(u,s,Wr,!mi);break t;case 2:wr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(x=ch+300-Et(),10<x)){if(_i(u,s,Wr,!mi),te(u,0,!0)!==0)break t;u.timeoutHandle=V1(y1.bind(null,u,o,wr,Jc,oh,s,Wr,Qi,Ys,mi,g,2,-0,0),x);break t}y1(u,o,wr,Jc,oh,s,Wr,Qi,Ys,mi,g,0,-0,0)}}break}while(!0);va(a)}function y1(a,s,o,u,x,g,M,X,ht,zt,Wt,Qt,It,$t){if(a.timeoutHandle=-1,Qt=s.subtreeFlags,(Qt&8192||(Qt&16785408)===16785408)&&(go={stylesheets:null,count:0,unsuspend:sw},u1(s),Qt=ow(),Qt!==null)){a.cancelPendingCommit=Qt(T1.bind(null,a,s,g,o,u,x,M,X,ht,Wt,1,It,$t)),_i(a,g,M,!zt);return}T1(a,s,g,o,u,x,M,X,ht)}function T4(a){for(var s=a;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var x=o[u],g=x.getSnapshot;x=x.value;try{if(!Dr(g(),x))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function _i(a,s,o,u){s&=~lh,s&=~Qi,a.suspendedLanes|=s,a.pingedLanes&=~s,u&&(a.warmLanes|=s),u=a.expirationTimes;for(var x=s;0<x;){var g=31-G(x),M=1<<g;u[g]=-1,x&=~M}o!==0&&Ee(a,o,s)}function tf(){return(Ke&6)===0?(fo(0),!1):!0}function dh(){if(Be!==null){if(Ze===0)var a=Be.return;else a=Be,La=Vi=null,Fu(a),Us=null,to=0,a=Be;for(;a!==null;)Zm(a.alternate,a),a=a.return;Be=null}}function Ws(a,s){var o=a.timeoutHandle;o!==-1&&(a.timeoutHandle=-1,G4(o)),o=a.cancelPendingCommit,o!==null&&(a.cancelPendingCommit=null,o()),dh(),dn=a,Be=o=Ma(a.current,null),He=s,Ze=0,Cr=null,mi=!1,Ps=Bt(a,s),sh=!1,Ys=Wr=lh=Qi=gi=En=0,wr=oo=null,oh=!1,(s&8)!==0&&(s|=s&32);var u=a.entangledLanes;if(u!==0)for(a=a.entanglements,u&=s;0<u;){var x=31-G(u),g=1<<x;s|=a[x],u&=~g}return Pa=s,wc(),o}function v1(a,s){Oe=null,J.H=Hc,s===Yl||s===Cc?(s=Lx(),Ze=3):s===Mx?(s=Lx(),Ze=4):Ze=s===Bm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Cr=s,Be===null&&(En=1,Vc(a,Gr(s,a.current)))}function _1(){var a=J.H;return J.H=Hc,a===null?Hc:a}function b1(){var a=J.A;return J.A=S4,a}function ph(){En=4,mi||(He&4194048)!==He&&Xr.current!==null||(Ps=!0),(gi&134217727)===0&&(Qi&134217727)===0||dn===null||_i(dn,He,Wr,!1)}function xh(a,s,o){var u=Ke;Ke|=2;var x=_1(),g=b1();(dn!==a||He!==s)&&(Jc=null,Ws(a,s)),s=!1;var M=En;t:do try{if(Ze!==0&&Be!==null){var X=Be,ht=Cr;switch(Ze){case 8:dh(),M=6;break t;case 3:case 2:case 9:case 6:Xr.current===null&&(s=!0);var zt=Ze;if(Ze=0,Cr=null,qs(a,X,ht,zt),o&&Ps){M=0;break t}break;default:zt=Ze,Ze=0,Cr=null,qs(a,X,ht,zt)}}A4(),M=En;break}catch(Wt){v1(a,Wt)}while(!0);return s&&a.shellSuspendCounter++,La=Vi=null,Ke=u,J.H=x,J.A=g,Be===null&&(dn=null,He=0,wc()),M}function A4(){for(;Be!==null;)w1(Be)}function D4(a,s){var o=Ke;Ke|=2;var u=_1(),x=b1();dn!==a||He!==s?(Jc=null,Qc=Et()+500,Ws(a,s)):Ps=Bt(a,s);t:do try{if(Ze!==0&&Be!==null){s=Be;var g=Cr;e:switch(Ze){case 1:Ze=0,Cr=null,qs(a,s,g,1);break;case 2:case 9:if(Ox(g)){Ze=0,Cr=null,S1(s);break}s=function(){Ze!==2&&Ze!==9||dn!==a||(Ze=7),va(a)},g.then(s,s);break t;case 3:Ze=7;break t;case 4:Ze=5;break t;case 7:Ox(g)?(Ze=0,Cr=null,S1(s)):(Ze=0,Cr=null,qs(a,s,g,7));break;case 5:var M=null;switch(Be.tag){case 26:M=Be.memoizedState;case 5:case 27:var X=Be;if(!M||ag(M)){Ze=0,Cr=null;var ht=X.sibling;if(ht!==null)Be=ht;else{var zt=X.return;zt!==null?(Be=zt,ef(zt)):Be=null}break e}}Ze=0,Cr=null,qs(a,s,g,5);break;case 6:Ze=0,Cr=null,qs(a,s,g,6);break;case 8:dh(),En=6;break t;default:throw Error(i(462))}}N4();break}catch(Wt){v1(a,Wt)}while(!0);return La=Vi=null,J.H=u,J.A=x,Ke=o,Be!==null?0:(dn=null,He=0,wc(),En)}function N4(){for(;Be!==null&&!Kt();)w1(Be)}function w1(a){var s=qm(a.alternate,a,Pa);a.memoizedProps=a.pendingProps,s===null?ef(a):Be=s}function S1(a){var s=a,o=s.alternate;switch(s.tag){case 15:case 0:s=Gm(o,s,s.pendingProps,s.type,void 0,He);break;case 11:s=Gm(o,s,s.pendingProps,s.type.render,s.ref,He);break;case 5:Fu(s);default:Zm(o,s),s=Be=Ex(s,Pa),s=qm(o,s,Pa)}a.memoizedProps=a.pendingProps,s===null?ef(a):Be=s}function qs(a,s,o,u){La=Vi=null,Fu(s),Us=null,to=0;var x=s.return;try{if(g4(a,x,s,o,He)){En=1,Vc(a,Gr(o,a.current)),Be=null;return}}catch(g){if(x!==null)throw Be=x,g;En=1,Vc(a,Gr(o,a.current)),Be=null;return}s.flags&32768?(Ve||u===1?a=!0:Ps||(He&536870912)!==0?a=!1:(mi=a=!0,(u===2||u===9||u===3||u===6)&&(u=Xr.current,u!==null&&u.tag===13&&(u.flags|=16384))),E1(s,a)):ef(s)}function ef(a){var s=a;do{if((s.flags&32768)!==0){E1(s,mi);return}a=s.return;var o=v4(s.alternate,s,Pa);if(o!==null){Be=o;return}if(s=s.sibling,s!==null){Be=s;return}Be=s=a}while(s!==null);En===0&&(En=5)}function E1(a,s){do{var o=_4(a.alternate,a);if(o!==null){o.flags&=32767,Be=o;return}if(o=a.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(a=a.sibling,a!==null)){Be=a;return}Be=a=o}while(a!==null);En=6,Be=null}function T1(a,s,o,u,x,g,M,X,ht){a.cancelPendingCommit=null;do nf();while(Qn!==0);if((Ke&6)!==0)throw Error(i(327));if(s!==null){if(s===a.current)throw Error(i(177));if(g=s.lanes|s.childLanes,g|=iu,be(a,o,g,M,X,ht),a===dn&&(Be=dn=null,He=0),Vs=s,vi=a,Xs=o,fh=g,uh=x,x1=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,R4(ie,function(){return F1(),null})):(a.callbackNode=null,a.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=J.T,J.T=null,x=gt.p,gt.p=2,M=Ke,Ke|=4;try{b4(a,s,o)}finally{Ke=M,gt.p=x,J.T=u}}Qn=1,A1(),D1(),N1()}}function A1(){if(Qn===1){Qn=0;var a=vi,s=Vs,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=J.T,J.T=null;var u=gt.p;gt.p=2;var x=Ke;Ke|=4;try{o1(s,a);var g=Dh,M=px(a.containerInfo),X=g.focusedElem,ht=g.selectionRange;if(M!==X&&X&&X.ownerDocument&&dx(X.ownerDocument.documentElement,X)){if(ht!==null&&tu(X)){var zt=ht.start,Wt=ht.end;if(Wt===void 0&&(Wt=zt),"selectionStart"in X)X.selectionStart=zt,X.selectionEnd=Math.min(Wt,X.value.length);else{var Qt=X.ownerDocument||document,It=Qt&&Qt.defaultView||window;if(It.getSelection){var $t=It.getSelection(),Ne=X.textContent.length,Ae=Math.min(ht.start,Ne),on=ht.end===void 0?Ae:Math.min(ht.end,Ne);!$t.extend&&Ae>on&&(M=on,on=Ae,Ae=M);var Nt=hx(X,Ae),_t=hx(X,on);if(Nt&&_t&&($t.rangeCount!==1||$t.anchorNode!==Nt.node||$t.anchorOffset!==Nt.offset||$t.focusNode!==_t.node||$t.focusOffset!==_t.offset)){var Rt=Qt.createRange();Rt.setStart(Nt.node,Nt.offset),$t.removeAllRanges(),Ae>on?($t.addRange(Rt),$t.extend(_t.node,_t.offset)):(Rt.setEnd(_t.node,_t.offset),$t.addRange(Rt))}}}}for(Qt=[],$t=X;$t=$t.parentNode;)$t.nodeType===1&&Qt.push({element:$t,left:$t.scrollLeft,top:$t.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Qt.length;X++){var qt=Qt[X];qt.element.scrollLeft=qt.left,qt.element.scrollTop=qt.top}}xf=!!Ah,Dh=Ah=null}finally{Ke=x,gt.p=u,J.T=o}}a.current=s,Qn=2}}function D1(){if(Qn===2){Qn=0;var a=vi,s=Vs,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=J.T,J.T=null;var u=gt.p;gt.p=2;var x=Ke;Ke|=4;try{a1(a,s.alternate,s)}finally{Ke=x,gt.p=u,J.T=o}}Qn=3}}function N1(){if(Qn===4||Qn===3){Qn=0,Yt();var a=vi,s=Vs,o=Xs,u=x1;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Qn=5:(Qn=0,Vs=vi=null,k1(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(yi=null),$e(o),s=s.stateNode,ct&&typeof ct.onCommitFiberRoot=="function")try{ct.onCommitFiberRoot(rt,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=J.T,x=gt.p,gt.p=2,J.T=null;try{for(var g=a.onRecoverableError,M=0;M<u.length;M++){var X=u[M];g(X.value,{componentStack:X.stack})}}finally{J.T=s,gt.p=x}}(Xs&3)!==0&&nf(),va(a),x=a.pendingLanes,(o&4194090)!==0&&(x&42)!==0?a===hh?co++:(co=0,hh=a):co=0,fo(0)}}function k1(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,Gl(s)))}function nf(a){return A1(),D1(),N1(),F1()}function F1(){if(Qn!==5)return!1;var a=vi,s=fh;fh=0;var o=$e(Xs),u=J.T,x=gt.p;try{gt.p=32>o?32:o,J.T=null,o=uh,uh=null;var g=vi,M=Xs;if(Qn=0,Vs=vi=null,Xs=0,(Ke&6)!==0)throw Error(i(331));var X=Ke;if(Ke|=4,d1(g.current),f1(g,g.current,M,o),Ke=X,fo(0,!1),ct&&typeof ct.onPostCommitFiberRoot=="function")try{ct.onPostCommitFiberRoot(rt,g)}catch{}return!0}finally{gt.p=x,J.T=u,k1(a,s)}}function C1(a,s,o){s=Gr(o,s),s=Pu(a.stateNode,s,2),a=ci(a,s,2),a!==null&&(pe(a,2),va(a))}function fn(a,s,o){if(a.tag===3)C1(a,a,o);else for(;s!==null;){if(s.tag===3){C1(s,a,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(yi===null||!yi.has(u))){a=Gr(o,a),o=zm(2),u=ci(s,o,2),u!==null&&(Lm(o,u,s,a),pe(u,2),va(u));break}}s=s.return}}function mh(a,s,o){var u=a.pingCache;if(u===null){u=a.pingCache=new E4;var x=new Set;u.set(s,x)}else x=u.get(s),x===void 0&&(x=new Set,u.set(s,x));x.has(o)||(sh=!0,x.add(o),a=k4.bind(null,a,s,o),s.then(a,a))}function k4(a,s,o){var u=a.pingCache;u!==null&&u.delete(s),a.pingedLanes|=a.suspendedLanes&o,a.warmLanes&=~o,dn===a&&(He&o)===o&&(En===4||En===3&&(He&62914560)===He&&300>Et()-ch?(Ke&2)===0&&Ws(a,0):lh|=o,Ys===He&&(Ys=0)),va(a)}function R1(a,s){s===0&&(s=Tt()),a=Fs(a,s),a!==null&&(pe(a,s),va(a))}function F4(a){var s=a.memoizedState,o=0;s!==null&&(o=s.retryLane),R1(a,o)}function C4(a,s){var o=0;switch(a.tag){case 13:var u=a.stateNode,x=a.memoizedState;x!==null&&(o=x.retryLane);break;case 19:u=a.stateNode;break;case 22:u=a.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),R1(a,o)}function R4(a,s){return Zt(a,s)}var rf=null,Ks=null,gh=!1,af=!1,yh=!1,Ji=0;function va(a){a!==Ks&&a.next===null&&(Ks===null?rf=Ks=a:Ks=Ks.next=a),af=!0,gh||(gh=!0,O4())}function fo(a,s){if(!yh&&af){yh=!0;do for(var o=!1,u=rf;u!==null;){if(a!==0){var x=u.pendingLanes;if(x===0)var g=0;else{var M=u.suspendedLanes,X=u.pingedLanes;g=(1<<31-G(42|a)+1)-1,g&=x&~(M&~X),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,L1(u,g))}else g=He,g=te(u,u===dn?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Bt(u,g)||(o=!0,L1(u,g));u=u.next}while(o);yh=!1}}function M4(){M1()}function M1(){af=gh=!1;var a=0;Ji!==0&&($4()&&(a=Ji),Ji=0);for(var s=Et(),o=null,u=rf;u!==null;){var x=u.next,g=O1(u,s);g===0?(u.next=null,o===null?rf=x:o.next=x,x===null&&(Ks=o)):(o=u,(a!==0||(g&3)!==0)&&(af=!0)),u=x}fo(a)}function O1(a,s){for(var o=a.suspendedLanes,u=a.pingedLanes,x=a.expirationTimes,g=a.pendingLanes&-62914561;0<g;){var M=31-G(g),X=1<<M,ht=x[M];ht===-1?((X&o)===0||(X&u)!==0)&&(x[M]=At(X,s)):ht<=s&&(a.expiredLanes|=X),g&=~X}if(s=dn,o=He,o=te(a,a===s?o:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u=a.callbackNode,o===0||a===s&&(Ze===2||Ze===9)||a.cancelPendingCommit!==null)return u!==null&&u!==null&&Gt(u),a.callbackNode=null,a.callbackPriority=0;if((o&3)===0||Bt(a,o)){if(s=o&-o,s===a.callbackPriority)return s;switch(u!==null&&Gt(u),$e(o)){case 2:case 8:o=Dt;break;case 32:o=ie;break;case 268435456:o=ue;break;default:o=ie}return u=z1.bind(null,a),o=Zt(o,u),a.callbackPriority=s,a.callbackNode=o,s}return u!==null&&u!==null&&Gt(u),a.callbackPriority=2,a.callbackNode=null,2}function z1(a,s){if(Qn!==0&&Qn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var o=a.callbackNode;if(nf()&&a.callbackNode!==o)return null;var u=He;return u=te(a,a===dn?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u===0?null:(g1(a,u,s),O1(a,Et()),a.callbackNode!=null&&a.callbackNode===o?z1.bind(null,a):null)}function L1(a,s){if(nf())return null;g1(a,s,!0)}function O4(){P4(function(){(Ke&6)!==0?Zt(Ot,M4):M1()})}function vh(){return Ji===0&&(Ji=Pt()),Ji}function B1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:xc(""+a)}function j1(a,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,a.id&&o.setAttribute("form",a.id),s.parentNode.insertBefore(o,s),a=new FormData(a),o.parentNode.removeChild(o),a}function z4(a,s,o,u,x){if(s==="submit"&&o&&o.stateNode===x){var g=B1((x[qe]||null).action),M=u.submitter;M&&(s=(s=M[qe]||null)?B1(s.formAction):M.getAttribute("formAction"),s!==null&&(g=s,M=null));var X=new vc("action","action",null,u,x);a.push({event:X,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ji!==0){var ht=M?j1(x,M):new FormData(x);Iu(o,{pending:!0,data:ht,method:x.method,action:g},null,ht)}}else typeof g=="function"&&(X.preventDefault(),ht=M?j1(x,M):new FormData(x),Iu(o,{pending:!0,data:ht,method:x.method,action:g},g,ht))},currentTarget:x}]})}}for(var _h=0;_h<au.length;_h++){var bh=au[_h],L4=bh.toLowerCase(),B4=bh[0].toUpperCase()+bh.slice(1);ea(L4,"on"+B4)}ea(gx,"onAnimationEnd"),ea(yx,"onAnimationIteration"),ea(vx,"onAnimationStart"),ea("dblclick","onDoubleClick"),ea("focusin","onFocus"),ea("focusout","onBlur"),ea(t4,"onTransitionRun"),ea(e4,"onTransitionStart"),ea(n4,"onTransitionCancel"),ea(_x,"onTransitionEnd"),le("onMouseEnter",["mouseout","mouseover"]),le("onMouseLeave",["mouseout","mouseover"]),le("onPointerEnter",["pointerout","pointerover"]),le("onPointerLeave",["pointerout","pointerover"]),re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),re("onBeforeInput",["compositionend","keypress","textInput","paste"]),re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uo));function I1(a,s){s=(s&4)!==0;for(var o=0;o<a.length;o++){var u=a[o],x=u.event;u=u.listeners;t:{var g=void 0;if(s)for(var M=u.length-1;0<=M;M--){var X=u[M],ht=X.instance,zt=X.currentTarget;if(X=X.listener,ht!==g&&x.isPropagationStopped())break t;g=X,x.currentTarget=zt;try{g(x)}catch(Wt){Yc(Wt)}x.currentTarget=null,g=ht}else for(M=0;M<u.length;M++){if(X=u[M],ht=X.instance,zt=X.currentTarget,X=X.listener,ht!==g&&x.isPropagationStopped())break t;g=X,x.currentTarget=zt;try{g(x)}catch(Wt){Yc(Wt)}x.currentTarget=null,g=ht}}}}function je(a,s){var o=s[ka];o===void 0&&(o=s[ka]=new Set);var u=a+"__bubble";o.has(u)||(U1(s,a,2,!1),o.add(u))}function wh(a,s,o){var u=0;s&&(u|=4),U1(o,a,u,s)}var sf="_reactListening"+Math.random().toString(36).slice(2);function Sh(a){if(!a[sf]){a[sf]=!0,jt.forEach(function(o){o!=="selectionchange"&&(j4.has(o)||wh(o,!1,a),wh(o,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[sf]||(s[sf]=!0,wh("selectionchange",!1,s))}}function U1(a,s,o,u){switch(fg(s)){case 2:var x=uw;break;case 8:x=hw;break;default:x=Bh}o=x.bind(null,s,o,a),x=void 0,!Y0||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),u?x!==void 0?a.addEventListener(s,o,{capture:!0,passive:x}):a.addEventListener(s,o,!0):x!==void 0?a.addEventListener(s,o,{passive:x}):a.addEventListener(s,o,!1)}function Eh(a,s,o,u,x){var g=u;if((s&1)===0&&(s&2)===0&&u!==null)t:for(;;){if(u===null)return;var M=u.tag;if(M===3||M===4){var X=u.stateNode.containerInfo;if(X===x)break;if(M===4)for(M=u.return;M!==null;){var ht=M.tag;if((ht===3||ht===4)&&M.stateNode.containerInfo===x)return;M=M.return}for(;X!==null;){if(M=at(X),M===null)return;if(ht=M.tag,ht===5||ht===6||ht===26||ht===27){u=g=M;continue t}X=X.parentNode}}u=u.return}Xp(function(){var zt=g,Wt=G0(o),Qt=[];t:{var It=bx.get(a);if(It!==void 0){var $t=vc,Ne=a;switch(a){case"keypress":if(gc(o)===0)break t;case"keydown":case"keyup":$t=Rb;break;case"focusin":Ne="focus",$t=q0;break;case"focusout":Ne="blur",$t=q0;break;case"beforeblur":case"afterblur":$t=q0;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$t=Kp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$t=_b;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$t=zb;break;case gx:case yx:case vx:$t=Sb;break;case _x:$t=Bb;break;case"scroll":case"scrollend":$t=yb;break;case"wheel":$t=Ib;break;case"copy":case"cut":case"paste":$t=Tb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$t=Qp;break;case"toggle":case"beforetoggle":$t=Hb}var Ae=(s&4)!==0,on=!Ae&&(a==="scroll"||a==="scrollend"),Nt=Ae?It!==null?It+"Capture":null:It;Ae=[];for(var _t=zt,Rt;_t!==null;){var qt=_t;if(Rt=qt.stateNode,qt=qt.tag,qt!==5&&qt!==26&&qt!==27||Rt===null||Nt===null||(qt=Fl(_t,Nt),qt!=null&&Ae.push(ho(_t,qt,Rt))),on)break;_t=_t.return}0<Ae.length&&(It=new $t(It,Ne,null,o,Wt),Qt.push({event:It,listeners:Ae}))}}if((s&7)===0){t:{if(It=a==="mouseover"||a==="pointerover",$t=a==="mouseout"||a==="pointerout",It&&o!==$0&&(Ne=o.relatedTarget||o.fromElement)&&(at(Ne)||Ne[pr]))break t;if(($t||It)&&(It=Wt.window===Wt?Wt:(It=Wt.ownerDocument)?It.defaultView||It.parentWindow:window,$t?(Ne=o.relatedTarget||o.toElement,$t=zt,Ne=Ne?at(Ne):null,Ne!==null&&(on=c(Ne),Ae=Ne.tag,Ne!==on||Ae!==5&&Ae!==27&&Ae!==6)&&(Ne=null)):($t=null,Ne=zt),$t!==Ne)){if(Ae=Kp,qt="onMouseLeave",Nt="onMouseEnter",_t="mouse",(a==="pointerout"||a==="pointerover")&&(Ae=Qp,qt="onPointerLeave",Nt="onPointerEnter",_t="pointer"),on=$t==null?It:Lt($t),Rt=Ne==null?It:Lt(Ne),It=new Ae(qt,_t+"leave",$t,o,Wt),It.target=on,It.relatedTarget=Rt,qt=null,at(Wt)===zt&&(Ae=new Ae(Nt,_t+"enter",Ne,o,Wt),Ae.target=Rt,Ae.relatedTarget=on,qt=Ae),on=qt,$t&&Ne)e:{for(Ae=$t,Nt=Ne,_t=0,Rt=Ae;Rt;Rt=Zs(Rt))_t++;for(Rt=0,qt=Nt;qt;qt=Zs(qt))Rt++;for(;0<_t-Rt;)Ae=Zs(Ae),_t--;for(;0<Rt-_t;)Nt=Zs(Nt),Rt--;for(;_t--;){if(Ae===Nt||Nt!==null&&Ae===Nt.alternate)break e;Ae=Zs(Ae),Nt=Zs(Nt)}Ae=null}else Ae=null;$t!==null&&H1(Qt,It,$t,Ae,!1),Ne!==null&&on!==null&&H1(Qt,on,Ne,Ae,!0)}}t:{if(It=zt?Lt(zt):window,$t=It.nodeName&&It.nodeName.toLowerCase(),$t==="select"||$t==="input"&&It.type==="file")var ye=sx;else if(ax(It))if(lx)ye=Zb;else{ye=qb;var ze=Wb}else $t=It.nodeName,!$t||$t.toLowerCase()!=="input"||It.type!=="checkbox"&&It.type!=="radio"?zt&&H0(zt.elementType)&&(ye=sx):ye=Kb;if(ye&&(ye=ye(a,zt))){ix(Qt,ye,o,Wt);break t}ze&&ze(a,It,zt),a==="focusout"&&zt&&It.type==="number"&&zt.memoizedProps.value!=null&&U0(It,"number",It.value)}switch(ze=zt?Lt(zt):window,a){case"focusin":(ax(ze)||ze.contentEditable==="true")&&(Ds=ze,eu=zt,jl=null);break;case"focusout":jl=eu=Ds=null;break;case"mousedown":nu=!0;break;case"contextmenu":case"mouseup":case"dragend":nu=!1,xx(Qt,o,Wt);break;case"selectionchange":if(Jb)break;case"keydown":case"keyup":xx(Qt,o,Wt)}var we;if(Z0)t:{switch(a){case"compositionstart":var De="onCompositionStart";break t;case"compositionend":De="onCompositionEnd";break t;case"compositionupdate":De="onCompositionUpdate";break t}De=void 0}else As?nx(a,o)&&(De="onCompositionEnd"):a==="keydown"&&o.keyCode===229&&(De="onCompositionStart");De&&(Jp&&o.locale!=="ko"&&(As||De!=="onCompositionStart"?De==="onCompositionEnd"&&As&&(we=Wp()):(ii=Wt,V0="value"in ii?ii.value:ii.textContent,As=!0)),ze=lf(zt,De),0<ze.length&&(De=new Zp(De,a,null,o,Wt),Qt.push({event:De,listeners:ze}),we?De.data=we:(we=rx(o),we!==null&&(De.data=we)))),(we=Gb?Pb(a,o):Yb(a,o))&&(De=lf(zt,"onBeforeInput"),0<De.length&&(ze=new Zp("onBeforeInput","beforeinput",null,o,Wt),Qt.push({event:ze,listeners:De}),ze.data=we)),z4(Qt,a,zt,o,Wt)}I1(Qt,s)})}function ho(a,s,o){return{instance:a,listener:s,currentTarget:o}}function lf(a,s){for(var o=s+"Capture",u=[];a!==null;){var x=a,g=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||g===null||(x=Fl(a,o),x!=null&&u.unshift(ho(a,x,g)),x=Fl(a,s),x!=null&&u.push(ho(a,x,g))),a.tag===3)return u;a=a.return}return[]}function Zs(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function H1(a,s,o,u,x){for(var g=s._reactName,M=[];o!==null&&o!==u;){var X=o,ht=X.alternate,zt=X.stateNode;if(X=X.tag,ht!==null&&ht===u)break;X!==5&&X!==26&&X!==27||zt===null||(ht=zt,x?(zt=Fl(o,g),zt!=null&&M.unshift(ho(o,zt,ht))):x||(zt=Fl(o,g),zt!=null&&M.push(ho(o,zt,ht)))),o=o.return}M.length!==0&&a.push({event:s,listeners:M})}var I4=/\r\n?/g,U4=/\u0000|\uFFFD/g;function $1(a){return(typeof a=="string"?a:""+a).replace(I4,`
`).replace(U4,"")}function G1(a,s){return s=$1(s),$1(a)===s}function of(){}function ln(a,s,o,u,x,g){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Ss(a,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Ss(a,""+u);break;case"className":an(a,"class",u);break;case"tabIndex":an(a,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":an(a,o,u);break;case"style":Yp(a,u,g);break;case"data":if(s!=="object"){an(a,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){a.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=xc(""+u),a.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){a.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(s!=="input"&&ln(a,s,"name",x.name,x,null),ln(a,s,"formEncType",x.formEncType,x,null),ln(a,s,"formMethod",x.formMethod,x,null),ln(a,s,"formTarget",x.formTarget,x,null)):(ln(a,s,"encType",x.encType,x,null),ln(a,s,"method",x.method,x,null),ln(a,s,"target",x.target,x,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=xc(""+u),a.setAttribute(o,u);break;case"onClick":u!=null&&(a.onclick=of);break;case"onScroll":u!=null&&je("scroll",a);break;case"onScrollEnd":u!=null&&je("scrollend",a);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(x.children!=null)throw Error(i(60));a.innerHTML=o}}break;case"multiple":a.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":a.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){a.removeAttribute("xlink:href");break}o=xc(""+u),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""+u):a.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""):a.removeAttribute(o);break;case"capture":case"download":u===!0?a.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,u):a.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?a.setAttribute(o,u):a.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?a.removeAttribute(o):a.setAttribute(o,u);break;case"popover":je("beforetoggle",a),je("toggle",a),rn(a,"popover",u);break;case"xlinkActuate":hn(a,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":hn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":hn(a,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":hn(a,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":hn(a,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":hn(a,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":hn(a,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":hn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":hn(a,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":rn(a,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=mb.get(o)||o,rn(a,o,u))}}function Th(a,s,o,u,x,g){switch(o){case"style":Yp(a,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(x.children!=null)throw Error(i(60));a.innerHTML=o}}break;case"children":typeof u=="string"?Ss(a,u):(typeof u=="number"||typeof u=="bigint")&&Ss(a,""+u);break;case"onScroll":u!=null&&je("scroll",a);break;case"onScrollEnd":u!=null&&je("scrollend",a);break;case"onClick":u!=null&&(a.onclick=of);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ht.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(x=o.endsWith("Capture"),s=o.slice(2,x?o.length-7:void 0),g=a[qe]||null,g=g!=null?g[o]:null,typeof g=="function"&&a.removeEventListener(s,g,x),typeof u=="function")){typeof g!="function"&&g!==null&&(o in a?a[o]=null:a.hasAttribute(o)&&a.removeAttribute(o)),a.addEventListener(s,u,x);break t}o in a?a[o]=u:u===!0?a.setAttribute(o,""):rn(a,o,u)}}}function Jn(a,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",a),je("load",a);var u=!1,x=!1,g;for(g in o)if(o.hasOwnProperty(g)){var M=o[g];if(M!=null)switch(g){case"src":u=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ln(a,s,g,M,o,null)}}x&&ln(a,s,"srcSet",o.srcSet,o,null),u&&ln(a,s,"src",o.src,o,null);return;case"input":je("invalid",a);var X=g=M=x=null,ht=null,zt=null;for(u in o)if(o.hasOwnProperty(u)){var Wt=o[u];if(Wt!=null)switch(u){case"name":x=Wt;break;case"type":M=Wt;break;case"checked":ht=Wt;break;case"defaultChecked":zt=Wt;break;case"value":g=Wt;break;case"defaultValue":X=Wt;break;case"children":case"dangerouslySetInnerHTML":if(Wt!=null)throw Error(i(137,s));break;default:ln(a,s,u,Wt,o,null)}}Hp(a,g,X,ht,zt,M,x,!1),dc(a);return;case"select":je("invalid",a),u=M=g=null;for(x in o)if(o.hasOwnProperty(x)&&(X=o[x],X!=null))switch(x){case"value":g=X;break;case"defaultValue":M=X;break;case"multiple":u=X;default:ln(a,s,x,X,o,null)}s=g,o=M,a.multiple=!!u,s!=null?ws(a,!!u,s,!1):o!=null&&ws(a,!!u,o,!0);return;case"textarea":je("invalid",a),g=x=u=null;for(M in o)if(o.hasOwnProperty(M)&&(X=o[M],X!=null))switch(M){case"value":u=X;break;case"defaultValue":x=X;break;case"children":g=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(91));break;default:ln(a,s,M,X,o,null)}Gp(a,u,x,g),dc(a);return;case"option":for(ht in o)if(o.hasOwnProperty(ht)&&(u=o[ht],u!=null))switch(ht){case"selected":a.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ln(a,s,ht,u,o,null)}return;case"dialog":je("beforetoggle",a),je("toggle",a),je("cancel",a),je("close",a);break;case"iframe":case"object":je("load",a);break;case"video":case"audio":for(u=0;u<uo.length;u++)je(uo[u],a);break;case"image":je("error",a),je("load",a);break;case"details":je("toggle",a);break;case"embed":case"source":case"link":je("error",a),je("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(zt in o)if(o.hasOwnProperty(zt)&&(u=o[zt],u!=null))switch(zt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ln(a,s,zt,u,o,null)}return;default:if(H0(s)){for(Wt in o)o.hasOwnProperty(Wt)&&(u=o[Wt],u!==void 0&&Th(a,s,Wt,u,o,void 0));return}}for(X in o)o.hasOwnProperty(X)&&(u=o[X],u!=null&&ln(a,s,X,u,o,null))}function H4(a,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,g=null,M=null,X=null,ht=null,zt=null,Wt=null;for($t in o){var Qt=o[$t];if(o.hasOwnProperty($t)&&Qt!=null)switch($t){case"checked":break;case"value":break;case"defaultValue":ht=Qt;default:u.hasOwnProperty($t)||ln(a,s,$t,null,u,Qt)}}for(var It in u){var $t=u[It];if(Qt=o[It],u.hasOwnProperty(It)&&($t!=null||Qt!=null))switch(It){case"type":g=$t;break;case"name":x=$t;break;case"checked":zt=$t;break;case"defaultChecked":Wt=$t;break;case"value":M=$t;break;case"defaultValue":X=$t;break;case"children":case"dangerouslySetInnerHTML":if($t!=null)throw Error(i(137,s));break;default:$t!==Qt&&ln(a,s,It,$t,u,Qt)}}I0(a,M,X,ht,zt,Wt,g,x);return;case"select":$t=M=X=It=null;for(g in o)if(ht=o[g],o.hasOwnProperty(g)&&ht!=null)switch(g){case"value":break;case"multiple":$t=ht;default:u.hasOwnProperty(g)||ln(a,s,g,null,u,ht)}for(x in u)if(g=u[x],ht=o[x],u.hasOwnProperty(x)&&(g!=null||ht!=null))switch(x){case"value":It=g;break;case"defaultValue":X=g;break;case"multiple":M=g;default:g!==ht&&ln(a,s,x,g,u,ht)}s=X,o=M,u=$t,It!=null?ws(a,!!o,It,!1):!!u!=!!o&&(s!=null?ws(a,!!o,s,!0):ws(a,!!o,o?[]:"",!1));return;case"textarea":$t=It=null;for(X in o)if(x=o[X],o.hasOwnProperty(X)&&x!=null&&!u.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:ln(a,s,X,null,u,x)}for(M in u)if(x=u[M],g=o[M],u.hasOwnProperty(M)&&(x!=null||g!=null))switch(M){case"value":It=x;break;case"defaultValue":$t=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==g&&ln(a,s,M,x,u,g)}$p(a,It,$t);return;case"option":for(var Ne in o)if(It=o[Ne],o.hasOwnProperty(Ne)&&It!=null&&!u.hasOwnProperty(Ne))switch(Ne){case"selected":a.selected=!1;break;default:ln(a,s,Ne,null,u,It)}for(ht in u)if(It=u[ht],$t=o[ht],u.hasOwnProperty(ht)&&It!==$t&&(It!=null||$t!=null))switch(ht){case"selected":a.selected=It&&typeof It!="function"&&typeof It!="symbol";break;default:ln(a,s,ht,It,u,$t)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in o)It=o[Ae],o.hasOwnProperty(Ae)&&It!=null&&!u.hasOwnProperty(Ae)&&ln(a,s,Ae,null,u,It);for(zt in u)if(It=u[zt],$t=o[zt],u.hasOwnProperty(zt)&&It!==$t&&(It!=null||$t!=null))switch(zt){case"children":case"dangerouslySetInnerHTML":if(It!=null)throw Error(i(137,s));break;default:ln(a,s,zt,It,u,$t)}return;default:if(H0(s)){for(var on in o)It=o[on],o.hasOwnProperty(on)&&It!==void 0&&!u.hasOwnProperty(on)&&Th(a,s,on,void 0,u,It);for(Wt in u)It=u[Wt],$t=o[Wt],!u.hasOwnProperty(Wt)||It===$t||It===void 0&&$t===void 0||Th(a,s,Wt,It,u,$t);return}}for(var Nt in o)It=o[Nt],o.hasOwnProperty(Nt)&&It!=null&&!u.hasOwnProperty(Nt)&&ln(a,s,Nt,null,u,It);for(Qt in u)It=u[Qt],$t=o[Qt],!u.hasOwnProperty(Qt)||It===$t||It==null&&$t==null||ln(a,s,Qt,It,u,$t)}var Ah=null,Dh=null;function cf(a){return a.nodeType===9?a:a.ownerDocument}function P1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Y1(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Nh(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var kh=null;function $4(){var a=window.event;return a&&a.type==="popstate"?a===kh?!1:(kh=a,!0):(kh=null,!1)}var V1=typeof setTimeout=="function"?setTimeout:void 0,G4=typeof clearTimeout=="function"?clearTimeout:void 0,X1=typeof Promise=="function"?Promise:void 0,P4=typeof queueMicrotask=="function"?queueMicrotask:typeof X1<"u"?function(a){return X1.resolve(null).then(a).catch(Y4)}:V1;function Y4(a){setTimeout(function(){throw a})}function bi(a){return a==="head"}function W1(a,s){var o=s,u=0,x=0;do{var g=o.nextSibling;if(a.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(0<u&&8>u){o=u;var M=a.ownerDocument;if(o&1&&po(M.documentElement),o&2&&po(M.body),o&4)for(o=M.head,po(o),M=o.firstChild;M;){var X=M.nextSibling,ht=M.nodeName;M[Q]||ht==="SCRIPT"||ht==="STYLE"||ht==="LINK"&&M.rel.toLowerCase()==="stylesheet"||o.removeChild(M),M=X}}if(x===0){a.removeChild(g),wo(s);return}x--}else o==="$"||o==="$?"||o==="$!"?x++:u=o.charCodeAt(0)-48;else u=0;o=g}while(o);wo(s)}function Fh(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Fh(o),et(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}a.removeChild(o)}}function V4(a,s,o,u){for(;a.nodeType===1;){var x=o;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(u){if(!a[Q])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(g=a.getAttribute("rel"),g==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(g!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(g=a.getAttribute("src"),(g!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&g&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var g=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===g)return a}else return a;if(a=ra(a.nextSibling),a===null)break}return null}function X4(a,s,o){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=ra(a.nextSibling),a===null))return null;return a}function Ch(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function W4(a,s){var o=a.ownerDocument;if(a.data!=="$?"||o.readyState==="complete")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),a._reactRetry=u}}function ra(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}var Rh=null;function q1(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var o=a.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return a;s--}else o==="/$"&&s++}a=a.previousSibling}return null}function K1(a,s,o){switch(s=cf(o),a){case"html":if(a=s.documentElement,!a)throw Error(i(452));return a;case"head":if(a=s.head,!a)throw Error(i(453));return a;case"body":if(a=s.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function po(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);et(a)}var qr=new Map,Z1=new Set;function ff(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ya=gt.d;gt.d={f:q4,r:K4,D:Z4,C:Q4,L:J4,m:tw,X:nw,S:ew,M:rw};function q4(){var a=Ya.f(),s=tf();return a||s}function K4(a){var s=ot(a);s!==null&&s.tag===5&&s.type==="form"?gm(s):Ya.r(a)}var Qs=typeof document>"u"?null:document;function Q1(a,s,o){var u=Qs;if(u&&typeof s=="string"&&s){var x=$r(s);x='link[rel="'+a+'"][href="'+x+'"]',typeof o=="string"&&(x+='[crossorigin="'+o+'"]'),Z1.has(x)||(Z1.add(x),a={rel:a,crossOrigin:o,href:s},u.querySelector(x)===null&&(s=u.createElement("link"),Jn(s,"link",a),kt(s),u.head.appendChild(s)))}}function Z4(a){Ya.D(a),Q1("dns-prefetch",a,null)}function Q4(a,s){Ya.C(a,s),Q1("preconnect",a,s)}function J4(a,s,o){Ya.L(a,s,o);var u=Qs;if(u&&a&&s){var x='link[rel="preload"][as="'+$r(s)+'"]';s==="image"&&o&&o.imageSrcSet?(x+='[imagesrcset="'+$r(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(x+='[imagesizes="'+$r(o.imageSizes)+'"]')):x+='[href="'+$r(a)+'"]';var g=x;switch(s){case"style":g=Js(a);break;case"script":g=tl(a)}qr.has(g)||(a=m({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:a,as:s},o),qr.set(g,a),u.querySelector(x)!==null||s==="style"&&u.querySelector(xo(g))||s==="script"&&u.querySelector(mo(g))||(s=u.createElement("link"),Jn(s,"link",a),kt(s),u.head.appendChild(s)))}}function tw(a,s){Ya.m(a,s);var o=Qs;if(o&&a){var u=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+$r(u)+'"][href="'+$r(a)+'"]',g=x;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=tl(a)}if(!qr.has(g)&&(a=m({rel:"modulepreload",href:a},s),qr.set(g,a),o.querySelector(x)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(mo(g)))return}u=o.createElement("link"),Jn(u,"link",a),kt(u),o.head.appendChild(u)}}}function ew(a,s,o){Ya.S(a,s,o);var u=Qs;if(u&&a){var x=Vt(u).hoistableStyles,g=Js(a);s=s||"default";var M=x.get(g);if(!M){var X={loading:0,preload:null};if(M=u.querySelector(xo(g)))X.loading=5;else{a=m({rel:"stylesheet",href:a,"data-precedence":s},o),(o=qr.get(g))&&Mh(a,o);var ht=M=u.createElement("link");kt(ht),Jn(ht,"link",a),ht._p=new Promise(function(zt,Wt){ht.onload=zt,ht.onerror=Wt}),ht.addEventListener("load",function(){X.loading|=1}),ht.addEventListener("error",function(){X.loading|=2}),X.loading|=4,uf(M,s,u)}M={type:"stylesheet",instance:M,count:1,state:X},x.set(g,M)}}}function nw(a,s){Ya.X(a,s);var o=Qs;if(o&&a){var u=Vt(o).hoistableScripts,x=tl(a),g=u.get(x);g||(g=o.querySelector(mo(x)),g||(a=m({src:a,async:!0},s),(s=qr.get(x))&&Oh(a,s),g=o.createElement("script"),kt(g),Jn(g,"link",a),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(x,g))}}function rw(a,s){Ya.M(a,s);var o=Qs;if(o&&a){var u=Vt(o).hoistableScripts,x=tl(a),g=u.get(x);g||(g=o.querySelector(mo(x)),g||(a=m({src:a,async:!0,type:"module"},s),(s=qr.get(x))&&Oh(a,s),g=o.createElement("script"),kt(g),Jn(g,"link",a),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(x,g))}}function J1(a,s,o,u){var x=(x=tt.current)?ff(x):null;if(!x)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Js(o.href),o=Vt(x).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){a=Js(o.href);var g=Vt(x).hoistableStyles,M=g.get(a);if(M||(x=x.ownerDocument||x,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(a,M),(g=x.querySelector(xo(a)))&&!g._p&&(M.instance=g,M.state.loading=5),qr.has(a)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},qr.set(a,o),g||aw(x,a,o,M.state))),s&&u===null)throw Error(i(528,""));return M}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=tl(o),o=Vt(x).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Js(a){return'href="'+$r(a)+'"'}function xo(a){return'link[rel="stylesheet"]['+a+"]"}function tg(a){return m({},a,{"data-precedence":a.precedence,precedence:null})}function aw(a,s,o,u){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=a.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),Jn(s,"link",o),kt(s),a.head.appendChild(s))}function tl(a){return'[src="'+$r(a)+'"]'}function mo(a){return"script[async]"+a}function eg(a,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=a.querySelector('style[data-href~="'+$r(o.href)+'"]');if(u)return s.instance=u,kt(u),u;var x=m({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(a.ownerDocument||a).createElement("style"),kt(u),Jn(u,"style",x),uf(u,o.precedence,a),s.instance=u;case"stylesheet":x=Js(o.href);var g=a.querySelector(xo(x));if(g)return s.state.loading|=4,s.instance=g,kt(g),g;u=tg(o),(x=qr.get(x))&&Mh(u,x),g=(a.ownerDocument||a).createElement("link"),kt(g);var M=g;return M._p=new Promise(function(X,ht){M.onload=X,M.onerror=ht}),Jn(g,"link",u),s.state.loading|=4,uf(g,o.precedence,a),s.instance=g;case"script":return g=tl(o.src),(x=a.querySelector(mo(g)))?(s.instance=x,kt(x),x):(u=o,(x=qr.get(g))&&(u=m({},o),Oh(u,x)),a=a.ownerDocument||a,x=a.createElement("script"),kt(x),Jn(x,"link",u),a.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,uf(u,o.precedence,a));return s.instance}function uf(a,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=u.length?u[u.length-1]:null,g=x,M=0;M<u.length;M++){var X=u[M];if(X.dataset.precedence===s)g=X;else if(g!==x)break}g?g.parentNode.insertBefore(a,g.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(a,s.firstChild))}function Mh(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Oh(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var hf=null;function ng(a,s,o){if(hf===null){var u=new Map,x=hf=new Map;x.set(o,u)}else x=hf,u=x.get(o),u||(u=new Map,x.set(o,u));if(u.has(a))return u;for(u.set(a,null),o=o.getElementsByTagName(a),x=0;x<o.length;x++){var g=o[x];if(!(g[Q]||g[xn]||a==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var M=g.getAttribute(s)||"";M=a+M;var X=u.get(M);X?X.push(g):u.set(M,[g])}}return u}function rg(a,s,o){a=a.ownerDocument||a,a.head.insertBefore(o,s==="title"?a.querySelector("head > title"):null)}function iw(a,s,o){if(o===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function ag(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var go=null;function sw(){}function lw(a,s,o){if(go===null)throw Error(i(475));var u=go;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var x=Js(o.href),g=a.querySelector(xo(x));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(u.count++,u=df.bind(u),a.then(u,u)),s.state.loading|=4,s.instance=g,kt(g);return}g=a.ownerDocument||a,o=tg(o),(x=qr.get(x))&&Mh(o,x),g=g.createElement("link"),kt(g);var M=g;M._p=new Promise(function(X,ht){M.onload=X,M.onerror=ht}),Jn(g,"link",o),s.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(u.count++,s=df.bind(u),a.addEventListener("load",s),a.addEventListener("error",s))}}function ow(){if(go===null)throw Error(i(475));var a=go;return a.stylesheets&&a.count===0&&zh(a,a.stylesheets),0<a.count?function(s){var o=setTimeout(function(){if(a.stylesheets&&zh(a,a.stylesheets),a.unsuspend){var u=a.unsuspend;a.unsuspend=null,u()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(o)}}:null}function df(){if(this.count--,this.count===0){if(this.stylesheets)zh(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var pf=null;function zh(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,pf=new Map,s.forEach(cw,a),pf=null,df.call(a))}function cw(a,s){if(!(s.state.loading&4)){var o=pf.get(a);if(o)var u=o.get(null);else{o=new Map,pf.set(a,o);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<x.length;g++){var M=x[g];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(o.set(M.dataset.precedence,M),u=M)}u&&o.set(null,u)}x=s.instance,M=x.getAttribute("data-precedence"),g=o.get(M)||u,g===u&&o.set(null,x),o.set(M,x),this.count++,u=df.bind(this),x.addEventListener("load",u),x.addEventListener("error",u),g?g.parentNode.insertBefore(x,g.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),s.state.loading|=4}}var yo={$$typeof:C,Provider:null,Consumer:null,_currentValue:wt,_currentValue2:wt,_threadCount:0};function fw(a,s,o,u,x,g,M,X){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ae(0),this.hiddenUpdates=ae(null),this.identifierPrefix=u,this.onUncaughtError=x,this.onCaughtError=g,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function ig(a,s,o,u,x,g,M,X,ht,zt,Wt,Qt){return a=new fw(a,s,o,M,X,ht,zt,Qt),s=1,g===!0&&(s|=24),g=Nr(3,null,null,s),a.current=g,g.stateNode=a,s=mu(),s.refCount++,a.pooledCache=s,s.refCount++,g.memoizedState={element:u,isDehydrated:o,cache:s},_u(g),a}function sg(a){return a?(a=Cs,a):Cs}function lg(a,s,o,u,x,g){x=sg(x),u.context===null?u.context=x:u.pendingContext=x,u=oi(s),u.payload={element:o},g=g===void 0?null:g,g!==null&&(u.callback=g),o=ci(a,u,s),o!==null&&(Mr(o,a,s),Xl(o,a,s))}function og(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var o=a.retryLane;a.retryLane=o!==0&&o<s?o:s}}function Lh(a,s){og(a,s),(a=a.alternate)&&og(a,s)}function cg(a){if(a.tag===13){var s=Fs(a,67108864);s!==null&&Mr(s,a,67108864),Lh(a,67108864)}}var xf=!0;function uw(a,s,o,u){var x=J.T;J.T=null;var g=gt.p;try{gt.p=2,Bh(a,s,o,u)}finally{gt.p=g,J.T=x}}function hw(a,s,o,u){var x=J.T;J.T=null;var g=gt.p;try{gt.p=8,Bh(a,s,o,u)}finally{gt.p=g,J.T=x}}function Bh(a,s,o,u){if(xf){var x=jh(u);if(x===null)Eh(a,s,u,mf,o),ug(a,u);else if(pw(x,a,s,o,u))u.stopPropagation();else if(ug(a,u),s&4&&-1<dw.indexOf(a)){for(;x!==null;){var g=ot(x);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var M=Ut(g.pendingLanes);if(M!==0){var X=g;for(X.pendingLanes|=2,X.entangledLanes|=2;M;){var ht=1<<31-G(M);X.entanglements[1]|=ht,M&=~ht}va(g),(Ke&6)===0&&(Qc=Et()+500,fo(0))}}break;case 13:X=Fs(g,2),X!==null&&Mr(X,g,2),tf(),Lh(g,2)}if(g=jh(u),g===null&&Eh(a,s,u,mf,o),g===x)break;x=g}x!==null&&u.stopPropagation()}else Eh(a,s,u,null,o)}}function jh(a){return a=G0(a),Ih(a)}var mf=null;function Ih(a){if(mf=null,a=at(a),a!==null){var s=c(a);if(s===null)a=null;else{var o=s.tag;if(o===13){if(a=f(s),a!==null)return a;a=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return mf=a,null}function fg(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Mt()){case Ot:return 2;case Dt:return 8;case ie:case xe:return 32;case ue:return 268435456;default:return 32}default:return 32}}var Uh=!1,wi=null,Si=null,Ei=null,vo=new Map,_o=new Map,Ti=[],dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ug(a,s){switch(a){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":vo.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(s.pointerId)}}function bo(a,s,o,u,x,g){return a===null||a.nativeEvent!==g?(a={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:g,targetContainers:[x]},s!==null&&(s=ot(s),s!==null&&cg(s)),a):(a.eventSystemFlags|=u,s=a.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),a)}function pw(a,s,o,u,x){switch(s){case"focusin":return wi=bo(wi,a,s,o,u,x),!0;case"dragenter":return Si=bo(Si,a,s,o,u,x),!0;case"mouseover":return Ei=bo(Ei,a,s,o,u,x),!0;case"pointerover":var g=x.pointerId;return vo.set(g,bo(vo.get(g)||null,a,s,o,u,x)),!0;case"gotpointercapture":return g=x.pointerId,_o.set(g,bo(_o.get(g)||null,a,s,o,u,x)),!0}return!1}function hg(a){var s=at(a.target);if(s!==null){var o=c(s);if(o!==null){if(s=o.tag,s===13){if(s=f(o),s!==null){a.blockedOn=s,$n(a.priority,function(){if(o.tag===13){var u=Rr();u=Ue(u);var x=Fs(o,u);x!==null&&Mr(x,o,u),Lh(o,u)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){a.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}a.blockedOn=null}function gf(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var o=jh(a.nativeEvent);if(o===null){o=a.nativeEvent;var u=new o.constructor(o.type,o);$0=u,o.target.dispatchEvent(u),$0=null}else return s=ot(o),s!==null&&cg(s),a.blockedOn=o,!1;s.shift()}return!0}function dg(a,s,o){gf(a)&&o.delete(s)}function xw(){Uh=!1,wi!==null&&gf(wi)&&(wi=null),Si!==null&&gf(Si)&&(Si=null),Ei!==null&&gf(Ei)&&(Ei=null),vo.forEach(dg),_o.forEach(dg)}function yf(a,s){a.blockedOn===s&&(a.blockedOn=null,Uh||(Uh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,xw)))}var vf=null;function pg(a){vf!==a&&(vf=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){vf===a&&(vf=null);for(var s=0;s<a.length;s+=3){var o=a[s],u=a[s+1],x=a[s+2];if(typeof u!="function"){if(Ih(u||o)===null)continue;break}var g=ot(o);g!==null&&(a.splice(s,3),s-=3,Iu(g,{pending:!0,data:x,method:o.method,action:u},u,x))}}))}function wo(a){function s(ht){return yf(ht,a)}wi!==null&&yf(wi,a),Si!==null&&yf(Si,a),Ei!==null&&yf(Ei,a),vo.forEach(s),_o.forEach(s);for(var o=0;o<Ti.length;o++){var u=Ti[o];u.blockedOn===a&&(u.blockedOn=null)}for(;0<Ti.length&&(o=Ti[0],o.blockedOn===null);)hg(o),o.blockedOn===null&&Ti.shift();if(o=(a.ownerDocument||a).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var x=o[u],g=o[u+1],M=x[qe]||null;if(typeof g=="function")M||pg(o);else if(M){var X=null;if(g&&g.hasAttribute("formAction")){if(x=g,M=g[qe]||null)X=M.formAction;else if(Ih(x)!==null)continue}else X=M.action;typeof X=="function"?o[u+1]=X:(o.splice(u,3),u-=3),pg(o)}}}function Hh(a){this._internalRoot=a}_f.prototype.render=Hh.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=Rr();lg(o,u,a,s,null,null)},_f.prototype.unmount=Hh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;lg(a.current,2,null,a,null,null),tf(),s[pr]=null}};function _f(a){this._internalRoot=a}_f.prototype.unstable_scheduleHydration=function(a){if(a){var s=pn();a={blockedOn:null,target:a,priority:s};for(var o=0;o<Ti.length&&s!==0&&s<Ti[o].priority;o++);Ti.splice(o,0,a),o===0&&hg(a)}};var xg=n.version;if(xg!=="19.1.0")throw Error(i(527,xg,"19.1.0"));gt.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=p(s),a=a!==null?h(a):null,a=a===null?null:a.stateNode,a};var mw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bf.isDisabled&&bf.supportsFiber)try{rt=bf.inject(mw),ct=bf}catch{}}return Eo.createRoot=function(a,s){if(!l(a))throw Error(i(299));var o=!1,u="",x=Cm,g=Rm,M=Mm,X=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(M=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(X=s.unstable_transitionCallbacks)),s=ig(a,1,!1,null,null,o,u,x,g,M,X,null),a[pr]=s.current,Sh(a),new Hh(s)},Eo.hydrateRoot=function(a,s,o){if(!l(a))throw Error(i(299));var u=!1,x="",g=Cm,M=Rm,X=Mm,ht=null,zt=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(M=o.onCaughtError),o.onRecoverableError!==void 0&&(X=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(ht=o.unstable_transitionCallbacks),o.formState!==void 0&&(zt=o.formState)),s=ig(a,1,!0,s,o??null,u,x,g,M,X,ht,zt),s.context=sg(null),o=s.current,u=Rr(),u=Ue(u),x=oi(u),x.callback=null,ci(o,x,u),o=u,s.current.lanes=o,pe(s,o),va(s),a[pr]=s.current,Sh(a),new _f(s)},Eo.version="19.1.0",Eo}var Tg;function Aw(){if(Tg)return Ph.exports;Tg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Ph.exports=Tw(),Ph.exports}var Dw=Aw();/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ag="popstate";function Nw(t={}){function n(i,l){let{pathname:c,search:f,hash:d}=i.location;return Td("",{pathname:c,search:f,hash:d},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(i,l){return typeof l=="string"?l:Go(l)}return Fw(n,r,null,t)}function vn(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function ua(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function kw(){return Math.random().toString(36).substring(2,10)}function Dg(t,n){return{usr:t.state,key:t.key,idx:n}}function Td(t,n,r=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?wl(n):n,state:r,key:n&&n.key||i||kw()}}function Go({pathname:t="/",search:n="",hash:r=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function wl(t){let n={};if(t){let r=t.indexOf("#");r>=0&&(n.hash=t.substring(r),t=t.substring(0,r));let i=t.indexOf("?");i>=0&&(n.search=t.substring(i),t=t.substring(0,i)),t&&(n.pathname=t)}return n}function Fw(t,n,r,i={}){let{window:l=document.defaultView,v5Compat:c=!1}=i,f=l.history,d="POP",p=null,h=m();h==null&&(h=0,f.replaceState({...f.state,idx:h},""));function m(){return(f.state||{idx:null}).idx}function y(){d="POP";let E=m(),A=E==null?null:E-h;h=E,p&&p({action:d,location:b.location,delta:A})}function v(E,A){d="PUSH";let O=Td(b.location,E,A);h=m()+1;let C=Dg(O,h),U=b.createHref(O);try{f.pushState(C,"",U)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;l.location.assign(U)}c&&p&&p({action:d,location:b.location,delta:1})}function w(E,A){d="REPLACE";let O=Td(b.location,E,A);h=m();let C=Dg(O,h),U=b.createHref(O);f.replaceState(C,"",U),c&&p&&p({action:d,location:b.location,delta:0})}function S(E){return Cw(E)}let b={get action(){return d},get location(){return t(l,f)},listen(E){if(p)throw new Error("A history only accepts one active listener");return l.addEventListener(Ag,y),p=E,()=>{l.removeEventListener(Ag,y),p=null}},createHref(E){return n(l,E)},createURL:S,encodeLocation(E){let A=S(E);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:v,replace:w,go(E){return f.go(E)}};return b}function Cw(t,n=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),vn(r,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Go(t);return i=i.replace(/ $/,"%20"),!n&&i.startsWith("//")&&(i=r+i),new URL(i,r)}function f2(t,n,r="/"){return Rw(t,n,r,!1)}function Rw(t,n,r,i){let l=typeof n=="string"?wl(n):n,c=Ja(l.pathname||"/",r);if(c==null)return null;let f=u2(t);Mw(f);let d=null;for(let p=0;d==null&&p<f.length;++p){let h=Pw(c);d=$w(f[p],h,i)}return d}function u2(t,n=[],r=[],i=""){let l=(c,f,d)=>{let p={relativePath:d===void 0?c.path||"":d,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};p.relativePath.startsWith("/")&&(vn(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length));let h=qa([i,p.relativePath]),m=r.concat(p);c.children&&c.children.length>0&&(vn(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),u2(c.children,n,m,h)),!(c.path==null&&!c.index)&&n.push({path:h,score:Uw(h,c.index),routesMeta:m})};return t.forEach((c,f)=>{if(c.path===""||!c.path?.includes("?"))l(c,f);else for(let d of h2(c.path))l(c,f,d)}),n}function h2(t){let n=t.split("/");if(n.length===0)return[];let[r,...i]=n,l=r.endsWith("?"),c=r.replace(/\?$/,"");if(i.length===0)return l?[c,""]:[c];let f=h2(i.join("/")),d=[];return d.push(...f.map(p=>p===""?c:[c,p].join("/"))),l&&d.push(...f),d.map(p=>t.startsWith("/")&&p===""?"/":p)}function Mw(t){t.sort((n,r)=>n.score!==r.score?r.score-n.score:Hw(n.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}var Ow=/^:[\w-]+$/,zw=3,Lw=2,Bw=1,jw=10,Iw=-2,Ng=t=>t==="*";function Uw(t,n){let r=t.split("/"),i=r.length;return r.some(Ng)&&(i+=Iw),n&&(i+=Lw),r.filter(l=>!Ng(l)).reduce((l,c)=>l+(Ow.test(c)?zw:c===""?Bw:jw),i)}function Hw(t,n){return t.length===n.length&&t.slice(0,-1).every((i,l)=>i===n[l])?t[t.length-1]-n[n.length-1]:0}function $w(t,n,r=!1){let{routesMeta:i}=t,l={},c="/",f=[];for(let d=0;d<i.length;++d){let p=i[d],h=d===i.length-1,m=c==="/"?n:n.slice(c.length)||"/",y=Yf({path:p.relativePath,caseSensitive:p.caseSensitive,end:h},m),v=p.route;if(!y&&h&&r&&!i[i.length-1].route.index&&(y=Yf({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},m)),!y)return null;Object.assign(l,y.params),f.push({params:l,pathname:qa([c,y.pathname]),pathnameBase:Ww(qa([c,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(c=qa([c,y.pathnameBase]))}return f}function Yf(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,i]=Gw(t.path,t.caseSensitive,t.end),l=n.match(r);if(!l)return null;let c=l[0],f=c.replace(/(.)\/+$/,"$1"),d=l.slice(1);return{params:i.reduce((h,{paramName:m,isOptional:y},v)=>{if(m==="*"){let S=d[v]||"";f=c.slice(0,c.length-S.length).replace(/(.)\/+$/,"$1")}const w=d[v];return y&&!w?h[m]=void 0:h[m]=(w||"").replace(/%2F/g,"/"),h},{}),pathname:c,pathnameBase:f,pattern:t}}function Gw(t,n=!1,r=!0){ua(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,d,p)=>(i.push({paramName:d,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,n?void 0:"i"),i]}function Pw(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return ua(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function Ja(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let r=n.endsWith("/")?n.length-1:n.length,i=t.charAt(r);return i&&i!=="/"?null:t.slice(r)||"/"}function Yw(t,n="/"){let{pathname:r,search:i="",hash:l=""}=typeof t=="string"?wl(t):t;return{pathname:r?r.startsWith("/")?r:Vw(r,n):n,search:qw(i),hash:Kw(l)}}function Vw(t,n){let r=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?r.length>1&&r.pop():l!=="."&&r.push(l)}),r.length>1?r.join("/"):"/"}function Wh(t,n,r,i){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Xw(t){return t.filter((n,r)=>r===0||n.route.path&&n.route.path.length>0)}function Zd(t){let n=Xw(t);return n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase)}function Qd(t,n,r,i=!1){let l;typeof t=="string"?l=wl(t):(l={...t},vn(!l.pathname||!l.pathname.includes("?"),Wh("?","pathname","search",l)),vn(!l.pathname||!l.pathname.includes("#"),Wh("#","pathname","hash",l)),vn(!l.search||!l.search.includes("#"),Wh("#","search","hash",l)));let c=t===""||l.pathname==="",f=c?"/":l.pathname,d;if(f==null)d=r;else{let y=n.length-1;if(!i&&f.startsWith("..")){let v=f.split("/");for(;v[0]==="..";)v.shift(),y-=1;l.pathname=v.join("/")}d=y>=0?n[y]:"/"}let p=Yw(l,d),h=f&&f!=="/"&&f.endsWith("/"),m=(c||f===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(h||m)&&(p.pathname+="/"),p}var qa=t=>t.join("/").replace(/\/\/+/g,"/"),Ww=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),qw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Kw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Zw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var d2=["POST","PUT","PATCH","DELETE"];new Set(d2);var Qw=["GET",...d2];new Set(Qw);var Sl=Z.createContext(null);Sl.displayName="DataRouter";var w0=Z.createContext(null);w0.displayName="DataRouterState";Z.createContext(!1);var p2=Z.createContext({isTransitioning:!1});p2.displayName="ViewTransition";var Jw=Z.createContext(new Map);Jw.displayName="Fetchers";var tS=Z.createContext(null);tS.displayName="Await";var ha=Z.createContext(null);ha.displayName="Navigation";var ec=Z.createContext(null);ec.displayName="Location";var Aa=Z.createContext({outlet:null,matches:[],isDataRoute:!1});Aa.displayName="Route";var Jd=Z.createContext(null);Jd.displayName="RouteError";function eS(t,{relative:n}={}){vn(El(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:i}=Z.useContext(ha),{hash:l,pathname:c,search:f}=nc(t,{relative:n}),d=c;return r!=="/"&&(d=c==="/"?r:qa([r,c])),i.createHref({pathname:d,search:f,hash:l})}function El(){return Z.useContext(ec)!=null}function zi(){return vn(El(),"useLocation() may be used only in the context of a <Router> component."),Z.useContext(ec).location}var x2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function m2(t){Z.useContext(ha).static||Z.useLayoutEffect(t)}function g2(){let{isDataRoute:t}=Z.useContext(Aa);return t?pS():nS()}function nS(){vn(El(),"useNavigate() may be used only in the context of a <Router> component.");let t=Z.useContext(Sl),{basename:n,navigator:r}=Z.useContext(ha),{matches:i}=Z.useContext(Aa),{pathname:l}=zi(),c=JSON.stringify(Zd(i)),f=Z.useRef(!1);return m2(()=>{f.current=!0}),Z.useCallback((p,h={})=>{if(ua(f.current,x2),!f.current)return;if(typeof p=="number"){r.go(p);return}let m=Qd(p,JSON.parse(c),l,h.relative==="path");t==null&&n!=="/"&&(m.pathname=m.pathname==="/"?n:qa([n,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[n,r,c,l,t])}Z.createContext(null);function nc(t,{relative:n}={}){let{matches:r}=Z.useContext(Aa),{pathname:i}=zi(),l=JSON.stringify(Zd(r));return Z.useMemo(()=>Qd(t,JSON.parse(l),i,n==="path"),[t,l,i,n])}function rS(t,n){return y2(t,n)}function y2(t,n,r,i){vn(El(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=Z.useContext(ha),{matches:c}=Z.useContext(Aa),f=c[c.length-1],d=f?f.params:{},p=f?f.pathname:"/",h=f?f.pathnameBase:"/",m=f&&f.route;{let A=m&&m.path||"";v2(p,!m||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let y=zi(),v;if(n){let A=typeof n=="string"?wl(n):n;vn(h==="/"||A.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${A.pathname}" was given in the \`location\` prop.`),v=A}else v=y;let w=v.pathname||"/",S=w;if(h!=="/"){let A=h.replace(/^\//,"").split("/");S="/"+w.replace(/^\//,"").split("/").slice(A.length).join("/")}let b=f2(t,{pathname:S});ua(m||b!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ua(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=oS(b&&b.map(A=>Object.assign({},A,{params:Object.assign({},d,A.params),pathname:qa([h,l.encodeLocation?l.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?h:qa([h,l.encodeLocation?l.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),c,r,i);return n&&E?Z.createElement(ec.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function aS(){let t=dS(),n=Zw(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},f=null;return console.error("Error handled by React Router default ErrorBoundary:",t),f=Z.createElement(Z.Fragment,null,Z.createElement("p",null,"💿 Hey developer 👋"),Z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Z.createElement("code",{style:c},"ErrorBoundary")," or"," ",Z.createElement("code",{style:c},"errorElement")," prop on your route.")),Z.createElement(Z.Fragment,null,Z.createElement("h2",null,"Unexpected Application Error!"),Z.createElement("h3",{style:{fontStyle:"italic"}},n),r?Z.createElement("pre",{style:l},r):null,f)}var iS=Z.createElement(aS,null),sS=class extends Z.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?Z.createElement(Aa.Provider,{value:this.props.routeContext},Z.createElement(Jd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lS({routeContext:t,match:n,children:r}){let i=Z.useContext(Sl);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),Z.createElement(Aa.Provider,{value:t},r)}function oS(t,n=[],r=null,i=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(n.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,c=r?.errors;if(c!=null){let p=l.findIndex(h=>h.route.id&&c?.[h.route.id]!==void 0);vn(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,p+1))}let f=!1,d=-1;if(r)for(let p=0;p<l.length;p++){let h=l[p];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=p),h.route.id){let{loaderData:m,errors:y}=r,v=h.route.loader&&!m.hasOwnProperty(h.route.id)&&(!y||y[h.route.id]===void 0);if(h.route.lazy||v){f=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((p,h,m)=>{let y,v=!1,w=null,S=null;r&&(y=c&&h.route.id?c[h.route.id]:void 0,w=h.route.errorElement||iS,f&&(d<0&&m===0?(v2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,S=null):d===m&&(v=!0,S=h.route.hydrateFallbackElement||null)));let b=n.concat(l.slice(0,m+1)),E=()=>{let A;return y?A=w:v?A=S:h.route.Component?A=Z.createElement(h.route.Component,null):h.route.element?A=h.route.element:A=p,Z.createElement(lS,{match:h,routeContext:{outlet:p,matches:b,isDataRoute:r!=null},children:A})};return r&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?Z.createElement(sS,{location:r.location,revalidation:r.revalidation,component:w,error:y,children:E(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):E()},null)}function tp(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cS(t){let n=Z.useContext(Sl);return vn(n,tp(t)),n}function fS(t){let n=Z.useContext(w0);return vn(n,tp(t)),n}function uS(t){let n=Z.useContext(Aa);return vn(n,tp(t)),n}function ep(t){let n=uS(t),r=n.matches[n.matches.length-1];return vn(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function hS(){return ep("useRouteId")}function dS(){let t=Z.useContext(Jd),n=fS("useRouteError"),r=ep("useRouteError");return t!==void 0?t:n.errors?.[r]}function pS(){let{router:t}=cS("useNavigate"),n=ep("useNavigate"),r=Z.useRef(!1);return m2(()=>{r.current=!0}),Z.useCallback(async(l,c={})=>{ua(r.current,x2),r.current&&(typeof l=="number"?t.navigate(l):await t.navigate(l,{fromRouteId:n,...c}))},[t,n])}var kg={};function v2(t,n,r){!n&&!kg[t]&&(kg[t]=!0,ua(!1,r))}Z.memo(xS);function xS({routes:t,future:n,state:r}){return y2(t,void 0,r,n)}function Fg({to:t,replace:n,state:r,relative:i}){vn(El(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=Z.useContext(ha);ua(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=Z.useContext(Aa),{pathname:f}=zi(),d=g2(),p=Qd(t,Zd(c),f,i==="path"),h=JSON.stringify(p);return Z.useEffect(()=>{d(JSON.parse(h),{replace:n,state:r,relative:i})},[d,h,i,n,r]),null}function Ni(t){vn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mS({basename:t="/",children:n=null,location:r,navigationType:i="POP",navigator:l,static:c=!1}){vn(!El(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=t.replace(/^\/*/,"/"),d=Z.useMemo(()=>({basename:f,navigator:l,static:c,future:{}}),[f,l,c]);typeof r=="string"&&(r=wl(r));let{pathname:p="/",search:h="",hash:m="",state:y=null,key:v="default"}=r,w=Z.useMemo(()=>{let S=Ja(p,f);return S==null?null:{location:{pathname:S,search:h,hash:m,state:y,key:v},navigationType:i}},[f,p,h,m,y,v,i]);return ua(w!=null,`<Router basename="${f}"> is not able to match the URL "${p}${h}${m}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:Z.createElement(ha.Provider,{value:d},Z.createElement(ec.Provider,{children:n,value:w}))}function gS({children:t,location:n}){return rS(Ad(t),n)}function Ad(t,n=[]){let r=[];return Z.Children.forEach(t,(i,l)=>{if(!Z.isValidElement(i))return;let c=[...n,l];if(i.type===Z.Fragment){r.push.apply(r,Ad(i.props.children,c));return}vn(i.type===Ni,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),vn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let f={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=Ad(i.props.children,c)),r.push(f)}),r}var Bf="get",jf="application/x-www-form-urlencoded";function S0(t){return t!=null&&typeof t.tagName=="string"}function yS(t){return S0(t)&&t.tagName.toLowerCase()==="button"}function vS(t){return S0(t)&&t.tagName.toLowerCase()==="form"}function _S(t){return S0(t)&&t.tagName.toLowerCase()==="input"}function bS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function wS(t,n){return t.button===0&&(!n||n==="_self")&&!bS(t)}var Sf=null;function SS(){if(Sf===null)try{new FormData(document.createElement("form"),0),Sf=!1}catch{Sf=!0}return Sf}var ES=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qh(t){return t!=null&&!ES.has(t)?(ua(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${jf}"`),null):t}function TS(t,n){let r,i,l,c,f;if(vS(t)){let d=t.getAttribute("action");i=d?Ja(d,n):null,r=t.getAttribute("method")||Bf,l=qh(t.getAttribute("enctype"))||jf,c=new FormData(t)}else if(yS(t)||_S(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||d.getAttribute("action");if(i=p?Ja(p,n):null,r=t.getAttribute("formmethod")||d.getAttribute("method")||Bf,l=qh(t.getAttribute("formenctype"))||qh(d.getAttribute("enctype"))||jf,c=new FormData(d,t),!SS()){let{name:h,type:m,value:y}=t;if(m==="image"){let v=h?`${h}.`:"";c.append(`${v}x`,"0"),c.append(`${v}y`,"0")}else h&&c.append(h,y)}}else{if(S0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Bf,i=null,l=jf,f=t}return c&&l==="text/plain"&&(f=c,c=void 0),{action:i,method:r.toLowerCase(),encType:l,formData:c,body:f}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function np(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function AS(t,n,r){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${r}`:n&&Ja(i.pathname,n)==="/"?i.pathname=`${n.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function DS(t,n){if(t.id in n)return n[t.id];try{let r=await import(t.module);return n[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function kS(t,n,r){let i=await Promise.all(t.map(async l=>{let c=n.routes[l.route.id];if(c){let f=await DS(c,r);return f.links?f.links():[]}return[]}));return MS(i.flat(1).filter(NS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function Cg(t,n,r,i,l,c){let f=(p,h)=>r[h]?p.route.id!==r[h].route.id:!0,d=(p,h)=>r[h].pathname!==p.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==p.params["*"];return c==="assets"?n.filter((p,h)=>f(p,h)||d(p,h)):c==="data"?n.filter((p,h)=>{let m=i.routes[p.route.id];if(!m||!m.hasLoader)return!1;if(f(p,h)||d(p,h))return!0;if(p.route.shouldRevalidate){let y=p.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function FS(t,n,{includeHydrateFallback:r}={}){return CS(t.map(i=>{let l=n.routes[i.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),r&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function CS(t){return[...new Set(t)]}function RS(t){let n={},r=Object.keys(t).sort();for(let i of r)n[i]=t[i];return n}function MS(t,n){let r=new Set;return new Set(n),t.reduce((i,l)=>{let c=JSON.stringify(RS(l));return r.has(c)||(r.add(c),i.push({key:c,link:l})),i},[])}function _2(){let t=Z.useContext(Sl);return np(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function OS(){let t=Z.useContext(w0);return np(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rp=Z.createContext(void 0);rp.displayName="FrameworkContext";function b2(){let t=Z.useContext(rp);return np(t,"You must render this element inside a <HydratedRouter> element"),t}function zS(t,n){let r=Z.useContext(rp),[i,l]=Z.useState(!1),[c,f]=Z.useState(!1),{onFocus:d,onBlur:p,onMouseEnter:h,onMouseLeave:m,onTouchStart:y}=n,v=Z.useRef(null);Z.useEffect(()=>{if(t==="render"&&f(!0),t==="viewport"){let b=A=>{A.forEach(O=>{f(O.isIntersecting)})},E=new IntersectionObserver(b,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[t]),Z.useEffect(()=>{if(i){let b=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(b)}}},[i]);let w=()=>{l(!0)},S=()=>{l(!1),f(!1)};return r?t!=="intent"?[c,v,{}]:[c,v,{onFocus:To(d,w),onBlur:To(p,S),onMouseEnter:To(h,w),onMouseLeave:To(m,S),onTouchStart:To(y,w)}]:[!1,v,{}]}function To(t,n){return r=>{t&&t(r),r.defaultPrevented||n(r)}}function LS({page:t,...n}){let{router:r}=_2(),i=Z.useMemo(()=>f2(r.routes,t,r.basename),[r.routes,t,r.basename]);return i?Z.createElement(jS,{page:t,matches:i,...n}):null}function BS(t){let{manifest:n,routeModules:r}=b2(),[i,l]=Z.useState([]);return Z.useEffect(()=>{let c=!1;return kS(t,n,r).then(f=>{c||l(f)}),()=>{c=!0}},[t,n,r]),i}function jS({page:t,matches:n,...r}){let i=zi(),{manifest:l,routeModules:c}=b2(),{basename:f}=_2(),{loaderData:d,matches:p}=OS(),h=Z.useMemo(()=>Cg(t,n,p,l,i,"data"),[t,n,p,l,i]),m=Z.useMemo(()=>Cg(t,n,p,l,i,"assets"),[t,n,p,l,i]),y=Z.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let S=new Set,b=!1;if(n.forEach(A=>{let O=l.routes[A.route.id];!O||!O.hasLoader||(!h.some(C=>C.route.id===A.route.id)&&A.route.id in d&&c[A.route.id]?.shouldRevalidate||O.hasClientLoader?b=!0:S.add(A.route.id))}),S.size===0)return[];let E=AS(t,f,"data");return b&&S.size>0&&E.searchParams.set("_routes",n.filter(A=>S.has(A.route.id)).map(A=>A.route.id).join(",")),[E.pathname+E.search]},[f,d,i,l,h,n,t,c]),v=Z.useMemo(()=>FS(m,l),[m,l]),w=BS(m);return Z.createElement(Z.Fragment,null,y.map(S=>Z.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...r})),v.map(S=>Z.createElement("link",{key:S,rel:"modulepreload",href:S,...r})),w.map(({key:S,link:b})=>Z.createElement("link",{key:S,...b})))}function IS(...t){return n=>{t.forEach(r=>{typeof r=="function"?r(n):r!=null&&(r.current=n)})}}var w2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{w2&&(window.__reactRouterVersion="7.7.1")}catch{}function US({basename:t,children:n,window:r}){let i=Z.useRef();i.current==null&&(i.current=Nw({window:r,v5Compat:!0}));let l=i.current,[c,f]=Z.useState({action:l.action,location:l.location}),d=Z.useCallback(p=>{Z.startTransition(()=>f(p))},[f]);return Z.useLayoutEffect(()=>l.listen(d),[l,d]),Z.createElement(mS,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l})}var S2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,E2=Z.forwardRef(function({onClick:n,discover:r="render",prefetch:i="none",relative:l,reloadDocument:c,replace:f,state:d,target:p,to:h,preventScrollReset:m,viewTransition:y,...v},w){let{basename:S}=Z.useContext(ha),b=typeof h=="string"&&S2.test(h),E,A=!1;if(typeof h=="string"&&b&&(E=h,w2))try{let T=new URL(window.location.href),N=h.startsWith("//")?new URL(T.protocol+h):new URL(h),D=Ja(N.pathname,S);N.origin===T.origin&&D!=null?h=D+N.search+N.hash:A=!0}catch{ua(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=eS(h,{relative:l}),[C,U,B]=zS(i,v),V=GS(h,{replace:f,state:d,target:p,preventScrollReset:m,relative:l,viewTransition:y});function k(T){n&&n(T),T.defaultPrevented||V(T)}let F=Z.createElement("a",{...v,...B,href:E||O,onClick:A||c?n:k,ref:IS(w,U),target:p,"data-discover":!b&&r==="render"?"true":void 0});return C&&!b?Z.createElement(Z.Fragment,null,F,Z.createElement(LS,{page:O})):F});E2.displayName="Link";var T2=Z.forwardRef(function({"aria-current":n="page",caseSensitive:r=!1,className:i="",end:l=!1,style:c,to:f,viewTransition:d,children:p,...h},m){let y=nc(f,{relative:h.relative}),v=zi(),w=Z.useContext(w0),{navigator:S,basename:b}=Z.useContext(ha),E=w!=null&&WS(y)&&d===!0,A=S.encodeLocation?S.encodeLocation(y).pathname:y.pathname,O=v.pathname,C=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;r||(O=O.toLowerCase(),C=C?C.toLowerCase():null,A=A.toLowerCase()),C&&b&&(C=Ja(C,b)||C);const U=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let B=O===A||!l&&O.startsWith(A)&&O.charAt(U)==="/",V=C!=null&&(C===A||!l&&C.startsWith(A)&&C.charAt(A.length)==="/"),k={isActive:B,isPending:V,isTransitioning:E},F=B?n:void 0,T;typeof i=="function"?T=i(k):T=[i,B?"active":null,V?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let N=typeof c=="function"?c(k):c;return Z.createElement(E2,{...h,"aria-current":F,className:T,ref:m,style:N,to:f,viewTransition:d},typeof p=="function"?p(k):p)});T2.displayName="NavLink";var HS=Z.forwardRef(({discover:t="render",fetcherKey:n,navigate:r,reloadDocument:i,replace:l,state:c,method:f=Bf,action:d,onSubmit:p,relative:h,preventScrollReset:m,viewTransition:y,...v},w)=>{let S=VS(),b=XS(d,{relative:h}),E=f.toLowerCase()==="get"?"get":"post",A=typeof d=="string"&&S2.test(d),O=C=>{if(p&&p(C),C.defaultPrevented)return;C.preventDefault();let U=C.nativeEvent.submitter,B=U?.getAttribute("formmethod")||f;S(U||C.currentTarget,{fetcherKey:n,method:B,navigate:r,replace:l,state:c,relative:h,preventScrollReset:m,viewTransition:y})};return Z.createElement("form",{ref:w,method:E,action:b,onSubmit:i?p:O,...v,"data-discover":!A&&t==="render"?"true":void 0})});HS.displayName="Form";function $S(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A2(t){let n=Z.useContext(Sl);return vn(n,$S(t)),n}function GS(t,{target:n,replace:r,state:i,preventScrollReset:l,relative:c,viewTransition:f}={}){let d=g2(),p=zi(),h=nc(t,{relative:c});return Z.useCallback(m=>{if(wS(m,n)){m.preventDefault();let y=r!==void 0?r:Go(p)===Go(h);d(t,{replace:y,state:i,preventScrollReset:l,relative:c,viewTransition:f})}},[p,d,h,r,i,n,t,l,c,f])}var PS=0,YS=()=>`__${String(++PS)}__`;function VS(){let{router:t}=A2("useSubmit"),{basename:n}=Z.useContext(ha),r=hS();return Z.useCallback(async(i,l={})=>{let{action:c,method:f,encType:d,formData:p,body:h}=TS(i,n);if(l.navigate===!1){let m=l.fetcherKey||YS();await t.fetch(m,r,l.action||c,{preventScrollReset:l.preventScrollReset,formData:p,body:h,formMethod:l.method||f,formEncType:l.encType||d,flushSync:l.flushSync})}else await t.navigate(l.action||c,{preventScrollReset:l.preventScrollReset,formData:p,body:h,formMethod:l.method||f,formEncType:l.encType||d,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[t,n,r])}function XS(t,{relative:n}={}){let{basename:r}=Z.useContext(ha),i=Z.useContext(Aa);vn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),c={...nc(t||".",{relative:n})},f=zi();if(t==null){c.search=f.search;let d=new URLSearchParams(c.search),p=d.getAll("index");if(p.some(m=>m==="")){d.delete("index"),p.filter(y=>y).forEach(y=>d.append("index",y));let m=d.toString();c.search=m?`?${m}`:""}}return(!t||t===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(c.pathname=c.pathname==="/"?r:qa([r,c.pathname])),Go(c)}function WS(t,{relative:n}={}){let r=Z.useContext(p2);vn(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=A2("useViewTransitionState"),l=nc(t,{relative:n});if(!r.isTransitioning)return!1;let c=Ja(r.currentLocation.pathname,i)||r.currentLocation.pathname,f=Ja(r.nextLocation.pathname,i)||r.nextLocation.pathname;return Yf(l.pathname,f)!=null||Yf(l.pathname,c)!=null}function qS(){return _.jsx("section",{className:"relative",children:_.jsxs("div",{className:"mx-auto -mt-10 max-w-50xl px-4 sm:px-6 lg:px-8 text-left",children:[_.jsxs("div",{className:"mt-8 rounded-2xl border border-zinc-200 bg-white/70 p-6 backdrop-blur sm:p-8 dark:border-zinc-800 dark:bg-zinc-900/60",children:[_.jsx("h2",{className:"font-serif text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Abstract"}),_.jsx("p",{className:"mt-3 text-lg leading-8 text-zinc-800 dark:text-zinc-200 font-serif",children:"High testosterone along with masculinized traits are often considered maladaptive for female mammals, a view largely shaped by clinical human cases of reproductive disorders and animal studies in captivity. Yet, despotic species, where masculinized females monopolize reproduction, challenge this assumption. Using 13 years of data from nearly 5'000 free-ranging female house mice, we test the fetal programming hypothesis for female masculinization. It predicts that maternal testosterone programs daughters for enhanced competitiveness and increased fitness in an environment of intensified competition. Based on assumptions of the fetal programming hypothesis, we test four predictions:"})]}),_.jsxs("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[_.jsxs("article",{className:"rounded-2xl border border-zinc-200 p-6 shadow-sm transition hover:shadow-md dark:border-zinc-800",children:[_.jsx("h3",{className:"font-serif text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Hypothesis 1"}),_.jsx("p",{className:"mt-2 text-zinc-700 dark:text-zinc-300",children:"Reproductive competition increases adult female corticosterone and testosterone"}),_.jsx("div",{className:"mt-3 border-l-2 border-emerald-400 pl-3 dark:border-emerald-500",children:_.jsx("p",{className:"font-medium  text-emerald-700 dark:text-emerald-300",children:"Observed → Testosterone and corticosterone decreased with density, when competition increased. Testosterone was highest and corticosterone lowest in winter, when breeding activity was lowest. These results oppose expectations."})})]}),_.jsxs("article",{className:"rounded-2xl border border-zinc-200 p-6 shadow-sm transition hover:shadow-md dark:border-zinc-800",children:[_.jsx("h3",{className:"font-serif text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Hypothesis 2"}),_.jsx("p",{className:"mt-2 text-zinc-700 dark:text-zinc-300",children:"Maternal exposure to reproductive competition during pregnancy increases daughter degree of masculinization."}),_.jsx("div",{className:"mt-3 border-l-2 border-emerald-400 pl-3 dark:border-emerald-500",children:_.jsx("p",{className:"font-medium text-emerald-700 dark:text-emerald-300",children:"Observed → The degree of female masculinization decreased when reproductive competition was highest: during high density and during peak breeding season in spring. These results oppose expectations."})})]}),_.jsxs("article",{className:"rounded-2xl border border-zinc-200 p-6 shadow-sm transition hover:shadow-md dark:border-zinc-800",children:[_.jsx("h3",{className:"font-serif text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Hypothesis 3"}),_.jsx("p",{className:"mt-2 text-zinc-700 dark:text-zinc-300",children:"Maternal testosterone and corticosterone during pregnancy increases daughter degree of masculinization."}),_.jsx("div",{className:"mt-3 border-l-2 border-emerald-400 pl-3 dark:border-emerald-500",children:_.jsx("p",{className:"font-medium text-emerald-700 dark:text-emerald-300",children:"Observed → Daughter degree of masculinization increased with maternal testosterone, not with corticosterone. These results align with expectations for testosterone, but oppose for corticosterone."})})]}),_.jsxs("article",{className:"rounded-2xl border border-zinc-200 p-6 shadow-sm transition hover:shadow-md dark:border-zinc-800",children:[_.jsx("h3",{className:"font-serif text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Hypothesis 4"}),_.jsx("p",{className:"mt-2 text-zinc-700 dark:text-zinc-300",children:"Masculinization enhances female fitness under high reproductive competition."}),_.jsx("div",{className:"mt-3 border-l-2 border-emerald-400 pl-3 dark:border-emerald-500",children:_.jsx("p",{className:"font-medium text-emerald-700 dark:text-emerald-300",children:"Observed → Female lifetime reproductive success increased with masculinization as density increased, likely through improved recruitment into the population. This alines with P4."})})]})]}),_.jsxs("div",{className:"mt-10 rounded-2xl border border-emerald-900/20 bg-gradient-to-r from-emerald-500/10 to-sky-500/10 p-6 sm:p-8 dark:border-emerald-400/20",children:[_.jsx("h2",{className:"font-serif text-xl font-semibold text-emerald-700 dark:text-emerald-300",children:"Conclusion"}),_.jsx("p",{className:"mt-2 text-lg leading-8 text-zinc-800 dark:text-zinc-200 font-serif",children:"The mismatch between individual fitness benefits (Hypothesis 4) and population-wide trends (Hypothesis 1 and 2) suggests that masculinization is shaped by trade-offs between maternal quality offspring demands, and ecological constraints. These findings suggest that female masculinization is not inherently maladaptive but represents a flexible strategy within – and likely across – species."})]})]})})}function KS(){return _.jsxs("main",{className:"fixed inset-x-0 top-10 bottom-0 overflow-y-auto flex flex-col items-start gap-4 p-4",children:[_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/static_1.jpg",alt:"Figure 1",className:"w-[75%] object-cover justify-self-start ml-5"}),_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/static_2.jpg",alt:"Figure 2",className:"w-[70.4%] object-cover justify-self-start ml-18 -mt-10"}),_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/static_3.jpg",alt:"Figure 3",className:"w-[75%] object-cover justify-self-start ml-6"})]})}function If(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function ZS(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function D2(t){let n,r,i;t.length!==2?(n=If,r=(d,p)=>If(t(d),p),i=(d,p)=>t(d)-p):(n=t===If||t===ZS?t:QS,r=t,i=t);function l(d,p,h=0,m=d.length){if(h<m){if(n(p,p)!==0)return m;do{const y=h+m>>>1;r(d[y],p)<0?h=y+1:m=y}while(h<m)}return h}function c(d,p,h=0,m=d.length){if(h<m){if(n(p,p)!==0)return m;do{const y=h+m>>>1;r(d[y],p)<=0?h=y+1:m=y}while(h<m)}return h}function f(d,p,h=0,m=d.length){const y=l(d,p,h,m-1);return y>h&&i(d[y-1],p)>-i(d[y],p)?y-1:y}return{left:l,center:f,right:c}}function QS(){return 0}function JS(t){return t===null?NaN:+t}const t3=D2(If),e3=t3.right;D2(JS).center;function wn(t,n){let r,i;if(n===void 0)for(const l of t)l!=null&&(r===void 0?l>=l&&(r=i=l):(r>l&&(r=l),i<l&&(i=l)));else{let l=-1;for(let c of t)(c=n(c,++l,t))!=null&&(r===void 0?c>=c&&(r=i=c):(r>c&&(r=c),i<c&&(i=c)))}return[r,i]}class Dd extends Map{constructor(n,r=a3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[i,l]of n)this.set(i,l)}get(n){return super.get(Rg(this,n))}has(n){return super.has(Rg(this,n))}set(n,r){return super.set(n3(this,n),r)}delete(n){return super.delete(r3(this,n))}}function Rg({_intern:t,_key:n},r){const i=n(r);return t.has(i)?t.get(i):r}function n3({_intern:t,_key:n},r){const i=n(r);return t.has(i)?t.get(i):(t.set(i,r),r)}function r3({_intern:t,_key:n},r){const i=n(r);return t.has(i)&&(r=t.get(i),t.delete(i)),r}function a3(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Nd(t){return t}function Ea(t,...n){return N2(t,Nd,Nd,n)}function rc(t,n,...r){return N2(t,Nd,n,r)}function N2(t,n,r,i){return function l(c,f){if(f>=i.length)return r(c);const d=new Dd,p=i[f++];let h=-1;for(const m of c){const y=p(m,++h,c),v=d.get(y);v?v.push(m):d.set(y,[m])}for(const[m,y]of d)d.set(m,l(y,f));return n(d)}(t,0)}const i3=Math.sqrt(50),s3=Math.sqrt(10),l3=Math.sqrt(2);function Vf(t,n,r){const i=(n-t)/Math.max(0,r),l=Math.floor(Math.log10(i)),c=i/Math.pow(10,l),f=c>=i3?10:c>=s3?5:c>=l3?2:1;let d,p,h;return l<0?(h=Math.pow(10,-l)/f,d=Math.round(t*h),p=Math.round(n*h),d/h<t&&++d,p/h>n&&--p,h=-h):(h=Math.pow(10,l)*f,d=Math.round(t/h),p=Math.round(n/h),d*h<t&&++d,p*h>n&&--p),p<d&&.5<=r&&r<2?Vf(t,n,r*2):[d,p,h]}function o3(t,n,r){if(n=+n,t=+t,r=+r,!(r>0))return[];if(t===n)return[t];const i=n<t,[l,c,f]=i?Vf(n,t,r):Vf(t,n,r);if(!(c>=l))return[];const d=c-l+1,p=new Array(d);if(i)if(f<0)for(let h=0;h<d;++h)p[h]=(c-h)/-f;else for(let h=0;h<d;++h)p[h]=(c-h)*f;else if(f<0)for(let h=0;h<d;++h)p[h]=(l+h)/-f;else for(let h=0;h<d;++h)p[h]=(l+h)*f;return p}function kd(t,n,r){return n=+n,t=+t,r=+r,Vf(t,n,r)[2]}function c3(t,n,r){n=+n,t=+t,r=+r;const i=n<t,l=i?kd(n,t,r):kd(t,n,r);return(i?-1:1)*(l<0?1/-l:l)}function fe(t,n){let r;if(n===void 0)for(const i of t)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let l of t)(l=n(l,++i,t))!=null&&(r<l||r===void 0&&l>=l)&&(r=l)}return r}function _e(t,n){let r;if(n===void 0)for(const i of t)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let l of t)(l=n(l,++i,t))!=null&&(r>l||r===void 0&&l>=l)&&(r=l)}return r}function Hn(t,n){let r=0,i=0;if(n===void 0)for(let l of t)l!=null&&(l=+l)>=l&&(++r,i+=l);else{let l=-1;for(let c of t)(c=n(c,++l,t))!=null&&(c=+c)>=c&&(++r,i+=c)}if(r)return i/r}function An(t,n,r){t=+t,n=+n,r=(l=arguments.length)<2?(n=t,t=0,1):l<3?1:+r;for(var i=-1,l=Math.max(0,Math.ceil((n-t)/r))|0,c=new Array(l);++i<l;)c[i]=t+i*r;return c}function Te(t,n){let r=0;for(let i of t)(i=+i)&&(r+=i);return r}function f3(t){return t}var Kh=1,Zh=2,Fd=3,Ro=4,Mg=1e-6;function u3(t){return"translate("+t+",0)"}function h3(t){return"translate(0,"+t+")"}function d3(t){return n=>+t(n)}function p3(t,n){return n=Math.max(0,t.bandwidth()-n*2)/2,t.round()&&(n=Math.round(n)),r=>+t(r)+n}function x3(){return!this.__axis}function k2(t,n){var r=[],i=null,l=null,c=6,f=6,d=3,p=typeof window<"u"&&window.devicePixelRatio>1?0:.5,h=t===Kh||t===Ro?-1:1,m=t===Ro||t===Zh?"x":"y",y=t===Kh||t===Fd?u3:h3;function v(w){var S=i??(n.ticks?n.ticks.apply(n,r):n.domain()),b=l??(n.tickFormat?n.tickFormat.apply(n,r):f3),E=Math.max(c,0)+d,A=n.range(),O=+A[0]+p,C=+A[A.length-1]+p,U=(n.bandwidth?p3:d3)(n.copy(),p),B=w.selection?w.selection():w,V=B.selectAll(".domain").data([null]),k=B.selectAll(".tick").data(S,n).order(),F=k.exit(),T=k.enter().append("g").attr("class","tick"),N=k.select("line"),D=k.select("text");V=V.merge(V.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(T),N=N.merge(T.append("line").attr("stroke","currentColor").attr(m+"2",h*c)),D=D.merge(T.append("text").attr("fill","currentColor").attr(m,h*E).attr("dy",t===Kh?"0em":t===Fd?"0.71em":"0.32em")),w!==B&&(V=V.transition(w),k=k.transition(w),N=N.transition(w),D=D.transition(w),F=F.transition(w).attr("opacity",Mg).attr("transform",function(L){return isFinite(L=U(L))?y(L+p):this.getAttribute("transform")}),T.attr("opacity",Mg).attr("transform",function(L){var K=this.parentNode.__axis;return y((K&&isFinite(K=K(L))?K:U(L))+p)})),F.remove(),V.attr("d",t===Ro||t===Zh?f?"M"+h*f+","+O+"H"+p+"V"+C+"H"+h*f:"M"+p+","+O+"V"+C:f?"M"+O+","+h*f+"V"+p+"H"+C+"V"+h*f:"M"+O+","+p+"H"+C),k.attr("opacity",1).attr("transform",function(L){return y(U(L)+p)}),N.attr(m+"2",h*c),D.attr(m,h*E).text(b),B.filter(x3).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Zh?"start":t===Ro?"end":"middle"),B.each(function(){this.__axis=U})}return v.scale=function(w){return arguments.length?(n=w,v):n},v.ticks=function(){return r=Array.from(arguments),v},v.tickArguments=function(w){return arguments.length?(r=w==null?[]:Array.from(w),v):r.slice()},v.tickValues=function(w){return arguments.length?(i=w==null?null:Array.from(w),v):i&&i.slice()},v.tickFormat=function(w){return arguments.length?(l=w,v):l},v.tickSize=function(w){return arguments.length?(c=f=+w,v):c},v.tickSizeInner=function(w){return arguments.length?(c=+w,v):c},v.tickSizeOuter=function(w){return arguments.length?(f=+w,v):f},v.tickPadding=function(w){return arguments.length?(d=+w,v):d},v.offset=function(w){return arguments.length?(p=+w,v):p},v}function Ie(t){return k2(Fd,t)}function Se(t){return k2(Ro,t)}var m3={value:()=>{}};function ap(){for(var t=0,n=arguments.length,r={},i;t<n;++t){if(!(i=arguments[t]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new Uf(r)}function Uf(t){this._=t}function g3(t,n){return t.trim().split(/^|\s+/).map(function(r){var i="",l=r.indexOf(".");if(l>=0&&(i=r.slice(l+1),r=r.slice(0,l)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}Uf.prototype=ap.prototype={constructor:Uf,on:function(t,n){var r=this._,i=g3(t+"",r),l,c=-1,f=i.length;if(arguments.length<2){for(;++c<f;)if((l=(t=i[c]).type)&&(l=y3(r[l],t.name)))return l;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++c<f;)if(l=(t=i[c]).type)r[l]=Og(r[l],t.name,n);else if(n==null)for(l in r)r[l]=Og(r[l],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new Uf(t)},call:function(t,n){if((l=arguments.length-2)>0)for(var r=new Array(l),i=0,l,c;i<l;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(c=this._[t],i=0,l=c.length;i<l;++i)c[i].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],l=0,c=i.length;l<c;++l)i[l].value.apply(n,r)}};function y3(t,n){for(var r=0,i=t.length,l;r<i;++r)if((l=t[r]).name===n)return l.value}function Og(t,n,r){for(var i=0,l=t.length;i<l;++i)if(t[i].name===n){t[i]=m3,t=t.slice(0,i).concat(t.slice(i+1));break}return r!=null&&t.push({name:n,value:r}),t}var Cd="http://www.w3.org/1999/xhtml";const zg={svg:"http://www.w3.org/2000/svg",xhtml:Cd,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function E0(t){var n=t+="",r=n.indexOf(":");return r>=0&&(n=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),zg.hasOwnProperty(n)?{space:zg[n],local:t}:t}function v3(t){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===Cd&&n.documentElement.namespaceURI===Cd?n.createElement(t):n.createElementNS(r,t)}}function _3(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function F2(t){var n=E0(t);return(n.local?_3:v3)(n)}function b3(){}function ip(t){return t==null?b3:function(){return this.querySelector(t)}}function w3(t){typeof t!="function"&&(t=ip(t));for(var n=this._groups,r=n.length,i=new Array(r),l=0;l<r;++l)for(var c=n[l],f=c.length,d=i[l]=new Array(f),p,h,m=0;m<f;++m)(p=c[m])&&(h=t.call(p,p.__data__,m,c))&&("__data__"in p&&(h.__data__=p.__data__),d[m]=h);return new jr(i,this._parents)}function S3(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function E3(){return[]}function C2(t){return t==null?E3:function(){return this.querySelectorAll(t)}}function T3(t){return function(){return S3(t.apply(this,arguments))}}function A3(t){typeof t=="function"?t=T3(t):t=C2(t);for(var n=this._groups,r=n.length,i=[],l=[],c=0;c<r;++c)for(var f=n[c],d=f.length,p,h=0;h<d;++h)(p=f[h])&&(i.push(t.call(p,p.__data__,h,f)),l.push(p));return new jr(i,l)}function R2(t){return function(){return this.matches(t)}}function M2(t){return function(n){return n.matches(t)}}var D3=Array.prototype.find;function N3(t){return function(){return D3.call(this.children,t)}}function k3(){return this.firstElementChild}function F3(t){return this.select(t==null?k3:N3(typeof t=="function"?t:M2(t)))}var C3=Array.prototype.filter;function R3(){return Array.from(this.children)}function M3(t){return function(){return C3.call(this.children,t)}}function O3(t){return this.selectAll(t==null?R3:M3(typeof t=="function"?t:M2(t)))}function z3(t){typeof t!="function"&&(t=R2(t));for(var n=this._groups,r=n.length,i=new Array(r),l=0;l<r;++l)for(var c=n[l],f=c.length,d=i[l]=[],p,h=0;h<f;++h)(p=c[h])&&t.call(p,p.__data__,h,c)&&d.push(p);return new jr(i,this._parents)}function O2(t){return new Array(t.length)}function L3(){return new jr(this._enter||this._groups.map(O2),this._parents)}function Xf(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Xf.prototype={constructor:Xf,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function B3(t){return function(){return t}}function j3(t,n,r,i,l,c){for(var f=0,d,p=n.length,h=c.length;f<h;++f)(d=n[f])?(d.__data__=c[f],i[f]=d):r[f]=new Xf(t,c[f]);for(;f<p;++f)(d=n[f])&&(l[f]=d)}function I3(t,n,r,i,l,c,f){var d,p,h=new Map,m=n.length,y=c.length,v=new Array(m),w;for(d=0;d<m;++d)(p=n[d])&&(v[d]=w=f.call(p,p.__data__,d,n)+"",h.has(w)?l[d]=p:h.set(w,p));for(d=0;d<y;++d)w=f.call(t,c[d],d,c)+"",(p=h.get(w))?(i[d]=p,p.__data__=c[d],h.delete(w)):r[d]=new Xf(t,c[d]);for(d=0;d<m;++d)(p=n[d])&&h.get(v[d])===p&&(l[d]=p)}function U3(t){return t.__data__}function H3(t,n){if(!arguments.length)return Array.from(this,U3);var r=n?I3:j3,i=this._parents,l=this._groups;typeof t!="function"&&(t=B3(t));for(var c=l.length,f=new Array(c),d=new Array(c),p=new Array(c),h=0;h<c;++h){var m=i[h],y=l[h],v=y.length,w=$3(t.call(m,m&&m.__data__,h,i)),S=w.length,b=d[h]=new Array(S),E=f[h]=new Array(S),A=p[h]=new Array(v);r(m,y,b,E,A,w,n);for(var O=0,C=0,U,B;O<S;++O)if(U=b[O]){for(O>=C&&(C=O+1);!(B=E[C])&&++C<S;);U._next=B||null}}return f=new jr(f,i),f._enter=d,f._exit=p,f}function $3(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function G3(){return new jr(this._exit||this._groups.map(O2),this._parents)}function P3(t,n,r){var i=this.enter(),l=this,c=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),n!=null&&(l=n(l),l&&(l=l.selection())),r==null?c.remove():r(c),i&&l?i.merge(l).order():l}function Y3(t){for(var n=t.selection?t.selection():t,r=this._groups,i=n._groups,l=r.length,c=i.length,f=Math.min(l,c),d=new Array(l),p=0;p<f;++p)for(var h=r[p],m=i[p],y=h.length,v=d[p]=new Array(y),w,S=0;S<y;++S)(w=h[S]||m[S])&&(v[S]=w);for(;p<l;++p)d[p]=r[p];return new jr(d,this._parents)}function V3(){for(var t=this._groups,n=-1,r=t.length;++n<r;)for(var i=t[n],l=i.length-1,c=i[l],f;--l>=0;)(f=i[l])&&(c&&f.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(f,c),c=f);return this}function X3(t){t||(t=W3);function n(y,v){return y&&v?t(y.__data__,v.__data__):!y-!v}for(var r=this._groups,i=r.length,l=new Array(i),c=0;c<i;++c){for(var f=r[c],d=f.length,p=l[c]=new Array(d),h,m=0;m<d;++m)(h=f[m])&&(p[m]=h);p.sort(n)}return new jr(l,this._parents).order()}function W3(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function q3(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function K3(){return Array.from(this)}function Z3(){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],l=0,c=i.length;l<c;++l){var f=i[l];if(f)return f}return null}function Q3(){let t=0;for(const n of this)++t;return t}function J3(){return!this.node()}function tE(t){for(var n=this._groups,r=0,i=n.length;r<i;++r)for(var l=n[r],c=0,f=l.length,d;c<f;++c)(d=l[c])&&t.call(d,d.__data__,c,l);return this}function eE(t){return function(){this.removeAttribute(t)}}function nE(t){return function(){this.removeAttributeNS(t.space,t.local)}}function rE(t,n){return function(){this.setAttribute(t,n)}}function aE(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function iE(t,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function sE(t,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function lE(t,n){var r=E0(t);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((n==null?r.local?nE:eE:typeof n=="function"?r.local?sE:iE:r.local?aE:rE)(r,n))}function z2(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function oE(t){return function(){this.style.removeProperty(t)}}function cE(t,n,r){return function(){this.style.setProperty(t,n,r)}}function fE(t,n,r){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,r)}}function uE(t,n,r){return arguments.length>1?this.each((n==null?oE:typeof n=="function"?fE:cE)(t,n,r??"")):ml(this.node(),t)}function ml(t,n){return t.style.getPropertyValue(n)||z2(t).getComputedStyle(t,null).getPropertyValue(n)}function hE(t){return function(){delete this[t]}}function dE(t,n){return function(){this[t]=n}}function pE(t,n){return function(){var r=n.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function xE(t,n){return arguments.length>1?this.each((n==null?hE:typeof n=="function"?pE:dE)(t,n)):this.node()[t]}function L2(t){return t.trim().split(/^|\s+/)}function sp(t){return t.classList||new B2(t)}function B2(t){this._node=t,this._names=L2(t.getAttribute("class")||"")}B2.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function j2(t,n){for(var r=sp(t),i=-1,l=n.length;++i<l;)r.add(n[i])}function I2(t,n){for(var r=sp(t),i=-1,l=n.length;++i<l;)r.remove(n[i])}function mE(t){return function(){j2(this,t)}}function gE(t){return function(){I2(this,t)}}function yE(t,n){return function(){(n.apply(this,arguments)?j2:I2)(this,t)}}function vE(t,n){var r=L2(t+"");if(arguments.length<2){for(var i=sp(this.node()),l=-1,c=r.length;++l<c;)if(!i.contains(r[l]))return!1;return!0}return this.each((typeof n=="function"?yE:n?mE:gE)(r,n))}function _E(){this.textContent=""}function bE(t){return function(){this.textContent=t}}function wE(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function SE(t){return arguments.length?this.each(t==null?_E:(typeof t=="function"?wE:bE)(t)):this.node().textContent}function EE(){this.innerHTML=""}function TE(t){return function(){this.innerHTML=t}}function AE(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function DE(t){return arguments.length?this.each(t==null?EE:(typeof t=="function"?AE:TE)(t)):this.node().innerHTML}function NE(){this.nextSibling&&this.parentNode.appendChild(this)}function kE(){return this.each(NE)}function FE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function CE(){return this.each(FE)}function RE(t){var n=typeof t=="function"?t:F2(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function ME(){return null}function OE(t,n){var r=typeof t=="function"?t:F2(t),i=n==null?ME:typeof n=="function"?n:ip(n);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function zE(){var t=this.parentNode;t&&t.removeChild(this)}function LE(){return this.each(zE)}function BE(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function jE(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function IE(t){return this.select(t?jE:BE)}function UE(t){return arguments.length?this.property("__data__",t):this.node().__data__}function HE(t){return function(n){t.call(this,n,this.__data__)}}function $E(t){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");return i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),{type:n,name:r}})}function GE(t){return function(){var n=this.__on;if(n){for(var r=0,i=-1,l=n.length,c;r<l;++r)c=n[r],(!t.type||c.type===t.type)&&c.name===t.name?this.removeEventListener(c.type,c.listener,c.options):n[++i]=c;++i?n.length=i:delete this.__on}}}function PE(t,n,r){return function(){var i=this.__on,l,c=HE(n);if(i){for(var f=0,d=i.length;f<d;++f)if((l=i[f]).type===t.type&&l.name===t.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=c,l.options=r),l.value=n;return}}this.addEventListener(t.type,c,r),l={type:t.type,name:t.name,value:n,listener:c,options:r},i?i.push(l):this.__on=[l]}}function YE(t,n,r){var i=$E(t+""),l,c=i.length,f;if(arguments.length<2){var d=this.node().__on;if(d){for(var p=0,h=d.length,m;p<h;++p)for(l=0,m=d[p];l<c;++l)if((f=i[l]).type===m.type&&f.name===m.name)return m.value}return}for(d=n?PE:GE,l=0;l<c;++l)this.each(d(i[l],n,r));return this}function U2(t,n,r){var i=z2(t),l=i.CustomEvent;typeof l=="function"?l=new l(n,r):(l=i.document.createEvent("Event"),r?(l.initEvent(n,r.bubbles,r.cancelable),l.detail=r.detail):l.initEvent(n,!1,!1)),t.dispatchEvent(l)}function VE(t,n){return function(){return U2(this,t,n)}}function XE(t,n){return function(){return U2(this,t,n.apply(this,arguments))}}function WE(t,n){return this.each((typeof n=="function"?XE:VE)(t,n))}function*qE(){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],l=0,c=i.length,f;l<c;++l)(f=i[l])&&(yield f)}var H2=[null];function jr(t,n){this._groups=t,this._parents=n}function ac(){return new jr([[document.documentElement]],H2)}function KE(){return this}jr.prototype=ac.prototype={constructor:jr,select:w3,selectAll:A3,selectChild:F3,selectChildren:O3,filter:z3,data:H3,enter:L3,exit:G3,join:P3,merge:Y3,selection:KE,order:V3,sort:X3,call:q3,nodes:K3,node:Z3,size:Q3,empty:J3,each:tE,attr:lE,style:uE,property:xE,classed:vE,text:SE,html:DE,raise:kE,lower:CE,append:RE,insert:OE,remove:LE,clone:IE,datum:UE,on:YE,dispatch:WE,[Symbol.iterator]:qE};function Ft(t){return typeof t=="string"?new jr([[document.querySelector(t)]],[document.documentElement]):new jr([[t]],H2)}function ZE(t){let n;for(;n=t.sourceEvent;)t=n;return t}function nn(t,n){if(t=ZE(t),n===void 0&&(n=t.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var l=n.getBoundingClientRect();return[t.clientX-l.left-n.clientLeft,t.clientY-l.top-n.clientTop]}}return[t.pageX,t.pageY]}const Rd={capture:!0,passive:!1};function Md(t){t.preventDefault(),t.stopImmediatePropagation()}function QE(t){var n=t.document.documentElement,r=Ft(t).on("dragstart.drag",Md,Rd);"onselectstart"in n?r.on("selectstart.drag",Md,Rd):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function JE(t,n){var r=t.document.documentElement,i=Ft(t).on("dragstart.drag",null);n&&(i.on("click.drag",Md,Rd),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}function ic(t,n,r){t.prototype=n.prototype=r,r.constructor=t}function T0(t,n){var r=Object.create(t.prototype);for(var i in n)r[i]=n[i];return r}function hs(){}var Po=.7,Wf=1/Po,fl="\\s*([+-]?\\d+)\\s*",Yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tT=/^#([0-9a-f]{3,8})$/,eT=new RegExp(`^rgb\\(${fl},${fl},${fl}\\)$`),nT=new RegExp(`^rgb\\(${wa},${wa},${wa}\\)$`),rT=new RegExp(`^rgba\\(${fl},${fl},${fl},${Yo}\\)$`),aT=new RegExp(`^rgba\\(${wa},${wa},${wa},${Yo}\\)$`),iT=new RegExp(`^hsl\\(${Yo},${wa},${wa}\\)$`),sT=new RegExp(`^hsla\\(${Yo},${wa},${wa},${Yo}\\)$`),Lg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ic(hs,is,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Bg,formatHex:Bg,formatHex8:lT,formatHsl:oT,formatRgb:jg,toString:jg});function Bg(){return this.rgb().formatHex()}function lT(){return this.rgb().formatHex8()}function oT(){return G2(this).formatHsl()}function jg(){return this.rgb().formatRgb()}function is(t){var n,r;return t=(t+"").trim().toLowerCase(),(n=tT.exec(t))?(r=n[1].length,n=parseInt(n[1],16),r===6?Ig(n):r===3?new fr(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?Ef(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?Ef(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=eT.exec(t))?new fr(n[1],n[2],n[3],1):(n=nT.exec(t))?new fr(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=rT.exec(t))?Ef(n[1],n[2],n[3],n[4]):(n=aT.exec(t))?Ef(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=iT.exec(t))?$g(n[1],n[2]/100,n[3]/100,1):(n=sT.exec(t))?$g(n[1],n[2]/100,n[3]/100,n[4]):Lg.hasOwnProperty(t)?Ig(Lg[t]):t==="transparent"?new fr(NaN,NaN,NaN,0):null}function Ig(t){return new fr(t>>16&255,t>>8&255,t&255,1)}function Ef(t,n,r,i){return i<=0&&(t=n=r=NaN),new fr(t,n,r,i)}function $2(t){return t instanceof hs||(t=is(t)),t?(t=t.rgb(),new fr(t.r,t.g,t.b,t.opacity)):new fr}function Od(t,n,r,i){return arguments.length===1?$2(t):new fr(t,n,r,i??1)}function fr(t,n,r,i){this.r=+t,this.g=+n,this.b=+r,this.opacity=+i}ic(fr,Od,T0(hs,{brighter(t){return t=t==null?Wf:Math.pow(Wf,t),new fr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Po:Math.pow(Po,t),new fr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new fr(rs(this.r),rs(this.g),rs(this.b),qf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ug,formatHex:Ug,formatHex8:cT,formatRgb:Hg,toString:Hg}));function Ug(){return`#${ns(this.r)}${ns(this.g)}${ns(this.b)}`}function cT(){return`#${ns(this.r)}${ns(this.g)}${ns(this.b)}${ns((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hg(){const t=qf(this.opacity);return`${t===1?"rgb(":"rgba("}${rs(this.r)}, ${rs(this.g)}, ${rs(this.b)}${t===1?")":`, ${t})`}`}function qf(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function rs(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ns(t){return t=rs(t),(t<16?"0":"")+t.toString(16)}function $g(t,n,r,i){return i<=0?t=n=r=NaN:r<=0||r>=1?t=n=NaN:n<=0&&(t=NaN),new la(t,n,r,i)}function G2(t){if(t instanceof la)return new la(t.h,t.s,t.l,t.opacity);if(t instanceof hs||(t=is(t)),!t)return new la;if(t instanceof la)return t;t=t.rgb();var n=t.r/255,r=t.g/255,i=t.b/255,l=Math.min(n,r,i),c=Math.max(n,r,i),f=NaN,d=c-l,p=(c+l)/2;return d?(n===c?f=(r-i)/d+(r<i)*6:r===c?f=(i-n)/d+2:f=(n-r)/d+4,d/=p<.5?c+l:2-c-l,f*=60):d=p>0&&p<1?0:f,new la(f,d,p,t.opacity)}function fT(t,n,r,i){return arguments.length===1?G2(t):new la(t,n,r,i??1)}function la(t,n,r,i){this.h=+t,this.s=+n,this.l=+r,this.opacity=+i}ic(la,fT,T0(hs,{brighter(t){return t=t==null?Wf:Math.pow(Wf,t),new la(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Po:Math.pow(Po,t),new la(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,l=2*r-i;return new fr(Qh(t>=240?t-240:t+120,l,i),Qh(t,l,i),Qh(t<120?t+240:t-120,l,i),this.opacity)},clamp(){return new la(Gg(this.h),Tf(this.s),Tf(this.l),qf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=qf(this.opacity);return`${t===1?"hsl(":"hsla("}${Gg(this.h)}, ${Tf(this.s)*100}%, ${Tf(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Gg(t){return t=(t||0)%360,t<0?t+360:t}function Tf(t){return Math.max(0,Math.min(1,t||0))}function Qh(t,n,r){return(t<60?n+(r-n)*t/60:t<180?r:t<240?n+(r-n)*(240-t)/60:n)*255}const uT=Math.PI/180,hT=180/Math.PI,Kf=18,P2=.96422,Y2=1,V2=.82521,X2=4/29,ul=6/29,W2=3*ul*ul,dT=ul*ul*ul;function q2(t){if(t instanceof Sa)return new Sa(t.l,t.a,t.b,t.opacity);if(t instanceof Wa)return K2(t);t instanceof fr||(t=$2(t));var n=nd(t.r),r=nd(t.g),i=nd(t.b),l=Jh((.2225045*n+.7168786*r+.0606169*i)/Y2),c,f;return n===r&&r===i?c=f=l:(c=Jh((.4360747*n+.3850649*r+.1430804*i)/P2),f=Jh((.0139322*n+.0971045*r+.7141733*i)/V2)),new Sa(116*l-16,500*(c-l),200*(l-f),t.opacity)}function zd(t,n,r,i){return arguments.length===1?q2(t):new Sa(t,n,r,i??1)}function Sa(t,n,r,i){this.l=+t,this.a=+n,this.b=+r,this.opacity=+i}ic(Sa,zd,T0(hs,{brighter(t){return new Sa(this.l+Kf*(t??1),this.a,this.b,this.opacity)},darker(t){return new Sa(this.l-Kf*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,r=isNaN(this.b)?t:t-this.b/200;return n=P2*td(n),t=Y2*td(t),r=V2*td(r),new fr(ed(3.1338561*n-1.6168667*t-.4906146*r),ed(-.9787684*n+1.9161415*t+.033454*r),ed(.0719453*n-.2289914*t+1.4052427*r),this.opacity)}}));function Jh(t){return t>dT?Math.pow(t,1/3):t/W2+X2}function td(t){return t>ul?t*t*t:W2*(t-X2)}function ed(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function nd(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pT(t){if(t instanceof Wa)return new Wa(t.h,t.c,t.l,t.opacity);if(t instanceof Sa||(t=q2(t)),t.a===0&&t.b===0)return new Wa(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*hT;return new Wa(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function xT(t,n,r,i){return arguments.length===1?pT(t):new Wa(t,n,r,i??1)}function Wa(t,n,r,i){this.h=+t,this.c=+n,this.l=+r,this.opacity=+i}function K2(t){if(isNaN(t.h))return new Sa(t.l,0,0,t.opacity);var n=t.h*uT;return new Sa(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}ic(Wa,xT,T0(hs,{brighter(t){return new Wa(this.h,this.c,this.l+Kf*(t??1),this.opacity)},darker(t){return new Wa(this.h,this.c,this.l-Kf*(t??1),this.opacity)},rgb(){return K2(this).rgb()}}));const lp=t=>()=>t;function mT(t,n){return function(r){return t+r*n}}function gT(t,n,r){return t=Math.pow(t,r),n=Math.pow(n,r)-t,r=1/r,function(i){return Math.pow(t+i*n,r)}}function yT(t){return(t=+t)==1?ol:function(n,r){return r-n?gT(n,r,t):lp(isNaN(n)?r:n)}}function ol(t,n){var r=n-t;return r?mT(t,r):lp(isNaN(t)?n:t)}const Zf=function t(n){var r=yT(n);function i(l,c){var f=r((l=Od(l)).r,(c=Od(c)).r),d=r(l.g,c.g),p=r(l.b,c.b),h=ol(l.opacity,c.opacity);return function(m){return l.r=f(m),l.g=d(m),l.b=p(m),l.opacity=h(m),l+""}}return i.gamma=t,i}(1);function vT(t,n){n||(n=[]);var r=t?Math.min(n.length,t.length):0,i=n.slice(),l;return function(c){for(l=0;l<r;++l)i[l]=t[l]*(1-c)+n[l]*c;return i}}function _T(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function bT(t,n){var r=n?n.length:0,i=t?Math.min(r,t.length):0,l=new Array(i),c=new Array(r),f;for(f=0;f<i;++f)l[f]=sc(t[f],n[f]);for(;f<r;++f)c[f]=n[f];return function(d){for(f=0;f<i;++f)c[f]=l[f](d);return c}}function wT(t,n){var r=new Date;return t=+t,n=+n,function(i){return r.setTime(t*(1-i)+n*i),r}}function sa(t,n){return t=+t,n=+n,function(r){return t*(1-r)+n*r}}function ST(t,n){var r={},i={},l;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(l in n)l in t?r[l]=sc(t[l],n[l]):i[l]=n[l];return function(c){for(l in r)i[l]=r[l](c);return i}}var Ld=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rd=new RegExp(Ld.source,"g");function ET(t){return function(){return t}}function TT(t){return function(n){return t(n)+""}}function Z2(t,n){var r=Ld.lastIndex=rd.lastIndex=0,i,l,c,f=-1,d=[],p=[];for(t=t+"",n=n+"";(i=Ld.exec(t))&&(l=rd.exec(n));)(c=l.index)>r&&(c=n.slice(r,c),d[f]?d[f]+=c:d[++f]=c),(i=i[0])===(l=l[0])?d[f]?d[f]+=l:d[++f]=l:(d[++f]=null,p.push({i:f,x:sa(i,l)})),r=rd.lastIndex;return r<n.length&&(c=n.slice(r),d[f]?d[f]+=c:d[++f]=c),d.length<2?p[0]?TT(p[0].x):ET(n):(n=p.length,function(h){for(var m=0,y;m<n;++m)d[(y=p[m]).i]=y.x(h);return d.join("")})}function sc(t,n){var r=typeof n,i;return n==null||r==="boolean"?lp(n):(r==="number"?sa:r==="string"?(i=is(n))?(n=i,Zf):Z2:n instanceof is?Zf:n instanceof Date?wT:_T(n)?vT:Array.isArray(n)?bT:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?ST:sa)(t,n)}function Q2(t,n){return t=+t,n=+n,function(r){return Math.round(t*(1-r)+n*r)}}var Pg=180/Math.PI,Bd={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function J2(t,n,r,i,l,c){var f,d,p;return(f=Math.sqrt(t*t+n*n))&&(t/=f,n/=f),(p=t*r+n*i)&&(r-=t*p,i-=n*p),(d=Math.sqrt(r*r+i*i))&&(r/=d,i/=d,p/=d),t*i<n*r&&(t=-t,n=-n,p=-p,f=-f),{translateX:l,translateY:c,rotate:Math.atan2(n,t)*Pg,skewX:Math.atan(p)*Pg,scaleX:f,scaleY:d}}var Af;function AT(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Bd:J2(n.a,n.b,n.c,n.d,n.e,n.f)}function DT(t){return t==null||(Af||(Af=document.createElementNS("http://www.w3.org/2000/svg","g")),Af.setAttribute("transform",t),!(t=Af.transform.baseVal.consolidate()))?Bd:(t=t.matrix,J2(t.a,t.b,t.c,t.d,t.e,t.f))}function tv(t,n,r,i){function l(h){return h.length?h.pop()+" ":""}function c(h,m,y,v,w,S){if(h!==y||m!==v){var b=w.push("translate(",null,n,null,r);S.push({i:b-4,x:sa(h,y)},{i:b-2,x:sa(m,v)})}else(y||v)&&w.push("translate("+y+n+v+r)}function f(h,m,y,v){h!==m?(h-m>180?m+=360:m-h>180&&(h+=360),v.push({i:y.push(l(y)+"rotate(",null,i)-2,x:sa(h,m)})):m&&y.push(l(y)+"rotate("+m+i)}function d(h,m,y,v){h!==m?v.push({i:y.push(l(y)+"skewX(",null,i)-2,x:sa(h,m)}):m&&y.push(l(y)+"skewX("+m+i)}function p(h,m,y,v,w,S){if(h!==y||m!==v){var b=w.push(l(w)+"scale(",null,",",null,")");S.push({i:b-4,x:sa(h,y)},{i:b-2,x:sa(m,v)})}else(y!==1||v!==1)&&w.push(l(w)+"scale("+y+","+v+")")}return function(h,m){var y=[],v=[];return h=t(h),m=t(m),c(h.translateX,h.translateY,m.translateX,m.translateY,y,v),f(h.rotate,m.rotate,y,v),d(h.skewX,m.skewX,y,v),p(h.scaleX,h.scaleY,m.scaleX,m.scaleY,y,v),h=m=null,function(w){for(var S=-1,b=v.length,E;++S<b;)y[(E=v[S]).i]=E.x(w);return y.join("")}}}var NT=tv(AT,"px, ","px)","deg)"),kT=tv(DT,", ",")",")");function Tl(t,n){var r=ol((t=zd(t)).l,(n=zd(n)).l),i=ol(t.a,n.a),l=ol(t.b,n.b),c=ol(t.opacity,n.opacity);return function(f){return t.l=r(f),t.a=i(f),t.b=l(f),t.opacity=c(f),t+""}}var gl=0,Mo=0,Ao=0,ev=1e3,Qf,Oo,Jf=0,ss=0,A0=0,Vo=typeof performance=="object"&&performance.now?performance:Date,nv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function op(){return ss||(nv(FT),ss=Vo.now()+A0)}function FT(){ss=0}function t0(){this._call=this._time=this._next=null}t0.prototype=rv.prototype={constructor:t0,restart:function(t,n,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?op():+r)+(n==null?0:+n),!this._next&&Oo!==this&&(Oo?Oo._next=this:Qf=this,Oo=this),this._call=t,this._time=r,jd()},stop:function(){this._call&&(this._call=null,this._time=1/0,jd())}};function rv(t,n,r){var i=new t0;return i.restart(t,n,r),i}function CT(){op(),++gl;for(var t=Qf,n;t;)(n=ss-t._time)>=0&&t._call.call(void 0,n),t=t._next;--gl}function Yg(){ss=(Jf=Vo.now())+A0,gl=Mo=0;try{CT()}finally{gl=0,MT(),ss=0}}function RT(){var t=Vo.now(),n=t-Jf;n>ev&&(A0-=n,Jf=t)}function MT(){for(var t,n=Qf,r,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(r=n._next,n._next=null,n=t?t._next=r:Qf=r);Oo=t,jd(i)}function jd(t){if(!gl){Mo&&(Mo=clearTimeout(Mo));var n=t-ss;n>24?(t<1/0&&(Mo=setTimeout(Yg,t-Vo.now()-A0)),Ao&&(Ao=clearInterval(Ao))):(Ao||(Jf=Vo.now(),Ao=setInterval(RT,ev)),gl=1,nv(Yg))}}function Vg(t,n,r){var i=new t0;return n=n==null?0:+n,i.restart(l=>{i.stop(),t(l+n)},n,r),i}var OT=ap("start","end","cancel","interrupt"),zT=[],av=0,Xg=1,Id=2,Hf=3,Wg=4,Ud=5,$f=6;function D0(t,n,r,i,l,c){var f=t.__transition;if(!f)t.__transition={};else if(r in f)return;LT(t,r,{name:n,index:i,group:l,on:OT,tween:zT,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:av})}function cp(t,n){var r=da(t,n);if(r.state>av)throw new Error("too late; already scheduled");return r}function Da(t,n){var r=da(t,n);if(r.state>Hf)throw new Error("too late; already running");return r}function da(t,n){var r=t.__transition;if(!r||!(r=r[n]))throw new Error("transition not found");return r}function LT(t,n,r){var i=t.__transition,l;i[n]=r,r.timer=rv(c,0,r.time);function c(h){r.state=Xg,r.timer.restart(f,r.delay,r.time),r.delay<=h&&f(h-r.delay)}function f(h){var m,y,v,w;if(r.state!==Xg)return p();for(m in i)if(w=i[m],w.name===r.name){if(w.state===Hf)return Vg(f);w.state===Wg?(w.state=$f,w.timer.stop(),w.on.call("interrupt",t,t.__data__,w.index,w.group),delete i[m]):+m<n&&(w.state=$f,w.timer.stop(),w.on.call("cancel",t,t.__data__,w.index,w.group),delete i[m])}if(Vg(function(){r.state===Hf&&(r.state=Wg,r.timer.restart(d,r.delay,r.time),d(h))}),r.state=Id,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Id){for(r.state=Hf,l=new Array(v=r.tween.length),m=0,y=-1;m<v;++m)(w=r.tween[m].value.call(t,t.__data__,r.index,r.group))&&(l[++y]=w);l.length=y+1}}function d(h){for(var m=h<r.duration?r.ease.call(null,h/r.duration):(r.timer.restart(p),r.state=Ud,1),y=-1,v=l.length;++y<v;)l[y].call(t,m);r.state===Ud&&(r.on.call("end",t,t.__data__,r.index,r.group),p())}function p(){r.state=$f,r.timer.stop(),delete i[n];for(var h in i)return;delete t.__transition}}function Hd(t,n){var r=t.__transition,i,l,c=!0,f;if(r){n=n==null?null:n+"";for(f in r){if((i=r[f]).name!==n){c=!1;continue}l=i.state>Id&&i.state<Ud,i.state=$f,i.timer.stop(),i.on.call(l?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete r[f]}c&&delete t.__transition}}function BT(t){return this.each(function(){Hd(this,t)})}function jT(t,n){var r,i;return function(){var l=Da(this,t),c=l.tween;if(c!==r){i=r=c;for(var f=0,d=i.length;f<d;++f)if(i[f].name===n){i=i.slice(),i.splice(f,1);break}}l.tween=i}}function IT(t,n,r){var i,l;if(typeof r!="function")throw new Error;return function(){var c=Da(this,t),f=c.tween;if(f!==i){l=(i=f).slice();for(var d={name:n,value:r},p=0,h=l.length;p<h;++p)if(l[p].name===n){l[p]=d;break}p===h&&l.push(d)}c.tween=l}}function UT(t,n){var r=this._id;if(t+="",arguments.length<2){for(var i=da(this.node(),r).tween,l=0,c=i.length,f;l<c;++l)if((f=i[l]).name===t)return f.value;return null}return this.each((n==null?jT:IT)(r,t,n))}function fp(t,n,r){var i=t._id;return t.each(function(){var l=Da(this,i);(l.value||(l.value={}))[n]=r.apply(this,arguments)}),function(l){return da(l,i).value[n]}}function iv(t,n){var r;return(typeof n=="number"?sa:n instanceof is?Zf:(r=is(n))?(n=r,Zf):Z2)(t,n)}function HT(t){return function(){this.removeAttribute(t)}}function $T(t){return function(){this.removeAttributeNS(t.space,t.local)}}function GT(t,n,r){var i,l=r+"",c;return function(){var f=this.getAttribute(t);return f===l?null:f===i?c:c=n(i=f,r)}}function PT(t,n,r){var i,l=r+"",c;return function(){var f=this.getAttributeNS(t.space,t.local);return f===l?null:f===i?c:c=n(i=f,r)}}function YT(t,n,r){var i,l,c;return function(){var f,d=r(this),p;return d==null?void this.removeAttribute(t):(f=this.getAttribute(t),p=d+"",f===p?null:f===i&&p===l?c:(l=p,c=n(i=f,d)))}}function VT(t,n,r){var i,l,c;return function(){var f,d=r(this),p;return d==null?void this.removeAttributeNS(t.space,t.local):(f=this.getAttributeNS(t.space,t.local),p=d+"",f===p?null:f===i&&p===l?c:(l=p,c=n(i=f,d)))}}function XT(t,n){var r=E0(t),i=r==="transform"?kT:iv;return this.attrTween(t,typeof n=="function"?(r.local?VT:YT)(r,i,fp(this,"attr."+t,n)):n==null?(r.local?$T:HT)(r):(r.local?PT:GT)(r,i,n))}function WT(t,n){return function(r){this.setAttribute(t,n.call(this,r))}}function qT(t,n){return function(r){this.setAttributeNS(t.space,t.local,n.call(this,r))}}function KT(t,n){var r,i;function l(){var c=n.apply(this,arguments);return c!==i&&(r=(i=c)&&qT(t,c)),r}return l._value=n,l}function ZT(t,n){var r,i;function l(){var c=n.apply(this,arguments);return c!==i&&(r=(i=c)&&WT(t,c)),r}return l._value=n,l}function QT(t,n){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;var i=E0(t);return this.tween(r,(i.local?KT:ZT)(i,n))}function JT(t,n){return function(){cp(this,t).delay=+n.apply(this,arguments)}}function tA(t,n){return n=+n,function(){cp(this,t).delay=n}}function eA(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?JT:tA)(n,t)):da(this.node(),n).delay}function nA(t,n){return function(){Da(this,t).duration=+n.apply(this,arguments)}}function rA(t,n){return n=+n,function(){Da(this,t).duration=n}}function aA(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?nA:rA)(n,t)):da(this.node(),n).duration}function iA(t,n){if(typeof n!="function")throw new Error;return function(){Da(this,t).ease=n}}function sA(t){var n=this._id;return arguments.length?this.each(iA(n,t)):da(this.node(),n).ease}function lA(t,n){return function(){var r=n.apply(this,arguments);if(typeof r!="function")throw new Error;Da(this,t).ease=r}}function oA(t){if(typeof t!="function")throw new Error;return this.each(lA(this._id,t))}function cA(t){typeof t!="function"&&(t=R2(t));for(var n=this._groups,r=n.length,i=new Array(r),l=0;l<r;++l)for(var c=n[l],f=c.length,d=i[l]=[],p,h=0;h<f;++h)(p=c[h])&&t.call(p,p.__data__,h,c)&&d.push(p);return new ti(i,this._parents,this._name,this._id)}function fA(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,r=t._groups,i=n.length,l=r.length,c=Math.min(i,l),f=new Array(i),d=0;d<c;++d)for(var p=n[d],h=r[d],m=p.length,y=f[d]=new Array(m),v,w=0;w<m;++w)(v=p[w]||h[w])&&(y[w]=v);for(;d<i;++d)f[d]=n[d];return new ti(f,this._parents,this._name,this._id)}function uA(t){return(t+"").trim().split(/^|\s+/).every(function(n){var r=n.indexOf(".");return r>=0&&(n=n.slice(0,r)),!n||n==="start"})}function hA(t,n,r){var i,l,c=uA(n)?cp:Da;return function(){var f=c(this,t),d=f.on;d!==i&&(l=(i=d).copy()).on(n,r),f.on=l}}function dA(t,n){var r=this._id;return arguments.length<2?da(this.node(),r).on.on(t):this.each(hA(r,t,n))}function pA(t){return function(){var n=this.parentNode;for(var r in this.__transition)if(+r!==t)return;n&&n.removeChild(this)}}function xA(){return this.on("end.remove",pA(this._id))}function mA(t){var n=this._name,r=this._id;typeof t!="function"&&(t=ip(t));for(var i=this._groups,l=i.length,c=new Array(l),f=0;f<l;++f)for(var d=i[f],p=d.length,h=c[f]=new Array(p),m,y,v=0;v<p;++v)(m=d[v])&&(y=t.call(m,m.__data__,v,d))&&("__data__"in m&&(y.__data__=m.__data__),h[v]=y,D0(h[v],n,r,v,h,da(m,r)));return new ti(c,this._parents,n,r)}function gA(t){var n=this._name,r=this._id;typeof t!="function"&&(t=C2(t));for(var i=this._groups,l=i.length,c=[],f=[],d=0;d<l;++d)for(var p=i[d],h=p.length,m,y=0;y<h;++y)if(m=p[y]){for(var v=t.call(m,m.__data__,y,p),w,S=da(m,r),b=0,E=v.length;b<E;++b)(w=v[b])&&D0(w,n,r,b,v,S);c.push(v),f.push(m)}return new ti(c,f,n,r)}var yA=ac.prototype.constructor;function vA(){return new yA(this._groups,this._parents)}function _A(t,n){var r,i,l;return function(){var c=ml(this,t),f=(this.style.removeProperty(t),ml(this,t));return c===f?null:c===r&&f===i?l:l=n(r=c,i=f)}}function sv(t){return function(){this.style.removeProperty(t)}}function bA(t,n,r){var i,l=r+"",c;return function(){var f=ml(this,t);return f===l?null:f===i?c:c=n(i=f,r)}}function wA(t,n,r){var i,l,c;return function(){var f=ml(this,t),d=r(this),p=d+"";return d==null&&(p=d=(this.style.removeProperty(t),ml(this,t))),f===p?null:f===i&&p===l?c:(l=p,c=n(i=f,d))}}function SA(t,n){var r,i,l,c="style."+n,f="end."+c,d;return function(){var p=Da(this,t),h=p.on,m=p.value[c]==null?d||(d=sv(n)):void 0;(h!==r||l!==m)&&(i=(r=h).copy()).on(f,l=m),p.on=i}}function EA(t,n,r){var i=(t+="")=="transform"?NT:iv;return n==null?this.styleTween(t,_A(t,i)).on("end.style."+t,sv(t)):typeof n=="function"?this.styleTween(t,wA(t,i,fp(this,"style."+t,n))).each(SA(this._id,t)):this.styleTween(t,bA(t,i,n),r).on("end.style."+t,null)}function TA(t,n,r){return function(i){this.style.setProperty(t,n.call(this,i),r)}}function AA(t,n,r){var i,l;function c(){var f=n.apply(this,arguments);return f!==l&&(i=(l=f)&&TA(t,f,r)),i}return c._value=n,c}function DA(t,n,r){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,AA(t,n,r??""))}function NA(t){return function(){this.textContent=t}}function kA(t){return function(){var n=t(this);this.textContent=n??""}}function FA(t){return this.tween("text",typeof t=="function"?kA(fp(this,"text",t)):NA(t==null?"":t+""))}function CA(t){return function(n){this.textContent=t.call(this,n)}}function RA(t){var n,r;function i(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&CA(l)),n}return i._value=t,i}function MA(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,RA(t))}function OA(){for(var t=this._name,n=this._id,r=lv(),i=this._groups,l=i.length,c=0;c<l;++c)for(var f=i[c],d=f.length,p,h=0;h<d;++h)if(p=f[h]){var m=da(p,n);D0(p,t,r,h,f,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new ti(i,this._parents,t,r)}function zA(){var t,n,r=this,i=r._id,l=r.size();return new Promise(function(c,f){var d={value:f},p={value:function(){--l===0&&c()}};r.each(function(){var h=Da(this,i),m=h.on;m!==t&&(n=(t=m).copy(),n._.cancel.push(d),n._.interrupt.push(d),n._.end.push(p)),h.on=n}),l===0&&c()})}var LA=0;function ti(t,n,r,i){this._groups=t,this._parents=n,this._name=r,this._id=i}function lv(){return++LA}var Va=ac.prototype;ti.prototype={constructor:ti,select:mA,selectAll:gA,selectChild:Va.selectChild,selectChildren:Va.selectChildren,filter:cA,merge:fA,selection:vA,transition:OA,call:Va.call,nodes:Va.nodes,node:Va.node,size:Va.size,empty:Va.empty,each:Va.each,on:dA,attr:XT,attrTween:QT,style:EA,styleTween:DA,text:FA,textTween:MA,remove:xA,tween:UT,delay:eA,duration:aA,ease:sA,easeVarying:oA,end:zA,[Symbol.iterator]:Va[Symbol.iterator]};function BA(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var jA={time:null,delay:0,duration:250,ease:BA};function IA(t,n){for(var r;!(r=t.__transition)||!(r=r[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return r}function UA(t){var n,r;t instanceof ti?(n=t._id,t=t._name):(n=lv(),(r=jA).time=op(),t=t==null?null:t+"");for(var i=this._groups,l=i.length,c=0;c<l;++c)for(var f=i[c],d=f.length,p,h=0;h<d;++h)(p=f[h])&&D0(p,t,n,h,f,r||IA(p,n));return new ti(i,this._parents,t,n)}ac.prototype.interrupt=BT;ac.prototype.transition=UA;const ad=t=>()=>t;function HA(t,{sourceEvent:n,target:r,selection:i,mode:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}function $A(t){t.stopImmediatePropagation()}function id(t){t.preventDefault(),t.stopImmediatePropagation()}var qg={name:"drag"},sd={name:"space"},el={name:"handle"},nl={name:"center"};const{abs:Kg,max:or,min:cr}=Math;function Zg(t){return[+t[0],+t[1]]}function $d(t){return[Zg(t[0]),Zg(t[1])]}var Gf={name:"x",handles:["w","e"].map(e0),input:function(t,n){return t==null?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ld={},GA={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(e0),input:function(t){return t==null?null:$d(t)},output:function(t){return t}},Xa={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Qg={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Jg={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},PA={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},YA={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function e0(t){return{type:t}}function VA(t){return!t.ctrlKey&&!t.button}function XA(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function WA(){return navigator.maxTouchPoints||"ontouchstart"in this}function od(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function qA(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ov(){return cv(Gf)}function Fn(){return cv(GA)}function cv(t){var n=XA,r=VA,i=WA,l=!0,c=ap("start","brush","end"),f=6,d;function p(E){var A=E.property("__brush",b).selectAll(".overlay").data([e0("overlay")]);A.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Xa.overlay).merge(A).each(function(){var C=od(this).extent;Ft(this).attr("x",C[0][0]).attr("y",C[0][1]).attr("width",C[1][0]-C[0][0]).attr("height",C[1][1]-C[0][1])}),E.selectAll(".selection").data([e0("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Xa.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var O=E.selectAll(".handle").data(t.handles,function(C){return C.type});O.exit().remove(),O.enter().append("rect").attr("class",function(C){return"handle handle--"+C.type}).attr("cursor",function(C){return Xa[C.type]}),E.each(h).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",v).filter(i).on("touchstart.brush",v).on("touchmove.brush",w).on("touchend.brush touchcancel.brush",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.move=function(E,A,O){E.tween?E.on("start.brush",function(C){m(this,arguments).beforestart().start(C)}).on("interrupt.brush end.brush",function(C){m(this,arguments).end(C)}).tween("brush",function(){var C=this,U=C.__brush,B=m(C,arguments),V=U.selection,k=t.input(typeof A=="function"?A.apply(this,arguments):A,U.extent),F=sc(V,k);function T(N){U.selection=N===1&&k===null?null:F(N),h.call(C),B.brush()}return V!==null&&k!==null?T:T(1)}):E.each(function(){var C=this,U=arguments,B=C.__brush,V=t.input(typeof A=="function"?A.apply(C,U):A,B.extent),k=m(C,U).beforestart();Hd(C),B.selection=V===null?null:V,h.call(C),k.start(O).brush(O).end(O)})},p.clear=function(E,A){p.move(E,null,A)};function h(){var E=Ft(this),A=od(this).selection;A?(E.selectAll(".selection").style("display",null).attr("x",A[0][0]).attr("y",A[0][1]).attr("width",A[1][0]-A[0][0]).attr("height",A[1][1]-A[0][1]),E.selectAll(".handle").style("display",null).attr("x",function(O){return O.type[O.type.length-1]==="e"?A[1][0]-f/2:A[0][0]-f/2}).attr("y",function(O){return O.type[0]==="s"?A[1][1]-f/2:A[0][1]-f/2}).attr("width",function(O){return O.type==="n"||O.type==="s"?A[1][0]-A[0][0]+f:f}).attr("height",function(O){return O.type==="e"||O.type==="w"?A[1][1]-A[0][1]+f:f})):E.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function m(E,A,O){var C=E.__brush.emitter;return C&&(!O||!C.clean)?C:new y(E,A,O)}function y(E,A,O){this.that=E,this.args=A,this.state=E.__brush,this.active=0,this.clean=O}y.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(E,A){return this.starting?(this.starting=!1,this.emit("start",E,A)):this.emit("brush",E),this},brush:function(E,A){return this.emit("brush",E,A),this},end:function(E,A){return--this.active===0&&(delete this.state.emitter,this.emit("end",E,A)),this},emit:function(E,A,O){var C=Ft(this.that).datum();c.call(E,this.that,new HA(E,{sourceEvent:A,target:p,selection:t.output(this.state.selection),mode:O,dispatch:c}),C)}};function v(E){if(d&&!E.touches||!r.apply(this,arguments))return;var A=this,O=E.target.__data__.type,C=(l&&E.metaKey?O="overlay":O)==="selection"?qg:l&&E.altKey?nl:el,U=t===ld?null:PA[O],B=t===Gf?null:YA[O],V=od(A),k=V.extent,F=V.selection,T=k[0][0],N,D,L=k[0][1],K,ft,dt=k[1][0],J,gt,wt=k[1][1],bt,P,I=0,R=0,Y,z=U&&B&&l&&E.shiftKey,W,tt,nt=Array.from(E.touches||[E],Et=>{const Mt=Et.identifier;return Et=nn(Et,A),Et.point0=Et.slice(),Et.identifier=Mt,Et});Hd(A);var j=m(A,arguments,!0).beforestart();if(O==="overlay"){F&&(Y=!0);const Et=[nt[0],nt[1]||nt[0]];V.selection=F=[[N=t===ld?T:cr(Et[0][0],Et[1][0]),K=t===Gf?L:cr(Et[0][1],Et[1][1])],[J=t===ld?dt:or(Et[0][0],Et[1][0]),bt=t===Gf?wt:or(Et[0][1],Et[1][1])]],nt.length>1&&Zt(E)}else N=F[0][0],K=F[0][1],J=F[1][0],bt=F[1][1];D=N,ft=K,gt=J,P=bt;var q=Ft(A).attr("pointer-events","none"),lt=q.selectAll(".overlay").attr("cursor",Xa[O]);if(E.touches)j.moved=vt,j.ended=Gt;else{var Ct=Ft(E.view).on("mousemove.brush",vt,!0).on("mouseup.brush",Gt,!0);l&&Ct.on("keydown.brush",Kt,!0).on("keyup.brush",Yt,!0),QE(E.view)}h.call(A),j.start(E,C.name);function vt(Et){for(const Mt of Et.changedTouches||[Et])for(const Ot of nt)Ot.identifier===Mt.identifier&&(Ot.cur=nn(Mt,A));if(z&&!W&&!tt&&nt.length===1){const Mt=nt[0];Kg(Mt.cur[0]-Mt[0])>Kg(Mt.cur[1]-Mt[1])?tt=!0:W=!0}for(const Mt of nt)Mt.cur&&(Mt[0]=Mt.cur[0],Mt[1]=Mt.cur[1]);Y=!0,id(Et),Zt(Et)}function Zt(Et){const Mt=nt[0],Ot=Mt.point0;var Dt;switch(I=Mt[0]-Ot[0],R=Mt[1]-Ot[1],C){case sd:case qg:{U&&(I=or(T-N,cr(dt-J,I)),D=N+I,gt=J+I),B&&(R=or(L-K,cr(wt-bt,R)),ft=K+R,P=bt+R);break}case el:{nt[1]?(U&&(D=or(T,cr(dt,nt[0][0])),gt=or(T,cr(dt,nt[1][0])),U=1),B&&(ft=or(L,cr(wt,nt[0][1])),P=or(L,cr(wt,nt[1][1])),B=1)):(U<0?(I=or(T-N,cr(dt-N,I)),D=N+I,gt=J):U>0&&(I=or(T-J,cr(dt-J,I)),D=N,gt=J+I),B<0?(R=or(L-K,cr(wt-K,R)),ft=K+R,P=bt):B>0&&(R=or(L-bt,cr(wt-bt,R)),ft=K,P=bt+R));break}case nl:{U&&(D=or(T,cr(dt,N-I*U)),gt=or(T,cr(dt,J+I*U))),B&&(ft=or(L,cr(wt,K-R*B)),P=or(L,cr(wt,bt+R*B)));break}}gt<D&&(U*=-1,Dt=N,N=J,J=Dt,Dt=D,D=gt,gt=Dt,O in Qg&&lt.attr("cursor",Xa[O=Qg[O]])),P<ft&&(B*=-1,Dt=K,K=bt,bt=Dt,Dt=ft,ft=P,P=Dt,O in Jg&&lt.attr("cursor",Xa[O=Jg[O]])),V.selection&&(F=V.selection),W&&(D=F[0][0],gt=F[1][0]),tt&&(ft=F[0][1],P=F[1][1]),(F[0][0]!==D||F[0][1]!==ft||F[1][0]!==gt||F[1][1]!==P)&&(V.selection=[[D,ft],[gt,P]],h.call(A),j.brush(Et,C.name))}function Gt(Et){if($A(Et),Et.touches){if(Et.touches.length)return;d&&clearTimeout(d),d=setTimeout(function(){d=null},500)}else JE(Et.view,Y),Ct.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);q.attr("pointer-events","all"),lt.attr("cursor",Xa.overlay),V.selection&&(F=V.selection),qA(F)&&(V.selection=null,h.call(A)),j.end(Et,C.name)}function Kt(Et){switch(Et.keyCode){case 16:{z=U&&B;break}case 18:{C===el&&(U&&(J=gt-I*U,N=D+I*U),B&&(bt=P-R*B,K=ft+R*B),C=nl,Zt(Et));break}case 32:{(C===el||C===nl)&&(U<0?J=gt-I:U>0&&(N=D-I),B<0?bt=P-R:B>0&&(K=ft-R),C=sd,lt.attr("cursor",Xa.selection),Zt(Et));break}default:return}id(Et)}function Yt(Et){switch(Et.keyCode){case 16:{z&&(W=tt=z=!1,Zt(Et));break}case 18:{C===nl&&(U<0?J=gt:U>0&&(N=D),B<0?bt=P:B>0&&(K=ft),C=el,Zt(Et));break}case 32:{C===sd&&(Et.altKey?(U&&(J=gt-I*U,N=D+I*U),B&&(bt=P-R*B,K=ft+R*B),C=nl):(U<0?J=gt:U>0&&(N=D),B<0?bt=P:B>0&&(K=ft),C=el),lt.attr("cursor",Xa[O]),Zt(Et));break}default:return}id(Et)}}function w(E){m(this,arguments).moved(E)}function S(E){m(this,arguments).ended(E)}function b(){var E=this.__brush||{selection:null};return E.extent=$d(n.apply(this,arguments)),E.dim=t,E}return p.extent=function(E){return arguments.length?(n=typeof E=="function"?E:ad($d(E)),p):n},p.filter=function(E){return arguments.length?(r=typeof E=="function"?E:ad(!!E),p):r},p.touchable=function(E){return arguments.length?(i=typeof E=="function"?E:ad(!!E),p):i},p.handleSize=function(E){return arguments.length?(f=+E,p):f},p.keyModifiers=function(E){return arguments.length?(l=!!E,p):l},p.on=function(){var E=c.on.apply(c,arguments);return E===c?p:E},p}const Gd=Math.PI,Pd=2*Gd,ts=1e-6,KA=Pd-ts;function fv(t){this._+=t[0];for(let n=1,r=t.length;n<r;++n)this._+=arguments[n]+t[n]}function ZA(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return fv;const r=10**n;return function(i){this._+=i[0];for(let l=1,c=i.length;l<c;++l)this._+=Math.round(arguments[l]*r)/r+i[l]}}class QA{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?fv:ZA(n)}moveTo(n,r){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,r){this._append`L${this._x1=+n},${this._y1=+r}`}quadraticCurveTo(n,r,i,l){this._append`Q${+n},${+r},${this._x1=+i},${this._y1=+l}`}bezierCurveTo(n,r,i,l,c,f){this._append`C${+n},${+r},${+i},${+l},${this._x1=+c},${this._y1=+f}`}arcTo(n,r,i,l,c){if(n=+n,r=+r,i=+i,l=+l,c=+c,c<0)throw new Error(`negative radius: ${c}`);let f=this._x1,d=this._y1,p=i-n,h=l-r,m=f-n,y=d-r,v=m*m+y*y;if(this._x1===null)this._append`M${this._x1=n},${this._y1=r}`;else if(v>ts)if(!(Math.abs(y*p-h*m)>ts)||!c)this._append`L${this._x1=n},${this._y1=r}`;else{let w=i-f,S=l-d,b=p*p+h*h,E=w*w+S*S,A=Math.sqrt(b),O=Math.sqrt(v),C=c*Math.tan((Gd-Math.acos((b+v-E)/(2*A*O)))/2),U=C/O,B=C/A;Math.abs(U-1)>ts&&this._append`L${n+U*m},${r+U*y}`,this._append`A${c},${c},0,0,${+(y*w>m*S)},${this._x1=n+B*p},${this._y1=r+B*h}`}}arc(n,r,i,l,c,f){if(n=+n,r=+r,i=+i,f=!!f,i<0)throw new Error(`negative radius: ${i}`);let d=i*Math.cos(l),p=i*Math.sin(l),h=n+d,m=r+p,y=1^f,v=f?l-c:c-l;this._x1===null?this._append`M${h},${m}`:(Math.abs(this._x1-h)>ts||Math.abs(this._y1-m)>ts)&&this._append`L${h},${m}`,i&&(v<0&&(v=v%Pd+Pd),v>KA?this._append`A${i},${i},0,1,${y},${n-d},${r-p}A${i},${i},0,1,${y},${this._x1=h},${this._y1=m}`:v>ts&&this._append`A${i},${i},0,${+(v>=Gd)},${y},${this._x1=n+i*Math.cos(c)},${this._y1=r+i*Math.sin(c)}`)}rect(n,r,i,l){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}h${i=+i}v${+l}h${-i}Z`}toString(){return this._}}var ty={},cd={},fd=34,Do=10,ud=13;function uv(t){return new Function("d","return {"+t.map(function(n,r){return JSON.stringify(n)+": d["+r+'] || ""'}).join(",")+"}")}function JA(t,n){var r=uv(t);return function(i,l){return n(r(i),l,t)}}function ey(t){var n=Object.create(null),r=[];return t.forEach(function(i){for(var l in i)l in n||r.push(n[l]=l)}),r}function Sr(t,n){var r=t+"",i=r.length;return i<n?new Array(n-i+1).join(0)+r:r}function t8(t){return t<0?"-"+Sr(-t,6):t>9999?"+"+Sr(t,6):Sr(t,4)}function e8(t){var n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),l=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":t8(t.getUTCFullYear())+"-"+Sr(t.getUTCMonth()+1,2)+"-"+Sr(t.getUTCDate(),2)+(l?"T"+Sr(n,2)+":"+Sr(r,2)+":"+Sr(i,2)+"."+Sr(l,3)+"Z":i?"T"+Sr(n,2)+":"+Sr(r,2)+":"+Sr(i,2)+"Z":r||n?"T"+Sr(n,2)+":"+Sr(r,2)+"Z":"")}function n8(t){var n=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function i(y,v){var w,S,b=l(y,function(E,A){if(w)return w(E,A-1);S=E,w=v?JA(E,v):uv(E)});return b.columns=S||[],b}function l(y,v){var w=[],S=y.length,b=0,E=0,A,O=S<=0,C=!1;y.charCodeAt(S-1)===Do&&--S,y.charCodeAt(S-1)===ud&&--S;function U(){if(O)return cd;if(C)return C=!1,ty;var V,k=b,F;if(y.charCodeAt(k)===fd){for(;b++<S&&y.charCodeAt(b)!==fd||y.charCodeAt(++b)===fd;);return(V=b)>=S?O=!0:(F=y.charCodeAt(b++))===Do?C=!0:F===ud&&(C=!0,y.charCodeAt(b)===Do&&++b),y.slice(k+1,V-1).replace(/""/g,'"')}for(;b<S;){if((F=y.charCodeAt(V=b++))===Do)C=!0;else if(F===ud)C=!0,y.charCodeAt(b)===Do&&++b;else if(F!==r)continue;return y.slice(k,V)}return O=!0,y.slice(k,S)}for(;(A=U())!==cd;){for(var B=[];A!==ty&&A!==cd;)B.push(A),A=U();v&&(B=v(B,E++))==null||w.push(B)}return w}function c(y,v){return y.map(function(w){return v.map(function(S){return m(w[S])}).join(t)})}function f(y,v){return v==null&&(v=ey(y)),[v.map(m).join(t)].concat(c(y,v)).join(`
`)}function d(y,v){return v==null&&(v=ey(y)),c(y,v).join(`
`)}function p(y){return y.map(h).join(`
`)}function h(y){return y.map(m).join(t)}function m(y){return y==null?"":y instanceof Date?e8(y):n.test(y+="")?'"'+y.replace(/"/g,'""')+'"':y}return{parse:i,parseRows:l,format:f,formatBody:d,formatRows:p,formatRow:h,formatValue:m}}var r8=n8(","),a8=r8.parse;function ne(t){for(var n in t){var r=t[n].trim(),i,l;if(!r)r=null;else if(r==="true")r=!0;else if(r==="false")r=!1;else if(r==="NaN")r=NaN;else if(!isNaN(i=+r))r=i;else if(l=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))i8&&l[4]&&!l[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r);else continue;t[n]=r}return t}const i8=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function s8(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function l8(t,n){return fetch(t,n).then(s8)}function o8(t){return function(n,r,i){return arguments.length===2&&typeof r=="function"&&(i=r,r=void 0),l8(n,r).then(function(l){return t(l,i)})}}var Jt=o8(a8);function c8(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function n0(t,n){if((r=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var r,i=t.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+t.slice(r+1)]}function yl(t){return t=n0(Math.abs(t)),t?t[1]:NaN}function f8(t,n){return function(r,i){for(var l=r.length,c=[],f=0,d=t[0],p=0;l>0&&d>0&&(p+d+1>i&&(d=Math.max(1,i-p)),c.push(r.substring(l-=d,l+d)),!((p+=d+1)>i));)d=t[f=(f+1)%t.length];return c.reverse().join(n)}}function u8(t){return function(n){return n.replace(/[0-9]/g,function(r){return t[+r]})}}var h8=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r0(t){if(!(n=h8.exec(t)))throw new Error("invalid format: "+t);var n;return new up({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}r0.prototype=up.prototype;function up(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}up.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function d8(t){t:for(var n=t.length,r=1,i=-1,l;r<n;++r)switch(t[r]){case".":i=l=r;break;case"0":i===0&&(i=r),l=r;break;default:if(!+t[r])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(l+1):t}var hv;function p8(t,n){var r=n0(t,n);if(!r)return t+"";var i=r[0],l=r[1],c=l-(hv=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,f=i.length;return c===f?i:c>f?i+new Array(c-f+1).join("0"):c>0?i.slice(0,c)+"."+i.slice(c):"0."+new Array(1-c).join("0")+n0(t,Math.max(0,n+c-1))[0]}function ny(t,n){var r=n0(t,n);if(!r)return t+"";var i=r[0],l=r[1];return l<0?"0."+new Array(-l).join("0")+i:i.length>l+1?i.slice(0,l+1)+"."+i.slice(l+1):i+new Array(l-i.length+2).join("0")}const ry={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:c8,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>ny(t*100,n),r:ny,s:p8,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ay(t){return t}var iy=Array.prototype.map,sy=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function x8(t){var n=t.grouping===void 0||t.thousands===void 0?ay:f8(iy.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",l=t.decimal===void 0?".":t.decimal+"",c=t.numerals===void 0?ay:u8(iy.call(t.numerals,String)),f=t.percent===void 0?"%":t.percent+"",d=t.minus===void 0?"−":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function h(y){y=r0(y);var v=y.fill,w=y.align,S=y.sign,b=y.symbol,E=y.zero,A=y.width,O=y.comma,C=y.precision,U=y.trim,B=y.type;B==="n"?(O=!0,B="g"):ry[B]||(C===void 0&&(C=12),U=!0,B="g"),(E||v==="0"&&w==="=")&&(E=!0,v="0",w="=");var V=b==="$"?r:b==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",k=b==="$"?i:/[%p]/.test(B)?f:"",F=ry[B],T=/[defgprs%]/.test(B);C=C===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,C)):Math.max(0,Math.min(20,C));function N(D){var L=V,K=k,ft,dt,J;if(B==="c")K=F(D)+K,D="";else{D=+D;var gt=D<0||1/D<0;if(D=isNaN(D)?p:F(Math.abs(D),C),U&&(D=d8(D)),gt&&+D==0&&S!=="+"&&(gt=!1),L=(gt?S==="("?S:d:S==="-"||S==="("?"":S)+L,K=(B==="s"?sy[8+hv/3]:"")+K+(gt&&S==="("?")":""),T){for(ft=-1,dt=D.length;++ft<dt;)if(J=D.charCodeAt(ft),48>J||J>57){K=(J===46?l+D.slice(ft+1):D.slice(ft))+K,D=D.slice(0,ft);break}}}O&&!E&&(D=n(D,1/0));var wt=L.length+D.length+K.length,bt=wt<A?new Array(A-wt+1).join(v):"";switch(O&&E&&(D=n(bt+D,bt.length?A-K.length:1/0),bt=""),w){case"<":D=L+D+K+bt;break;case"=":D=L+bt+D+K;break;case"^":D=bt.slice(0,wt=bt.length>>1)+L+D+K+bt.slice(wt);break;default:D=bt+L+D+K;break}return c(D)}return N.toString=function(){return y+""},N}function m(y,v){var w=h((y=r0(y),y.type="f",y)),S=Math.max(-8,Math.min(8,Math.floor(yl(v)/3)))*3,b=Math.pow(10,-S),E=sy[8+S/3];return function(A){return w(b*A)+E}}return{format:h,formatPrefix:m}}var Df,Me,dv;m8({thousands:",",grouping:[3],currency:["$",""]});function m8(t){return Df=x8(t),Me=Df.format,dv=Df.formatPrefix,Df}function g8(t){return Math.max(0,-yl(Math.abs(t)))}function y8(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yl(n)/3)))*3-yl(Math.abs(t)))}function v8(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,yl(n)-yl(t))+1}const _8=Math.random,un=function t(n){function r(i,l){return i=i==null?0:+i,l=l==null?1:+l,arguments.length===1?(l=i,i=0):l-=i,function(){return n()*l+i}}return r.source=t,r}(_8),b8=1664525,w8=1013904223,ly=1/4294967296;function We(t=Math.random()){let n=(0<=t&&t<1?t/ly:Math.abs(t))|0;return()=>(n=b8*n+w8|0,ly*(n>>>0))}function pv(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function S8(t,n){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const oy=Symbol("implicit");function pa(){var t=new Dd,n=[],r=[],i=oy;function l(c){let f=t.get(c);if(f===void 0){if(i!==oy)return i;t.set(c,f=n.push(c)-1)}return r[f%r.length]}return l.domain=function(c){if(!arguments.length)return n.slice();n=[],t=new Dd;for(const f of c)t.has(f)||t.set(f,n.push(f)-1);return l},l.range=function(c){return arguments.length?(r=Array.from(c),l):r.slice()},l.unknown=function(c){return arguments.length?(i=c,l):i},l.copy=function(){return pa(n,r).unknown(i)},pv.apply(l,arguments),l}function E8(t){return function(){return t}}function T8(t){return+t}var cy=[0,1];function ki(t){return t}function Yd(t,n){return(n-=t=+t)?function(r){return(r-t)/n}:E8(isNaN(n)?NaN:.5)}function A8(t,n){var r;return t>n&&(r=t,t=n,n=r),function(i){return Math.max(t,Math.min(n,i))}}function D8(t,n,r){var i=t[0],l=t[1],c=n[0],f=n[1];return l<i?(i=Yd(l,i),c=r(f,c)):(i=Yd(i,l),c=r(c,f)),function(d){return c(i(d))}}function N8(t,n,r){var i=Math.min(t.length,n.length)-1,l=new Array(i),c=new Array(i),f=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++f<i;)l[f]=Yd(t[f],t[f+1]),c[f]=r(n[f],n[f+1]);return function(d){var p=e3(t,d,1,i)-1;return c[p](l[p](d))}}function k8(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function F8(){var t=cy,n=cy,r=sc,i,l,c,f=ki,d,p,h;function m(){var v=Math.min(t.length,n.length);return f!==ki&&(f=A8(t[0],t[v-1])),d=v>2?N8:D8,p=h=null,y}function y(v){return v==null||isNaN(v=+v)?c:(p||(p=d(t.map(i),n,r)))(i(f(v)))}return y.invert=function(v){return f(l((h||(h=d(n,t.map(i),sa)))(v)))},y.domain=function(v){return arguments.length?(t=Array.from(v,T8),m()):t.slice()},y.range=function(v){return arguments.length?(n=Array.from(v),m()):n.slice()},y.rangeRound=function(v){return n=Array.from(v),r=Q2,m()},y.clamp=function(v){return arguments.length?(f=v?!0:ki,m()):f!==ki},y.interpolate=function(v){return arguments.length?(r=v,m()):r},y.unknown=function(v){return arguments.length?(c=v,y):c},function(v,w){return i=v,l=w,m()}}function C8(){return F8()(ki,ki)}function R8(t,n,r,i){var l=c3(t,n,r),c;switch(i=r0(i??",f"),i.type){case"s":{var f=Math.max(Math.abs(t),Math.abs(n));return i.precision==null&&!isNaN(c=y8(l,f))&&(i.precision=c),dv(i,f)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(c=v8(l,Math.max(Math.abs(t),Math.abs(n))))&&(i.precision=c-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(c=g8(l))&&(i.precision=c-(i.type==="%")*2);break}}return Me(i)}function xv(t){var n=t.domain;return t.ticks=function(r){var i=n();return o3(i[0],i[i.length-1],r??10)},t.tickFormat=function(r,i){var l=n();return R8(l[0],l[l.length-1],r??10,i)},t.nice=function(r){r==null&&(r=10);var i=n(),l=0,c=i.length-1,f=i[l],d=i[c],p,h,m=10;for(d<f&&(h=f,f=d,d=h,h=l,l=c,c=h);m-- >0;){if(h=kd(f,d,r),h===p)return i[l]=f,i[c]=d,n(i);if(h>0)f=Math.floor(f/h)*h,d=Math.ceil(d/h)*h;else if(h<0)f=Math.ceil(f*h)/h,d=Math.floor(d*h)/h;else break;p=h}return t},t}function he(){var t=C8();return t.copy=function(){return k8(t,he())},pv.apply(t,arguments),xv(t)}const hd=new Date,dd=new Date;function Na(t,n,r,i){function l(c){return t(c=arguments.length===0?new Date:new Date(+c)),c}return l.floor=c=>(t(c=new Date(+c)),c),l.ceil=c=>(t(c=new Date(c-1)),n(c,1),t(c),c),l.round=c=>{const f=l(c),d=l.ceil(c);return c-f<d-c?f:d},l.offset=(c,f)=>(n(c=new Date(+c),f==null?1:Math.floor(f)),c),l.range=(c,f,d)=>{const p=[];if(c=l.ceil(c),d=d==null?1:Math.floor(d),!(c<f)||!(d>0))return p;let h;do p.push(h=new Date(+c)),n(c,d),t(c);while(h<c&&c<f);return p},l.filter=c=>Na(f=>{if(f>=f)for(;t(f),!c(f);)f.setTime(f-1)},(f,d)=>{if(f>=f)if(d<0)for(;++d<=0;)for(;n(f,-1),!c(f););else for(;--d>=0;)for(;n(f,1),!c(f););}),r&&(l.count=(c,f)=>(hd.setTime(+c),dd.setTime(+f),t(hd),t(dd),Math.floor(r(hd,dd))),l.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?l.filter(i?f=>i(f)%c===0:f=>l.count(0,f)%c===0):l)),l}const M8=1e3,hp=M8*60,O8=hp*60,Xo=O8*24,mv=Xo*7,dp=Na(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*hp)/Xo,t=>t.getDate()-1);dp.range;const pp=Na(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/Xo,t=>t.getUTCDate()-1);pp.range;const z8=Na(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/Xo,t=>Math.floor(t/Xo));z8.range;function ds(t){return Na(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,r)=>{n.setDate(n.getDate()+r*7)},(n,r)=>(r-n-(r.getTimezoneOffset()-n.getTimezoneOffset())*hp)/mv)}const gv=ds(0),a0=ds(1),L8=ds(2),B8=ds(3),vl=ds(4),j8=ds(5),I8=ds(6);gv.range;a0.range;L8.range;B8.range;vl.range;j8.range;I8.range;function ps(t){return Na(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCDate(n.getUTCDate()+r*7)},(n,r)=>(r-n)/mv)}const yv=ps(0),i0=ps(1),U8=ps(2),H8=ps(3),_l=ps(4),$8=ps(5),G8=ps(6);yv.range;i0.range;U8.range;H8.range;_l.range;$8.range;G8.range;const ls=Na(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());ls.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Na(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,r)=>{n.setFullYear(n.getFullYear()+r*t)});ls.range;const os=Na(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());os.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Na(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCFullYear(n.getUTCFullYear()+r*t)});os.range;function pd(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function xd(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function No(t,n,r){return{y:t,m:n,d:r,H:0,M:0,S:0,L:0}}function P8(t){var n=t.dateTime,r=t.date,i=t.time,l=t.periods,c=t.days,f=t.shortDays,d=t.months,p=t.shortMonths,h=ko(l),m=Fo(l),y=ko(c),v=Fo(c),w=ko(f),S=Fo(f),b=ko(d),E=Fo(d),A=ko(p),O=Fo(p),C={a:gt,A:wt,b:bt,B:P,c:null,d:xy,e:xy,f:d6,g:S6,G:T6,H:f6,I:u6,j:h6,L:vv,m:p6,M:x6,p:I,q:R,Q:yy,s:vy,S:m6,u:g6,U:y6,V:v6,w:_6,W:b6,x:null,X:null,y:w6,Y:E6,Z:A6,"%":gy},U={a:Y,A:z,b:W,B:tt,c:null,d:my,e:my,f:F6,g:U6,G:$6,H:D6,I:N6,j:k6,L:bv,m:C6,M:R6,p:nt,q:j,Q:yy,s:vy,S:M6,u:O6,U:z6,V:L6,w:B6,W:j6,x:null,X:null,y:I6,Y:H6,Z:G6,"%":gy},B={a:N,A:D,b:L,B:K,c:ft,d:dy,e:dy,f:s6,g:hy,G:uy,H:py,I:py,j:n6,L:i6,m:e6,M:r6,p:T,q:t6,Q:o6,s:c6,S:a6,u:q8,U:K8,V:Z8,w:W8,W:Q8,x:dt,X:J,y:hy,Y:uy,Z:J8,"%":l6};C.x=V(r,C),C.X=V(i,C),C.c=V(n,C),U.x=V(r,U),U.X=V(i,U),U.c=V(n,U);function V(q,lt){return function(Ct){var vt=[],Zt=-1,Gt=0,Kt=q.length,Yt,Et,Mt;for(Ct instanceof Date||(Ct=new Date(+Ct));++Zt<Kt;)q.charCodeAt(Zt)===37&&(vt.push(q.slice(Gt,Zt)),(Et=fy[Yt=q.charAt(++Zt)])!=null?Yt=q.charAt(++Zt):Et=Yt==="e"?" ":"0",(Mt=lt[Yt])&&(Yt=Mt(Ct,Et)),vt.push(Yt),Gt=Zt+1);return vt.push(q.slice(Gt,Zt)),vt.join("")}}function k(q,lt){return function(Ct){var vt=No(1900,void 0,1),Zt=F(vt,q,Ct+="",0),Gt,Kt;if(Zt!=Ct.length)return null;if("Q"in vt)return new Date(vt.Q);if("s"in vt)return new Date(vt.s*1e3+("L"in vt?vt.L:0));if(lt&&!("Z"in vt)&&(vt.Z=0),"p"in vt&&(vt.H=vt.H%12+vt.p*12),vt.m===void 0&&(vt.m="q"in vt?vt.q:0),"V"in vt){if(vt.V<1||vt.V>53)return null;"w"in vt||(vt.w=1),"Z"in vt?(Gt=xd(No(vt.y,0,1)),Kt=Gt.getUTCDay(),Gt=Kt>4||Kt===0?i0.ceil(Gt):i0(Gt),Gt=pp.offset(Gt,(vt.V-1)*7),vt.y=Gt.getUTCFullYear(),vt.m=Gt.getUTCMonth(),vt.d=Gt.getUTCDate()+(vt.w+6)%7):(Gt=pd(No(vt.y,0,1)),Kt=Gt.getDay(),Gt=Kt>4||Kt===0?a0.ceil(Gt):a0(Gt),Gt=dp.offset(Gt,(vt.V-1)*7),vt.y=Gt.getFullYear(),vt.m=Gt.getMonth(),vt.d=Gt.getDate()+(vt.w+6)%7)}else("W"in vt||"U"in vt)&&("w"in vt||(vt.w="u"in vt?vt.u%7:"W"in vt?1:0),Kt="Z"in vt?xd(No(vt.y,0,1)).getUTCDay():pd(No(vt.y,0,1)).getDay(),vt.m=0,vt.d="W"in vt?(vt.w+6)%7+vt.W*7-(Kt+5)%7:vt.w+vt.U*7-(Kt+6)%7);return"Z"in vt?(vt.H+=vt.Z/100|0,vt.M+=vt.Z%100,xd(vt)):pd(vt)}}function F(q,lt,Ct,vt){for(var Zt=0,Gt=lt.length,Kt=Ct.length,Yt,Et;Zt<Gt;){if(vt>=Kt)return-1;if(Yt=lt.charCodeAt(Zt++),Yt===37){if(Yt=lt.charAt(Zt++),Et=B[Yt in fy?lt.charAt(Zt++):Yt],!Et||(vt=Et(q,Ct,vt))<0)return-1}else if(Yt!=Ct.charCodeAt(vt++))return-1}return vt}function T(q,lt,Ct){var vt=h.exec(lt.slice(Ct));return vt?(q.p=m.get(vt[0].toLowerCase()),Ct+vt[0].length):-1}function N(q,lt,Ct){var vt=w.exec(lt.slice(Ct));return vt?(q.w=S.get(vt[0].toLowerCase()),Ct+vt[0].length):-1}function D(q,lt,Ct){var vt=y.exec(lt.slice(Ct));return vt?(q.w=v.get(vt[0].toLowerCase()),Ct+vt[0].length):-1}function L(q,lt,Ct){var vt=A.exec(lt.slice(Ct));return vt?(q.m=O.get(vt[0].toLowerCase()),Ct+vt[0].length):-1}function K(q,lt,Ct){var vt=b.exec(lt.slice(Ct));return vt?(q.m=E.get(vt[0].toLowerCase()),Ct+vt[0].length):-1}function ft(q,lt,Ct){return F(q,n,lt,Ct)}function dt(q,lt,Ct){return F(q,r,lt,Ct)}function J(q,lt,Ct){return F(q,i,lt,Ct)}function gt(q){return f[q.getDay()]}function wt(q){return c[q.getDay()]}function bt(q){return p[q.getMonth()]}function P(q){return d[q.getMonth()]}function I(q){return l[+(q.getHours()>=12)]}function R(q){return 1+~~(q.getMonth()/3)}function Y(q){return f[q.getUTCDay()]}function z(q){return c[q.getUTCDay()]}function W(q){return p[q.getUTCMonth()]}function tt(q){return d[q.getUTCMonth()]}function nt(q){return l[+(q.getUTCHours()>=12)]}function j(q){return 1+~~(q.getUTCMonth()/3)}return{format:function(q){var lt=V(q+="",C);return lt.toString=function(){return q},lt},parse:function(q){var lt=k(q+="",!1);return lt.toString=function(){return q},lt},utcFormat:function(q){var lt=V(q+="",U);return lt.toString=function(){return q},lt},utcParse:function(q){var lt=k(q+="",!0);return lt.toString=function(){return q},lt}}}var fy={"-":"",_:" ",0:"0"},Kn=/^\s*\d+/,Y8=/^%/,V8=/[\\^$*+?|[\]().{}]/g;function Ye(t,n,r){var i=t<0?"-":"",l=(i?-t:t)+"",c=l.length;return i+(c<r?new Array(r-c+1).join(n)+l:l)}function X8(t){return t.replace(V8,"\\$&")}function ko(t){return new RegExp("^(?:"+t.map(X8).join("|")+")","i")}function Fo(t){return new Map(t.map((n,r)=>[n.toLowerCase(),r]))}function W8(t,n,r){var i=Kn.exec(n.slice(r,r+1));return i?(t.w=+i[0],r+i[0].length):-1}function q8(t,n,r){var i=Kn.exec(n.slice(r,r+1));return i?(t.u=+i[0],r+i[0].length):-1}function K8(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.U=+i[0],r+i[0].length):-1}function Z8(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.V=+i[0],r+i[0].length):-1}function Q8(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.W=+i[0],r+i[0].length):-1}function uy(t,n,r){var i=Kn.exec(n.slice(r,r+4));return i?(t.y=+i[0],r+i[0].length):-1}function hy(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function J8(t,n,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(r,r+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function t6(t,n,r){var i=Kn.exec(n.slice(r,r+1));return i?(t.q=i[0]*3-3,r+i[0].length):-1}function e6(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.m=i[0]-1,r+i[0].length):-1}function dy(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.d=+i[0],r+i[0].length):-1}function n6(t,n,r){var i=Kn.exec(n.slice(r,r+3));return i?(t.m=0,t.d=+i[0],r+i[0].length):-1}function py(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.H=+i[0],r+i[0].length):-1}function r6(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.M=+i[0],r+i[0].length):-1}function a6(t,n,r){var i=Kn.exec(n.slice(r,r+2));return i?(t.S=+i[0],r+i[0].length):-1}function i6(t,n,r){var i=Kn.exec(n.slice(r,r+3));return i?(t.L=+i[0],r+i[0].length):-1}function s6(t,n,r){var i=Kn.exec(n.slice(r,r+6));return i?(t.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function l6(t,n,r){var i=Y8.exec(n.slice(r,r+1));return i?r+i[0].length:-1}function o6(t,n,r){var i=Kn.exec(n.slice(r));return i?(t.Q=+i[0],r+i[0].length):-1}function c6(t,n,r){var i=Kn.exec(n.slice(r));return i?(t.s=+i[0],r+i[0].length):-1}function xy(t,n){return Ye(t.getDate(),n,2)}function f6(t,n){return Ye(t.getHours(),n,2)}function u6(t,n){return Ye(t.getHours()%12||12,n,2)}function h6(t,n){return Ye(1+dp.count(ls(t),t),n,3)}function vv(t,n){return Ye(t.getMilliseconds(),n,3)}function d6(t,n){return vv(t,n)+"000"}function p6(t,n){return Ye(t.getMonth()+1,n,2)}function x6(t,n){return Ye(t.getMinutes(),n,2)}function m6(t,n){return Ye(t.getSeconds(),n,2)}function g6(t){var n=t.getDay();return n===0?7:n}function y6(t,n){return Ye(gv.count(ls(t)-1,t),n,2)}function _v(t){var n=t.getDay();return n>=4||n===0?vl(t):vl.ceil(t)}function v6(t,n){return t=_v(t),Ye(vl.count(ls(t),t)+(ls(t).getDay()===4),n,2)}function _6(t){return t.getDay()}function b6(t,n){return Ye(a0.count(ls(t)-1,t),n,2)}function w6(t,n){return Ye(t.getFullYear()%100,n,2)}function S6(t,n){return t=_v(t),Ye(t.getFullYear()%100,n,2)}function E6(t,n){return Ye(t.getFullYear()%1e4,n,4)}function T6(t,n){var r=t.getDay();return t=r>=4||r===0?vl(t):vl.ceil(t),Ye(t.getFullYear()%1e4,n,4)}function A6(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+Ye(n/60|0,"0",2)+Ye(n%60,"0",2)}function my(t,n){return Ye(t.getUTCDate(),n,2)}function D6(t,n){return Ye(t.getUTCHours(),n,2)}function N6(t,n){return Ye(t.getUTCHours()%12||12,n,2)}function k6(t,n){return Ye(1+pp.count(os(t),t),n,3)}function bv(t,n){return Ye(t.getUTCMilliseconds(),n,3)}function F6(t,n){return bv(t,n)+"000"}function C6(t,n){return Ye(t.getUTCMonth()+1,n,2)}function R6(t,n){return Ye(t.getUTCMinutes(),n,2)}function M6(t,n){return Ye(t.getUTCSeconds(),n,2)}function O6(t){var n=t.getUTCDay();return n===0?7:n}function z6(t,n){return Ye(yv.count(os(t)-1,t),n,2)}function wv(t){var n=t.getUTCDay();return n>=4||n===0?_l(t):_l.ceil(t)}function L6(t,n){return t=wv(t),Ye(_l.count(os(t),t)+(os(t).getUTCDay()===4),n,2)}function B6(t){return t.getUTCDay()}function j6(t,n){return Ye(i0.count(os(t)-1,t),n,2)}function I6(t,n){return Ye(t.getUTCFullYear()%100,n,2)}function U6(t,n){return t=wv(t),Ye(t.getUTCFullYear()%100,n,2)}function H6(t,n){return Ye(t.getUTCFullYear()%1e4,n,4)}function $6(t,n){var r=t.getUTCDay();return t=r>=4||r===0?_l(t):_l.ceil(t),Ye(t.getUTCFullYear()%1e4,n,4)}function G6(){return"+0000"}function gy(){return"%"}function yy(t){return+t}function vy(t){return Math.floor(+t/1e3)}var rl,xs,ms;P6({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function P6(t){return rl=P8(t),xs=rl.format,ms=rl.parse,rl.utcFormat,rl.utcParse,rl}function Y6(){var t=0,n=1,r,i,l,c,f=ki,d=!1,p;function h(y){return y==null||isNaN(y=+y)?p:f(l===0?.5:(y=(c(y)-r)*l,d?Math.max(0,Math.min(1,y)):y))}h.domain=function(y){return arguments.length?([t,n]=y,r=c(t=+t),i=c(n=+n),l=r===i?0:1/(i-r),h):[t,n]},h.clamp=function(y){return arguments.length?(d=!!y,h):d},h.interpolator=function(y){return arguments.length?(f=y,h):f};function m(y){return function(v){var w,S;return arguments.length?([w,S]=v,f=y(w,S),h):[f(0),f(1)]}}return h.range=m(sc),h.rangeRound=m(Q2),h.unknown=function(y){return arguments.length?(p=y,h):p},function(y){return c=y,r=y(t),i=y(n),l=r===i?0:1/(i-r),h}}function V6(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function N0(){var t=xv(Y6()(ki));return t.copy=function(){return V6(t,N0())},S8.apply(t,arguments)}function k0(t){for(var n=t.length/6|0,r=new Array(n),i=0;i<n;)r[i]="#"+t.slice(i*6,++i*6);return r}function F0(t){var n=t.length;return function(r){return t[Math.max(0,Math.min(n-1,Math.floor(r*n)))]}}const xp=F0(k0("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));F0(k0("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));F0(k0("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));F0(k0("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Vn(t){return function(){return t}}function Sv(t){let n=3;return t.digits=function(r){if(!arguments.length)return n;if(r==null)n=null;else{const i=Math.floor(r);if(!(i>=0))throw new RangeError(`invalid digits: ${r}`);n=i}return t},()=>new QA(n)}function Ev(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Tv(t){this._context=t}Tv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);break}}};function Av(t){return new Tv(t)}function Dv(t){return t[0]}function Nv(t){return t[1]}function gn(t,n){var r=Vn(!0),i=null,l=Av,c=null,f=Sv(d);t=typeof t=="function"?t:t===void 0?Dv:Vn(t),n=typeof n=="function"?n:n===void 0?Nv:Vn(n);function d(p){var h,m=(p=Ev(p)).length,y,v=!1,w;for(i==null&&(c=l(w=f())),h=0;h<=m;++h)!(h<m&&r(y=p[h],h,p))===v&&((v=!v)?c.lineStart():c.lineEnd()),v&&c.point(+t(y,h,p),+n(y,h,p));if(w)return c=null,w+""||null}return d.x=function(p){return arguments.length?(t=typeof p=="function"?p:Vn(+p),d):t},d.y=function(p){return arguments.length?(n=typeof p=="function"?p:Vn(+p),d):n},d.defined=function(p){return arguments.length?(r=typeof p=="function"?p:Vn(!!p),d):r},d.curve=function(p){return arguments.length?(l=p,i!=null&&(c=l(i)),d):l},d.context=function(p){return arguments.length?(p==null?i=c=null:c=l(i=p),d):i},d}function _n(t,n,r){var i=null,l=Vn(!0),c=null,f=Av,d=null,p=Sv(h);t=typeof t=="function"?t:t===void 0?Dv:Vn(+t),n=typeof n=="function"?n:Vn(n===void 0?0:+n),r=typeof r=="function"?r:r===void 0?Nv:Vn(+r);function h(y){var v,w,S,b=(y=Ev(y)).length,E,A=!1,O,C=new Array(b),U=new Array(b);for(c==null&&(d=f(O=p())),v=0;v<=b;++v){if(!(v<b&&l(E=y[v],v,y))===A)if(A=!A)w=v,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),S=v-1;S>=w;--S)d.point(C[S],U[S]);d.lineEnd(),d.areaEnd()}A&&(C[v]=+t(E,v,y),U[v]=+n(E,v,y),d.point(i?+i(E,v,y):C[v],r?+r(E,v,y):U[v]))}if(O)return d=null,O+""||null}function m(){return gn().defined(l).curve(f).context(c)}return h.x=function(y){return arguments.length?(t=typeof y=="function"?y:Vn(+y),i=null,h):t},h.x0=function(y){return arguments.length?(t=typeof y=="function"?y:Vn(+y),h):t},h.x1=function(y){return arguments.length?(i=y==null?null:typeof y=="function"?y:Vn(+y),h):i},h.y=function(y){return arguments.length?(n=typeof y=="function"?y:Vn(+y),r=null,h):n},h.y0=function(y){return arguments.length?(n=typeof y=="function"?y:Vn(+y),h):n},h.y1=function(y){return arguments.length?(r=y==null?null:typeof y=="function"?y:Vn(+y),h):r},h.lineX0=h.lineY0=function(){return m().x(t).y(n)},h.lineY1=function(){return m().x(t).y(r)},h.lineX1=function(){return m().x(i).y(n)},h.defined=function(y){return arguments.length?(l=typeof y=="function"?y:Vn(!!y),h):l},h.curve=function(y){return arguments.length?(f=y,c!=null&&(d=f(c)),h):f},h.context=function(y){return arguments.length?(y==null?c=d=null:d=f(c=y),h):c},h}function _y(t){return t<0?-1:1}function by(t,n,r){var i=t._x1-t._x0,l=n-t._x1,c=(t._y1-t._y0)/(i||l<0&&-0),f=(r-t._y1)/(l||i<0&&-0),d=(c*l+f*i)/(i+l);return(_y(c)+_y(f))*Math.min(Math.abs(c),Math.abs(f),.5*Math.abs(d))||0}function wy(t,n){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-n)/2:n}function md(t,n,r){var i=t._x0,l=t._y0,c=t._x1,f=t._y1,d=(c-i)/3;t._context.bezierCurveTo(i+d,l+d*n,c-d,f-d*r,c,f)}function s0(t){this._context=t}s0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:md(this,this._t0,wy(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var r=NaN;if(t=+t,n=+n,!(t===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,md(this,wy(this,r=by(this,t,n)),r);break;default:md(this,this._t0,r=by(this,t,n));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=r}}};Object.create(s0.prototype).point=function(t,n){s0.prototype.point.call(this,n,t)};function ke(t){return new s0(t)}function zo(t,n,r){this.k=t,this.x=n,this.y=r}zo.prototype={constructor:zo,scale:function(t){return t===1?this:new zo(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new zo(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};zo.prototype;function X6({width:t=500,height:n=70,mode:r,onModeChange:i,darkMode:l}){const c=Z.useRef();return Z.useEffect(()=>{Ft(c.current).selectAll("*").remove(),Ft(c.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{className:"flex space-x-4",children:_.jsx("div",{className:`relative transition-colors duration-300 ${l?"bg-black":"bg-white"}`,style:{width:t,height:n},children:_.jsxs("div",{className:"mb-8 flex items-center space-x-8 mt-5 ml-6",children:[_.jsxs("label",{className:"flex items-center space-x-2 gap-2",children:[_.jsx("input",{type:"radio",value:"hover",checked:r==="hover",onChange:()=>i("hover")}),"Hover Tooltips"]}),_.jsxs("label",{className:"flex items-center space-x-2 gap-2",children:[_.jsx("input",{type:"radio",value:"brush",checked:r==="brush",onChange:()=>i("brush")}),"Brush Selection"]})]})})})}const W6=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="36px",p="30px",h="26px",m="22px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,j=>j.tail),fe(S,j=>j.tail)]).nice().range([E,0]),U=he().domain([_e(S,j=>j.weight),fe(S,j=>j.weight)]).nice().range([0,b]),B=1e-6,V=(j,q)=>Math.abs(j-q)<B,k=(j,q)=>j.some(lt=>V(lt,q))?j:[...j,q],F=U.domain()[1],T=C.domain()[1],N=[3,6,9],D=[30,40,50,60];O.append("g").call(Se(C).tickValues(k(D,T)).tickFormat(j=>V(j,T)?"":j).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues(k(N,F)).tickFormat(j=>V(j,F)?"":Me("d")(j)).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const ft=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);ft.append("tspan").style("font-size",p).text("Weight "),ft.append("tspan").style("font-size",h).text("(g)");const dt=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",30).attr("text-anchor","middle").style("font-family",f);dt.append("tspan").style("font-size",p).text("Tail length "),dt.append("tspan").style("font-size",h).text("(mm)");const J=We(2025),gt=un.source(J)(-8,8);O.selectAll("circle").data(S.map(j=>({...j,jx:gt()}))).enter().append("circle").attr("cx",j=>U(j.weight)+j.jx).attr("cy",j=>C(j.tail)+j.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(j,q)=>{v.html(`Tail: ${q.tail} mm<br/>Weight: ${q.weight} g`).style("visibility","visible")}).on("mousemove",j=>{v.style("top",j.offsetY+"px").style("left",j.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const wt=S.map(j=>j.weight),bt=S.map(j=>j.tail),{slope:P,intercept:I}=w(wt,bt),R=_e(wt),Y=fe(wt),z=I+P*R,W=I+P*Y;O.append("line").attr("x1",U(R)).attr("y1",C(z)).attr("x2",U(Y)).attr("y2",C(W)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("A");const tt=wt.map(j=>I+P*j),nt=Hn(bt);Te(bt.map((j,q)=>(j-tt[q])**2)),Te(bt.map(j=>(j-nt)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},q6=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="36px",p="30px",h="26px",m="22px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,j=>j.anogenitalDistance),fe(S,j=>j.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,j=>j.tail),fe(S,j=>j.tail)]).nice().range([0,b]),B=1e-6,V=(j,q)=>Math.abs(j-q)<B,k=(j,q)=>j.some(lt=>V(lt,q))?j:[...j,q],F=U.domain()[1],T=C.domain()[1],N=[30,40,50,60],D=[2,3,4,5,6];O.append("g").call(Se(C).tickValues(k(D,T)).tickFormat(j=>V(j,T)?"":j).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues(k(N,F)).tickFormat(j=>V(j,F)?"":Me("d")(j)).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const ft=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);ft.append("tspan").style("font-size",p).text("Tail length "),ft.append("tspan").style("font-size",h).text("(mm)");const dt=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",30).attr("text-anchor","middle").style("font-family",f);dt.append("tspan").style("font-size",p).text("Anogenital distance "),dt.append("tspan").style("font-size",h).text("(mm)");const J=We(2025),gt=un.source(J)(-8,8);O.selectAll("circle").data(S.map(j=>({...j,jx:gt()}))).enter().append("circle").attr("cx",j=>U(j.tail)+j.jx).attr("cy",j=>C(j.anogenitalDistance)+j.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(j,q)=>{v.html(`Tail: ${q.anogenitalDistance} mm<br/>Weight: ${q.tail} g`).style("visibility","visible")}).on("mousemove",j=>{v.style("top",j.offsetY+"px").style("left",j.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const wt=S.map(j=>j.tail),bt=S.map(j=>j.anogenitalDistance),{slope:P,intercept:I}=w(wt,bt),R=_e(wt),Y=fe(wt),z=I+P*R,W=I+P*Y;O.append("line").attr("x1",U(R)).attr("y1",C(z)).attr("x2",U(Y)).attr("y2",C(W)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("B");const tt=wt.map(j=>I+P*j),nt=Hn(bt);Te(bt.map((j,q)=>(j-tt[q])**2)),Te(bt.map(j=>(j-nt)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},K6=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="36px",p="30px",h="26px",m="22px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,j=>j.anogenitalDistance),fe(S,j=>j.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,j=>j.weight),fe(S,j=>j.weight)]).nice().range([0,b]),B=1e-6,V=(j,q)=>Math.abs(j-q)<B,k=(j,q)=>j.some(lt=>V(lt,q))?j:[...j,q],F=U.domain()[1],T=C.domain()[1],N=[3,6,9],D=[2,3,4,5,6],L=O.append("g").call(Se(C).tickValues(k(D,T)).tickFormat(Me("d")).tickSizeOuter(0).tickPadding(10));O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues(k(N,F)).tickFormat(j=>V(j,F)?"":Me("d")(j)).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),L.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const ft=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);ft.append("tspan").style("font-size",p).text("Weight "),ft.append("tspan").style("font-size",h).text("(g)");const dt=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",30).attr("text-anchor","middle").style("font-family",f);dt.append("tspan").style("font-size",p).text("Anogenital distance "),dt.append("tspan").style("font-size",h).text("(mm)");const J=We(2025),gt=un.source(J)(-8,8);O.selectAll("circle").data(S.map(j=>({...j,jx:gt()}))).enter().append("circle").attr("cx",j=>U(j.weight)+j.jx).attr("cy",j=>C(j.anogenitalDistance)+j.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(j,q)=>{v.html(`Tail: ${q.anogenitalDistance} mm<br/>Weight: ${q.weight} g`).style("visibility","visible")}).on("mousemove",j=>{v.style("top",j.offsetY+"px").style("left",j.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const wt=S.map(j=>j.weight),bt=S.map(j=>j.anogenitalDistance),{slope:P,intercept:I}=w(wt,bt),R=_e(wt),Y=fe(wt),z=I+P*R,W=I+P*Y;O.append("line").attr("x1",U(R)).attr("y1",C(z)).attr("x2",U(Y)).attr("y2",C(W)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("C");const tt=wt.map(j=>I+P*j),nt=Hn(bt);Te(bt.map((j,q)=>(j-tt[q])**2)),Te(bt.map(j=>(j-nt)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})};var Pf={exports:{}},Z6=Pf.exports,Sy;function Q6(){return Sy||(Sy=1,function(t,n){(function(r,i){i()})(Z6,function(){function r(h,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function i(h,m,y){var v=new XMLHttpRequest;v.open("GET",h),v.responseType="blob",v.onload=function(){p(v.response,m,y)},v.onerror=function(){console.error("could not download file")},v.send()}function l(h){var m=new XMLHttpRequest;m.open("HEAD",h,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function c(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(m)}}var f=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof wf=="object"&&wf.global===wf?wf:void 0,d=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=f.saveAs||(typeof window!="object"||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(h,m,y){var v=f.URL||f.webkitURL,w=document.createElement("a");m=m||h.name||"download",w.download=m,w.rel="noopener",typeof h=="string"?(w.href=h,w.origin===location.origin?c(w):l(w.href)?i(h,m,y):c(w,w.target="_blank")):(w.href=v.createObjectURL(h),setTimeout(function(){v.revokeObjectURL(w.href)},4e4),setTimeout(function(){c(w)},0))}:"msSaveOrOpenBlob"in navigator?function(h,m,y){if(m=m||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,y),m);else if(l(h))i(h,m,y);else{var v=document.createElement("a");v.href=h,v.target="_blank",setTimeout(function(){c(v)})}}:function(h,m,y,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof h=="string")return i(h,m,y);var w=h.type==="application/octet-stream",S=/constructor/i.test(f.HTMLElement)||f.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||w&&S||d)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var C=E.result;C=b?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=C:location=C,v=null},E.readAsDataURL(h)}else{var A=f.URL||f.webkitURL,O=A.createObjectURL(h);v?v.location=O:location.href=O,v=null,setTimeout(function(){A.revokeObjectURL(O)},4e4)}});f.saveAs=p.saveAs=p,t.exports=p})}(Pf)),Pf.exports}var Cn=Q6();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var l0={};l0.version="0.18.5";var kv=1252,J6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Fv=function(t){J6.indexOf(t)!=-1&&(kv=t)};function t5(){Fv(1252)}var Wo=function(t){Fv(t)};function e5(){Wo(1200),t5()}var Nf=function(n){return String.fromCharCode(n)},Ey=function(n){return String.fromCharCode(n)},o0,Fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qo(t){for(var n="",r=0,i=0,l=0,c=0,f=0,d=0,p=0,h=0;h<t.length;)r=t.charCodeAt(h++),c=r>>2,i=t.charCodeAt(h++),f=(r&3)<<4|i>>4,l=t.charCodeAt(h++),d=(i&15)<<2|l>>6,p=l&63,isNaN(i)?d=p=64:isNaN(l)&&(p=64),n+=Fi.charAt(c)+Fi.charAt(f)+Fi.charAt(d)+Fi.charAt(p);return n}function ei(t){var n="",r=0,i=0,l=0,c=0,f=0,d=0,p=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)c=Fi.indexOf(t.charAt(h++)),f=Fi.indexOf(t.charAt(h++)),r=c<<2|f>>4,n+=String.fromCharCode(r),d=Fi.indexOf(t.charAt(h++)),i=(f&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(i)),p=Fi.indexOf(t.charAt(h++)),l=(d&3)<<6|p,p!==64&&(n+=String.fromCharCode(l));return n}var Xe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ri=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,r){return r?new Buffer(n,r):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function cs(t){return Xe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ty(t){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var oa=function(n){return Xe?ri(n,"binary"):n.split("").map(function(r){return r.charCodeAt(0)&255})};function C0(t){if(typeof ArrayBuffer>"u")return oa(t);for(var n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0;i!=t.length;++i)r[i]=t.charCodeAt(i)&255;return n}function lc(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var n=[],r=0;r<t.length;++r)n[r]=String.fromCharCode(t[r]);return n.join("")}function n5(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var nr=Xe?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:ri(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,r=0;for(n=0;n<t.length;++n)r+=t[n].length;var i=new Uint8Array(r),l=0;for(n=0,r=0;n<t.length;r+=l,++n)if(l=t[n].length,t[n]instanceof Uint8Array)i.set(t[n],r);else{if(typeof t[n]=="string")throw"wtf";i.set(new Uint8Array(t[n]),r)}return i}return[].concat.apply([],t.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function r5(t){for(var n=[],r=0,i=t.length+250,l=cs(t.length+255),c=0;c<t.length;++c){var f=t.charCodeAt(c);if(f<128)l[r++]=f;else if(f<2048)l[r++]=192|f>>6&31,l[r++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var d=t.charCodeAt(++c)&1023;l[r++]=240|f>>8&7,l[r++]=128|f>>2&63,l[r++]=128|d>>6&15|(f&3)<<4,l[r++]=128|d&63}else l[r++]=224|f>>12&15,l[r++]=128|f>>6&63,l[r++]=128|f&63;r>i&&(n.push(l.slice(0,r)),r=0,l=cs(65535),i=65530)}return n.push(l.slice(0,r)),nr(n)}var Bo=/\u0000/g,kf=/[\u0001-\u0006]/g;function hl(t){for(var n="",r=t.length-1;r>=0;)n+=t.charAt(r--);return n}function ca(t,n){var r=""+t;return r.length>=n?r:Tn("0",n-r.length)+r}function mp(t,n){var r=""+t;return r.length>=n?r:Tn(" ",n-r.length)+r}function c0(t,n){var r=""+t;return r.length>=n?r:r+Tn(" ",n-r.length)}function a5(t,n){var r=""+Math.round(t);return r.length>=n?r:Tn("0",n-r.length)+r}function i5(t,n){var r=""+t;return r.length>=n?r:Tn("0",n-r.length)+r}var Ay=Math.pow(2,32);function al(t,n){if(t>Ay||t<-Ay)return a5(t,n);var r=Math.round(t);return i5(r,n)}function f0(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var Dy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s5(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Dn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ny={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},l5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function u0(t,n,r){for(var i=t<0?-1:1,l=t*i,c=0,f=1,d=0,p=1,h=0,m=0,y=Math.floor(l);h<n&&(y=Math.floor(l),d=y*f+c,m=y*h+p,!(l-y<5e-8));)l=1/(l-y),c=f,f=d,p=h,h=m;if(m>n&&(h>n?(m=p,d=c):(m=h,d=f)),!r)return[0,i*d,m];var v=Math.floor(i*d/m);return[v,i*d-v*m,m]}function Ff(t,n,r){if(t>2958465||t<0)return null;var i=t|0,l=Math.floor(86400*(t-i)),c=0,f=[],d={D:i,T:l,u:86400*(t-i)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(i+=1462),d.u>.9999&&(d.u=0,++l==86400&&(d.T=l=0,++i,++d.D)),i===60)f=r?[1317,10,29]:[1900,2,29],c=3;else if(i===0)f=r?[1317,8,29]:[1900,1,0],c=6;else{i>60&&--i;var p=new Date(1900,0,1);p.setDate(p.getDate()+i-1),f=[p.getFullYear(),p.getMonth()+1,p.getDate()],c=p.getDay(),i<60&&(c=(c+6)%7),r&&(c=p5(p,f))}return d.y=f[0],d.m=f[1],d.d=f[2],d.S=l%60,l=Math.floor(l/60),d.M=l%60,l=Math.floor(l/60),d.H=l,d.q=c,d}var Cv=new Date(1899,11,31,0,0,0),o5=Cv.getTime(),c5=new Date(1900,2,1,0,0,0);function Rv(t,n){var r=t.getTime();return n?r-=1461*24*60*60*1e3:t>=c5&&(r+=24*60*60*1e3),(r-(o5+(t.getTimezoneOffset()-Cv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function gp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function f5(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function u5(t){var n=t<0?12:11,r=gp(t.toFixed(12));return r.length<=n||(r=t.toPrecision(10),r.length<=n)?r:t.toExponential(5)}function h5(t){var n=gp(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function d5(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return n>=-4&&n<=-1?r=t.toPrecision(10+n):Math.abs(n)<=9?r=u5(t):n===10?r=t.toFixed(10).substr(0,12):r=h5(t),gp(f5(r.toUpperCase()))}function Vd(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):d5(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ri(14,Rv(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function p5(t,n){n[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function x5(t,n,r,i){var l="",c=0,f=0,d=r.y,p,h=0;switch(t){case 98:d=r.y+543;case 121:switch(n.length){case 1:case 2:p=d%100,h=2;break;default:p=d%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:p=r.m,h=n.length;break;case 3:return gd[r.m-1][1];case 5:return gd[r.m-1][0];default:return gd[r.m-1][2]}break;case 100:switch(n.length){case 1:case 2:p=r.d,h=n.length;break;case 3:return Dy[r.q][0];default:return Dy[r.q][1]}break;case 104:switch(n.length){case 1:case 2:p=1+(r.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:p=r.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:p=r.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return r.u===0&&(n=="s"||n=="ss")?ca(r.S,n.length):(i>=2?f=i===3?1e3:100:f=i===1?10:1,c=Math.round(f*(r.S+r.u)),c>=60*f&&(c=0),n==="s"?c===0?"0":""+c/f:(l=ca(c,2+i),n==="ss"?l.substr(0,2):"."+l.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":p=r.D*24+r.H;break;case"[m]":case"[mm]":p=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":p=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:p=d,h=1;break}var m=h>0?ca(p,h):"";return m}function Ci(t){var n=3;if(t.length<=n)return t;for(var r=t.length%n,i=t.substr(0,r);r!=t.length;r+=n)i+=(i.length>0?",":"")+t.substr(r,n);return i}var Mv=/%/g;function m5(t,n,r){var i=n.replace(Mv,""),l=n.length-i.length;return Ka(t,i,r*Math.pow(10,2*l))+Tn("%",l)}function g5(t,n,r){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Ka(t,n.substr(0,i),r/Math.pow(10,3*(n.length-i)))}function Ov(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Ov(t,-n);var l=t.indexOf(".");l===-1&&(l=t.indexOf("E"));var c=Math.floor(Math.log(n)*Math.LOG10E)%l;if(c<0&&(c+=l),r=(n/Math.pow(10,c)).toPrecision(i+1+(l+c)%l),r.indexOf("e")===-1){var f=Math.floor(Math.log(n)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(f-r.length+c):r+="E+"+(f-c);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,l)+"."+r.substr(2+l),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,p,h,m){return p+h+m.substr(0,(l+c)%l)+"."+m.substr(c)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var zv=/# (\?+)( ?)\/( ?)(\d+)/;function y5(t,n,r){var i=parseInt(t[4],10),l=Math.round(n*i),c=Math.floor(l/i),f=l-c*i,d=i;return r+(c===0?"":""+c)+" "+(f===0?Tn(" ",t[1].length+1+t[4].length):mp(f,t[1].length)+t[2]+"/"+t[3]+ca(d,t[4].length))}function v5(t,n,r){return r+(n===0?"":""+n)+Tn(" ",t[1].length+2+t[4].length)}var Lv=/^#*0*\.([0#]+)/,Bv=/\).*[0#]/,jv=/\(###\) ###\\?-####/;function mr(t){for(var n="",r,i=0;i!=t.length;++i)switch(r=t.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(r)}return n}function ky(t,n){var r=Math.pow(10,n);return""+Math.round(t*r)/r}function Fy(t,n){var r=t-Math.floor(t),i=Math.pow(10,n);return n<(""+Math.round(r*i)).length?0:Math.round(r*i)}function _5(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function b5(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Kr(t,n,r){if(t.charCodeAt(0)===40&&!n.match(Bv)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Kr("n",i,r):"("+Kr("n",i,-r)+")"}if(n.charCodeAt(n.length-1)===44)return g5(t,n,r);if(n.indexOf("%")!==-1)return m5(t,n,r);if(n.indexOf("E")!==-1)return Ov(n,r);if(n.charCodeAt(0)===36)return"$"+Kr(t,n.substr(n.charAt(1)==" "?2:1),r);var l,c,f,d,p=Math.abs(r),h=r<0?"-":"";if(n.match(/^00+$/))return h+al(p,n.length);if(n.match(/^[#?]+$/))return l=al(r,0),l==="0"&&(l=""),l.length>n.length?l:mr(n.substr(0,n.length-l.length))+l;if(c=n.match(zv))return y5(c,p,h);if(n.match(/^#+0+$/))return h+al(p,n.length-n.indexOf("0"));if(c=n.match(Lv))return l=ky(r,c[1].length).replace(/^([^\.]+)$/,"$1."+mr(c[1])).replace(/\.$/,"."+mr(c[1])).replace(/\.(\d*)$/,function(S,b){return"."+b+Tn("0",mr(c[1]).length-b.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),c=n.match(/^(0*)\.(#*)$/))return h+ky(p,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=n.match(/^#{1,3},##0(\.?)$/))return h+Ci(al(p,0));if(c=n.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Kr(t,n,-r):Ci(""+(Math.floor(r)+_5(r,c[1].length)))+"."+ca(Fy(r,c[1].length),c[1].length);if(c=n.match(/^#,#*,#0/))return Kr(t,n.replace(/^#,#*,/,""),r);if(c=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=hl(Kr(t,n.replace(/[\\-]/g,""),r)),f=0,hl(hl(n.replace(/\\/g,"")).replace(/[0#]/g,function(S){return f<l.length?l.charAt(f++):S==="0"?"0":""}));if(n.match(jv))return l=Kr(t,"##########",r),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var m="";if(c=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),d=u0(p,Math.pow(10,f)-1,!1),l=""+h,m=Ka("n",c[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),l+=m+c[2]+"/"+c[3],m=c0(d[2],f),m.length<c[4].length&&(m=mr(c[4].substr(c[4].length-m.length))+m),l+=m,l;if(c=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),d=u0(p,Math.pow(10,f)-1,!0),h+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mp(d[1],f)+c[2]+"/"+c[3]+c0(d[2],f):Tn(" ",2*f+1+c[2].length+c[3].length));if(c=n.match(/^[#0?]+$/))return l=al(r,0),n.length<=l.length?l:mr(n.substr(0,n.length-l.length))+l;if(c=n.match(/^([#0?]+)\.([#0]+)$/)){l=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var y=n.indexOf(".")-f,v=n.length-l.length-y;return mr(n.substr(0,y)+l+n.substr(n.length-v))}if(c=n.match(/^00,000\.([#0]*0)$/))return f=Fy(r,c[1].length),r<0?"-"+Kr(t,n,-r):Ci(b5(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ca(0,3-S.length):"")+S})+"."+ca(f,c[1].length);switch(n){case"###,##0.00":return Kr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=Ci(al(p,0));return w!=="0"?h+w:"";case"###,###.00":return Kr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Kr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function w5(t,n,r){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Ka(t,n.substr(0,i),r/Math.pow(10,3*(n.length-i)))}function S5(t,n,r){var i=n.replace(Mv,""),l=n.length-i.length;return Ka(t,i,r*Math.pow(10,2*l))+Tn("%",l)}function Iv(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Iv(t,-n);var l=t.indexOf(".");l===-1&&(l=t.indexOf("E"));var c=Math.floor(Math.log(n)*Math.LOG10E)%l;if(c<0&&(c+=l),r=(n/Math.pow(10,c)).toPrecision(i+1+(l+c)%l),!r.match(/[Ee]/)){var f=Math.floor(Math.log(n)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(f-r.length+c):r+="E+"+(f-c),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,p,h,m){return p+h+m.substr(0,(l+c)%l)+"."+m.substr(c)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _a(t,n,r){if(t.charCodeAt(0)===40&&!n.match(Bv)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_a("n",i,r):"("+_a("n",i,-r)+")"}if(n.charCodeAt(n.length-1)===44)return w5(t,n,r);if(n.indexOf("%")!==-1)return S5(t,n,r);if(n.indexOf("E")!==-1)return Iv(n,r);if(n.charCodeAt(0)===36)return"$"+_a(t,n.substr(n.charAt(1)==" "?2:1),r);var l,c,f,d,p=Math.abs(r),h=r<0?"-":"";if(n.match(/^00+$/))return h+ca(p,n.length);if(n.match(/^[#?]+$/))return l=""+r,r===0&&(l=""),l.length>n.length?l:mr(n.substr(0,n.length-l.length))+l;if(c=n.match(zv))return v5(c,p,h);if(n.match(/^#+0+$/))return h+ca(p,n.length-n.indexOf("0"));if(c=n.match(Lv))return l=(""+r).replace(/^([^\.]+)$/,"$1."+mr(c[1])).replace(/\.$/,"."+mr(c[1])),l=l.replace(/\.(\d*)$/,function(S,b){return"."+b+Tn("0",mr(c[1]).length-b.length)}),n.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),c=n.match(/^(0*)\.(#*)$/))return h+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=n.match(/^#{1,3},##0(\.?)$/))return h+Ci(""+p);if(c=n.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_a(t,n,-r):Ci(""+r)+"."+Tn("0",c[1].length);if(c=n.match(/^#,#*,#0/))return _a(t,n.replace(/^#,#*,/,""),r);if(c=n.match(/^([0#]+)(\\?-([0#]+))+$/))return l=hl(_a(t,n.replace(/[\\-]/g,""),r)),f=0,hl(hl(n.replace(/\\/g,"")).replace(/[0#]/g,function(S){return f<l.length?l.charAt(f++):S==="0"?"0":""}));if(n.match(jv))return l=_a(t,"##########",r),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var m="";if(c=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),d=u0(p,Math.pow(10,f)-1,!1),l=""+h,m=Ka("n",c[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),l+=m+c[2]+"/"+c[3],m=c0(d[2],f),m.length<c[4].length&&(m=mr(c[4].substr(c[4].length-m.length))+m),l+=m,l;if(c=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),d=u0(p,Math.pow(10,f)-1,!0),h+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mp(d[1],f)+c[2]+"/"+c[3]+c0(d[2],f):Tn(" ",2*f+1+c[2].length+c[3].length));if(c=n.match(/^[#0?]+$/))return l=""+r,n.length<=l.length?l:mr(n.substr(0,n.length-l.length))+l;if(c=n.match(/^([#0]+)\.([#0]+)$/)){l=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=l.indexOf(".");var y=n.indexOf(".")-f,v=n.length-l.length-y;return mr(n.substr(0,y)+l+n.substr(n.length-v))}if(c=n.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_a(t,n,-r):Ci(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ca(0,3-S.length):"")+S})+"."+ca(0,c[1].length);switch(n){case"###,###":case"##,###":case"#,###":var w=Ci(""+p);return w!=="0"?h+w:"";default:if(n.match(/\.[0#?]*$/))return _a(t,n.slice(0,n.lastIndexOf(".")),r)+mr(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ka(t,n,r){return(r|0)===r?_a(t,n,r):Kr(t,n,r)}function E5(t){for(var n=[],r=!1,i=0,l=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:n[n.length]=t.substr(l,i-l),l=i+1}if(n[n.length]=t.substr(l),r===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var Uv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hv(t){for(var n=0,r="",i="";n<t.length;)switch(r=t.charAt(n)){case"G":f0(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(i=r;t.charAt(n++)!=="]"&&n<t.length;)i+=t.charAt(n);if(i.match(Uv))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++n))>-1||r=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===r;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function T5(t,n,r,i){for(var l=[],c="",f=0,d="",p="t",h,m,y,v="H";f<t.length;)switch(d=t.charAt(f)){case"G":if(!f0(t,f))throw new Error("unrecognized character "+d+" in "+t);l[l.length]={t:"G",v:"General"},f+=7;break;case'"':for(c="";(y=t.charCodeAt(++f))!==34&&f<t.length;)c+=String.fromCharCode(y);l[l.length]={t:"t",v:c},++f;break;case"\\":var w=t.charAt(++f),S=w==="("||w===")"?w:"t";l[l.length]={t:S,v:w},++f;break;case"_":l[l.length]={t:"t",v:" "},f+=2;break;case"@":l[l.length]={t:"T",v:n},++f;break;case"B":case"b":if(t.charAt(f+1)==="1"||t.charAt(f+1)==="2"){if(h==null&&(h=Ff(n,r,t.charAt(f+1)==="2"),h==null))return"";l[l.length]={t:"X",v:t.substr(f,2)},p=d,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=Ff(n,r),h==null))return"";for(c=d;++f<t.length&&t.charAt(f).toLowerCase()===d;)c+=d;d==="m"&&p.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=v),l[l.length]={t:d,v:c},p=d;break;case"A":case"a":case"上":var b={t:d,v:d};if(h==null&&(h=Ff(n,r)),t.substr(f,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",v="h",f+=3):t.substr(f,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",f+=5,v="h"):t.substr(f,5).toUpperCase()==="上午/下午"?(h!=null&&(b.v=h.H>=12?"下午":"上午"),b.t="T",f+=5,v="h"):(b.t="t",++f),h==null&&b.t==="T")return"";l[l.length]=b,p=d;break;case"[":for(c=d;t.charAt(f++)!=="]"&&f<t.length;)c+=t.charAt(f);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(Uv)){if(h==null&&(h=Ff(n,r),h==null))return"";l[l.length]={t:"Z",v:c.toLowerCase()},p=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hv(t)||(l[l.length]={t:"t",v:c}));break;case".":if(h!=null){for(c=d;++f<t.length&&(d=t.charAt(f))==="0";)c+=d;l[l.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++f<t.length&&"0#?.,E+-%".indexOf(d=t.charAt(f))>-1;)c+=d;l[l.length]={t:"n",v:c};break;case"?":for(c=d;t.charAt(++f)===d;)c+=d;l[l.length]={t:d,v:c},p=d;break;case"*":++f,(t.charAt(f)==" "||t.charAt(f)=="*")&&++f;break;case"(":case")":l[l.length]={t:i===1?"t":d,v:d},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;f<t.length&&"0123456789".indexOf(t.charAt(++f))>-1;)c+=t.charAt(f);l[l.length]={t:"D",v:c};break;case" ":l[l.length]={t:d,v:d},++f;break;case"$":l[l.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+t);l[l.length]={t:"t",v:d},++f;break}var E=0,A=0,O;for(f=l.length-1,p="t";f>=0;--f)switch(l[f].t){case"h":case"H":l[f].t=v,p="h",E<1&&(E=1);break;case"s":(O=l[f].v.match(/\.0+$/))&&(A=Math.max(A,O[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":p=l[f].t;break;case"m":p==="s"&&(l[f].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&l[f].v.match(/[Hh]/)&&(E=1),E<2&&l[f].v.match(/[Mm]/)&&(E=2),E<3&&l[f].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",U;for(f=0;f<l.length;++f)switch(l[f].t){case"t":case"T":case" ":case"D":break;case"X":l[f].v="",l[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[f].v=x5(l[f].t.charCodeAt(0),l[f].v,h,A),l[f].t="t";break;case"n":case"?":for(U=f+1;l[U]!=null&&((d=l[U].t)==="?"||d==="D"||(d===" "||d==="t")&&l[U+1]!=null&&(l[U+1].t==="?"||l[U+1].t==="t"&&l[U+1].v==="/")||l[f].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(l[U].v==="/"||l[U].v===" "&&l[U+1]!=null&&l[U+1].t=="?"));)l[f].v+=l[U].v,l[U]={v:"",t:";"},++U;C+=l[f].v,f=U-1;break;case"G":l[f].t="t",l[f].v=Vd(n,r);break}var B="",V,k;if(C.length>0){C.charCodeAt(0)==40?(V=n<0&&C.charCodeAt(0)===45?-n:n,k=Ka("n",C,V)):(V=n<0&&i>1?-n:n,k=Ka("n",C,V),V<0&&l[0]&&l[0].t=="t"&&(k=k.substr(1),l[0].v="-"+l[0].v)),U=k.length-1;var F=l.length;for(f=0;f<l.length;++f)if(l[f]!=null&&l[f].t!="t"&&l[f].v.indexOf(".")>-1){F=f;break}var T=l.length;if(F===l.length&&k.indexOf("E")===-1){for(f=l.length-1;f>=0;--f)l[f]==null||"n?".indexOf(l[f].t)===-1||(U>=l[f].v.length-1?(U-=l[f].v.length,l[f].v=k.substr(U+1,l[f].v.length)):U<0?l[f].v="":(l[f].v=k.substr(0,U+1),U=-1),l[f].t="t",T=f);U>=0&&T<l.length&&(l[T].v=k.substr(0,U+1)+l[T].v)}else if(F!==l.length&&k.indexOf("E")===-1){for(U=k.indexOf(".")-1,f=F;f>=0;--f)if(!(l[f]==null||"n?".indexOf(l[f].t)===-1)){for(m=l[f].v.indexOf(".")>-1&&f===F?l[f].v.indexOf(".")-1:l[f].v.length-1,B=l[f].v.substr(m+1);m>=0;--m)U>=0&&(l[f].v.charAt(m)==="0"||l[f].v.charAt(m)==="#")&&(B=k.charAt(U--)+B);l[f].v=B,l[f].t="t",T=f}for(U>=0&&T<l.length&&(l[T].v=k.substr(0,U+1)+l[T].v),U=k.indexOf(".")+1,f=F;f<l.length;++f)if(!(l[f]==null||"n?(".indexOf(l[f].t)===-1&&f!==F)){for(m=l[f].v.indexOf(".")>-1&&f===F?l[f].v.indexOf(".")+1:0,B=l[f].v.substr(0,m);m<l[f].v.length;++m)U<k.length&&(B+=k.charAt(U++));l[f].v=B,l[f].t="t",T=f}}}for(f=0;f<l.length;++f)l[f]!=null&&"n?".indexOf(l[f].t)>-1&&(V=i>1&&n<0&&f>0&&l[f-1].v==="-"?-n:n,l[f].v=Ka(l[f].t,l[f].v,V),l[f].t="t");var N="";for(f=0;f!==l.length;++f)l[f]!=null&&(N+=l[f].v);return N}var Cy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ry(t,n){if(n==null)return!1;var r=parseFloat(n[2]);switch(n[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function A5(t,n){var r=E5(t),i=r.length,l=r[i-1].indexOf("@");if(i<4&&l>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof n!="number")return[4,r.length===4||l>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=l>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=l>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=l>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var c=n>0?r[0]:n<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[i,c];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var f=r[0].match(Cy),d=r[1].match(Cy);return Ry(n,f)?[i,r[0]]:Ry(n,d)?[i,r[1]]:[i,r[f!=null&&d!=null?2:1]]}return[i,c]}function Ri(t,n,r){r==null&&(r={});var i="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?i=r.dateNF:i=t;break;case"number":t==14&&r.dateNF?i=r.dateNF:i=(r.table!=null?r.table:Dn)[t],i==null&&(i=r.table&&r.table[Ny[t]]||Dn[Ny[t]]),i==null&&(i=l5[t]||"General");break}if(f0(i,0))return Vd(n,r);n instanceof Date&&(n=Rv(n,r.date1904));var l=A5(i,n);if(f0(l[1]))return Vd(n,r);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return T5(l[1],n,r,l[0])}function $v(t,n){if(typeof n!="number"){n=+n||-1;for(var r=0;r<392;++r){if(Dn[r]==null){n<0&&(n=r);continue}if(Dn[r]==t){n=r;break}}n<0&&(n=391)}return Dn[n]=t,n}function R0(t){for(var n=0;n!=392;++n)t[n]!==void 0&&$v(t[n],n)}function M0(){Dn=s5()}var Gv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function D5(t){var n=typeof t=="number"?Dn[t]:t;return n=n.replace(Gv,"(\\d+)"),new RegExp("^"+n+"$")}function N5(t,n,r){var i=-1,l=-1,c=-1,f=-1,d=-1,p=-1;(n.match(Gv)||[]).forEach(function(y,v){var w=parseInt(r[v+1],10);switch(y.toLowerCase().charAt(0)){case"y":i=w;break;case"d":c=w;break;case"h":f=w;break;case"s":p=w;break;case"m":f>=0?d=w:l=w;break}}),p>=0&&d==-1&&l>=0&&(d=l,l=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(l>=1?l:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return f==-1&&d==-1&&p==-1?h:i==-1&&l==-1&&c==-1?m:h+"T"+m}var k5=function(){var t={};t.version="1.2.0";function n(){for(var k=0,F=new Array(256),T=0;T!=256;++T)k=T,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[T]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var r=n();function i(k){var F=0,T=0,N=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)D[N]=k[N];for(N=0;N!=256;++N)for(T=k[N],F=256+N;F<4096;F+=256)T=D[F]=T>>>8^k[T&255];var L=[];for(N=1;N!=16;++N)L[N-1]=typeof Int32Array<"u"?D.subarray(N*256,N*256+256):D.slice(N*256,N*256+256);return L}var l=i(r),c=l[0],f=l[1],d=l[2],p=l[3],h=l[4],m=l[5],y=l[6],v=l[7],w=l[8],S=l[9],b=l[10],E=l[11],A=l[12],O=l[13],C=l[14];function U(k,F){for(var T=F^-1,N=0,D=k.length;N<D;)T=T>>>8^r[(T^k.charCodeAt(N++))&255];return~T}function B(k,F){for(var T=F^-1,N=k.length-15,D=0;D<N;)T=C[k[D++]^T&255]^O[k[D++]^T>>8&255]^A[k[D++]^T>>16&255]^E[k[D++]^T>>>24]^b[k[D++]]^S[k[D++]]^w[k[D++]]^v[k[D++]]^y[k[D++]]^m[k[D++]]^h[k[D++]]^p[k[D++]]^d[k[D++]]^f[k[D++]]^c[k[D++]]^r[k[D++]];for(N+=15;D<N;)T=T>>>8^r[(T^k[D++])&255];return~T}function V(k,F){for(var T=F^-1,N=0,D=k.length,L=0,K=0;N<D;)L=k.charCodeAt(N++),L<128?T=T>>>8^r[(T^L)&255]:L<2048?(T=T>>>8^r[(T^(192|L>>6&31))&255],T=T>>>8^r[(T^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,K=k.charCodeAt(N++)&1023,T=T>>>8^r[(T^(240|L>>8&7))&255],T=T>>>8^r[(T^(128|L>>2&63))&255],T=T>>>8^r[(T^(128|K>>6&15|(L&3)<<4))&255],T=T>>>8^r[(T^(128|K&63))&255]):(T=T>>>8^r[(T^(224|L>>12&15))&255],T=T>>>8^r[(T^(128|L>>6&63))&255],T=T>>>8^r[(T^(128|L&63))&255]);return~T}return t.table=r,t.bstr=U,t.buf=B,t.str=V,t}(),cn=function(){var n={};n.version="1.2.1";function r(H,it){for(var Q=H.split("/"),et=it.split("/"),at=0,ot=0,Lt=Math.min(Q.length,et.length);at<Lt;++at){if(ot=Q[at].length-et[at].length)return ot;if(Q[at]!=et[at])return Q[at]<et[at]?-1:1}return Q.length-et.length}function i(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:i(H.slice(0,-1));var it=H.lastIndexOf("/");return it===-1?H:H.slice(0,it+1)}function l(H){if(H.charAt(H.length-1)=="/")return l(H.slice(0,-1));var it=H.lastIndexOf("/");return it===-1?H:H.slice(it+1)}function c(H,it){typeof it=="string"&&(it=new Date(it));var Q=it.getHours();Q=Q<<6|it.getMinutes(),Q=Q<<5|it.getSeconds()>>>1,H.write_shift(2,Q);var et=it.getFullYear()-1980;et=et<<4|it.getMonth()+1,et=et<<5|it.getDate(),H.write_shift(2,et)}function f(H){var it=H.read_shift(2)&65535,Q=H.read_shift(2)&65535,et=new Date,at=Q&31;Q>>>=5;var ot=Q&15;Q>>>=4,et.setMilliseconds(0),et.setFullYear(Q+1980),et.setMonth(ot-1),et.setDate(at);var Lt=it&31;it>>>=5;var Vt=it&63;return it>>>=6,et.setHours(it),et.setMinutes(Vt),et.setSeconds(Lt<<1),et}function d(H){zr(H,0);for(var it={},Q=0;H.l<=H.length-4;){var et=H.read_shift(2),at=H.read_shift(2),ot=H.l+at,Lt={};switch(et){case 21589:Q=H.read_shift(1),Q&1&&(Lt.mtime=H.read_shift(4)),at>5&&(Q&2&&(Lt.atime=H.read_shift(4)),Q&4&&(Lt.ctime=H.read_shift(4))),Lt.mtime&&(Lt.mt=new Date(Lt.mtime*1e3));break}H.l=ot,it[et]=Lt}return it}var p;function h(){return p||(p={})}function m(H,it){if(H[0]==80&&H[1]==75)return Tt(H,it);if((H[0]|32)==109&&(H[1]|32)==105)return $n(H,it);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var Q=3,et=512,at=0,ot=0,Lt=0,Vt=0,kt=0,jt=[],Ht=H.slice(0,512);zr(Ht,0);var re=y(Ht);switch(Q=re[0],Q){case 3:et=512;break;case 4:et=4096;break;case 0:if(re[1]==0)return Tt(H,it);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}et!==512&&(Ht=H.slice(0,et),zr(Ht,28));var le=H.slice(0,et);v(Ht,Q);var me=Ht.read_shift(4,"i");if(Q===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);Ht.l+=4,Lt=Ht.read_shift(4,"i"),Ht.l+=4,Ht.chk("00100000","Mini Stream Cutoff Size: "),Vt=Ht.read_shift(4,"i"),at=Ht.read_shift(4,"i"),kt=Ht.read_shift(4,"i"),ot=Ht.read_shift(4,"i");for(var se=-1,de=0;de<109&&(se=Ht.read_shift(4,"i"),!(se<0));++de)jt[de]=se;var Fe=w(H,et);E(kt,ot,Fe,et,jt);var rn=O(Fe,Lt,jt,et);rn[Lt].name="!Directory",at>0&&Vt!==K&&(rn[Vt].name="!MiniFAT"),rn[jt[0]].name="!FAT",rn.fat_addrs=jt,rn.ssz=et;var an={},hn=[],Ca=[],ai=[];C(Lt,rn,Fe,hn,at,an,Ca,Vt),S(Ca,ai,hn),hn.shift();var Ur={FileIndex:Ca,FullPaths:ai};return it&&it.raw&&(Ur.raw={header:le,sectors:Fe}),Ur}function y(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(ft,"Header Signature: "),H.l+=16;var it=H.read_shift(2,"u");return[H.read_shift(2,"u"),it]}function v(H,it){var Q=9;switch(H.l+=2,Q=H.read_shift(2)){case 9:if(it!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(it!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function w(H,it){for(var Q=Math.ceil(H.length/it)-1,et=[],at=1;at<Q;++at)et[at-1]=H.slice(at*it,(at+1)*it);return et[Q-1]=H.slice(Q*it),et}function S(H,it,Q){for(var et=0,at=0,ot=0,Lt=0,Vt=0,kt=Q.length,jt=[],Ht=[];et<kt;++et)jt[et]=Ht[et]=et,it[et]=Q[et];for(;Vt<Ht.length;++Vt)et=Ht[Vt],at=H[et].L,ot=H[et].R,Lt=H[et].C,jt[et]===et&&(at!==-1&&jt[at]!==at&&(jt[et]=jt[at]),ot!==-1&&jt[ot]!==ot&&(jt[et]=jt[ot])),Lt!==-1&&(jt[Lt]=et),at!==-1&&et!=jt[et]&&(jt[at]=jt[et],Ht.lastIndexOf(at)<Vt&&Ht.push(at)),ot!==-1&&et!=jt[et]&&(jt[ot]=jt[et],Ht.lastIndexOf(ot)<Vt&&Ht.push(ot));for(et=1;et<kt;++et)jt[et]===et&&(ot!==-1&&jt[ot]!==ot?jt[et]=jt[ot]:at!==-1&&jt[at]!==at&&(jt[et]=jt[at]));for(et=1;et<kt;++et)if(H[et].type!==0){if(Vt=et,Vt!=jt[Vt])do Vt=jt[Vt],it[et]=it[Vt]+"/"+it[et];while(Vt!==0&&jt[Vt]!==-1&&Vt!=jt[Vt]);jt[et]=-1}for(it[0]+="/",et=1;et<kt;++et)H[et].type!==2&&(it[et]+="/")}function b(H,it,Q){for(var et=H.start,at=H.size,ot=[],Lt=et;Q&&at>0&&Lt>=0;)ot.push(it.slice(Lt*L,Lt*L+L)),at-=L,Lt=es(Q,Lt*4);return ot.length===0?Xt(0):nr(ot).slice(0,H.size)}function E(H,it,Q,et,at){var ot=K;if(H===K){if(it!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var Lt=Q[H],Vt=(et>>>2)-1;if(!Lt)return;for(var kt=0;kt<Vt&&(ot=es(Lt,kt*4))!==K;++kt)at.push(ot);E(es(Lt,et-4),it-1,Q,et,at)}}function A(H,it,Q,et,at){var ot=[],Lt=[];at||(at=[]);var Vt=et-1,kt=0,jt=0;for(kt=it;kt>=0;){at[kt]=!0,ot[ot.length]=kt,Lt.push(H[kt]);var Ht=Q[Math.floor(kt*4/et)];if(jt=kt*4&Vt,et<4+jt)throw new Error("FAT boundary crossed: "+kt+" 4 "+et);if(!H[Ht])break;kt=es(H[Ht],jt)}return{nodes:ot,data:Uy([Lt])}}function O(H,it,Q,et){var at=H.length,ot=[],Lt=[],Vt=[],kt=[],jt=et-1,Ht=0,re=0,le=0,me=0;for(Ht=0;Ht<at;++Ht)if(Vt=[],le=Ht+it,le>=at&&(le-=at),!Lt[le]){kt=[];var se=[];for(re=le;re>=0;){se[re]=!0,Lt[re]=!0,Vt[Vt.length]=re,kt.push(H[re]);var de=Q[Math.floor(re*4/et)];if(me=re*4&jt,et<4+me)throw new Error("FAT boundary crossed: "+re+" 4 "+et);if(!H[de]||(re=es(H[de],me),se[re]))break}ot[le]={nodes:Vt,data:Uy([kt])}}return ot}function C(H,it,Q,et,at,ot,Lt,Vt){for(var kt=0,jt=et.length?2:0,Ht=it[H].data,re=0,le=0,me;re<Ht.length;re+=128){var se=Ht.slice(re,re+128);zr(se,64),le=se.read_shift(2),me=wp(se,0,le-jt),et.push(me);var de={name:me,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0},Fe=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);Fe!==0&&(de.ct=U(se,se.l-8));var rn=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);rn!==0&&(de.mt=U(se,se.l-8)),de.start=se.read_shift(4,"i"),de.size=se.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=K,de.name=""),de.type===5?(kt=de.start,at>0&&kt!==K&&(it[kt].name="!StreamData")):de.size>=4096?(de.storage="fat",it[de.start]===void 0&&(it[de.start]=A(Q,de.start,it.fat_addrs,it.ssz)),it[de.start].name=de.name,de.content=it[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:kt!==K&&de.start!==K&&it[kt]&&(de.content=b(de,it[kt].data,(it[Vt]||{}).data))),de.content&&zr(de.content,0),ot[me]=de,Lt.push(de)}}function U(H,it){return new Date((Br(H,it+4)/1e7*Math.pow(2,32)+Br(H,it)/1e7-11644473600)*1e3)}function B(H,it){return h(),m(p.readFileSync(H),it)}function V(H,it){var Q=it&&it.type;switch(Q||Xe&&Buffer.isBuffer(H)&&(Q="buffer"),Q||"base64"){case"file":return B(H,it);case"base64":return m(oa(ei(H)),it);case"binary":return m(oa(H),it)}return m(H,it)}function k(H,it){var Q=it||{},et=Q.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=et+"/",H.FileIndex[0]={name:et,type:5}),Q.CLSID&&(H.FileIndex[0].clsid=Q.CLSID),F(H)}function F(H){var it="Sh33tJ5";if(!cn.find(H,"/"+it)){var Q=Xt(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,H.FileIndex.push({name:it,type:2,content:Q,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+it),T(H)}}function T(H,it){k(H);for(var Q=!1,et=!1,at=H.FullPaths.length-1;at>=0;--at){var ot=H.FileIndex[at];switch(ot.type){case 0:et?Q=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:et=!0,isNaN(ot.R*ot.L*ot.C)&&(Q=!0),ot.R>-1&&ot.L>-1&&ot.R==ot.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!it)){var Lt=new Date(1987,1,19),Vt=0,kt=Object.create?Object.create(null):{},jt=[];for(at=0;at<H.FullPaths.length;++at)kt[H.FullPaths[at]]=!0,H.FileIndex[at].type!==0&&jt.push([H.FullPaths[at],H.FileIndex[at]]);for(at=0;at<jt.length;++at){var Ht=i(jt[at][0]);et=kt[Ht],et||(jt.push([Ht,{name:l(Ht).replace("/",""),type:1,clsid:J,ct:Lt,mt:Lt,content:null}]),kt[Ht]=!0)}for(jt.sort(function(me,se){return r(me[0],se[0])}),H.FullPaths=[],H.FileIndex=[],at=0;at<jt.length;++at)H.FullPaths[at]=jt[at][0],H.FileIndex[at]=jt[at][1];for(at=0;at<jt.length;++at){var re=H.FileIndex[at],le=H.FullPaths[at];if(re.name=l(le).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||J,at===0)re.C=jt.length>1?1:-1,re.size=0,re.type=5;else if(le.slice(-1)=="/"){for(Vt=at+1;Vt<jt.length&&i(H.FullPaths[Vt])!=le;++Vt);for(re.C=Vt>=jt.length?-1:Vt,Vt=at+1;Vt<jt.length&&i(H.FullPaths[Vt])!=i(le);++Vt);re.R=Vt>=jt.length?-1:Vt,re.type=1}else i(H.FullPaths[at+1]||"")==i(le)&&(re.R=at+1),re.type=2}}}function N(H,it){var Q=it||{};if(Q.fileType=="mad")return dr(H,Q);switch(T(H),Q.fileType){case"zip":return pe(H,Q)}var et=function(me){for(var se=0,de=0,Fe=0;Fe<me.FileIndex.length;++Fe){var rn=me.FileIndex[Fe];if(rn.content){var an=rn.content.length;an>0&&(an<4096?se+=an+63>>6:de+=an+511>>9)}}for(var hn=me.FullPaths.length+3>>2,Ca=se+7>>3,ai=se+127>>7,Ur=Ca+de+hn+ai,Jr=Ur+127>>7,Bi=Jr<=109?0:Math.ceil((Jr-109)/127);Ur+Jr+Bi+127>>7>Jr;)Bi=++Jr<=109?0:Math.ceil((Jr-109)/127);var ta=[1,Bi,Jr,ai,hn,de,se,0];return me.FileIndex[0].size=se<<6,ta[7]=(me.FileIndex[0].start=ta[0]+ta[1]+ta[2]+ta[3]+ta[4]+ta[5])+(ta[6]+7>>3),ta}(H),at=Xt(et[7]<<9),ot=0,Lt=0;{for(ot=0;ot<8;++ot)at.write_shift(1,dt[ot]);for(ot=0;ot<8;++ot)at.write_shift(2,0);for(at.write_shift(2,62),at.write_shift(2,3),at.write_shift(2,65534),at.write_shift(2,9),at.write_shift(2,6),ot=0;ot<3;++ot)at.write_shift(2,0);for(at.write_shift(4,0),at.write_shift(4,et[2]),at.write_shift(4,et[0]+et[1]+et[2]+et[3]-1),at.write_shift(4,0),at.write_shift(4,4096),at.write_shift(4,et[3]?et[0]+et[1]+et[2]-1:K),at.write_shift(4,et[3]),at.write_shift(-4,et[1]?et[0]-1:K),at.write_shift(4,et[1]),ot=0;ot<109;++ot)at.write_shift(-4,ot<et[2]?et[1]+ot:-1)}if(et[1])for(Lt=0;Lt<et[1];++Lt){for(;ot<236+Lt*127;++ot)at.write_shift(-4,ot<et[2]?et[1]+ot:-1);at.write_shift(-4,Lt===et[1]-1?K:Lt+1)}var Vt=function(me){for(Lt+=me;ot<Lt-1;++ot)at.write_shift(-4,ot+1);me&&(++ot,at.write_shift(-4,K))};for(Lt=ot=0,Lt+=et[1];ot<Lt;++ot)at.write_shift(-4,gt.DIFSECT);for(Lt+=et[2];ot<Lt;++ot)at.write_shift(-4,gt.FATSECT);Vt(et[3]),Vt(et[4]);for(var kt=0,jt=0,Ht=H.FileIndex[0];kt<H.FileIndex.length;++kt)Ht=H.FileIndex[kt],Ht.content&&(jt=Ht.content.length,!(jt<4096)&&(Ht.start=Lt,Vt(jt+511>>9)));for(Vt(et[6]+7>>3);at.l&511;)at.write_shift(-4,gt.ENDOFCHAIN);for(Lt=ot=0,kt=0;kt<H.FileIndex.length;++kt)Ht=H.FileIndex[kt],Ht.content&&(jt=Ht.content.length,!(!jt||jt>=4096)&&(Ht.start=Lt,Vt(jt+63>>6)));for(;at.l&511;)at.write_shift(-4,gt.ENDOFCHAIN);for(ot=0;ot<et[4]<<2;++ot){var re=H.FullPaths[ot];if(!re||re.length===0){for(kt=0;kt<17;++kt)at.write_shift(4,0);for(kt=0;kt<3;++kt)at.write_shift(4,-1);for(kt=0;kt<12;++kt)at.write_shift(4,0);continue}Ht=H.FileIndex[ot],ot===0&&(Ht.start=Ht.size?Ht.start-1:K);var le=ot===0&&Q.root||Ht.name;if(jt=2*(le.length+1),at.write_shift(64,le,"utf16le"),at.write_shift(2,jt),at.write_shift(1,Ht.type),at.write_shift(1,Ht.color),at.write_shift(-4,Ht.L),at.write_shift(-4,Ht.R),at.write_shift(-4,Ht.C),Ht.clsid)at.write_shift(16,Ht.clsid,"hex");else for(kt=0;kt<4;++kt)at.write_shift(4,0);at.write_shift(4,Ht.state||0),at.write_shift(4,0),at.write_shift(4,0),at.write_shift(4,0),at.write_shift(4,0),at.write_shift(4,Ht.start),at.write_shift(4,Ht.size),at.write_shift(4,0)}for(ot=1;ot<H.FileIndex.length;++ot)if(Ht=H.FileIndex[ot],Ht.size>=4096)if(at.l=Ht.start+1<<9,Xe&&Buffer.isBuffer(Ht.content))Ht.content.copy(at,at.l,0,Ht.size),at.l+=Ht.size+511&-512;else{for(kt=0;kt<Ht.size;++kt)at.write_shift(1,Ht.content[kt]);for(;kt&511;++kt)at.write_shift(1,0)}for(ot=1;ot<H.FileIndex.length;++ot)if(Ht=H.FileIndex[ot],Ht.size>0&&Ht.size<4096)if(Xe&&Buffer.isBuffer(Ht.content))Ht.content.copy(at,at.l,0,Ht.size),at.l+=Ht.size+63&-64;else{for(kt=0;kt<Ht.size;++kt)at.write_shift(1,Ht.content[kt]);for(;kt&63;++kt)at.write_shift(1,0)}if(Xe)at.l=at.length;else for(;at.l<at.length;)at.write_shift(1,0);return at}function D(H,it){var Q=H.FullPaths.map(function(kt){return kt.toUpperCase()}),et=Q.map(function(kt){var jt=kt.split("/");return jt[jt.length-(kt.slice(-1)=="/"?2:1)]}),at=!1;it.charCodeAt(0)===47?(at=!0,it=Q[0].slice(0,-1)+it):at=it.indexOf("/")!==-1;var ot=it.toUpperCase(),Lt=at===!0?Q.indexOf(ot):et.indexOf(ot);if(Lt!==-1)return H.FileIndex[Lt];var Vt=!ot.match(kf);for(ot=ot.replace(Bo,""),Vt&&(ot=ot.replace(kf,"!")),Lt=0;Lt<Q.length;++Lt)if((Vt?Q[Lt].replace(kf,"!"):Q[Lt]).replace(Bo,"")==ot||(Vt?et[Lt].replace(kf,"!"):et[Lt]).replace(Bo,"")==ot)return H.FileIndex[Lt];return null}var L=64,K=-2,ft="d0cf11e0a1b11ae1",dt=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",gt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ft,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function wt(H,it,Q){h();var et=N(H,Q);p.writeFileSync(it,et)}function bt(H){for(var it=new Array(H.length),Q=0;Q<H.length;++Q)it[Q]=String.fromCharCode(H[Q]);return it.join("")}function P(H,it){var Q=N(H,it);switch(it&&it.type||"buffer"){case"file":return h(),p.writeFileSync(it.filename,Q),Q;case"binary":return typeof Q=="string"?Q:bt(Q);case"base64":return qo(typeof Q=="string"?Q:bt(Q));case"buffer":if(Xe)return Buffer.isBuffer(Q)?Q:ri(Q);case"array":return typeof Q=="string"?oa(Q):Q}return Q}var I;function R(H){try{var it=H.InflateRaw,Q=new it;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)I=H;else throw new Error("zlib does not expose bytesRead")}catch(et){console.error("cannot use native zlib: "+(et.message||et))}}function Y(H,it){if(!I)return At(H,it);var Q=I.InflateRaw,et=new Q,at=et._processChunk(H.slice(H.l),et._finishFlushFlag);return H.l+=et.bytesRead,at}function z(H){return I?I.deflateRawSync(H):st(H)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],nt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function j(H){var it=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(it>>16|it>>8|it)&255}for(var q=typeof Uint8Array<"u",lt=q?new Uint8Array(256):[],Ct=0;Ct<256;++Ct)lt[Ct]=j(Ct);function vt(H,it){var Q=lt[H&255];return it<=8?Q>>>8-it:(Q=Q<<8|lt[H>>8&255],it<=16?Q>>>16-it:(Q=Q<<8|lt[H>>16&255],Q>>>24-it))}function Zt(H,it){var Q=it&7,et=it>>>3;return(H[et]|(Q<=6?0:H[et+1]<<8))>>>Q&3}function Gt(H,it){var Q=it&7,et=it>>>3;return(H[et]|(Q<=5?0:H[et+1]<<8))>>>Q&7}function Kt(H,it){var Q=it&7,et=it>>>3;return(H[et]|(Q<=4?0:H[et+1]<<8))>>>Q&15}function Yt(H,it){var Q=it&7,et=it>>>3;return(H[et]|(Q<=3?0:H[et+1]<<8))>>>Q&31}function Et(H,it){var Q=it&7,et=it>>>3;return(H[et]|(Q<=1?0:H[et+1]<<8))>>>Q&127}function Mt(H,it,Q){var et=it&7,at=it>>>3,ot=(1<<Q)-1,Lt=H[at]>>>et;return Q<8-et||(Lt|=H[at+1]<<8-et,Q<16-et)||(Lt|=H[at+2]<<16-et,Q<24-et)||(Lt|=H[at+3]<<24-et),Lt&ot}function Ot(H,it,Q){var et=it&7,at=it>>>3;return et<=5?H[at]|=(Q&7)<<et:(H[at]|=Q<<et&255,H[at+1]=(Q&7)>>8-et),it+3}function Dt(H,it,Q){var et=it&7,at=it>>>3;return Q=(Q&1)<<et,H[at]|=Q,it+1}function ie(H,it,Q){var et=it&7,at=it>>>3;return Q<<=et,H[at]|=Q&255,Q>>>=8,H[at+1]=Q,it+8}function xe(H,it,Q){var et=it&7,at=it>>>3;return Q<<=et,H[at]|=Q&255,Q>>>=8,H[at+1]=Q&255,H[at+2]=Q>>>8,it+16}function ue(H,it){var Q=H.length,et=2*Q>it?2*Q:it+5,at=0;if(Q>=it)return H;if(Xe){var ot=Ty(et);if(H.copy)H.copy(ot);else for(;at<H.length;++at)ot[at]=H[at];return ot}else if(q){var Lt=new Uint8Array(et);if(Lt.set)Lt.set(H);else for(;at<Q;++at)Lt[at]=H[at];return Lt}return H.length=et,H}function ge(H){for(var it=new Array(H),Q=0;Q<H;++Q)it[Q]=0;return it}function ut(H,it,Q){var et=1,at=0,ot=0,Lt=0,Vt=0,kt=H.length,jt=q?new Uint16Array(32):ge(32);for(ot=0;ot<32;++ot)jt[ot]=0;for(ot=kt;ot<Q;++ot)H[ot]=0;kt=H.length;var Ht=q?new Uint16Array(kt):ge(kt);for(ot=0;ot<kt;++ot)jt[at=H[ot]]++,et<at&&(et=at),Ht[ot]=0;for(jt[0]=0,ot=1;ot<=et;++ot)jt[ot+16]=Vt=Vt+jt[ot-1]<<1;for(ot=0;ot<kt;++ot)Vt=H[ot],Vt!=0&&(Ht[ot]=jt[Vt+16]++);var re=0;for(ot=0;ot<kt;++ot)if(re=H[ot],re!=0)for(Vt=vt(Ht[ot],et)>>et-re,Lt=(1<<et+4-re)-1;Lt>=0;--Lt)it[Vt|Lt<<re]=re&15|ot<<4;return et}var rt=q?new Uint16Array(512):ge(512),ct=q?new Uint16Array(32):ge(32);if(!q){for(var pt=0;pt<512;++pt)rt[pt]=0;for(pt=0;pt<32;++pt)ct[pt]=0}(function(){for(var H=[],it=0;it<32;it++)H.push(5);ut(H,ct,32);var Q=[];for(it=0;it<=143;it++)Q.push(8);for(;it<=255;it++)Q.push(9);for(;it<=279;it++)Q.push(7);for(;it<=287;it++)Q.push(8);ut(Q,rt,288)})();var G=function(){for(var it=q?new Uint8Array(32768):[],Q=0,et=0;Q<nt.length-1;++Q)for(;et<nt[Q+1];++et)it[et]=Q;for(;et<32768;++et)it[et]=29;var at=q?new Uint8Array(259):[];for(Q=0,et=0;Q<tt.length-1;++Q)for(;et<tt[Q+1];++et)at[et]=Q;function ot(Vt,kt){for(var jt=0;jt<Vt.length;){var Ht=Math.min(65535,Vt.length-jt),re=jt+Ht==Vt.length;for(kt.write_shift(1,+re),kt.write_shift(2,Ht),kt.write_shift(2,~Ht&65535);Ht-- >0;)kt[kt.l++]=Vt[jt++]}return kt.l}function Lt(Vt,kt){for(var jt=0,Ht=0,re=q?new Uint16Array(32768):[];Ht<Vt.length;){var le=Math.min(65535,Vt.length-Ht);if(le<10){for(jt=Ot(kt,jt,+(Ht+le==Vt.length)),jt&7&&(jt+=8-(jt&7)),kt.l=jt/8|0,kt.write_shift(2,le),kt.write_shift(2,~le&65535);le-- >0;)kt[kt.l++]=Vt[Ht++];jt=kt.l*8;continue}jt=Ot(kt,jt,+(Ht+le==Vt.length)+2);for(var me=0;le-- >0;){var se=Vt[Ht];me=(me<<5^se)&32767;var de=-1,Fe=0;if((de=re[me])&&(de|=Ht&-32768,de>Ht&&(de-=32768),de<Ht))for(;Vt[de+Fe]==Vt[Ht+Fe]&&Fe<250;)++Fe;if(Fe>2){se=at[Fe],se<=22?jt=ie(kt,jt,lt[se+1]>>1)-1:(ie(kt,jt,3),jt+=5,ie(kt,jt,lt[se-23]>>5),jt+=3);var rn=se<8?0:se-4>>2;rn>0&&(xe(kt,jt,Fe-tt[se]),jt+=rn),se=it[Ht-de],jt=ie(kt,jt,lt[se]>>3),jt-=3;var an=se<4?0:se-2>>1;an>0&&(xe(kt,jt,Ht-de-nt[se]),jt+=an);for(var hn=0;hn<Fe;++hn)re[me]=Ht&32767,me=(me<<5^Vt[Ht])&32767,++Ht;le-=Fe-1}else se<=143?se=se+48:jt=Dt(kt,jt,1),jt=ie(kt,jt,lt[se]),re[me]=Ht&32767,++Ht}jt=ie(kt,jt,0)-1}return kt.l=(jt+7)/8|0,kt.l}return function(kt,jt){return kt.length<8?ot(kt,jt):Lt(kt,jt)}}();function st(H){var it=Xt(50+Math.floor(H.length*1.1)),Q=G(H,it);return it.slice(0,Q)}var St=q?new Uint16Array(32768):ge(32768),xt=q?new Uint16Array(32768):ge(32768),mt=q?new Uint16Array(128):ge(128),yt=1,Ut=1;function te(H,it){var Q=Yt(H,it)+257;it+=5;var et=Yt(H,it)+1;it+=5;var at=Kt(H,it)+4;it+=4;for(var ot=0,Lt=q?new Uint8Array(19):ge(19),Vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],kt=1,jt=q?new Uint8Array(8):ge(8),Ht=q?new Uint8Array(8):ge(8),re=Lt.length,le=0;le<at;++le)Lt[W[le]]=ot=Gt(H,it),kt<ot&&(kt=ot),jt[ot]++,it+=3;var me=0;for(jt[0]=0,le=1;le<=kt;++le)Ht[le]=me=me+jt[le-1]<<1;for(le=0;le<re;++le)(me=Lt[le])!=0&&(Vt[le]=Ht[me]++);var se=0;for(le=0;le<re;++le)if(se=Lt[le],se!=0){me=lt[Vt[le]]>>8-se;for(var de=(1<<7-se)-1;de>=0;--de)mt[me|de<<se]=se&7|le<<3}var Fe=[];for(kt=1;Fe.length<Q+et;)switch(me=mt[Et(H,it)],it+=me&7,me>>>=3){case 16:for(ot=3+Zt(H,it),it+=2,me=Fe[Fe.length-1];ot-- >0;)Fe.push(me);break;case 17:for(ot=3+Gt(H,it),it+=3;ot-- >0;)Fe.push(0);break;case 18:for(ot=11+Et(H,it),it+=7;ot-- >0;)Fe.push(0);break;default:Fe.push(me),kt<me&&(kt=me);break}var rn=Fe.slice(0,Q),an=Fe.slice(Q);for(le=Q;le<286;++le)rn[le]=0;for(le=et;le<30;++le)an[le]=0;return yt=ut(rn,St,286),Ut=ut(an,xt,30),it}function Bt(H,it){if(H[0]==3&&!(H[1]&3))return[cs(it),2];for(var Q=0,et=0,at=Ty(it||1<<18),ot=0,Lt=at.length>>>0,Vt=0,kt=0;(et&1)==0;){if(et=Gt(H,Q),Q+=3,et>>>1)et>>1==1?(Vt=9,kt=5):(Q=te(H,Q),Vt=yt,kt=Ut);else{Q&7&&(Q+=8-(Q&7));var jt=H[Q>>>3]|H[(Q>>>3)+1]<<8;if(Q+=32,jt>0)for(!it&&Lt<ot+jt&&(at=ue(at,ot+jt),Lt=at.length);jt-- >0;)at[ot++]=H[Q>>>3],Q+=8;continue}for(;;){!it&&Lt<ot+32767&&(at=ue(at,ot+32767),Lt=at.length);var Ht=Mt(H,Q,Vt),re=et>>>1==1?rt[Ht]:St[Ht];if(Q+=re&15,re>>>=4,(re>>>8&255)===0)at[ot++]=re;else{if(re==256)break;re-=257;var le=re<8?0:re-4>>2;le>5&&(le=0);var me=ot+tt[re];le>0&&(me+=Mt(H,Q,le),Q+=le),Ht=Mt(H,Q,kt),re=et>>>1==1?ct[Ht]:xt[Ht],Q+=re&15,re>>>=4;var se=re<4?0:re-2>>1,de=nt[re];for(se>0&&(de+=Mt(H,Q,se),Q+=se),!it&&Lt<me&&(at=ue(at,me+100),Lt=at.length);ot<me;)at[ot]=at[ot-de],++ot}}}return it?[at,Q+7>>>3]:[at.slice(0,ot),Q+7>>>3]}function At(H,it){var Q=H.slice(H.l||0),et=Bt(Q,it);return H.l+=et[1],et[0]}function Pt(H,it){if(H)typeof console<"u"&&console.error(it);else throw new Error(it)}function Tt(H,it){var Q=H;zr(Q,0);var et=[],at=[],ot={FileIndex:et,FullPaths:at};k(ot,{root:it.root});for(var Lt=Q.length-4;(Q[Lt]!=80||Q[Lt+1]!=75||Q[Lt+2]!=5||Q[Lt+3]!=6)&&Lt>=0;)--Lt;Q.l=Lt+4,Q.l+=4;var Vt=Q.read_shift(2);Q.l+=6;var kt=Q.read_shift(4);for(Q.l=kt,Lt=0;Lt<Vt;++Lt){Q.l+=20;var jt=Q.read_shift(4),Ht=Q.read_shift(4),re=Q.read_shift(2),le=Q.read_shift(2),me=Q.read_shift(2);Q.l+=8;var se=Q.read_shift(4),de=d(Q.slice(Q.l+re,Q.l+re+le));Q.l+=re+le+me;var Fe=Q.l;Q.l=se+4,ae(Q,jt,Ht,ot,de),Q.l=Fe}return ot}function ae(H,it,Q,et,at){H.l+=2;var ot=H.read_shift(2),Lt=H.read_shift(2),Vt=f(H);if(ot&8257)throw new Error("Unsupported ZIP encryption");for(var kt=H.read_shift(4),jt=H.read_shift(4),Ht=H.read_shift(4),re=H.read_shift(2),le=H.read_shift(2),me="",se=0;se<re;++se)me+=String.fromCharCode(H[H.l++]);if(le){var de=d(H.slice(H.l,H.l+le));(de[21589]||{}).mt&&(Vt=de[21589].mt),((at||{})[21589]||{}).mt&&(Vt=at[21589].mt)}H.l+=le;var Fe=H.slice(H.l,H.l+jt);switch(Lt){case 8:Fe=Y(H,Ht);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Lt)}var rn=!1;ot&8&&(kt=H.read_shift(4),kt==134695760&&(kt=H.read_shift(4),rn=!0),jt=H.read_shift(4),Ht=H.read_shift(4)),jt!=it&&Pt(rn,"Bad compressed size: "+it+" != "+jt),Ht!=Q&&Pt(rn,"Bad uncompressed size: "+Q+" != "+Ht),qe(et,me,Fe,{unsafe:!0,mt:Vt})}function pe(H,it){var Q=it||{},et=[],at=[],ot=Xt(1),Lt=Q.compression?8:0,Vt=0,kt=0,jt=0,Ht=0,re=0,le=H.FullPaths[0],me=le,se=H.FileIndex[0],de=[],Fe=0;for(kt=1;kt<H.FullPaths.length;++kt)if(me=H.FullPaths[kt].slice(le.length),se=H.FileIndex[kt],!(!se.size||!se.content||me=="Sh33tJ5")){var rn=Ht,an=Xt(me.length);for(jt=0;jt<me.length;++jt)an.write_shift(1,me.charCodeAt(jt)&127);an=an.slice(0,an.l),de[re]=k5.buf(se.content,0);var hn=se.content;Lt==8&&(hn=z(hn)),ot=Xt(30),ot.write_shift(4,67324752),ot.write_shift(2,20),ot.write_shift(2,Vt),ot.write_shift(2,Lt),se.mt?c(ot,se.mt):ot.write_shift(4,0),ot.write_shift(-4,de[re]),ot.write_shift(4,hn.length),ot.write_shift(4,se.content.length),ot.write_shift(2,an.length),ot.write_shift(2,0),Ht+=ot.length,et.push(ot),Ht+=an.length,et.push(an),Ht+=hn.length,et.push(hn),ot=Xt(46),ot.write_shift(4,33639248),ot.write_shift(2,0),ot.write_shift(2,20),ot.write_shift(2,Vt),ot.write_shift(2,Lt),ot.write_shift(4,0),ot.write_shift(-4,de[re]),ot.write_shift(4,hn.length),ot.write_shift(4,se.content.length),ot.write_shift(2,an.length),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(4,0),ot.write_shift(4,rn),Fe+=ot.l,at.push(ot),Fe+=an.length,at.push(an),++re}return ot=Xt(22),ot.write_shift(4,101010256),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,re),ot.write_shift(2,re),ot.write_shift(4,Fe),ot.write_shift(4,Ht),ot.write_shift(2,0),nr([nr(et),nr(at),ot])}var be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ee(H,it){if(H.ctype)return H.ctype;var Q=H.name||"",et=Q.match(/\.([^\.]+)$/);return et&&be[et[1]]||it&&(et=(Q=it).match(/[\.\\]([^\.\\])+$/),et&&be[et[1]])?be[et[1]]:"application/octet-stream"}function Le(H){for(var it=qo(H),Q=[],et=0;et<it.length;et+=76)Q.push(it.slice(et,et+76));return Q.join(`\r
`)+`\r
`}function Ue(H){var it=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(jt){var Ht=jt.charCodeAt(0).toString(16).toUpperCase();return"="+(Ht.length==1?"0"+Ht:Ht)});it=it.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),it.charAt(0)==`
`&&(it="=0D"+it.slice(1)),it=it.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],et=it.split(`\r
`),at=0;at<et.length;++at){var ot=et[at];if(ot.length==0){Q.push("");continue}for(var Lt=0;Lt<ot.length;){var Vt=76,kt=ot.slice(Lt,Lt+Vt);kt.charAt(Vt-1)=="="?Vt--:kt.charAt(Vt-2)=="="?Vt-=2:kt.charAt(Vt-3)=="="&&(Vt-=3),kt=ot.slice(Lt,Lt+Vt),Lt+=Vt,Lt<ot.length&&(kt+="="),Q.push(kt)}}return Q.join(`\r
`)}function $e(H){for(var it=[],Q=0;Q<H.length;++Q){for(var et=H[Q];Q<=H.length&&et.charAt(et.length-1)=="=";)et=et.slice(0,et.length-1)+H[++Q];it.push(et)}for(var at=0;at<it.length;++at)it[at]=it[at].replace(/[=][0-9A-Fa-f]{2}/g,function(ot){return String.fromCharCode(parseInt(ot.slice(1),16))});return oa(it.join(`\r
`))}function pn(H,it,Q){for(var et="",at="",ot="",Lt,Vt=0;Vt<10;++Vt){var kt=it[Vt];if(!kt||kt.match(/^\s*$/))break;var jt=kt.match(/^(.*?):\s*([^\s].*)$/);if(jt)switch(jt[1].toLowerCase()){case"content-location":et=jt[2].trim();break;case"content-type":ot=jt[2].trim();break;case"content-transfer-encoding":at=jt[2].trim();break}}switch(++Vt,at.toLowerCase()){case"base64":Lt=oa(ei(it.slice(Vt).join("")));break;case"quoted-printable":Lt=$e(it.slice(Vt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+at)}var Ht=qe(H,et.slice(Q.length),Lt,{unsafe:!0});ot&&(Ht.ctype=ot)}function $n(H,it){if(bt(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=it&&it.root||"",et=(Xe&&Buffer.isBuffer(H)?H.toString("binary"):bt(H)).split(`\r
`),at=0,ot="";for(at=0;at<et.length;++at)if(ot=et[at],!!/^Content-Location:/i.test(ot)&&(ot=ot.slice(ot.indexOf("file")),Q||(Q=ot.slice(0,ot.lastIndexOf("/")+1)),ot.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ot.slice(0,Q.length)!=Q););var Lt=(et[1]||"").match(/boundary="(.*?)"/);if(!Lt)throw new Error("MAD cannot find boundary");var Vt="--"+(Lt[1]||""),kt=[],jt=[],Ht={FileIndex:kt,FullPaths:jt};k(Ht);var re,le=0;for(at=0;at<et.length;++at){var me=et[at];me!==Vt&&me!==Vt+"--"||(le++&&pn(Ht,et.slice(re,at),Q),re=at)}return Ht}function dr(H,it){var Q=it||{},et=Q.boundary||"SheetJS";et="------="+et;for(var at=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+et.slice(2)+'"',"","",""],ot=H.FullPaths[0],Lt=ot,Vt=H.FileIndex[0],kt=1;kt<H.FullPaths.length;++kt)if(Lt=H.FullPaths[kt].slice(ot.length),Vt=H.FileIndex[kt],!(!Vt.size||!Vt.content||Lt=="Sh33tJ5")){Lt=Lt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var jt=Vt.content,Ht=Xe&&Buffer.isBuffer(jt)?jt.toString("binary"):bt(jt),re=0,le=Math.min(1024,Ht.length),me=0,se=0;se<=le;++se)(me=Ht.charCodeAt(se))>=32&&me<128&&++re;var de=re>=le*4/5;at.push(et),at.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Lt),at.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),at.push("Content-Type: "+Ee(Vt,Lt)),at.push(""),at.push(de?Ue(Ht):Le(Ht))}return at.push(et+`--\r
`),at.join(`\r
`)}function xn(H){var it={};return k(it,H),it}function qe(H,it,Q,et){var at=et&&et.unsafe;at||k(H);var ot=!at&&cn.find(H,it);if(!ot){var Lt=H.FullPaths[0];it.slice(0,Lt.length)==Lt?Lt=it:(Lt.slice(-1)!="/"&&(Lt+="/"),Lt=(Lt+it).replace("//","/")),ot={name:l(it),type:2},H.FileIndex.push(ot),H.FullPaths.push(Lt),at||cn.utils.cfb_gc(H)}return ot.content=Q,ot.size=Q?Q.length:0,et&&(et.CLSID&&(ot.clsid=et.CLSID),et.mt&&(ot.mt=et.mt),et.ct&&(ot.ct=et.ct)),ot}function pr(H,it){k(H);var Q=cn.find(H,it);if(Q){for(var et=0;et<H.FileIndex.length;++et)if(H.FileIndex[et]==Q)return H.FileIndex.splice(et,1),H.FullPaths.splice(et,1),!0}return!1}function ka(H,it,Q){k(H);var et=cn.find(H,it);if(et){for(var at=0;at<H.FileIndex.length;++at)if(H.FileIndex[at]==et)return H.FileIndex[at].name=l(Q),H.FullPaths[at]=Q,!0}return!1}function Fa(H){T(H,!0)}return n.find=D,n.read=V,n.parse=m,n.write=P,n.writeFile=wt,n.utils={cfb_new:xn,cfb_add:qe,cfb_del:pr,cfb_mov:ka,cfb_gc:Fa,ReadShift:Io,CheckField:l_,prep_blob:zr,bconcat:nr,use_zlib:R,_deflateRaw:st,_inflateRaw:At,consts:gt},n}();function F5(t){return typeof t=="string"?C0(t):Array.isArray(t)?n5(t):t}function oc(t,n,r){if(typeof Deno<"u"){if(r&&typeof n=="string")switch(r){case"utf8":n=new TextEncoder(r).encode(n);break;case"binary":n=C0(n);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,n)}var i=r=="utf8"?Zo(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,t);if(typeof Blob<"u"){var l=new Blob([F5(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(l,t);if(typeof saveAs<"u")return saveAs(l,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(l);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:t,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=t,f.href=c,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(t);return d.open("w"),d.encoding="binary",Array.isArray(n)&&(n=lc(n)),d.write(n),d.close(),n}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+t)}function ir(t){for(var n=Object.keys(t),r=[],i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(t,n[i])&&r.push(n[i]);return r}function My(t,n){for(var r=[],i=ir(t),l=0;l!==i.length;++l)r[t[i[l]][n]]==null&&(r[t[i[l]][n]]=i[l]);return r}function yp(t){for(var n=[],r=ir(t),i=0;i!==r.length;++i)n[t[r[i]]]=r[i];return n}function O0(t){for(var n=[],r=ir(t),i=0;i!==r.length;++i)n[t[r[i]]]=parseInt(r[i],10);return n}function C5(t){for(var n=[],r=ir(t),i=0;i!==r.length;++i)n[t[r[i]]]==null&&(n[t[r[i]]]=[]),n[t[r[i]]].push(r[i]);return n}var h0=new Date(1899,11,30,0,0,0);function Tr(t,n){var r=t.getTime(),i=h0.getTime()+(t.getTimezoneOffset()-h0.getTimezoneOffset())*6e4;return(r-i)/(24*60*60*1e3)}var Pv=new Date,R5=h0.getTime()+(Pv.getTimezoneOffset()-h0.getTimezoneOffset())*6e4,Oy=Pv.getTimezoneOffset();function Yv(t){var n=new Date;return n.setTime(t*24*60*60*1e3+R5),n.getTimezoneOffset()!==Oy&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Oy)*6e4),n}var zy=new Date("2017-02-19T19:06:09.000Z"),Vv=isNaN(zy.getFullYear())?new Date("2/19/17"):zy,M5=Vv.getFullYear()==2017;function yr(t,n){var r=new Date(t);if(M5)return n>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):n<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Vv.getFullYear()==1917&&!isNaN(r.getFullYear())){var i=r.getFullYear();return t.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var l=t.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+l[0],+l[1]-1,+l[2],+l[3]||0,+l[4]||0,+l[5]||0);return t.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function z0(t,n){if(Xe&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(c){return r[c]||c})}catch{}for(var i=[],l=0;l!=t.length;++l)i.push(String.fromCharCode(t[l]));return i.join("")}function Ar(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Ar(t[r]));return n}function Tn(t,n){for(var r="";r.length<n;)r+=t;return r}function Za(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var r=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(n=Number(i))||(i=i.replace(/[(](.*)[)]/,function(l,c){return r=-r,c}),!isNaN(n=Number(i)))?n/r:n}var O5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ko(t){var n=new Date(t),r=new Date(NaN),i=n.getYear(),l=n.getMonth(),c=n.getDate();if(isNaN(c))return r;var f=t.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&O5.indexOf(f)==-1)return r}else if(f.match(/[a-z]/))return r;return i<0||i>8099?r:(l>0||c>1)&&i!=101?n:t.match(/[^-0-9:,\/\\]/)?r:n}function Re(t,n,r){if(t.FullPaths){if(typeof r=="string"){var i;return Xe?i=ri(r):i=r5(r),cn.utils.cfb_add(t,n,i)}cn.utils.cfb_add(t,n,r)}else t.file(n,r)}function vp(){return cn.utils.cfb_new()}var Bn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,z5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_p=yp(z5),bp=/[&<>'"]/g,L5=/[\u0000-\u0008\u000b-\u001f]/g;function tn(t){var n=t+"";return n.replace(bp,function(r){return _p[r]}).replace(L5,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ly(t){return tn(t).replace(/ /g,"_x0020_")}var Xv=/[\u0000-\u001f]/g;function B5(t){var n=t+"";return n.replace(bp,function(r){return _p[r]}).replace(/\n/g,"<br/>").replace(Xv,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function j5(t){var n=t+"";return n.replace(bp,function(r){return _p[r]}).replace(Xv,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function I5(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function U5(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yd(t){for(var n="",r=0,i=0,l=0,c=0,f=0,d=0;r<t.length;){if(i=t.charCodeAt(r++),i<128){n+=String.fromCharCode(i);continue}if(l=t.charCodeAt(r++),i>191&&i<224){f=(i&31)<<6,f|=l&63,n+=String.fromCharCode(f);continue}if(c=t.charCodeAt(r++),i<240){n+=String.fromCharCode((i&15)<<12|(l&63)<<6|c&63);continue}f=t.charCodeAt(r++),d=((i&7)<<18|(l&63)<<12|(c&63)<<6|f&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function By(t){var n=cs(2*t.length),r,i,l=1,c=0,f=0,d;for(i=0;i<t.length;i+=l)l=1,(d=t.charCodeAt(i))<128?r=d:d<224?(r=(d&31)*64+(t.charCodeAt(i+1)&63),l=2):d<240?(r=(d&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63),l=3):(l=4,r=(d&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63),r-=65536,f=55296+(r>>>10&1023),r=56320+(r&1023)),f!==0&&(n[c++]=f&255,n[c++]=f>>>8,f=0),n[c++]=r%256,n[c++]=r>>>8;return n.slice(0,c).toString("ucs2")}function jy(t){return ri(t,"binary").toString("utf8")}var Cf="foo bar bazâð£",jo=Xe&&(jy(Cf)==yd(Cf)&&jy||By(Cf)==yd(Cf)&&By)||yd,Zo=Xe?function(t){return ri(t,"utf8").toString("binary")}:function(t){for(var n=[],r=0,i=0,l=0;r<t.length;)switch(i=t.charCodeAt(r++),!0){case i<128:n.push(String.fromCharCode(i));break;case i<2048:n.push(String.fromCharCode(192+(i>>6))),n.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,l=t.charCodeAt(r++)-56320+(i<<10),n.push(String.fromCharCode(240+(l>>18&7))),n.push(String.fromCharCode(144+(l>>12&63))),n.push(String.fromCharCode(128+(l>>6&63))),n.push(String.fromCharCode(128+(l&63)));break;default:n.push(String.fromCharCode(224+(i>>12))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)))}return n.join("")},H5=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),l=0;l<t.length;++l)i=i.replace(t[l][0],t[l][1]);return i}}(),Wv=/(^\s|\s$|\n)/;function rr(t,n){return"<"+t+(n.match(Wv)?' xml:space="preserve"':"")+">"+n+"</"+t+">"}function Qo(t){return ir(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function oe(t,n,r){return"<"+t+(r!=null?Qo(r):"")+(n!=null?(n.match(Wv)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function Xd(t,n){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(n)throw r}return""}function $5(t,n){switch(typeof t){case"string":var r=oe("vt:lpwstr",tn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return oe((t|0)==t?"vt:i4":"vt:r8",tn(String(t)));case"boolean":return oe("vt:bool",t?"true":"false")}if(t instanceof Date)return oe("vt:filetime",Xd(t));throw new Error("Unable to serialize "+t)}var Xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Al=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Lr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function G5(t,n){for(var r=1-2*(t[n+7]>>>7),i=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),l=t[n+6]&15,c=5;c>=0;--c)l=l*256+t[n+c];return i==2047?l==0?r*(1/0):NaN:(i==0?i=-1022:(i-=1023,l+=Math.pow(2,52)),r*Math.pow(2,i-52)*l)}function P5(t,n,r){var i=(n<0||1/n==-1/0?1:0)<<7,l=0,c=0,f=i?-n:n;isFinite(f)?f==0?l=c=0:(l=Math.floor(Math.log(f)/Math.LN2),c=f*Math.pow(2,52-l),l<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?l=-1022:(c-=Math.pow(2,52),l+=1023)):(l=2047,c=isNaN(n)?26985:0);for(var d=0;d<=5;++d,c/=256)t[r+d]=c&255;t[r+6]=(l&15)<<4|c&15,t[r+7]=l>>4|i}var Iy=function(t){for(var n=[],r=10240,i=0;i<t[0].length;++i)if(t[0][i])for(var l=0,c=t[0][i].length;l<c;l+=r)n.push.apply(n,t[0][i].slice(l,l+r));return n},Uy=Xe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:ri(n)})):Iy(t)}:Iy,Hy=function(t,n,r){for(var i=[],l=n;l<r;l+=2)i.push(String.fromCharCode(Lo(t,l)));return i.join("").replace(Bo,"")},wp=Xe?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf16le",n,r).replace(Bo,""):Hy(t,n,r)}:Hy,$y=function(t,n,r){for(var i=[],l=n;l<n+r;++l)i.push(("0"+t[l].toString(16)).slice(-2));return i.join("")},qv=Xe?function(t,n,r){return Buffer.isBuffer(t)?t.toString("hex",n,n+r):$y(t,n,r)}:$y,Gy=function(t,n,r){for(var i=[],l=n;l<r;l++)i.push(String.fromCharCode(ll(t,l)));return i.join("")},cc=Xe?function(n,r,i){return Buffer.isBuffer(n)?n.toString("utf8",r,i):Gy(n,r,i)}:Gy,Kv=function(t,n){var r=Br(t,n);return r>0?cc(t,n+4,n+4+r-1):""},Zv=Kv,Qv=function(t,n){var r=Br(t,n);return r>0?cc(t,n+4,n+4+r-1):""},Jv=Qv,t_=function(t,n){var r=2*Br(t,n);return r>0?cc(t,n+4,n+4+r-1):""},e_=t_,n_=function(n,r){var i=Br(n,r);return i>0?wp(n,r+4,r+4+i):""},r_=n_,a_=function(t,n){var r=Br(t,n);return r>0?cc(t,n+4,n+4+r):""},i_=a_,s_=function(t,n){return G5(t,n)},d0=s_,Sp=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Xe&&(Zv=function(n,r){if(!Buffer.isBuffer(n))return Kv(n,r);var i=n.readUInt32LE(r);return i>0?n.toString("utf8",r+4,r+4+i-1):""},Jv=function(n,r){if(!Buffer.isBuffer(n))return Qv(n,r);var i=n.readUInt32LE(r);return i>0?n.toString("utf8",r+4,r+4+i-1):""},e_=function(n,r){if(!Buffer.isBuffer(n))return t_(n,r);var i=2*n.readUInt32LE(r);return n.toString("utf16le",r+4,r+4+i-1)},r_=function(n,r){if(!Buffer.isBuffer(n))return n_(n,r);var i=n.readUInt32LE(r);return n.toString("utf16le",r+4,r+4+i)},i_=function(n,r){if(!Buffer.isBuffer(n))return a_(n,r);var i=n.readUInt32LE(r);return n.toString("utf8",r+4,r+4+i)},d0=function(n,r){return Buffer.isBuffer(n)?n.readDoubleLE(r):s_(n,r)},Sp=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var ll=function(t,n){return t[n]},Lo=function(t,n){return t[n+1]*256+t[n]},Y5=function(t,n){var r=t[n+1]*256+t[n];return r<32768?r:(65535-r+1)*-1},Br=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},es=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},V5=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function Io(t,n){var r="",i,l,c=[],f,d,p,h;switch(n){case"dbcs":if(h=this.l,Xe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(p=0;p<t;++p)r+=String.fromCharCode(Lo(this,h)),h+=2;t*=2;break;case"utf8":r=cc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=wp(this,this.l,this.l+t);break;case"wstr":return Io.call(this,t,"dbcs");case"lpstr-ansi":r=Zv(this,this.l),t=4+Br(this,this.l);break;case"lpstr-cp":r=Jv(this,this.l),t=4+Br(this,this.l);break;case"lpwstr":r=e_(this,this.l),t=4+2*Br(this,this.l);break;case"lpp4":t=4+Br(this,this.l),r=r_(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Br(this,this.l),r=i_(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(f=ll(this,this.l+t++))!==0;)c.push(Nf(f));r=c.join("");break;case"_wstr":for(t=0,r="";(f=Lo(this,this.l+t))!==0;)c.push(Nf(f)),t+=2;t+=2,r=c.join("");break;case"dbcs-cont":for(r="",h=this.l,p=0;p<t;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return f=ll(this,h),this.l=h+1,d=Io.call(this,t-p,f?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(Nf(Lo(this,h))),h+=2}r=c.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,p=0;p!=t;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return f=ll(this,h),this.l=h+1,d=Io.call(this,t-p,f?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(Nf(ll(this,h))),h+=1}r=c.join("");break;default:switch(t){case 1:return i=ll(this,this.l),this.l++,i;case 2:return i=(n==="i"?Y5:Lo)(this,this.l),this.l+=2,i;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(i=(t>0?es:V5)(this,this.l),this.l+=4,i):(l=Br(this,this.l),this.l+=4,l);case 8:case-8:if(n==="f")return t==8?l=d0(this,this.l):l=d0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,l;t=8;case 16:r=qv(this,this.l,t);break}}return this.l+=t,r}var X5=function(t,n,r){t[r]=n&255,t[r+1]=n>>>8&255,t[r+2]=n>>>16&255,t[r+3]=n>>>24&255},W5=function(t,n,r){t[r]=n&255,t[r+1]=n>>8&255,t[r+2]=n>>16&255,t[r+3]=n>>24&255},q5=function(t,n,r){t[r]=n&255,t[r+1]=n>>>8&255};function K5(t,n,r){var i=0,l=0;if(r==="dbcs"){for(l=0;l!=n.length;++l)q5(this,n.charCodeAt(l),this.l+2*l);i=2*n.length}else if(r==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),l=0;l!=n.length;++l)this[this.l+l]=n.charCodeAt(l)&255;i=n.length}else if(r==="hex"){for(;l<t;++l)this[this.l++]=parseInt(n.slice(2*l,2*l+2),16)||0;return this}else if(r==="utf16le"){var c=Math.min(this.l+t,this.length);for(l=0;l<Math.min(n.length,t);++l){var f=n.charCodeAt(l);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(t){case 1:i=1,this[this.l]=n&255;break;case 2:i=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:i=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:i=4,X5(this,n,this.l);break;case 8:if(i=8,r==="f"){P5(this,n,this.l);break}case 16:break;case-4:i=4,W5(this,n,this.l);break}return this.l+=i,this}function l_(t,n){var r=qv(this,this.l,t.length>>1);if(r!==t)throw new Error(n+"Expected "+t+" saw "+r);this.l+=t.length>>1}function zr(t,n){t.l=n,t.read_shift=Io,t.chk=l_,t.write_shift=K5}function Ta(t,n){t.l+=n}function Xt(t){var n=cs(t);return zr(n,0),n}function Er(){var t=[],n=Xe?256:2048,r=function(h){var m=Xt(h);return zr(m,0),m},i=r(n),l=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i),i=null)},c=function(h){return i&&h<i.length-i.l?i:(l(),i=r(Math.max(h+1,n)))},f=function(){return l(),nr(t)},d=function(h){l(),i=h,i.l==null&&(i.l=i.length),c(n)};return{next:c,push:d,end:f,_bufs:t}}function ee(t,n,r,i){var l=+n,c;if(!isNaN(l)){i||(i=G7[l].p||(r||[]).length||0),c=1+(l>=128?1:0)+1,i>=128&&++c,i>=16384&&++c,i>=2097152&&++c;var f=t.next(c);l<=127?f.write_shift(1,l):(f.write_shift(1,(l&127)+128),f.write_shift(1,l>>7));for(var d=0;d!=4;++d)if(i>=128)f.write_shift(1,(i&127)+128),i>>=7;else{f.write_shift(1,i);break}i>0&&Sp(r)&&t.push(r)}}function Uo(t,n,r){var i=Ar(t);if(n.s?(i.cRel&&(i.c+=n.s.c),i.rRel&&(i.r+=n.s.r)):(i.cRel&&(i.c+=n.c),i.rRel&&(i.r+=n.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Py(t,n,r){var i=Ar(t);return i.s=Uo(i.s,n.s,r),i.e=Uo(i.e,n.s,r),i}function Ho(t,n){if(t.cRel&&t.c<0)for(t=Ar(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=Ar(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var r=en(t);return!t.cRel&&t.cRel!=null&&(r=J5(r)),!t.rRel&&t.rRel!=null&&(r=Z5(r)),r}function vd(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ur(t.s.c)+":"+(t.e.cRel?"":"$")+ur(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ar(t.s.r)+":"+(t.e.rRel?"":"$")+ar(t.e.r):Ho(t.s,n.biff)+":"+Ho(t.e,n.biff)}function Ep(t){return parseInt(Q5(t),10)-1}function ar(t){return""+(t+1)}function Z5(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Q5(t){return t.replace(/\$(\d+)$/,"$1")}function Tp(t){for(var n=tD(t),r=0,i=0;i!==n.length;++i)r=26*r+n.charCodeAt(i)-64;return r-1}function ur(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function J5(t){return t.replace(/^([A-Z])/,"$$$1")}function tD(t){return t.replace(/^\$([A-Z])/,"$1")}function eD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wn(t){for(var n=0,r=0,i=0;i<t.length;++i){var l=t.charCodeAt(i);l>=48&&l<=57?n=10*n+(l-48):l>=65&&l<=90&&(r=26*r+(l-64))}return{c:r-1,r:n-1}}function en(t){for(var n=t.c+1,r="";n;n=(n-1)/26|0)r=String.fromCharCode((n-1)%26+65)+r;return r+(t.r+1)}function Ir(t){var n=t.indexOf(":");return n==-1?{s:Wn(t),e:Wn(t)}:{s:Wn(t.slice(0,n)),e:Wn(t.slice(n+1))}}function Ln(t,n){return typeof n>"u"||typeof n=="number"?Ln(t.s,t.e):(typeof t!="string"&&(t=en(t)),typeof n!="string"&&(n=en(n)),t==n?t:t+":"+n)}function mn(t){var n={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,l=0,c=t.length;for(r=0;i<c&&!((l=t.charCodeAt(i)-64)<1||l>26);++i)r=26*r+l;for(n.s.c=--r,r=0;i<c&&!((l=t.charCodeAt(i)-48)<0||l>9);++i)r=10*r+l;if(n.s.r=--r,i===c||l!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++i,r=0;i!=c&&!((l=t.charCodeAt(i)-64)<1||l>26);++i)r=26*r+l;for(n.e.c=--r,r=0;i!=c&&!((l=t.charCodeAt(i)-48)<0||l>9);++i)r=10*r+l;return n.e.r=--r,n}function Yy(t,n){var r=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=Ri(t.z,r?Tr(n):n)}catch{}try{return t.w=Ri((t.XF||{}).numFmtId||(r?14:0),r?Tr(n):n)}catch{return""+n}}function ni(t,n,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?fc[t.v]||t.v:n==null?Yy(t,t.v):Yy(t,n))}function gs(t,n){var r=n&&n.sheet?n.sheet:"Sheet1",i={};return i[r]=t,{SheetNames:[r],Sheets:i}}function o_(t,n,r){var i=r||{},l=t?Array.isArray(t):i.dense,c=t||(l?[]:{}),f=0,d=0;if(c&&i.origin!=null){if(typeof i.origin=="number")f=i.origin;else{var p=typeof i.origin=="string"?Wn(i.origin):i.origin;f=p.r,d=p.c}c["!ref"]||(c["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var m=mn(c["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),f==-1&&(h.e.r=f=m.e.r+1)}for(var y=0;y!=n.length;++y)if(n[y]){if(!Array.isArray(n[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=n[y].length;++v)if(!(typeof n[y][v]>"u")){var w={v:n[y][v]},S=f+y,b=d+v;if(h.s.r>S&&(h.s.r=S),h.s.c>b&&(h.s.c=b),h.e.r<S&&(h.e.r=S),h.e.c<b&&(h.e.c=b),n[y][v]&&typeof n[y][v]=="object"&&!Array.isArray(n[y][v])&&!(n[y][v]instanceof Date))w=n[y][v];else if(Array.isArray(w.v)&&(w.f=n[y][v][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(i.nullError)w.t="e",w.v=0;else if(i.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=i.dateNF||Dn[14],i.cellDates?(w.t="d",w.w=Ri(w.z,Tr(w.v))):(w.t="n",w.v=Tr(w.v),w.w=Ri(w.z,w.v))):w.t="s";if(l)c[S]||(c[S]=[]),c[S][b]&&c[S][b].z&&(w.z=c[S][b].z),c[S][b]=w;else{var E=en({c:b,r:S});c[E]&&c[E].z&&(w.z=c[E].z),c[E]=w}}}return h.s.c<1e7&&(c["!ref"]=Ln(h)),c}function Dl(t,n){return o_(null,t,n)}function nD(t){return t.read_shift(4,"i")}function fa(t,n){return n||(n=Xt(4)),n.write_shift(4,t),n}function hr(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function qn(t,n){var r=!1;return n==null&&(r=!0,n=Xt(4+2*t.length)),n.write_shift(4,t.length),t.length>0&&n.write_shift(0,t,"dbcs"),r?n.slice(0,n.l):n}function rD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function aD(t,n){return n||(n=Xt(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Ap(t,n){var r=t.l,i=t.read_shift(1),l=hr(t),c=[],f={t:l,h:l};if((i&1)!==0){for(var d=t.read_shift(4),p=0;p!=d;++p)c.push(rD(t));f.r=c}else f.r=[{ich:0,ifnt:0}];return t.l=r+n,f}function iD(t,n){var r=!1;return n==null&&(r=!0,n=Xt(15+4*t.t.length)),n.write_shift(1,0),qn(t.t,n),r?n.slice(0,n.l):n}var sD=Ap;function lD(t,n){var r=!1;return n==null&&(r=!0,n=Xt(23+4*t.t.length)),n.write_shift(1,1),qn(t.t,n),n.write_shift(4,1),aD({},n),r?n.slice(0,n.l):n}function Qr(t){var n=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:r}}function ys(t,n){return n==null&&(n=Xt(8)),n.write_shift(-4,t.c),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}function vs(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}function _s(t,n){return n==null&&(n=Xt(4)),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}var oD=hr,c_=qn;function Dp(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}function p0(t,n){var r=!1;return n==null&&(r=!0,n=Xt(127)),n.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&n.write_shift(0,t,"dbcs"),r?n.slice(0,n.l):n}var cD=hr,Wd=Dp,Np=p0;function f_(t){var n=t.slice(t.l,t.l+4),r=n[0]&1,i=n[0]&2;t.l+=4;var l=i===0?d0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):es(n,0)>>2;return r?l/100:l}function u_(t,n){n==null&&(n=Xt(4));var r=0,i=0,l=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?i=1:l==(l|0)&&l>=-536870912&&l<1<<29&&(i=1,r=1),i)n.write_shift(-4,((r?l:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function h_(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}function fD(t,n){return n||(n=Xt(16)),n.write_shift(4,t.s.r),n.write_shift(4,t.e.r),n.write_shift(4,t.s.c),n.write_shift(4,t.e.c),n}var bs=h_,Nl=fD;function kl(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function fs(t,n){return(n||Xt(8)).write_shift(8,t,"f")}function uD(t){var n={},r=t.read_shift(1),i=r>>>1,l=t.read_shift(1),c=t.read_shift(2,"i"),f=t.read_shift(1),d=t.read_shift(1),p=t.read_shift(1);switch(t.l++,i){case 0:n.auto=1;break;case 1:n.index=l;var h=_D[l];h&&(n.rgb=n2(h));break;case 2:n.rgb=n2([f,d,p]);break;case 3:n.theme=l;break}return c!=0&&(n.tint=c>0?c/32767:c/32768),n}function x0(t,n){if(n||(n=Xt(8)),!t||t.auto)return n.write_shift(4,0),n.write_shift(4,0),n;t.index!=null?(n.write_shift(1,2),n.write_shift(1,t.index)):t.theme!=null?(n.write_shift(1,6),n.write_shift(1,t.theme)):(n.write_shift(1,5),n.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),n.write_shift(2,r),!t.rgb||t.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var i=t.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),n.write_shift(1,parseInt(i.slice(0,2),16)),n.write_shift(1,parseInt(i.slice(2,4),16)),n.write_shift(1,parseInt(i.slice(4,6),16)),n.write_shift(1,255)}return n}function hD(t){var n=t.read_shift(1);t.l++;var r={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return r}function dD(t,n){n||(n=Xt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return n.write_shift(1,r),n.write_shift(1,0),n}var d_=2,Or=3,Rf=11,m0=19,Mf=64,pD=65,xD=71,mD=4108,gD=4126,er=80,Vy={1:{n:"CodePage",t:d_},2:{n:"Category",t:er},3:{n:"PresentationFormat",t:er},4:{n:"ByteCount",t:Or},5:{n:"LineCount",t:Or},6:{n:"ParagraphCount",t:Or},7:{n:"SlideCount",t:Or},8:{n:"NoteCount",t:Or},9:{n:"HiddenCount",t:Or},10:{n:"MultimediaClipCount",t:Or},11:{n:"ScaleCrop",t:Rf},12:{n:"HeadingPairs",t:mD},13:{n:"TitlesOfParts",t:gD},14:{n:"Manager",t:er},15:{n:"Company",t:er},16:{n:"LinksUpToDate",t:Rf},17:{n:"CharacterCount",t:Or},19:{n:"SharedDoc",t:Rf},22:{n:"HyperlinksChanged",t:Rf},23:{n:"AppVersion",t:Or,p:"version"},24:{n:"DigSig",t:pD},26:{n:"ContentType",t:er},27:{n:"ContentStatus",t:er},28:{n:"Language",t:er},29:{n:"Version",t:er},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},Xy={1:{n:"CodePage",t:d_},2:{n:"Title",t:er},3:{n:"Subject",t:er},4:{n:"Author",t:er},5:{n:"Keywords",t:er},6:{n:"Comments",t:er},7:{n:"Template",t:er},8:{n:"LastAuthor",t:er},9:{n:"RevNumber",t:er},10:{n:"EditTime",t:Mf},11:{n:"LastPrinted",t:Mf},12:{n:"CreatedDate",t:Mf},13:{n:"ModifiedDate",t:Mf},14:{n:"PageCount",t:Or},15:{n:"WordCount",t:Or},16:{n:"CharCount",t:Or},17:{n:"Thumbnail",t:xD},18:{n:"Application",t:er},19:{n:"DocSecurity",t:Or},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}};function yD(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var vD=yD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_D=Ar(vD),fc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bD={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Of={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x_(t,n){var r=C5(bD),i=[],l;i[i.length]=Bn,i[i.length]=oe("Types",null,{xmlns:Xn.CT,"xmlns:xsd":Xn.xsd,"xmlns:xsi":Xn.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(p){return oe("Default",null,{Extension:p[0],ContentType:p[1]})}));var c=function(p){t[p]&&t[p].length>0&&(l=t[p][0],i[i.length]=oe("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Of[p][n.bookType]||Of[p].xlsx}))},f=function(p){(t[p]||[]).forEach(function(h){i[i.length]=oe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Of[p][n.bookType]||Of[p].xlsx})})},d=function(p){(t[p]||[]).forEach(function(h){i[i.length]=oe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[p][0]})})};return c("workbooks"),f("sheets"),f("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),f("metadata"),d("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Pe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m_(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function dl(t){var n=[Bn,oe("Relationships",null,{xmlns:Xn.RELS})];return ir(t["!id"]).forEach(function(r){n[n.length]=oe("Relationship",null,t["!id"][r])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Je(t,n,r,i,l,c){if(l||(l={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),n<0)for(n=t["!idx"];t["!id"]["rId"+n];++n);if(t["!idx"]=n+1,l.Id="rId"+n,l.Type=i,l.Target=r,[Pe.HLINK,Pe.XPATH,Pe.XMISS].indexOf(l.Type)>-1&&(l.TargetMode="External"),t["!id"][l.Id])throw new Error("Cannot rewrite rId "+n);return t["!id"][l.Id]=l,t[("/"+l.Target).replace("//","/")]=l,n}function wD(t){var n=[Bn];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)n.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function Wy(t,n,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function SD(t,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function ED(t){var n=[Bn];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)n.push(Wy(t[r][0],t[r][1])),n.push(SD("",t[r][0]));return n.push(Wy("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function g_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+l0.version+"</meta:generator></office:meta></office:document-meta>"}var as=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function _d(t,n,r,i,l){l[t]!=null||n==null||n===""||(l[t]=n,n=tn(n),i[i.length]=r?oe(t,n,r):rr(t,n))}function y_(t,n){var r=n||{},i=[Bn,oe("cp:coreProperties",null,{"xmlns:cp":Xn.CORE_PROPS,"xmlns:dc":Xn.dc,"xmlns:dcterms":Xn.dcterms,"xmlns:dcmitype":Xn.dcmitype,"xmlns:xsi":Xn.xsi})],l={};if(!t&&!r.Props)return i.join("");t&&(t.CreatedDate!=null&&_d("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Xd(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,l),t.ModifiedDate!=null&&_d("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Xd(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,l));for(var c=0;c!=as.length;++c){var f=as[c],d=r.Props&&r.Props[f[1]]!=null?r.Props[f[1]]:t?t[f[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&_d(f[0],d,null,i,l)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var pl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],v_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function __(t){var n=[],r=oe;return t||(t={}),t.Application="SheetJS",n[n.length]=Bn,n[n.length]=oe("Properties",null,{xmlns:Xn.EXT_PROPS,"xmlns:vt":Xn.vt}),pl.forEach(function(i){if(t[i[1]]!==void 0){var l;switch(i[2]){case"string":l=tn(String(t[i[1]]));break;case"bool":l=t[i[1]]?"true":"false";break}l!==void 0&&(n[n.length]=r(i[0],l))}}),n[n.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(i){return"<vt:lpstr>"+tn(i)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function b_(t){var n=[Bn,oe("Properties",null,{xmlns:Xn.CUST_PROPS,"xmlns:vt":Xn.vt})];if(!t)return n.join("");var r=1;return ir(t).forEach(function(l){++r,n[n.length]=oe("property",$5(t[l]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tn(l)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var qy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function TD(t,n){var r=[];return ir(qy).map(function(i){for(var l=0;l<as.length;++l)if(as[l][1]==i)return as[l];for(l=0;l<pl.length;++l)if(pl[l][1]==i)return pl[l];throw i}).forEach(function(i){if(t[i[1]]!=null){var l=n&&n.Props&&n.Props[i[1]]!=null?n.Props[i[1]]:t[i[1]];switch(i[2]){case"date":l=new Date(l).toISOString().replace(/\.\d*Z/,"Z");break}typeof l=="number"?l=String(l):l===!0||l===!1?l=l?"1":"0":l instanceof Date&&(l=new Date(l).toISOString().replace(/\.\d*Z/,"")),r.push(rr(qy[i[1]]||i[1],l))}}),oe("DocumentProperties",r.join(""),{xmlns:Lr.o})}function AD(t,n){var r=["Worksheets","SheetNames"],i="CustomDocumentProperties",l=[];return t&&ir(t).forEach(function(c){if(Object.prototype.hasOwnProperty.call(t,c)){for(var f=0;f<as.length;++f)if(c==as[f][1])return;for(f=0;f<pl.length;++f)if(c==pl[f][1])return;for(f=0;f<r.length;++f)if(c==r[f])return;var d=t[c],p="string";typeof d=="number"?(p="float",d=String(d)):d===!0||d===!1?(p="boolean",d=d?"1":"0"):d=String(d),l.push(oe(Ly(c),d,{"dt:dt":p}))}}),n&&ir(n).forEach(function(c){if(Object.prototype.hasOwnProperty.call(n,c)&&!(t&&Object.prototype.hasOwnProperty.call(t,c))){var f=n[c],d="string";typeof f=="number"?(d="float",f=String(f)):f===!0||f===!1?(d="boolean",f=f?"1":"0"):f instanceof Date?(d="dateTime.tz",f=f.toISOString()):f=String(f),l.push(oe(Ly(c),f,{"dt:dt":d}))}}),"<"+i+' xmlns="'+Lr.o+'">'+l.join("")+"</"+i+">"}function DD(t){var n=typeof t=="string"?new Date(Date.parse(t)):t,r=n.getTime()/1e3+11644473600,i=r%Math.pow(2,32),l=(r-i)/Math.pow(2,32);i*=1e7,l*=1e7;var c=i/Math.pow(2,32)|0;c>0&&(i=i%Math.pow(2,32),l+=c);var f=Xt(8);return f.write_shift(4,i),f.write_shift(4,l),f}function Ky(t,n){var r=Xt(4),i=Xt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:i.write_shift(-4,n);break;case 5:i=Xt(8),i.write_shift(8,n,"f");break;case 11:i.write_shift(4,n?1:0);break;case 64:i=DD(n);break;case 31:case 80:for(i=Xt(4+2*(n.length+1)+(n.length%2?0:2)),i.write_shift(4,n.length+1),i.write_shift(0,n,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}return nr([r,i])}var w_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ND(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Zy(t,n,r){var i=Xt(8),l=[],c=[],f=8,d=0,p=Xt(8),h=Xt(8);if(p.write_shift(4,2),p.write_shift(4,1200),h.write_shift(4,1),c.push(p),l.push(h),f+=8+p.length,!n){h=Xt(8),h.write_shift(4,0),l.unshift(h);var m=[Xt(4)];for(m[0].write_shift(4,t.length),d=0;d<t.length;++d){var y=t[d][0];for(p=Xt(8+2*(y.length+1)+(y.length%2?0:2)),p.write_shift(4,d+2),p.write_shift(4,y.length+1),p.write_shift(0,y,"dbcs");p.l!=p.length;)p.write_shift(1,0);m.push(p)}p=nr(m),c.unshift(p),f+=8+p.length}for(d=0;d<t.length;++d)if(!(n&&!n[t[d][0]])&&!(w_.indexOf(t[d][0])>-1||v_.indexOf(t[d][0])>-1)&&t[d][1]!=null){var v=t[d][1],w=0;if(n){w=+n[t[d][0]];var S=r[w];if(S.p=="version"&&typeof v=="string"){var b=v.split(".");v=(+b[0]<<16)+(+b[1]||0)}p=Ky(S.t,v)}else{var E=ND(v);E==-1&&(E=31,v=String(v)),p=Ky(E,v)}c.push(p),h=Xt(8),h.write_shift(4,n?w:2+d),l.push(h),f+=8+p.length}var A=8*(c.length+1);for(d=0;d<c.length;++d)l[d].write_shift(4,A),A+=c[d].length;return i.write_shift(4,f),i.write_shift(4,c.length),nr([i].concat(l).concat(c))}function Qy(t,n,r,i,l,c){var f=Xt(l?68:48),d=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,cn.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,l?2:1),f.write_shift(16,n,"hex"),f.write_shift(4,l?68:48);var p=Zy(t,r,i);if(d.push(p),l){var h=Zy(l,null,null);f.write_shift(16,c,"hex"),f.write_shift(4,68+p.length),d.push(h)}return nr(d)}function kD(t,n){n||(n=Xt(t));for(var r=0;r<t;++r)n.write_shift(1,0);return n}function FD(t,n){return t.read_shift(n)===1}function gr(t,n){return n||(n=Xt(2)),n.write_shift(2,+!!t),n}function S_(t){return t.read_shift(2,"u")}function Zr(t,n){return n||(n=Xt(2)),n.write_shift(2,t),n}function E_(t,n,r){return r||(r=Xt(2)),r.write_shift(1,n=="e"?+t:+!!t),r.write_shift(1,n=="e"?1:0),r}function T_(t,n,r){var i=t.read_shift(r&&r.biff>=12?2:1),l="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var c=t.read_shift(1);c&&(l="dbcs-cont")}else r.biff==12&&(l="wstr");r.biff>=2&&r.biff<=5&&(l="cpstr");var f=i?t.read_shift(i,l):"";return f}function CD(t){var n=t.t||"",r=Xt(3);r.write_shift(2,n.length),r.write_shift(1,1);var i=Xt(2*n.length);i.write_shift(2*n.length,n,"utf16le");var l=[r,i];return nr(l)}function RD(t,n,r){var i;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(n,"cpstr");if(r.biff>=12)return t.read_shift(n,"dbcs-cont")}var l=t.read_shift(1);return l===0?i=t.read_shift(n,"sbcs-cont"):i=t.read_shift(n,"dbcs-cont"),i}function MD(t,n,r){var i=t.read_shift(r&&r.biff==2?1:2);return i===0?(t.l++,""):RD(t,i,r)}function OD(t,n,r){if(r.biff>5)return MD(t,n,r);var i=t.read_shift(1);return i===0?(t.l++,""):t.read_shift(i,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function A_(t,n,r){return r||(r=Xt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Jy(t,n){n||(n=Xt(6+t.length*2)),n.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)n.write_shift(2,t.charCodeAt(r));return n.write_shift(2,0),n}function zD(t){var n=Xt(512),r=0,i=t.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var l=i.indexOf("#"),c=l>-1?31:23;switch(i.charAt(0)){case"#":c=28;break;case".":c&=-3;break}n.write_shift(4,2),n.write_shift(4,c);var f=[8,6815827,6619237,4849780,83];for(r=0;r<f.length;++r)n.write_shift(4,f[r]);if(c==28)i=i.slice(1),Jy(i,n);else if(c&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<f.length;++r)n.write_shift(1,parseInt(f[r],16));var d=l>-1?i.slice(0,l):i;for(n.write_shift(4,2*(d.length+1)),r=0;r<d.length;++r)n.write_shift(2,d.charCodeAt(r));n.write_shift(2,0),c&8&&Jy(l>-1?i.slice(l+1):"",n)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<f.length;++r)n.write_shift(1,parseInt(f[r],16));for(var p=0;i.slice(p*3,p*3+3)=="../"||i.slice(p*3,p*3+3)=="..\\";)++p;for(n.write_shift(2,p),n.write_shift(4,i.length-3*p+1),r=0;r<i.length-3*p;++r)n.write_shift(1,i.charCodeAt(r+3*p)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),r=0;r<6;++r)n.write_shift(4,0)}return n.slice(0,n.l)}function us(t,n,r,i){return i||(i=Xt(6)),i.write_shift(2,t),i.write_shift(2,n),i.write_shift(2,r||0),i}function LD(t,n,r){var i=r.biff>8?4:2,l=t.read_shift(i),c=t.read_shift(i,"i"),f=t.read_shift(i,"i");return[l,c,f]}function BD(t){var n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2);return{s:{c:i,r:n},e:{c:l,r}}}function D_(t,n){return n||(n=Xt(8)),n.write_shift(2,t.s.r),n.write_shift(2,t.e.r),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c),n}function kp(t,n,r){var i=1536,l=16;switch(r.bookType){case"biff8":break;case"biff5":i=1280,l=8;break;case"biff4":i=4,l=6;break;case"biff3":i=3,l=6;break;case"biff2":i=2,l=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Xt(l);return c.write_shift(2,i),c.write_shift(2,n),l>4&&c.write_shift(2,29282),l>6&&c.write_shift(2,1997),l>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function jD(t,n){var r=!n||n.biff==8,i=Xt(r?112:54);for(i.write_shift(n.biff==8?2:1,7),r&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(r?0:536870912));i.l<i.length;)i.write_shift(1,r?0:32);return i}function ID(t,n){var r=!n||n.biff>=8?2:1,i=Xt(8+r*t.name.length);i.write_shift(4,t.pos),i.write_shift(1,t.hs||0),i.write_shift(1,t.dt),i.write_shift(1,t.name.length),n.biff>=8&&i.write_shift(1,1),i.write_shift(r*t.name.length,t.name,n.biff<8?"sbcs":"utf16le");var l=i.slice(0,i.l);return l.l=i.l,l}function UD(t,n){var r=Xt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var i=[],l=0;l<t.length;++l)i[l]=CD(t[l]);var c=nr([r].concat(i));return c.parts=[r.length].concat(i.map(function(f){return f.length})),c}function HD(){var t=Xt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function $D(t){var n=Xt(18),r=1718;return t&&t.RTL&&(r|=64),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function GD(t,n){var r=t.name||"Arial",i=n&&n.biff==5,l=i?15+r.length:16+2*r.length,c=Xt(l);return c.write_shift(2,t.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,r.length),i||c.write_shift(1,1),c.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le"),c}function PD(t,n,r,i){var l=Xt(10);return us(t,n,i,l),l.write_shift(4,r),l}function YD(t,n,r,i,l){var c=!l||l.biff==8,f=Xt(8+ +c+(1+c)*r.length);return us(t,n,i,f),f.write_shift(2,r.length),c&&f.write_shift(1,1),f.write_shift((1+c)*r.length,r,c?"utf16le":"sbcs"),f}function VD(t,n,r,i){var l=r&&r.biff==5;i||(i=Xt(l?3+n.length:5+2*n.length)),i.write_shift(2,t),i.write_shift(l?1:2,n.length),l||i.write_shift(1,1),i.write_shift((l?1:2)*n.length,n,l?"sbcs":"utf16le");var c=i.length>i.l?i.slice(0,i.l):i;return c.l==null&&(c.l=c.length),c}function XD(t,n){var r=n.biff==8||!n.biff?4:2,i=Xt(2*r+6);return i.write_shift(r,t.s.r),i.write_shift(r,t.e.r+1),i.write_shift(2,t.s.c),i.write_shift(2,t.e.c+1),i.write_shift(2,0),i}function t2(t,n,r,i){var l=r&&r.biff==5;i||(i=Xt(l?16:20)),i.write_shift(2,0),t.style?(i.write_shift(2,t.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,t.numFmtId||0),i.write_shift(2,n<<4));var c=0;return t.numFmtId>0&&l&&(c|=1024),i.write_shift(4,c),i.write_shift(4,0),l||i.write_shift(4,0),i.write_shift(2,0),i}function WD(t){var n=Xt(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function qD(t,n,r,i,l,c){var f=Xt(8);return us(t,n,i,f),E_(r,c,f),f}function KD(t,n,r,i){var l=Xt(14);return us(t,n,i,l),fs(r,l),l}function ZD(t,n,r){if(r.biff<8)return QD(t,n,r);for(var i=[],l=t.l+n,c=t.read_shift(r.biff>8?4:2);c--!==0;)i.push(LD(t,r.biff>8?12:6,r));if(t.l!=l)throw new Error("Bad ExternSheet: "+t.l+" != "+l);return i}function QD(t,n,r){t[t.l+1]==3&&t[t.l]++;var i=T_(t,n,r);return i.charCodeAt(0)==3?i.slice(1):i}function JD(t){var n=Xt(2+t.length*8);n.write_shift(2,t.length);for(var r=0;r<t.length;++r)D_(t[r],n);return n}function tN(t){var n=Xt(24),r=Wn(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),l=0;l<16;++l)n.write_shift(1,parseInt(i[l],16));return nr([n,zD(t[1])])}function eN(t){var n=t[1].Tooltip,r=Xt(10+2*(n.length+1));r.write_shift(2,2048);var i=Wn(t[0]);r.write_shift(2,i.r),r.write_shift(2,i.r),r.write_shift(2,i.c),r.write_shift(2,i.c);for(var l=0;l<n.length;++l)r.write_shift(2,n.charCodeAt(l));return r.write_shift(2,0),r}function nN(t){return t||(t=Xt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function rN(t,n,r){if(!r.cellStyles)return Ta(t,n);var i=r&&r.biff>=12?4:2,l=t.read_shift(i),c=t.read_shift(i),f=t.read_shift(i),d=t.read_shift(i),p=t.read_shift(2);i==2&&(t.l+=2);var h={s:l,e:c,w:f,ixfe:d,flags:p};return(r.biff>=5||!r.biff)&&(h.level=p>>8&7),h}function aN(t,n){var r=Xt(12);r.write_shift(2,n),r.write_shift(2,n),r.write_shift(2,t.width*256),r.write_shift(2,0);var i=0;return t.hidden&&(i|=1),r.write_shift(1,i),i=t.level||0,r.write_shift(1,i),r.write_shift(2,0),r}function iN(t){for(var n=Xt(2*t),r=0;r<t;++r)n.write_shift(2,r+1);return n}function sN(t,n,r){var i=Xt(15);return hc(i,t,n),i.write_shift(8,r,"f"),i}function lN(t,n,r){var i=Xt(9);return hc(i,t,n),i.write_shift(2,r),i}var oN=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=yp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(d,p){var h=[],m=cs(1);switch(p.type){case"base64":m=oa(ei(d));break;case"binary":m=oa(d);break;case"buffer":case"array":m=d;break}zr(m,0);var y=m.read_shift(1),v=!!(y&136),w=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:w=!0,v=!0;break;case 49:w=!0,v=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var b=0,E=521;y==2&&(b=m.read_shift(2)),m.l+=3,y!=2&&(b=m.read_shift(4)),b>1048576&&(b=1e6),y!=2&&(E=m.read_shift(2));var A=m.read_shift(2),O=p.codepage||1252;y!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(O=t[m[m.l]]),m.l+=1,m.l+=2),S&&(m.l+=36);for(var C=[],U={},B=Math.min(m.length,y==2?521:E-10-(w?264:0)),V=S?32:11;m.l<B&&m[m.l]!=13;)switch(U={},U.name=o0.utils.decode(O,m.slice(m.l,m.l+V)).replace(/[\u0000\r\n].*$/g,""),m.l+=V,U.type=String.fromCharCode(m.read_shift(1)),y!=2&&!S&&(U.offset=m.read_shift(4)),U.len=m.read_shift(1),y==2&&(U.offset=m.read_shift(2)),U.dec=m.read_shift(1),U.name.length&&C.push(U),y!=2&&(m.l+=S?13:14),U.type){case"B":(!w||U.len!=8)&&p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var k=0,F=0;for(h[0]=[],F=0;F!=C.length;++F)h[0][F]=C[F].name;for(;b-- >0;){if(m[m.l]===42){m.l+=A;continue}for(++m.l,h[++k]=[],F=0,F=0;F!=C.length;++F){var T=m.slice(m.l,m.l+C[F].len);m.l+=C[F].len,zr(T,0);var N=o0.utils.decode(O,T);switch(C[F].type){case"C":N.trim().length&&(h[k][F]=N.replace(/\s+$/,""));break;case"D":N.length===8?h[k][F]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):h[k][F]=N;break;case"F":h[k][F]=parseFloat(N.trim());break;case"+":case"I":h[k][F]=S?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":h[k][F]=!0;break;case"N":case"F":h[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));h[k][F]="##MEMO##"+(S?parseInt(N.trim(),10):T.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(h[k][F]=+N||0);break;case"@":h[k][F]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":h[k][F]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":h[k][F]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[k][F]=-T.read_shift(-8,"f");break;case"B":if(w&&C[F].len==8){h[k][F]=T.read_shift(8,"f");break}case"G":case"P":T.l+=C[F].len;break;case"0":if(C[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[F].type)}}}if(y!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return p&&p.sheetRows&&(h=h.slice(0,p.sheetRows)),p.DBF=C,h}function i(d,p){var h=p||{};h.dateNF||(h.dateNF="yyyymmdd");var m=Dl(r(d,h),h);return m["!cols"]=h.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete h.DBF,m}function l(d,p){try{return gs(i(d,p),p)}catch(h){if(p&&p.WTF)throw h}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function f(d,p){var h=p||{};if(+h.codepage>=0&&Wo(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Er(),y=b0(d,{header:1,raw:!0,cellDates:!0}),v=y[0],w=y.slice(1),S=d["!cols"]||[],b=0,E=0,A=0,O=1;for(b=0;b<v.length;++b){if(((S[b]||{}).DBF||{}).name){v[b]=S[b].DBF.name,++A;continue}if(v[b]!=null){if(++A,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(E=0;E<1024;++E)if(v.indexOf(v[b]+"_"+E)==-1){v[b]+="_"+E;break}}}}var C=mn(d["!ref"]),U=[],B=[],V=[];for(b=0;b<=C.e.c-C.s.c;++b){var k="",F="",T=0,N=[];for(E=0;E<w.length;++E)w[E][b]!=null&&N.push(w[E][b]);if(N.length==0||v[b]==null){U[b]="?";continue}for(E=0;E<N.length;++E){switch(typeof N[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=N[E]instanceof Date?"D":"C";break;default:F="C"}T=Math.max(T,String(N[E]).length),k=k&&k!=F?"C":F}T>250&&(T=250),F=((S[b]||{}).DBF||{}).type,F=="C"&&S[b].DBF.len>T&&(T=S[b].DBF.len),k=="B"&&F=="N"&&(k="N",V[b]=S[b].DBF.dec,T=S[b].DBF.len),B[b]=k=="C"||F=="N"?T:c[k]||0,O+=B[b],U[b]=k}var D=m.next(32);for(D.write_shift(4,318902576),D.write_shift(4,w.length),D.write_shift(2,296+32*A),D.write_shift(2,O),b=0;b<4;++b)D.write_shift(4,0);for(D.write_shift(4,0|(+n[kv]||3)<<8),b=0,E=0;b<v.length;++b)if(v[b]!=null){var L=m.next(32),K=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,K,"sbcs"),L.write_shift(1,U[b]=="?"?"C":U[b],"sbcs"),L.write_shift(4,E),L.write_shift(1,B[b]||c[U[b]]||0),L.write_shift(1,V[b]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),E+=B[b]||c[U[b]]||0}var ft=m.next(264);for(ft.write_shift(4,13),b=0;b<65;++b)ft.write_shift(4,0);for(b=0;b<w.length;++b){var dt=m.next(O);for(dt.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(U[E]){case"L":dt.write_shift(1,w[b][E]==null?63:w[b][E]?84:70);break;case"B":dt.write_shift(8,w[b][E]||0,"f");break;case"N":var J="0";for(typeof w[b][E]=="number"&&(J=w[b][E].toFixed(V[E]||0)),A=0;A<B[E]-J.length;++A)dt.write_shift(1,32);dt.write_shift(1,J,"sbcs");break;case"D":w[b][E]?(dt.write_shift(4,("0000"+w[b][E].getFullYear()).slice(-4),"sbcs"),dt.write_shift(2,("00"+(w[b][E].getMonth()+1)).slice(-2),"sbcs"),dt.write_shift(2,("00"+w[b][E].getDate()).slice(-2),"sbcs")):dt.write_shift(8,"00000000","sbcs");break;case"C":var gt=String(w[b][E]!=null?w[b][E]:"").slice(0,B[E]);for(dt.write_shift(1,gt,"sbcs"),A=0;A<B[E]-gt.length;++A)dt.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:l,to_sheet:i,from_sheet:f}}(),cN=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+ir(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,w){var S=t[w];return typeof S=="number"?Ey(S):S},i=function(v,w,S){var b=w.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return b==59?v:Ey(b)};t["|"]=254;function l(v,w){switch(w.type){case"base64":return c(ei(v),w);case"binary":return c(v,w);case"buffer":return c(Xe&&Buffer.isBuffer(v)?v.toString("binary"):lc(v),w);case"array":return c(z0(v),w)}throw new Error("Unrecognized type "+w.type)}function c(v,w){var S=v.split(/[\n\r]+/),b=-1,E=-1,A=0,O=0,C=[],U=[],B=null,V={},k=[],F=[],T=[],N=0,D;for(+w.codepage>=0&&Wo(+w.codepage);A!==S.length;++A){N=0;var L=S[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(n,r),K=L.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ft=K[0],dt;if(L.length>0)switch(ft){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&U.push(L.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,gt=!1,wt=!1,bt=!1,P=-1,I=-1;for(O=1;O<K.length;++O)switch(K[O].charAt(0)){case"A":break;case"X":E=parseInt(K[O].slice(1))-1,gt=!0;break;case"Y":for(b=parseInt(K[O].slice(1))-1,gt||(E=0),D=C.length;D<=b;++D)C[D]=[];break;case"K":dt=K[O].slice(1),dt.charAt(0)==='"'?dt=dt.slice(1,dt.length-1):dt==="TRUE"?dt=!0:dt==="FALSE"?dt=!1:isNaN(Za(dt))?isNaN(Ko(dt).getDate())||(dt=yr(dt)):(dt=Za(dt),B!==null&&Hv(B)&&(dt=Yv(dt))),J=!0;break;case"E":bt=!0;var R=lk(K[O].slice(1),{r:b,c:E});C[b][E]=[C[b][E],R];break;case"S":wt=!0,C[b][E]=[C[b][E],"S5S"];break;case"G":break;case"R":P=parseInt(K[O].slice(1))-1;break;case"C":I=parseInt(K[O].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+L)}if(J&&(C[b][E]&&C[b][E].length==2?C[b][E][0]=dt:C[b][E]=dt,B=null),wt){if(bt)throw new Error("SYLK shared formula cannot have own formula");var Y=P>-1&&C[P][I];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[b][E][1]=ok(Y[1],{r:b-P,c:E-I})}break;case"F":var z=0;for(O=1;O<K.length;++O)switch(K[O].charAt(0)){case"X":E=parseInt(K[O].slice(1))-1,++z;break;case"Y":for(b=parseInt(K[O].slice(1))-1,D=C.length;D<=b;++D)C[D]=[];break;case"M":N=parseInt(K[O].slice(1))/20;break;case"F":break;case"G":break;case"P":B=U[parseInt(K[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=K[O].slice(1).split(" "),D=parseInt(T[0],10);D<=parseInt(T[1],10);++D)N=parseInt(T[2],10),F[D-1]=N===0?{hidden:!0}:{wch:N},Fp(F[D-1]);break;case"C":E=parseInt(K[O].slice(1))-1,F[E]||(F[E]={});break;case"R":b=parseInt(K[O].slice(1))-1,k[b]||(k[b]={}),N>0?(k[b].hpt=N,k[b].hpx=R_(N)):N===0&&(k[b].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+L)}z<1&&(B=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+L)}}return k.length>0&&(V["!rows"]=k),F.length>0&&(V["!cols"]=F),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,V]}function f(v,w){var S=l(v,w),b=S[0],E=S[1],A=Dl(b,w);return ir(E).forEach(function(O){A[O]=E[O]}),A}function d(v,w){return gs(f(v,w),w)}function p(v,w,S,b){var E="C;Y"+(S+1)+";X"+(b+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+Rp(v.f,{r:S,c:b}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(v,w){w.forEach(function(S,b){var E="F;W"+(b+1)+" "+(b+1)+" ";S.hidden?E+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=g0(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=y0(S.wpx)),typeof S.wch=="number"&&(E+=Math.round(S.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,w){w.forEach(function(S,b){var E="F;";S.hidden?E+="M0;":S.hpt?E+="M"+20*S.hpt+";":S.hpx&&(E+="M"+20*v0(S.hpx)+";"),E.length>2&&v.push(E+"R"+(b+1))})}function y(v,w){var S=["ID;PWXL;N;E"],b=[],E=mn(v["!ref"]),A,O=Array.isArray(v),C=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),v["!cols"]&&h(S,v["!cols"]),v["!rows"]&&m(S,v["!rows"]),S.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var U=E.s.r;U<=E.e.r;++U)for(var B=E.s.c;B<=E.e.c;++B){var V=en({r:U,c:B});A=O?(v[U]||[])[B]:v[V],!(!A||A.v==null&&(!A.f||A.F))&&b.push(p(A,v,U,B))}return S.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:d,to_sheet:f,from_sheet:y}}(),fN=function(){function t(c,f){switch(f.type){case"base64":return n(ei(c),f);case"binary":return n(c,f);case"buffer":return n(Xe&&Buffer.isBuffer(c)?c.toString("binary"):lc(c),f);case"array":return n(z0(c),f)}throw new Error("Unrecognized type "+f.type)}function n(c,f){for(var d=c.split(`
`),p=-1,h=-1,m=0,y=[];m!==d.length;++m){if(d[m].trim()==="BOT"){y[++p]=[],h=0;continue}if(!(p<0)){var v=d[m].trim().split(","),w=v[0],S=v[1];++m;for(var b=d[m]||"";(b.match(/["]/g)||[]).length&1&&m<d.length-1;)b+=`
`+d[++m];switch(b=b.trim(),+w){case-1:if(b==="BOT"){y[++p]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?y[p][h]=!0:b==="FALSE"?y[p][h]=!1:isNaN(Za(S))?isNaN(Ko(S).getDate())?y[p][h]=S:y[p][h]=yr(S):y[p][h]=Za(S),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),y[p][h++]=b!==""?b:null;break}if(b==="EOD")break}}return f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),y}function r(c,f){return Dl(t(c,f),f)}function i(c,f){return gs(r(c,f),f)}var l=function(){var c=function(p,h,m,y,v){p.push(h),p.push(m+","+y),p.push('"'+v.replace(/"/g,'""')+'"')},f=function(p,h,m,y){p.push(h+","+m),p.push(h==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var h=[],m=mn(p["!ref"]),y,v=Array.isArray(p);c(h,"TABLE",0,1,"sheetjs"),c(h,"VECTORS",0,m.e.r-m.s.r+1,""),c(h,"TUPLES",0,m.e.c-m.s.c+1,""),c(h,"DATA",0,0,"");for(var w=m.s.r;w<=m.e.r;++w){f(h,-1,0,"BOT");for(var S=m.s.c;S<=m.e.c;++S){var b=en({r:w,c:S});if(y=v?(p[w]||[])[S]:p[b],!y){f(h,1,0,"");continue}switch(y.t){case"n":var E=y.w;!E&&y.v!=null&&(E=y.v),E==null?y.f&&!y.F?f(h,1,0,"="+y.f):f(h,1,0,""):f(h,0,E,"V");break;case"b":f(h,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":f(h,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Ri(y.z||Dn[14],Tr(yr(y.v)))),f(h,0,y.w,"V");break;default:f(h,1,0,"")}}}f(h,-1,0,"EOD");var A=`\r
`,O=h.join(A);return O}}();return{to_workbook:i,to_sheet:r,from_sheet:l}}(),N_=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,v){for(var w=y.split(`
`),S=-1,b=-1,E=0,A=[];E!==w.length;++E){var O=w[E].trim().split(":");if(O[0]==="cell"){var C=Wn(O[1]);if(A.length<=C.r)for(S=A.length;S<=C.r;++S)A[S]||(A[S]=[]);switch(S=C.r,b=C.c,O[2]){case"t":A[S][b]=t(O[3]);break;case"v":A[S][b]=+O[3];break;case"vtf":var U=O[O.length-1];case"vtc":switch(O[3]){case"nl":A[S][b]=!!+O[4];break;default:A[S][b]=+O[4];break}O[2]=="vtf"&&(A[S][b]=[A[S][b],U])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function i(y,v){return Dl(r(y,v),v)}function l(y,v){return gs(i(y,v),v)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function h(y){if(!y||!y["!ref"])return"";for(var v=[],w=[],S,b="",E=Ir(y["!ref"]),A=Array.isArray(y),O=E.s.r;O<=E.e.r;++O)for(var C=E.s.c;C<=E.e.c;++C)if(b=en({r:O,c:C}),S=A?(y[O]||[])[C]:y[b],!(!S||S.v==null||S.t==="z")){switch(w=["cell",b,"t"],S.t){case"s":case"str":w.push(n(S.v));break;case"n":S.f?(w[2]="vtf",w[3]="n",w[4]=S.v,w[5]=n(S.f)):(w[2]="v",w[3]=S.v);break;case"b":w[2]="vt"+(S.f?"f":"c"),w[3]="nl",w[4]=S.v?"1":"0",w[5]=n(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var U=Tr(yr(S.v));w[2]="vtc",w[3]="nd",w[4]=""+U,w[5]=S.w||Ri(S.z||Dn[14],U);break;case"e":continue}v.push(w.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(y){return[c,f,d,f,h(y),p].join(`
`)}return{to_workbook:l,to_sheet:i,from_sheet:m}}(),uN=function(){function t(m,y,v,w,S){S.raw?y[v][w]=m:m===""||(m==="TRUE"?y[v][w]=!0:m==="FALSE"?y[v][w]=!1:isNaN(Za(m))?isNaN(Ko(m).getDate())?y[v][w]=m:y[v][w]=yr(m):y[v][w]=Za(m))}function n(m,y){var v=y||{},w=[];if(!m||m.length===0)return w;for(var S=m.split(/[\r\n]/),b=S.length-1;b>=0&&S[b].length===0;)--b;for(var E=10,A=0,O=0;O<=b;++O)A=S[O].indexOf(" "),A==-1?A=S[O].length:A++,E=Math.max(E,A);for(O=0;O<=b;++O){w[O]=[];var C=0;for(t(S[O].slice(0,E).trim(),w,O,C,v),C=1;C<=(S[O].length-E)/10+1;++C)t(S[O].slice(E+(C-1)*10,E+C*10).trim(),w,O,C,v)}return v.sheetRows&&(w=w.slice(0,v.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function l(m){for(var y={},v=!1,w=0,S=0;w<m.length;++w)(S=m.charCodeAt(w))==34?v=!v:!v&&S in r&&(y[S]=(y[S]||0)+1);S=[];for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&S.push([y[w],w]);if(!S.length){y=i;for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&S.push([y[w],w])}return S.sort(function(b,E){return b[0]-E[0]||i[b[1]]-i[E[1]]}),r[S.pop()[1]]||44}function c(m,y){var v=y||{},w="",S=v.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(w=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(w=m.charAt(4),m=m.slice(6)):w=l(m.slice(0,1024)):v&&v.FS?w=v.FS:w=l(m.slice(0,1024));var E=0,A=0,O=0,C=0,U=0,B=w.charCodeAt(0),V=!1,k=0,F=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var T=v.dateNF!=null?D5(v.dateNF):null;function N(){var D=m.slice(C,U),L={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)L.t="z";else if(v.raw)L.t="s",L.v=D;else if(D.trim().length===0)L.t="s",L.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(L.t="s",L.v=D.slice(2,-1).replace(/""/g,'"')):ck(D)?(L.t="n",L.f=D.slice(1)):(L.t="s",L.v=D);else if(D=="TRUE")L.t="b",L.v=!0;else if(D=="FALSE")L.t="b",L.v=!1;else if(!isNaN(O=Za(D)))L.t="n",v.cellText!==!1&&(L.w=D),L.v=O;else if(!isNaN(Ko(D).getDate())||T&&D.match(T)){L.z=v.dateNF||Dn[14];var K=0;T&&D.match(T)&&(D=N5(D,v.dateNF,D.match(T)||[]),K=1),v.cellDates?(L.t="d",L.v=yr(D,K)):(L.t="n",L.v=Tr(yr(D,K))),v.cellText!==!1&&(L.w=Ri(L.z,L.v instanceof Date?Tr(L.v):L.v)),v.cellNF||delete L.z}else L.t="s",L.v=D;if(L.t=="z"||(v.dense?(S[E]||(S[E]=[]),S[E][A]=L):S[en({c:A,r:E})]=L),C=U+1,F=m.charCodeAt(C),b.e.c<A&&(b.e.c=A),b.e.r<E&&(b.e.r=E),k==B)++A;else if(A=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}t:for(;U<m.length;++U)switch(k=m.charCodeAt(U)){case 34:F===34&&(V=!V);break;case B:case 10:case 13:if(!V&&N())break t;break}return U-C>0&&N(),S["!ref"]=Ln(b),S}function f(m,y){return!(y&&y.PRN)||y.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?c(m,y):Dl(n(m,y),y)}function d(m,y){var v="",w=y.type=="string"?[0,0,0,0]:SR(m,y);switch(y.type){case"base64":v=ei(m);break;case"binary":v=m;break;case"buffer":y.codepage==65001?v=m.toString("utf8"):y.codepage&&typeof o0<"u"||(v=Xe&&Buffer.isBuffer(m)?m.toString("binary"):lc(m));break;case"array":v=z0(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+y.type)}return w[0]==239&&w[1]==187&&w[2]==191?v=jo(v.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?v=jo(v):y.type=="binary"&&typeof o0<"u",v.slice(0,19)=="socialcalc:version:"?N_.to_sheet(y.type=="string"?v:jo(v),y):f(v,y)}function p(m,y){return gs(d(m,y),y)}function h(m){for(var y=[],v=mn(m["!ref"]),w,S=Array.isArray(m),b=v.s.r;b<=v.e.r;++b){for(var E=[],A=v.s.c;A<=v.e.c;++A){var O=en({r:b,c:A});if(w=S?(m[b]||[])[A]:m[O],!w||w.v==null){E.push("          ");continue}for(var C=(w.w||(ni(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";E.push(C+(A===0?" ":""))}y.push(E.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:d,from_sheet:h}}(),e2=function(){function t(R,Y,z){if(R){zr(R,R.l||0);for(var W=z.Enum||P;R.l<R.length;){var tt=R.read_shift(2),nt=W[tt]||W[65535],j=R.read_shift(2),q=R.l+j,lt=nt.f&&nt.f(R,j,z);if(R.l=q,Y(lt,nt,tt))return}}}function n(R,Y){switch(Y.type){case"base64":return r(oa(ei(R)),Y);case"binary":return r(oa(R),Y);case"buffer":case"array":return r(R,Y)}throw"Unsupported type "+Y.type}function r(R,Y){if(!R)return R;var z=Y||{},W=z.dense?[]:{},tt="Sheet1",nt="",j=0,q={},lt=[],Ct=[],vt={s:{r:0,c:0},e:{r:0,c:0}},Zt=z.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)z.Enum=P,t(R,function(Et,Mt,Ot){switch(Ot){case 0:z.vers=Et,Et>=4096&&(z.qpro=!0);break;case 6:vt=Et;break;case 204:Et&&(nt=Et);break;case 222:nt=Et;break;case 15:case 51:z.qpro||(Et[1].v=Et[1].v.slice(1));case 13:case 14:case 16:Ot==14&&(Et[2]&112)==112&&(Et[2]&15)>1&&(Et[2]&15)<15&&(Et[1].z=z.dateNF||Dn[14],z.cellDates&&(Et[1].t="d",Et[1].v=Yv(Et[1].v))),z.qpro&&Et[3]>j&&(W["!ref"]=Ln(vt),q[tt]=W,lt.push(tt),W=z.dense?[]:{},vt={s:{r:0,c:0},e:{r:0,c:0}},j=Et[3],tt=nt||"Sheet"+(j+1),nt="");var Dt=z.dense?(W[Et[0].r]||[])[Et[0].c]:W[en(Et[0])];if(Dt){Dt.t=Et[1].t,Dt.v=Et[1].v,Et[1].z!=null&&(Dt.z=Et[1].z),Et[1].f!=null&&(Dt.f=Et[1].f);break}z.dense?(W[Et[0].r]||(W[Et[0].r]=[]),W[Et[0].r][Et[0].c]=Et[1]):W[en(Et[0])]=Et[1];break}},z);else if(R[2]==26||R[2]==14)z.Enum=I,R[2]==14&&(z.qpro=!0,R.l=0),t(R,function(Et,Mt,Ot){switch(Ot){case 204:tt=Et;break;case 22:Et[1].v=Et[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Et[3]>j&&(W["!ref"]=Ln(vt),q[tt]=W,lt.push(tt),W=z.dense?[]:{},vt={s:{r:0,c:0},e:{r:0,c:0}},j=Et[3],tt="Sheet"+(j+1)),Zt>0&&Et[0].r>=Zt)break;z.dense?(W[Et[0].r]||(W[Et[0].r]=[]),W[Et[0].r][Et[0].c]=Et[1]):W[en(Et[0])]=Et[1],vt.e.c<Et[0].c&&(vt.e.c=Et[0].c),vt.e.r<Et[0].r&&(vt.e.r=Et[0].r);break;case 27:Et[14e3]&&(Ct[Et[14e3][0]]=Et[14e3][1]);break;case 1537:Ct[Et[0]]=Et[1],Et[0]==j&&(tt=Et[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(W["!ref"]=Ln(vt),q[nt||tt]=W,lt.push(nt||tt),!Ct.length)return{SheetNames:lt,Sheets:q};for(var Gt={},Kt=[],Yt=0;Yt<Ct.length;++Yt)q[lt[Yt]]?(Kt.push(Ct[Yt]||lt[Yt]),Gt[Ct[Yt]]=q[Ct[Yt]]||q[lt[Yt]]):(Kt.push(Ct[Yt]),Gt[Ct[Yt]]={"!ref":"A1"});return{SheetNames:Kt,Sheets:Gt}}function i(R,Y){var z=Y||{};if(+z.codepage>=0&&Wo(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Er(),tt=mn(R["!ref"]),nt=Array.isArray(R),j=[];ce(W,0,c(1030)),ce(W,6,p(tt));for(var q=Math.min(tt.e.r,8191),lt=tt.s.r;lt<=q;++lt)for(var Ct=ar(lt),vt=tt.s.c;vt<=tt.e.c;++vt){lt===tt.s.r&&(j[vt]=ur(vt));var Zt=j[vt]+Ct,Gt=nt?(R[lt]||[])[vt]:R[Zt];if(!(!Gt||Gt.t=="z"))if(Gt.t=="n")(Gt.v|0)==Gt.v&&Gt.v>=-32768&&Gt.v<=32767?ce(W,13,w(lt,vt,Gt.v)):ce(W,14,b(lt,vt,Gt.v));else{var Kt=ni(Gt);ce(W,15,y(lt,vt,Kt.slice(0,239)))}}return ce(W,1),W.end()}function l(R,Y){var z=Y||{};if(+z.codepage>=0&&Wo(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Er();ce(W,0,f(R));for(var tt=0,nt=0;tt<R.SheetNames.length;++tt)(R.Sheets[R.SheetNames[tt]]||{})["!ref"]&&ce(W,27,bt(R.SheetNames[tt],nt++));var j=0;for(tt=0;tt<R.SheetNames.length;++tt){var q=R.Sheets[R.SheetNames[tt]];if(!(!q||!q["!ref"])){for(var lt=mn(q["!ref"]),Ct=Array.isArray(q),vt=[],Zt=Math.min(lt.e.r,8191),Gt=lt.s.r;Gt<=Zt;++Gt)for(var Kt=ar(Gt),Yt=lt.s.c;Yt<=lt.e.c;++Yt){Gt===lt.s.r&&(vt[Yt]=ur(Yt));var Et=vt[Yt]+Kt,Mt=Ct?(q[Gt]||[])[Yt]:q[Et];if(!(!Mt||Mt.t=="z"))if(Mt.t=="n")ce(W,23,N(Gt,Yt,j,Mt.v));else{var Ot=ni(Mt);ce(W,22,k(Gt,Yt,j,Ot.slice(0,239)))}}++j}}return ce(W,1),W.end()}function c(R){var Y=Xt(2);return Y.write_shift(2,R),Y}function f(R){var Y=Xt(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var z=0,W=0,tt=0,nt=0;nt<R.SheetNames.length;++nt){var j=R.SheetNames[nt],q=R.Sheets[j];if(!(!q||!q["!ref"])){++tt;var lt=Ir(q["!ref"]);z<lt.e.r&&(z=lt.e.r),W<lt.e.c&&(W=lt.e.c)}}return z>8191&&(z=8191),Y.write_shift(2,z),Y.write_shift(1,tt),Y.write_shift(1,W),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function d(R,Y,z){var W={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&z.qpro?(W.s.c=R.read_shift(1),R.l++,W.s.r=R.read_shift(2),W.e.c=R.read_shift(1),R.l++,W.e.r=R.read_shift(2),W):(W.s.c=R.read_shift(2),W.s.r=R.read_shift(2),Y==12&&z.qpro&&(R.l+=2),W.e.c=R.read_shift(2),W.e.r=R.read_shift(2),Y==12&&z.qpro&&(R.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function p(R){var Y=Xt(8);return Y.write_shift(2,R.s.c),Y.write_shift(2,R.s.r),Y.write_shift(2,R.e.c),Y.write_shift(2,R.e.r),Y}function h(R,Y,z){var W=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(W[0].c=R.read_shift(1),W[3]=R.read_shift(1),W[0].r=R.read_shift(2),R.l+=2):(W[2]=R.read_shift(1),W[0].c=R.read_shift(2),W[0].r=R.read_shift(2)),W}function m(R,Y,z){var W=R.l+Y,tt=h(R,Y,z);if(tt[1].t="s",z.vers==20768){R.l++;var nt=R.read_shift(1);return tt[1].v=R.read_shift(nt,"utf8"),tt}return z.qpro&&R.l++,tt[1].v=R.read_shift(W-R.l,"cstr"),tt}function y(R,Y,z){var W=Xt(7+z.length);W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,R),W.write_shift(1,39);for(var tt=0;tt<W.length;++tt){var nt=z.charCodeAt(tt);W.write_shift(1,nt>=128?95:nt)}return W.write_shift(1,0),W}function v(R,Y,z){var W=h(R,Y,z);return W[1].v=R.read_shift(2,"i"),W}function w(R,Y,z){var W=Xt(7);return W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,R),W.write_shift(2,z,"i"),W}function S(R,Y,z){var W=h(R,Y,z);return W[1].v=R.read_shift(8,"f"),W}function b(R,Y,z){var W=Xt(13);return W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,R),W.write_shift(8,z,"f"),W}function E(R,Y,z){var W=R.l+Y,tt=h(R,Y,z);if(tt[1].v=R.read_shift(8,"f"),z.qpro)R.l=W;else{var nt=R.read_shift(2);U(R.slice(R.l,R.l+nt),tt),R.l+=nt}return tt}function A(R,Y,z){var W=Y&32768;return Y&=-32769,Y=(W?R:0)+(Y>=8192?Y-16384:Y),(W?"":"$")+(z?ur(Y):ar(Y))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(R,Y){zr(R,0);for(var z=[],W=0,tt="",nt="",j="",q="";R.l<R.length;){var lt=R[R.l++];switch(lt){case 0:z.push(R.read_shift(8,"f"));break;case 1:nt=A(Y[0].c,R.read_shift(2),!0),tt=A(Y[0].r,R.read_shift(2),!1),z.push(nt+tt);break;case 2:{var Ct=A(Y[0].c,R.read_shift(2),!0),vt=A(Y[0].r,R.read_shift(2),!1);nt=A(Y[0].c,R.read_shift(2),!0),tt=A(Y[0].r,R.read_shift(2),!1),z.push(Ct+vt+":"+nt+tt)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(R.read_shift(2));break;case 6:{for(var Zt="";lt=R[R.l++];)Zt+=String.fromCharCode(lt);z.push('"'+Zt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:q=z.pop(),j=z.pop(),z.push(["AND","OR"][lt-20]+"("+j+","+q+")");break;default:if(lt<32&&C[lt])q=z.pop(),j=z.pop(),z.push(j+C[lt]+q);else if(O[lt]){if(W=O[lt][1],W==69&&(W=R[R.l++]),W>z.length){console.error("WK1 bad formula parse 0x"+lt.toString(16)+":|"+z.join("|")+"|");return}var Gt=z.slice(-W);z.length-=W,z.push(O[lt][0]+"("+Gt.join(",")+")")}else return lt<=7?console.error("WK1 invalid opcode "+lt.toString(16)):lt<=24?console.error("WK1 unsupported op "+lt.toString(16)):lt<=30?console.error("WK1 invalid opcode "+lt.toString(16)):lt<=115?console.error("WK1 unsupported function opcode "+lt.toString(16)):console.error("WK1 unrecognized opcode "+lt.toString(16))}}z.length==1?Y[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function B(R){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=R.read_shift(2),Y[3]=R[R.l++],Y[0].c=R[R.l++],Y}function V(R,Y){var z=B(R);return z[1].t="s",z[1].v=R.read_shift(Y-4,"cstr"),z}function k(R,Y,z,W){var tt=Xt(6+W.length);tt.write_shift(2,R),tt.write_shift(1,z),tt.write_shift(1,Y),tt.write_shift(1,39);for(var nt=0;nt<W.length;++nt){var j=W.charCodeAt(nt);tt.write_shift(1,j>=128?95:j)}return tt.write_shift(1,0),tt}function F(R,Y){var z=B(R);z[1].v=R.read_shift(2);var W=z[1].v>>1;if(z[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return z[1].v=W,z}function T(R,Y){var z=B(R),W=R.read_shift(4),tt=R.read_shift(4),nt=R.read_shift(2);if(nt==65535)return W===0&&tt===3221225472?(z[1].t="e",z[1].v=15):W===0&&tt===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var j=nt&32768;return nt=(nt&32767)-16446,z[1].v=(1-j*2)*(tt*Math.pow(2,nt+32)+W*Math.pow(2,nt)),z}function N(R,Y,z,W){var tt=Xt(14);if(tt.write_shift(2,R),tt.write_shift(1,z),tt.write_shift(1,Y),W==0)return tt.write_shift(4,0),tt.write_shift(4,0),tt.write_shift(2,65535),tt;var nt=0,j=0,q=0,lt=0;return W<0&&(nt=1,W=-W),j=Math.log2(W)|0,W/=Math.pow(2,j-31),lt=W>>>0,(lt&2147483648)==0&&(W/=2,++j,lt=W>>>0),W-=lt,lt|=2147483648,lt>>>=0,W*=Math.pow(2,32),q=W>>>0,tt.write_shift(4,q),tt.write_shift(4,lt),j+=16383+(nt?32768:0),tt.write_shift(2,j),tt}function D(R,Y){var z=T(R);return R.l+=Y-14,z}function L(R,Y){var z=B(R),W=R.read_shift(4);return z[1].v=W>>6,z}function K(R,Y){var z=B(R),W=R.read_shift(8,"f");return z[1].v=W,z}function ft(R,Y){var z=K(R);return R.l+=Y-10,z}function dt(R,Y){return R[R.l+Y-1]==0?R.read_shift(Y,"cstr"):""}function J(R,Y){var z=R[R.l++];z>Y-1&&(z=Y-1);for(var W="";W.length<z;)W+=String.fromCharCode(R[R.l++]);return W}function gt(R,Y,z){if(!(!z.qpro||Y<21)){var W=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var tt=R.read_shift(Y-21,"cstr");return[W,tt]}}function wt(R,Y){for(var z={},W=R.l+Y;R.l<W;){var tt=R.read_shift(2);if(tt==14e3){for(z[tt]=[0,""],z[tt][0]=R.read_shift(2);R[R.l];)z[tt][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return z}function bt(R,Y){var z=Xt(5+R.length);z.write_shift(2,14e3),z.write_shift(2,Y);for(var W=0;W<R.length;++W){var tt=R.charCodeAt(W);z[z.l++]=tt>127?95:tt}return z[z.l++]=0,z}var P={0:{n:"BOF",f:S_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:dt},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:wt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:ft},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:dt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:gt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:l,to_workbook:n}}(),hN=/^\s|\s$|[\t\n\r]/;function k_(t,n){if(!n.bookSST)return"";var r=[Bn];r[r.length]=oe("sst",null,{xmlns:Al[0],count:t.Count,uniqueCount:t.Unique});for(var i=0;i!=t.length;++i)if(t[i]!=null){var l=t[i],c="<si>";l.r?c+=l.r:(c+="<t",l.t||(l.t=""),l.t.match(hN)&&(c+=' xml:space="preserve"'),c+=">"+tn(l.t)+"</t>"),c+="</si>",r[r.length]=c}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function dN(t){return[t.read_shift(4),t.read_shift(4)]}function pN(t,n){return n||(n=Xt(8)),n.write_shift(4,t.Count),n.write_shift(4,t.Unique),n}var xN=iD;function mN(t){var n=Er();ee(n,159,pN(t));for(var r=0;r<t.length;++r)ee(n,19,xN(t[r]));return ee(n,160),n.end()}function gN(t){for(var n=[],r=t.split(""),i=0;i<r.length;++i)n[i]=r[i].charCodeAt(0);return n}function F_(t){var n=0,r,i=gN(t),l=i.length+1,c,f,d,p,h;for(r=cs(l),r[0]=i.length,c=1;c!=l;++c)r[c]=i[c-1];for(c=l-1;c>=0;--c)f=r[c],d=(n&16384)===0?0:1,p=n<<1&32767,h=d|p,n=h^f;return n^52811}var yN=function(){function t(l,c){switch(c.type){case"base64":return n(ei(l),c);case"binary":return n(l,c);case"buffer":return n(Xe&&Buffer.isBuffer(l)?l.toString("binary"):lc(l),c);case"array":return n(z0(l),c)}throw new Error("Unrecognized type "+c.type)}function n(l,c){var f=c||{},d=f.dense?[]:{},p=l.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(m,y){Array.isArray(d)&&(d[y]=[]);for(var v=/\\\w+\b/g,w=0,S,b=-1;S=v.exec(m);){switch(S[0]){case"\\cell":var E=m.slice(w,v.lastIndex-S[0].length);if(E[0]==" "&&(E=E.slice(1)),++b,E.length){var A={v:E,t:"s"};Array.isArray(d)?d[y][b]=A:d[en({r:y,c:b})]=A}break}w=v.lastIndex}b>h.e.c&&(h.e.c=b)}),d["!ref"]=Ln(h),d}function r(l,c){return gs(t(l,c),c)}function i(l){for(var c=["{\\rtf1\\ansi"],f=mn(l["!ref"]),d,p=Array.isArray(l),h=f.s.r;h<=f.e.r;++h){c.push("\\trowd\\trautofit1");for(var m=f.s.c;m<=f.e.c;++m)c.push("\\cellx"+(m+1));for(c.push("\\pard\\intbl"),m=f.s.c;m<=f.e.c;++m){var y=en({r:h,c:m});d=p?(l[h]||[])[m]:l[y],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(ni(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:i}}();function n2(t){for(var n=0,r=1;n!=3;++n)r=r*256+(t[n]>255?255:t[n]<0?0:t[n]);return r.toString(16).toUpperCase().slice(1)}var vN=6,Qa=vN;function g0(t){return Math.floor((t+Math.round(128/Qa)/256)*Qa)}function y0(t){return Math.floor((t-5)/Qa*100+.5)/100}function qd(t){return Math.round((t*Qa+5)/Qa*256)/256}function Fp(t){t.width?(t.wpx=g0(t.width),t.wch=y0(t.wpx),t.MDW=Qa):t.wpx?(t.wch=y0(t.wpx),t.width=qd(t.wch),t.MDW=Qa):typeof t.wch=="number"&&(t.width=qd(t.wch),t.wpx=g0(t.width),t.MDW=Qa),t.customWidth&&delete t.customWidth}var _N=96,C_=_N;function v0(t){return t*96/C_}function R_(t){return t*C_/96}function bN(t){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&(n[n.length]=oe("numFmt",null,{numFmtId:i,formatCode:tn(t[i])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=oe("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function wN(t){var n=[];return n[n.length]=oe("cellXfs",null),t.forEach(function(r){n[n.length]=oe("xf",null,r)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=oe("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function M_(t,n){var r=[Bn,oe("styleSheet",null,{xmlns:Al[0],"xmlns:vt":Xn.vt})],i;return t.SSF&&(i=bN(t.SSF))!=null&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=wN(n.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SN(t,n){var r=t.read_shift(2),i=hr(t);return[r,i]}function EN(t,n,r){r||(r=Xt(6+4*n.length)),r.write_shift(2,t),qn(n,r);var i=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),i}function TN(t,n,r){var i={};i.sz=t.read_shift(2)/20;var l=hD(t);l.fItalic&&(i.italic=1),l.fCondense&&(i.condense=1),l.fExtend&&(i.extend=1),l.fShadow&&(i.shadow=1),l.fOutline&&(i.outline=1),l.fStrikeout&&(i.strike=1);var c=t.read_shift(2);switch(c===700&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var f=t.read_shift(1);f!=0&&(i.underline=f);var d=t.read_shift(1);d>0&&(i.family=d);var p=t.read_shift(1);switch(p>0&&(i.charset=p),t.l++,i.color=uD(t),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=hr(t),i}function AN(t,n){n||(n=Xt(25+4*32)),n.write_shift(2,t.sz*20),dD(t,n),n.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),n.write_shift(2,r),n.write_shift(1,t.underline||0),n.write_shift(1,t.family||0),n.write_shift(1,t.charset||0),n.write_shift(1,0),x0(t.color,n);var i=0;return i=2,n.write_shift(1,i),qn(t.name,n),n.length>n.l?n.slice(0,n.l):n}var DN=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bd,NN=Ta;function r2(t,n){n||(n=Xt(4*3+8*7+16*1)),bd||(bd=yp(DN));var r=bd[t.patternType];r==null&&(r=40),n.write_shift(4,r);var i=0;if(r!=40)for(x0({auto:1},n),x0({auto:1},n);i<12;++i)n.write_shift(4,0);else{for(;i<4;++i)n.write_shift(4,0);for(;i<12;++i)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function kN(t,n){var r=t.l+n,i=t.read_shift(2),l=t.read_shift(2);return t.l=r,{ixfe:i,numFmtId:l}}function O_(t,n,r){r||(r=Xt(16)),r.write_shift(2,n||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var i=0;return r.write_shift(1,i),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Co(t,n){return n||(n=Xt(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var FN=Ta;function CN(t,n){return n||(n=Xt(51)),n.write_shift(1,0),Co(null,n),Co(null,n),Co(null,n),Co(null,n),Co(null,n),n.length>n.l?n.slice(0,n.l):n}function RN(t,n){return n||(n=Xt(12+4*10)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),p0(t.name||"",n),n.length>n.l?n.slice(0,n.l):n}function MN(t,n,r){var i=Xt(2052);return i.write_shift(4,t),p0(n,i),p0(r,i),i.length>i.l?i.slice(0,i.l):i}function ON(t,n){if(n){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&++r}),r!=0&&(ee(t,615,fa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&ee(t,44,EN(l,n[l]))}),ee(t,616))}}function zN(t){var n=1;ee(t,611,fa(n)),ee(t,43,AN({sz:12,color:{theme:1},name:"Calibri",family:2})),ee(t,612)}function LN(t){var n=2;ee(t,603,fa(n)),ee(t,45,r2({patternType:"none"})),ee(t,45,r2({patternType:"gray125"})),ee(t,604)}function BN(t){var n=1;ee(t,613,fa(n)),ee(t,46,CN()),ee(t,614)}function jN(t){var n=1;ee(t,626,fa(n)),ee(t,47,O_({numFmtId:0},65535)),ee(t,627)}function IN(t,n){ee(t,617,fa(n.length)),n.forEach(function(r){ee(t,47,O_(r,0))}),ee(t,618)}function UN(t){var n=1;ee(t,619,fa(n)),ee(t,48,RN({xfId:0,name:"Normal"})),ee(t,620)}function HN(t){var n=0;ee(t,505,fa(n)),ee(t,506)}function $N(t){var n=0;ee(t,508,MN(n,"TableStyleMedium9","PivotStyleMedium4")),ee(t,509)}function GN(t,n){var r=Er();return ee(r,278),ON(r,t.SSF),zN(r),LN(r),BN(r),jN(r),IN(r,n.cellXfs),UN(r),HN(r),$N(r),ee(r,279),r.end()}function z_(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Bn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function PN(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:hr(t)}}function YN(t){var n=Xt(12+2*t.name.length);return n.write_shift(4,t.flags),n.write_shift(4,t.version),qn(t.name,n),n.slice(0,n.l)}function VN(t){for(var n=[],r=t.read_shift(4);r-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function XN(t){var n=Xt(4+8*t.length);n.write_shift(4,t.length);for(var r=0;r<t.length;++r)n.write_shift(4,t[r][0]),n.write_shift(4,t[r][1]);return n}function WN(t,n){var r=Xt(8+2*n.length);return r.write_shift(4,t),qn(n,r),r.slice(0,r.l)}function qN(t){return t.l+=4,t.read_shift(4)!=0}function KN(t,n){var r=Xt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function ZN(){var t=Er();return ee(t,332),ee(t,334,fa(1)),ee(t,335,YN({name:"XLDAPR",version:12e4,flags:3496657072})),ee(t,336),ee(t,339,WN(1,"XLDAPR")),ee(t,52),ee(t,35,fa(514)),ee(t,4096,fa(0)),ee(t,4097,Zr(1)),ee(t,36),ee(t,53),ee(t,340),ee(t,337,KN(1)),ee(t,51,XN([[1,0]])),ee(t,338),ee(t,333),t.end()}function L_(){var t=[Bn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function QN(t){var n={};n.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),n.r=en(r);var i=t.read_shift(1);return i&2&&(n.l="1"),i&8&&(n.a="1"),n}var cl=1024;function B_(t,n){for(var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),l=[oe("xml",null,{"xmlns:v":Lr.v,"xmlns:o":Lr.o,"xmlns:x":Lr.x,"xmlns:mv":Lr.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:i})];cl<t*1e3;)cl+=1e3;return n.forEach(function(c){var f=Wn(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var p=d.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=oe("v:fill",p,d),m={on:"t",obscured:"t"};++cl,l=l.concat(["<v:shape"+Qo({id:"_x0000_s"+cl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,oe("v:shadow",null,m),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rr("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),rr("x:AutoFill","False"),rr("x:Row",String(f.r)),rr("x:Column",String(f.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),l.push("</xml>"),l.join("")}function j_(t){var n=[Bn,oe("comments",null,{xmlns:Al[0]})],r=[];return n.push("<authors>"),t.forEach(function(i){i[1].forEach(function(l){var c=tn(l.a);r.indexOf(c)==-1&&(r.push(c),n.push("<author>"+c+"</author>")),l.T&&l.ID&&r.indexOf("tc="+l.ID)==-1&&(r.push("tc="+l.ID),n.push("<author>tc="+l.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),t.forEach(function(i){var l=0,c=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?l=r.indexOf("tc="+i[1][0].ID):i[1].forEach(function(p){p.a&&(l=r.indexOf(tn(p.a))),c.push(p.t||"")}),n.push('<comment ref="'+i[0]+'" authorId="'+l+'"><text>'),c.length<=1)n.push(rr("t",tn(c[0]||"")));else{for(var f=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)f+=`Reply:
    `+c[d]+`
`;n.push(rr("t",tn(f)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function JN(t,n,r){var i=[Bn,oe("ThreadedComments",null,{xmlns:Xn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(l){var c="";(l[1]||[]).forEach(function(f,d){if(!f.T){delete f.ID;return}f.a&&n.indexOf(f.a)==-1&&n.push(f.a);var p={ref:l[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};d==0?c=p.id:p.parentId=c,f.ID=p.id,f.a&&(p.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(f.a)).slice(-12)+"}"),i.push(oe("threadedComment",rr("text",f.t||""),p))})}),i.push("</ThreadedComments>"),i.join("")}function tk(t){var n=[Bn,oe("personList",null,{xmlns:Xn.TCMNT,"xmlns:x":Al[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,i){n.push(oe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:r,providerId:"None"}))}),n.push("</personList>"),n.join("")}function ek(t){var n={};n.iauthor=t.read_shift(4);var r=bs(t);return n.rfx=r.s,n.ref=en(r.s),t.l+=16,n}function nk(t,n){return n==null&&(n=Xt(36)),n.write_shift(4,t[1].iauthor),Nl(t[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var rk=hr;function ak(t){return qn(t.slice(0,54))}function ik(t){var n=Er(),r=[];return ee(n,628),ee(n,630),t.forEach(function(i){i[1].forEach(function(l){r.indexOf(l.a)>-1||(r.push(l.a.slice(0,54)),ee(n,632,ak(l.a)))})}),ee(n,631),ee(n,633),t.forEach(function(i){i[1].forEach(function(l){l.iauthor=r.indexOf(l.a);var c={s:Wn(i[0]),e:Wn(i[0])};ee(n,635,nk([c,l])),l.t&&l.t.length>0&&ee(n,637,lD(l)),ee(n,636),delete l.iauthor})}),ee(n,634),ee(n,629),n.end()}function sk(t,n){n.FullPaths.forEach(function(r,i){if(i!=0){var l=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");l.slice(-1)!=="/"&&cn.utils.cfb_add(t,l,n.FileIndex[i].content)}})}var I_=["xlsb","xlsm","xlam","biff8","xla"],lk=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function r(i,l,c,f){var d=!1,p=!1;c.length==0?p=!0:c.charAt(0)=="["&&(p=!0,c=c.slice(1,-1)),f.length==0?d=!0:f.charAt(0)=="["&&(d=!0,f=f.slice(1,-1));var h=c.length>0?parseInt(c,10)|0:0,m=f.length>0?parseInt(f,10)|0:0;return d?m+=n.c:--m,p?h+=n.r:--h,l+(d?"":"$")+ur(m)+(p?"":"$")+ar(h)}return function(l,c){return n=c,l.replace(t,r)}}(),Cp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Rp=function(){return function(n,r){return n.replace(Cp,function(i,l,c,f,d,p){var h=Tp(f)-(c?0:r.c),m=Ep(p)-(d?0:r.r),y=m==0?"":d?m+1:"["+m+"]",v=h==0?"":c?h+1:"["+h+"]";return l+"R"+y+"C"+v})}}();function ok(t,n){return t.replace(Cp,function(r,i,l,c,f,d){return i+(l=="$"?l+c:ur(Tp(c)+n.c))+(f=="$"?f+d:ar(Ep(d)+n.r))})}function ck(t){return t.length!=1}function zn(t){t.l+=1}function Mi(t,n){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function U_(t,n,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return H_(t);r.biff==12&&(i=4)}var l=t.read_shift(i),c=t.read_shift(i),f=Mi(t),d=Mi(t);return{s:{r:l,c:f[0],cRel:f[1],rRel:f[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function H_(t){var n=Mi(t),r=Mi(t),i=t.read_shift(1),l=t.read_shift(1);return{s:{r:n[0],c:i,cRel:n[1],rRel:n[2]},e:{r:r[0],c:l,cRel:r[1],rRel:r[2]}}}function fk(t,n,r){if(r.biff<8)return H_(t);var i=t.read_shift(r.biff==12?4:2),l=t.read_shift(r.biff==12?4:2),c=Mi(t),f=Mi(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function $_(t,n,r){if(r&&r.biff>=2&&r.biff<=5)return uk(t);var i=t.read_shift(r&&r.biff==12?4:2),l=Mi(t);return{r:i,c:l[0],cRel:l[1],rRel:l[2]}}function uk(t){var n=Mi(t),r=t.read_shift(1);return{r:n[0],c:r,cRel:n[1],rRel:n[2]}}function hk(t){var n=t.read_shift(2),r=t.read_shift(2);return{r:n,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function dk(t,n,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return pk(t);var l=t.read_shift(i>=12?4:2),c=t.read_shift(2),f=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;l>524287;)l-=1048576;if(f==1)for(;c>8191;)c=c-16384;return{r:l,c,cRel:f,rRel:d}}function pk(t){var n=t.read_shift(2),r=t.read_shift(1),i=(n&32768)>>15,l=(n&16384)>>14;return n&=16383,i==1&&n>=8192&&(n=n-16384),l==1&&r>=128&&(r=r-256),{r:n,c:r,cRel:l,rRel:i}}function xk(t,n,r){var i=(t[t.l++]&96)>>5,l=U_(t,r.biff>=2&&r.biff<=5?6:8,r);return[i,l]}function mk(t,n,r){var i=(t[t.l++]&96)>>5,l=t.read_shift(2,"i"),c=8;if(r)switch(r.biff){case 5:t.l+=12,c=6;break;case 12:c=12;break}var f=U_(t,c,r);return[i,l,f]}function gk(t,n,r){var i=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}function yk(t,n,r){var i=(t[t.l++]&96)>>5,l=t.read_shift(2),c=8;if(r)switch(r.biff){case 5:t.l+=12,c=6;break;case 12:c=12;break}return t.l+=c,[i,l]}function vk(t,n,r){var i=(t[t.l++]&96)>>5,l=fk(t,n-1,r);return[i,l]}function _k(t,n,r){var i=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[i]}function a2(t){var n=t[t.l+1]&1,r=1;return t.l+=4,[n,r]}function bk(t,n,r){t.l+=2;for(var i=t.read_shift(r&&r.biff==2?1:2),l=[],c=0;c<=i;++c)l.push(t.read_shift(r&&r.biff==2?1:2));return l}function wk(t,n,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function Sk(t,n,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function Ek(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function Tk(t,n,r){var i=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[i]}function G_(t){var n=t.read_shift(1),r=t.read_shift(1);return[n,r]}function Ak(t){return t.read_shift(2),G_(t)}function Dk(t){return t.read_shift(2),G_(t)}function Nk(t,n,r){var i=(t[t.l]&96)>>5;t.l+=1;var l=$_(t,0,r);return[i,l]}function kk(t,n,r){var i=(t[t.l]&96)>>5;t.l+=1;var l=dk(t,0,r);return[i,l]}function Fk(t,n,r){var i=(t[t.l]&96)>>5;t.l+=1;var l=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var c=$_(t,0,r);return[i,l,c]}function Ck(t,n,r){var i=(t[t.l]&96)>>5;t.l+=1;var l=t.read_shift(r&&r.biff<=3?1:2);return[CF[l],V_[l],i]}function Rk(t,n,r){var i=t[t.l++],l=t.read_shift(1),c=r&&r.biff<=3?[i==88?-1:0,t.read_shift(1)]:Mk(t);return[l,(c[0]===0?V_:FF)[c[1]]]}function Mk(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Ok(t,n,r){t.l+=r&&r.biff==2?3:4}function zk(t,n,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var i=t.read_shift(2),l=t.read_shift(r&&r.biff==2?1:2);return[i,l]}function Lk(t){return t.l++,fc[t.read_shift(1)]}function Bk(t){return t.l++,t.read_shift(2)}function jk(t){return t.l++,t.read_shift(1)!==0}function Ik(t){return t.l++,kl(t)}function Uk(t,n,r){return t.l++,T_(t,n-1,r)}function Hk(t,n){var r=[t.read_shift(1)];if(n==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=FD(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:r[1]=fc[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=kl(t);break;case 2:r[1]=OD(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function $k(t,n,r){for(var i=t.read_shift(r.biff==12?4:2),l=[],c=0;c!=i;++c)l.push((r.biff==12?bs:BD)(t));return l}function Gk(t,n,r){var i=0,l=0;r.biff==12?(i=t.read_shift(4),l=t.read_shift(4)):(l=1+t.read_shift(1),i=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,--l==0&&(l=256));for(var c=0,f=[];c!=i&&(f[c]=[]);++c)for(var d=0;d!=l;++d)f[c][d]=Hk(t,r.biff);return f}function Pk(t,n,r){var i=t.read_shift(1)>>>5&3,l=!r||r.biff>=8?4:2,c=t.read_shift(l);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[i,0,c]}function Yk(t,n,r){if(r.biff==5)return Vk(t);var i=t.read_shift(1)>>>5&3,l=t.read_shift(2),c=t.read_shift(4);return[i,l,c]}function Vk(t){var n=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[n,r,i]}function Xk(t,n,r){var i=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var l=t.read_shift(r&&r.biff==2?1:2);return[i,l]}function Wk(t,n,r){var i=t.read_shift(1)>>>5&3,l=t.read_shift(r&&r.biff==2?1:2);return[i,l]}function qk(t,n,r){var i=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[i]}function Kk(t,n,r){var i=(t[t.l++]&96)>>5,l=t.read_shift(2),c=4;if(r)switch(r.biff){case 5:c=15;break;case 12:c=6;break}return t.l+=c,[i,l]}var Zk=Ta,Qk=Ta,Jk=Ta;function uc(t,n,r){return t.l+=2,[hk(t)]}function Mp(t){return t.l+=6,[]}var tF=uc,eF=Mp,nF=Mp,rF=uc;function P_(t){return t.l+=2,[S_(t),t.read_shift(2)&1]}var aF=uc,iF=P_,sF=Mp,lF=uc,oF=uc,cF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fF(t){t.l+=2;var n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(4),l=t.read_shift(2),c=t.read_shift(2),f=cF[r>>2&31];return{ixti:n,coltype:r&3,rt:f,idx:i,c:l,C:c}}function uF(t){return t.l+=2,[t.read_shift(4)]}function hF(t,n,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function dF(t,n,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pF(t){var n=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[n,r]}function xF(t){var n=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[n,r]}function mF(t){return t.l+=4,[0,0]}var i2={1:{n:"PtgExp",f:zk},2:{n:"PtgTbl",f:Jk},3:{n:"PtgAdd",f:zn},4:{n:"PtgSub",f:zn},5:{n:"PtgMul",f:zn},6:{n:"PtgDiv",f:zn},7:{n:"PtgPower",f:zn},8:{n:"PtgConcat",f:zn},9:{n:"PtgLt",f:zn},10:{n:"PtgLe",f:zn},11:{n:"PtgEq",f:zn},12:{n:"PtgGe",f:zn},13:{n:"PtgGt",f:zn},14:{n:"PtgNe",f:zn},15:{n:"PtgIsect",f:zn},16:{n:"PtgUnion",f:zn},17:{n:"PtgRange",f:zn},18:{n:"PtgUplus",f:zn},19:{n:"PtgUminus",f:zn},20:{n:"PtgPercent",f:zn},21:{n:"PtgParen",f:zn},22:{n:"PtgMissArg",f:zn},23:{n:"PtgStr",f:Uk},26:{n:"PtgSheet",f:hF},27:{n:"PtgEndSheet",f:dF},28:{n:"PtgErr",f:Lk},29:{n:"PtgBool",f:jk},30:{n:"PtgInt",f:Bk},31:{n:"PtgNum",f:Ik},32:{n:"PtgArray",f:_k},33:{n:"PtgFunc",f:Ck},34:{n:"PtgFuncVar",f:Rk},35:{n:"PtgName",f:Pk},36:{n:"PtgRef",f:Nk},37:{n:"PtgArea",f:xk},38:{n:"PtgMemArea",f:Xk},39:{n:"PtgMemErr",f:Zk},40:{n:"PtgMemNoMem",f:Qk},41:{n:"PtgMemFunc",f:Wk},42:{n:"PtgRefErr",f:qk},43:{n:"PtgAreaErr",f:gk},44:{n:"PtgRefN",f:kk},45:{n:"PtgAreaN",f:vk},46:{n:"PtgMemAreaN",f:pF},47:{n:"PtgMemNoMemN",f:xF},57:{n:"PtgNameX",f:Yk},58:{n:"PtgRef3d",f:Fk},59:{n:"PtgArea3d",f:mk},60:{n:"PtgRefErr3d",f:Kk},61:{n:"PtgAreaErr3d",f:yk},255:{}},gF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yF={1:{n:"PtgElfLel",f:P_},2:{n:"PtgElfRw",f:lF},3:{n:"PtgElfCol",f:tF},6:{n:"PtgElfRwV",f:oF},7:{n:"PtgElfColV",f:rF},10:{n:"PtgElfRadical",f:aF},11:{n:"PtgElfRadicalS",f:sF},13:{n:"PtgElfColS",f:eF},15:{n:"PtgElfColSV",f:nF},16:{n:"PtgElfRadicalLel",f:iF},25:{n:"PtgList",f:fF},29:{n:"PtgSxName",f:uF},255:{}},vF={0:{n:"PtgAttrNoop",f:mF},1:{n:"PtgAttrSemi",f:Tk},2:{n:"PtgAttrIf",f:Sk},4:{n:"PtgAttrChoose",f:bk},8:{n:"PtgAttrGoto",f:wk},16:{n:"PtgAttrSum",f:Ok},32:{n:"PtgAttrBaxcel",f:a2},33:{n:"PtgAttrBaxcel",f:a2},64:{n:"PtgAttrSpace",f:Ak},65:{n:"PtgAttrSpaceSemi",f:Dk},128:{n:"PtgAttrIfError",f:Ek},255:{}};function _F(t,n,r,i){if(i.biff<8)return Ta(t,n);for(var l=t.l+n,c=[],f=0;f!==r.length;++f)switch(r[f][0]){case"PtgArray":r[f][1]=Gk(t,0,i),c.push(r[f][1]);break;case"PtgMemArea":r[f][2]=$k(t,r[f][1],i),c.push(r[f][2]);break;case"PtgExp":i&&i.biff==12&&(r[f][1][1]=t.read_shift(4),c.push(r[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[f][0]}return n=l-t.l,n!==0&&c.push(Ta(t,n)),c}function bF(t,n,r){for(var i=t.l+n,l,c,f=[];i!=t.l;)n=i-t.l,c=t[t.l],l=i2[c]||i2[gF[c]],(c===24||c===25)&&(l=(c===24?yF:vF)[t[t.l+1]]),!l||!l.f?Ta(t,n):f.push([l.n,l.f(t,n,r)]);return f}function wF(t){for(var n=[],r=0;r<t.length;++r){for(var i=t[r],l=[],c=0;c<i.length;++c){var f=i[c];if(f)switch(f[0]){case 2:l.push('"'+f[1].replace(/"/g,'""')+'"');break;default:l.push(f[1])}else l.push("")}n.push(l.join(","))}return n.join(";")}var SF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EF(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Y_(t,n,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[n];if(r.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!i)return"SH33TJSERR1";var l="";if(r.biff>8)switch(t[i[0]][0]){case 357:return l=i[1]==-1?"#REF":t.SheetNames[i[1]],i[1]==i[2]?l:l+":"+t.SheetNames[i[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[i[0]][0];case 355:default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return l=i[1]==-1?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?l:l+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return t[i[0]][0][3]?(l=i[1]==-1?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?l:l+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function s2(t,n,r){var i=Y_(t,n,r);return i=="#REF"?i:EF(i,r)}function bl(t,n,r,i,l){var c=l&&l.biff||8,f={s:{c:0,r:0}},d=[],p,h,m,y=0,v=0,w,S="";if(!t[0]||!t[0][0])return"";for(var b=-1,E="",A=0,O=t[0].length;A<O;++A){var C=t[0][A];switch(C[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=d.pop(),h=d.pop(),b>=0){switch(t[0][b][1][0]){case 0:E=Tn(" ",t[0][b][1][1]);break;case 1:E=Tn("\r",t[0][b][1][1]);break;default:if(E="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}h=h+E,b=-1}d.push(h+SF[C[0]]+p);break;case"PtgIsect":p=d.pop(),h=d.pop(),d.push(h+" "+p);break;case"PtgUnion":p=d.pop(),h=d.pop(),d.push(h+","+p);break;case"PtgRange":p=d.pop(),h=d.pop(),d.push(h+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Uo(C[1][1],f,l),d.push(Ho(m,c));break;case"PtgRefN":m=r?Uo(C[1][1],r,l):C[1][1],d.push(Ho(m,c));break;case"PtgRef3d":y=C[1][1],m=Uo(C[1][2],f,l),S=s2(i,y,l),d.push(S+"!"+Ho(m,c));break;case"PtgFunc":case"PtgFuncVar":var U=C[1][0],B=C[1][1];U||(U=0),U&=127;var V=U==0?[]:d.slice(-U);d.length-=U,B==="User"&&(B=V.shift()),d.push(B+"("+V.join(",")+")");break;case"PtgBool":d.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(C[1]);break;case"PtgNum":d.push(String(C[1]));break;case"PtgStr":d.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(C[1]);break;case"PtgAreaN":w=Py(C[1][1],r?{s:r}:f,l),d.push(vd(w,l));break;case"PtgArea":w=Py(C[1][1],f,l),d.push(vd(w,l));break;case"PtgArea3d":y=C[1][1],w=C[1][2],S=s2(i,y,l),d.push(S+"!"+vd(w,l));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var k=(i.names||[])[v-1]||(i[0]||[])[v],F=k?k.Name:"SH33TJSNAME"+String(v);F&&F.slice(0,6)=="_xlfn."&&!l.xlfn&&(F=F.slice(6)),d.push(F);break;case"PtgNameX":var T=C[1][1];v=C[1][2];var N;if(l.biff<=5)T<0&&(T=-T),i[T]&&(N=i[T][v]);else{var D="";if(((i[T]||[])[0]||[])[0]==14849||(((i[T]||[])[0]||[])[0]==1025?i[T][v]&&i[T][v].itab>0&&(D=i.SheetNames[i[T][v].itab-1]+"!"):D=i.SheetNames[v-1]+"!"),i[T]&&i[T][v])D+=i[T][v].Name;else if(i[0]&&i[0][v])D+=i[0][v].Name;else{var L=(Y_(i,T,l)||"").split(";;");L[v-1]?D=L[v-1]:D+="SH33TJSERRX"}d.push(D);break}N||(N={Name:"SH33TJSERRY"}),d.push(N.Name);break;case"PtgParen":var K="(",ft=")";if(b>=0){switch(E="",t[0][b][1][0]){case 2:K=Tn(" ",t[0][b][1][1])+K;break;case 3:K=Tn("\r",t[0][b][1][1])+K;break;case 4:ft=Tn(" ",t[0][b][1][1])+ft;break;case 5:ft=Tn("\r",t[0][b][1][1])+ft;break;default:if(l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}d.push(K+d.pop()+ft);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:C[1][1],r:C[1][0]};var dt={c:r.c,r:r.r};if(i.sharedf[en(m)]){var J=i.sharedf[en(m)];d.push(bl(J,f,dt,i,l))}else{var gt=!1;for(p=0;p!=i.arrayf.length;++p)if(h=i.arrayf[p],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){d.push(bl(h[1],f,dt,i,l)),gt=!0;break}gt||d.push(C[1])}break;case"PtgArray":d.push("{"+wF(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var wt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(l.biff!=3&&b>=0&&wt.indexOf(t[0][A][0])==-1){C=t[0][b];var bt=!0;switch(C[1][0]){case 4:bt=!1;case 0:E=Tn(" ",C[1][1]);break;case 5:bt=!1;case 1:E=Tn("\r",C[1][1]);break;default:if(E="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}d.push((bt?E:"")+d.pop()+(bt?"":E)),b=-1}}if(d.length>1&&l.WTF)throw new Error("bad formula stack");return d[0]}function TF(t){if(t==null){var n=Xt(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof t=="number")return fs(t);return fs(0)}function AF(t,n,r,i,l){var c=us(n,r,l),f=TF(t.v),d=Xt(6),p=33;d.write_shift(2,p),d.write_shift(4,0);for(var h=Xt(t.bf.length),m=0;m<t.bf.length;++m)h[m]=t.bf[m];var y=nr([c,f,d,h]);return y}function L0(t,n,r){var i=t.read_shift(4),l=bF(t,i,r),c=t.read_shift(4),f=c>0?_F(t,c,l,r):null;return[l,f]}var DF=L0,B0=L0,NF=L0,kF=L0,FF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},V_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},CF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function RF(t){var n="of:="+t.replace(Cp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function MF(t){return t.replace(/\./,"!")}var $o=typeof Map<"u";function Op(t,n,r){var i=0,l=t.length;if(r){if($o?r.has(n):Object.prototype.hasOwnProperty.call(r,n)){for(var c=$o?r.get(n):r[n];i<c.length;++i)if(t[c[i]].t===n)return t.Count++,c[i]}}else for(;i<l;++i)if(t[i].t===n)return t.Count++,i;return t[l]={t:n},t.Count++,t.Unique++,r&&($o?(r.has(n)||r.set(n,[]),r.get(n).push(l)):(Object.prototype.hasOwnProperty.call(r,n)||(r[n]=[]),r[n].push(l))),l}function j0(t,n){var r={min:t+1,max:t+1},i=-1;return n.MDW&&(Qa=n.MDW),n.width!=null?r.customWidth=1:n.wpx!=null?i=y0(n.wpx):n.wch!=null&&(i=n.wch),i>-1?(r.width=qd(i),r.customWidth=1):n.width!=null&&(r.width=n.width),n.hidden&&(r.hidden=!0),n.level!=null&&(r.outlineLevel=r.level=n.level),r}function X_(t,n){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Li(t,n,r){var i=r.revssf[n.z!=null?n.z:"General"],l=60,c=t.length;if(i==null&&r.ssf){for(;l<392;++l)if(r.ssf[l]==null){$v(n.z,l),r.ssf[l]=n.z,r.revssf[n.z]=i=l;break}}for(l=0;l!=c;++l)if(t[l].numFmtId===i)return l;return t[c]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function OF(t,n,r){if(t&&t["!ref"]){var i=mn(t["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function zF(t){if(t.length===0)return"";for(var n='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)n+='<mergeCell ref="'+Ln(t[r])+'"/>';return n+"</mergeCells>"}function LF(t,n,r,i,l){var c=!1,f={},d=null;if(i.bookType!=="xlsx"&&n.vbaraw){var p=n.SheetNames[r];try{n.Workbook&&(p=n.Workbook.Sheets[r].CodeName||p)}catch{}c=!0,f.codeName=Zo(tn(p))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),d=(d||"")+oe("outlinePr",null,h)}!c&&!d||(l[l.length]=oe("sheetPr",d,f))}var BF=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jF=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function IF(t){var n={sheet:1};return BF.forEach(function(r){t[r]!=null&&t[r]&&(n[r]="1")}),jF.forEach(function(r){t[r]!=null&&!t[r]&&(n[r]="0")}),t.password&&(n.password=F_(t.password).toString(16).toUpperCase()),oe("sheetProtection",null,n)}function UF(t){return X_(t),oe("pageMargins",null,t)}function HF(t,n){for(var r=["<cols>"],i,l=0;l!=n.length;++l)(i=n[l])&&(r[r.length]=oe("col",null,j0(l,i)));return r[r.length]="</cols>",r.join("")}function $F(t,n,r,i){var l=typeof t.ref=="string"?t.ref:Ln(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,f=Ir(l);f.s.r==f.e.r&&(f.e.r=Ir(n["!ref"]).e.r,l=Ln(f));for(var d=0;d<c.length;++d){var p=c[d];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==i){p.Ref="'"+r.SheetNames[i]+"'!"+l;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+l}),oe("autoFilter",null,{ref:l})}function GF(t,n,r,i){var l={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(l.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,l),{})}function PF(t,n,r,i){if(t.c&&r["!comments"].push([n,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var l="",c=t.t,f=t.v;if(t.t!=="z")switch(t.t){case"b":l=t.v?"1":"0";break;case"n":l=""+t.v;break;case"e":l=fc[t.v];break;case"d":i&&i.cellDates?l=yr(t.v,-1).toISOString():(t=Ar(t),t.t="n",l=""+(t.v=Tr(yr(t.v)))),typeof t.z>"u"&&(t.z=Dn[14]);break;default:l=t.v;break}var d=rr("v",tn(l)),p={r:n},h=Li(i.cellXfs,t,i);switch(h!==0&&(p.s=h),t.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){d=rr("v",""+Op(i.Strings,t.v,i.revStrings)),p.t="s";break}p.t="str";break}if(t.t!=c&&(t.t=c,t.v=f),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,n.length)==n?{t:"array",ref:t.F}:null;d=oe("f",tn(t.f),m)+(t.v!=null?d:"")}return t.l&&r["!links"].push([n,t.l]),t.D&&(p.cm=1),oe("c",d,p)}function YF(t,n,r,i){var l=[],c=[],f=mn(t["!ref"]),d="",p,h="",m=[],y=0,v=0,w=t["!rows"],S=Array.isArray(t),b={r:h},E,A=-1;for(v=f.s.c;v<=f.e.c;++v)m[v]=ur(v);for(y=f.s.r;y<=f.e.r;++y){for(c=[],h=ar(y),v=f.s.c;v<=f.e.c;++v){p=m[v]+h;var O=S?(t[y]||[])[v]:t[p];O!==void 0&&(d=PF(O,p,t,n))!=null&&c.push(d)}(c.length>0||w&&w[y])&&(b={r:h},w&&w[y]&&(E=w[y],E.hidden&&(b.hidden=1),A=-1,E.hpx?A=v0(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(b.ht=A,b.customHeight=1),E.level&&(b.outlineLevel=E.level)),l[l.length]=oe("row",c.join(""),b))}if(w)for(;y<w.length;++y)w&&w[y]&&(b={r:y+1},E=w[y],E.hidden&&(b.hidden=1),A=-1,E.hpx?A=v0(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(b.ht=A,b.customHeight=1),E.level&&(b.outlineLevel=E.level),l[l.length]=oe("row","",b));return l.join("")}function W_(t,n,r,i){var l=[Bn,oe("worksheet",null,{xmlns:Al[0],"xmlns:r":Xn.r})],c=r.SheetNames[t],f=0,d="",p=r.Sheets[c];p==null&&(p={});var h=p["!ref"]||"A1",m=mn(h);if(m.e.c>16383||m.e.r>1048575){if(n.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Ln(m)}i||(i={}),p["!comments"]=[];var y=[];LF(p,r,t,n,l),l[l.length]=oe("dimension",null,{ref:h}),l[l.length]=GF(p,n,t,r),n.sheetFormat&&(l[l.length]=oe("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),p["!cols"]!=null&&p["!cols"].length>0&&(l[l.length]=HF(p,p["!cols"])),l[f=l.length]="<sheetData/>",p["!links"]=[],p["!ref"]!=null&&(d=YF(p,n),d.length>0&&(l[l.length]=d)),l.length>f+1&&(l[l.length]="</sheetData>",l[f]=l[f].replace("/>",">")),p["!protect"]&&(l[l.length]=IF(p["!protect"])),p["!autofilter"]!=null&&(l[l.length]=$F(p["!autofilter"],p,r,t)),p["!merges"]!=null&&p["!merges"].length>0&&(l[l.length]=zF(p["!merges"]));var v=-1,w,S=-1;return p["!links"].length>0&&(l[l.length]="<hyperlinks>",p["!links"].forEach(function(b){b[1].Target&&(w={ref:b[0]},b[1].Target.charAt(0)!="#"&&(S=Je(i,-1,tn(b[1].Target).replace(/#.*$/,""),Pe.HLINK),w["r:id"]="rId"+S),(v=b[1].Target.indexOf("#"))>-1&&(w.location=tn(b[1].Target.slice(v+1))),b[1].Tooltip&&(w.tooltip=tn(b[1].Tooltip)),l[l.length]=oe("hyperlink",null,w))}),l[l.length]="</hyperlinks>"),delete p["!links"],p["!margins"]!=null&&(l[l.length]=UF(p["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(l[l.length]=rr("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),y.length>0&&(S=Je(i,-1,"../drawings/drawing"+(t+1)+".xml",Pe.DRAW),l[l.length]=oe("drawing",null,{"r:id":"rId"+S}),p["!drawing"]=y),p["!comments"].length>0&&(S=Je(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Pe.VML),l[l.length]=oe("legacyDrawing",null,{"r:id":"rId"+S}),p["!legacy"]=S),l.length>1&&(l[l.length]="</worksheet>",l[1]=l[1].replace("/>",">")),l.join("")}function VF(t,n){var r={},i=t.l+n;r.r=t.read_shift(4),t.l+=4;var l=t.read_shift(2);t.l+=1;var c=t.read_shift(1);return t.l=i,c&7&&(r.level=c&7),c&16&&(r.hidden=!0),c&32&&(r.hpt=l/20),r}function XF(t,n,r){var i=Xt(145),l=(r["!rows"]||[])[t]||{};i.write_shift(4,t),i.write_shift(4,0);var c=320;l.hpx?c=v0(l.hpx)*20:l.hpt&&(c=l.hpt*20),i.write_shift(2,c),i.write_shift(1,0);var f=0;l.level&&(f|=l.level),l.hidden&&(f|=16),(l.hpx||l.hpt)&&(f|=32),i.write_shift(1,f),i.write_shift(1,0);var d=0,p=i.l;i.l+=4;for(var h={r:t,c:0},m=0;m<16;++m)if(!(n.s.c>m+1<<10||n.e.c<m<<10)){for(var y=-1,v=-1,w=m<<10;w<m+1<<10;++w){h.c=w;var S=Array.isArray(r)?(r[h.r]||[])[h.c]:r[en(h)];S&&(y<0&&(y=w),v=w)}y<0||(++d,i.write_shift(4,y),i.write_shift(4,v))}var b=i.l;return i.l=p,i.write_shift(4,d),i.l=b,i.length>i.l?i.slice(0,i.l):i}function WF(t,n,r,i){var l=XF(i,r,n);(l.length>17||(n["!rows"]||[])[i])&&ee(t,0,l)}var qF=bs,KF=Nl;function ZF(){}function QF(t,n){var r={},i=t[t.l];return++t.l,r.above=!(i&64),r.left=!(i&128),t.l+=18,r.name=oD(t),r}function JF(t,n,r){r==null&&(r=Xt(84+4*t.length));var i=192;n&&(n.above&&(i&=-65),n.left&&(i&=-129)),r.write_shift(1,i);for(var l=1;l<3;++l)r.write_shift(1,0);return x0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),c_(t,r),r.slice(0,r.l)}function tC(t){var n=Qr(t);return[n]}function eC(t,n,r){return r==null&&(r=Xt(8)),ys(n,r)}function nC(t){var n=vs(t);return[n]}function rC(t,n,r){return r==null&&(r=Xt(4)),_s(n,r)}function aC(t){var n=Qr(t),r=t.read_shift(1);return[n,r,"b"]}function iC(t,n,r){return r==null&&(r=Xt(9)),ys(n,r),r.write_shift(1,t.v?1:0),r}function sC(t){var n=vs(t),r=t.read_shift(1);return[n,r,"b"]}function lC(t,n,r){return r==null&&(r=Xt(5)),_s(n,r),r.write_shift(1,t.v?1:0),r}function oC(t){var n=Qr(t),r=t.read_shift(1);return[n,r,"e"]}function cC(t,n,r){return r==null&&(r=Xt(9)),ys(n,r),r.write_shift(1,t.v),r}function fC(t){var n=vs(t),r=t.read_shift(1);return[n,r,"e"]}function uC(t,n,r){return r==null&&(r=Xt(8)),_s(n,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function hC(t){var n=Qr(t),r=t.read_shift(4);return[n,r,"s"]}function dC(t,n,r){return r==null&&(r=Xt(12)),ys(n,r),r.write_shift(4,n.v),r}function pC(t){var n=vs(t),r=t.read_shift(4);return[n,r,"s"]}function xC(t,n,r){return r==null&&(r=Xt(8)),_s(n,r),r.write_shift(4,n.v),r}function mC(t){var n=Qr(t),r=kl(t);return[n,r,"n"]}function gC(t,n,r){return r==null&&(r=Xt(16)),ys(n,r),fs(t.v,r),r}function yC(t){var n=vs(t),r=kl(t);return[n,r,"n"]}function vC(t,n,r){return r==null&&(r=Xt(12)),_s(n,r),fs(t.v,r),r}function _C(t){var n=Qr(t),r=f_(t);return[n,r,"n"]}function bC(t,n,r){return r==null&&(r=Xt(12)),ys(n,r),u_(t.v,r),r}function wC(t){var n=vs(t),r=f_(t);return[n,r,"n"]}function SC(t,n,r){return r==null&&(r=Xt(8)),_s(n,r),u_(t.v,r),r}function EC(t){var n=Qr(t),r=Ap(t);return[n,r,"is"]}function TC(t){var n=Qr(t),r=hr(t);return[n,r,"str"]}function AC(t,n,r){return r==null&&(r=Xt(12+4*t.v.length)),ys(n,r),qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function DC(t){var n=vs(t),r=hr(t);return[n,r,"str"]}function NC(t,n,r){return r==null&&(r=Xt(8+4*t.v.length)),_s(n,r),qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function kC(t,n,r){var i=t.l+n,l=Qr(t);l.r=r["!row"];var c=t.read_shift(1),f=[l,c,"b"];if(r.cellFormula){t.l+=2;var d=B0(t,i-t.l,r);f[3]=bl(d,null,l,r.supbooks,r)}else t.l=i;return f}function FC(t,n,r){var i=t.l+n,l=Qr(t);l.r=r["!row"];var c=t.read_shift(1),f=[l,c,"e"];if(r.cellFormula){t.l+=2;var d=B0(t,i-t.l,r);f[3]=bl(d,null,l,r.supbooks,r)}else t.l=i;return f}function CC(t,n,r){var i=t.l+n,l=Qr(t);l.r=r["!row"];var c=kl(t),f=[l,c,"n"];if(r.cellFormula){t.l+=2;var d=B0(t,i-t.l,r);f[3]=bl(d,null,l,r.supbooks,r)}else t.l=i;return f}function RC(t,n,r){var i=t.l+n,l=Qr(t);l.r=r["!row"];var c=hr(t),f=[l,c,"str"];if(r.cellFormula){t.l+=2;var d=B0(t,i-t.l,r);f[3]=bl(d,null,l,r.supbooks,r)}else t.l=i;return f}var MC=bs,OC=Nl;function zC(t,n){return n==null&&(n=Xt(4)),n.write_shift(4,t),n}function LC(t,n){var r=t.l+n,i=bs(t),l=Dp(t),c=hr(t),f=hr(t),d=hr(t);t.l=r;var p={rfx:i,relId:l,loc:c,display:d};return f&&(p.Tooltip=f),p}function BC(t,n){var r=Xt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Nl({s:Wn(t[0]),e:Wn(t[0])},r),Np("rId"+n,r);var i=t[1].Target.indexOf("#"),l=i==-1?"":t[1].Target.slice(i+1);return qn(l||"",r),qn(t[1].Tooltip||"",r),qn("",r),r.slice(0,r.l)}function jC(){}function IC(t,n,r){var i=t.l+n,l=h_(t),c=t.read_shift(1),f=[l];if(f[2]=c,r.cellFormula){var d=DF(t,i-t.l,r);f[1]=d}else t.l=i;return f}function UC(t,n,r){var i=t.l+n,l=bs(t),c=[l];if(r.cellFormula){var f=kF(t,i-t.l,r);c[1]=f,t.l=i}else t.l=i;return c}function HC(t,n,r){r==null&&(r=Xt(18));var i=j0(t,n);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(i.width||10)*256),r.write_shift(4,0);var l=0;return n.hidden&&(l|=1),typeof i.width=="number"&&(l|=2),n.level&&(l|=n.level<<8),r.write_shift(2,l),r}var q_=["left","right","top","bottom","header","footer"];function $C(t){var n={};return q_.forEach(function(r){n[r]=kl(t)}),n}function GC(t,n){return n==null&&(n=Xt(6*8)),X_(t),q_.forEach(function(r){fs(t[r],n)}),n}function PC(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function YC(t,n,r){r==null&&(r=Xt(30));var i=924;return(((n||{}).Views||[])[0]||{}).RTL&&(i|=32),r.write_shift(2,i),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function VC(t){var n=Xt(24);return n.write_shift(4,4),n.write_shift(4,1),Nl(t,n),n}function XC(t,n){return n==null&&(n=Xt(16*4+2)),n.write_shift(2,t.password?F_(t.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?n.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):n.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),n}function WC(){}function qC(){}function KC(t,n,r,i,l,c,f){if(n.v===void 0)return!1;var d="";switch(n.t){case"b":d=n.v?"1":"0";break;case"d":n=Ar(n),n.z=n.z||Dn[14],n.v=Tr(yr(n.v)),n.t="n";break;case"n":case"e":d=""+n.v;break;default:d=n.v;break}var p={r,c:i};switch(p.s=Li(l.cellXfs,n,l),n.l&&c["!links"].push([en(p),n.l]),n.c&&c["!comments"].push([en(p),n.c]),n.t){case"s":case"str":return l.bookSST?(d=Op(l.Strings,n.v,l.revStrings),p.t="s",p.v=d,f?ee(t,18,xC(n,p)):ee(t,7,dC(n,p))):(p.t="str",f?ee(t,17,NC(n,p)):ee(t,6,AC(n,p))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?f?ee(t,13,SC(n,p)):ee(t,2,bC(n,p)):f?ee(t,16,vC(n,p)):ee(t,5,gC(n,p)),!0;case"b":return p.t="b",f?ee(t,15,lC(n,p)):ee(t,4,iC(n,p)),!0;case"e":return p.t="e",f?ee(t,14,uC(n,p)):ee(t,3,cC(n,p)),!0}return f?ee(t,12,rC(n,p)):ee(t,1,eC(n,p)),!0}function ZC(t,n,r,i){var l=mn(n["!ref"]||"A1"),c,f="",d=[];ee(t,145);var p=Array.isArray(n),h=l.e.r;n["!rows"]&&(h=Math.max(l.e.r,n["!rows"].length-1));for(var m=l.s.r;m<=h;++m){f=ar(m),WF(t,n,l,m);var y=!1;if(m<=l.e.r)for(var v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(d[v]=ur(v)),c=d[v]+f;var w=p?(n[m]||[])[v]:n[c];if(!w){y=!1;continue}y=KC(t,w,m,v,i,n,y)}}ee(t,146)}function QC(t,n){!n||!n["!merges"]||(ee(t,177,zC(n["!merges"].length)),n["!merges"].forEach(function(r){ee(t,176,OC(r))}),ee(t,178))}function JC(t,n){!n||!n["!cols"]||(ee(t,390),n["!cols"].forEach(function(r,i){r&&ee(t,60,HC(i,r))}),ee(t,391))}function t7(t,n){!n||!n["!ref"]||(ee(t,648),ee(t,649,VC(mn(n["!ref"]))),ee(t,650))}function e7(t,n,r){n["!links"].forEach(function(i){if(i[1].Target){var l=Je(r,-1,i[1].Target.replace(/#.*$/,""),Pe.HLINK);ee(t,494,BC(i,l))}}),delete n["!links"]}function n7(t,n,r,i){if(n["!comments"].length>0){var l=Je(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pe.VML);ee(t,551,Np("rId"+l)),n["!legacy"]=l}}function r7(t,n,r,i){if(n["!autofilter"]){var l=n["!autofilter"],c=typeof l.ref=="string"?l.ref:Ln(l.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var f=r.Workbook.Names,d=Ir(c);d.s.r==d.e.r&&(d.e.r=Ir(n["!ref"]).e.r,c=Ln(d));for(var p=0;p<f.length;++p){var h=f[p];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+r.SheetNames[i]+"'!"+c;break}}p==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+c}),ee(t,161,Nl(mn(c))),ee(t,162)}}function a7(t,n,r){ee(t,133),ee(t,137,YC(n,r)),ee(t,138),ee(t,134)}function i7(t,n){n["!protect"]&&ee(t,535,XC(n["!protect"]))}function s7(t,n,r,i){var l=Er(),c=r.SheetNames[t],f=r.Sheets[c]||{},d=c;try{r&&r.Workbook&&(d=r.Workbook.Sheets[t].CodeName||d)}catch{}var p=mn(f["!ref"]||"A1");if(p.e.c>16383||p.e.r>1048575){if(n.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],ee(l,129),(r.vbaraw||f["!outline"])&&ee(l,147,JF(d,f["!outline"])),ee(l,148,KF(p)),a7(l,f,r.Workbook),JC(l,f),ZC(l,f,t,n),i7(l,f),r7(l,f,r,t),QC(l,f),e7(l,f,i),f["!margins"]&&ee(l,476,GC(f["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&t7(l,f),n7(l,f,t,i),ee(l,130),l.end()}function l7(t,n){t.l+=10;var r=hr(t);return{name:r}}var o7=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function c7(t){return!t.Workbook||!t.Workbook.WBProps?"false":U5(t.Workbook.WBProps.date1904)?"true":"false"}var f7="][*?/\\".split("");function K_(t,n){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return f7.forEach(function(i){if(t.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function u7(t,n,r){t.forEach(function(i,l){K_(i);for(var c=0;c<l;++c)if(i==t[c])throw new Error("Duplicate Sheet Name: "+i);if(r){var f=n&&n[l]&&n[l].CodeName||i;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function h7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var n=t.Workbook&&t.Workbook.Sheets||[];u7(t.SheetNames,n,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)OF(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function Z_(t){var n=[Bn];n[n.length]=oe("workbook",null,{xmlns:Al[0],"xmlns:r":Xn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(o7.forEach(function(d){t.Workbook.WBProps[d[0]]!=null&&t.Workbook.WBProps[d[0]]!=d[1]&&(i[d[0]]=t.Workbook.WBProps[d[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),n[n.length]=oe("workbookPr",null,i);var l=t.Workbook&&t.Workbook.Sheets||[],c=0;if(l&&l[0]&&l[0].Hidden){for(n[n.length]="<bookViews>",c=0;c!=t.SheetNames.length&&!(!l[c]||!l[c].Hidden);++c);c==t.SheetNames.length&&(c=0),n[n.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",c=0;c!=t.SheetNames.length;++c){var f={name:tn(t.SheetNames[c].slice(0,31))};if(f.sheetId=""+(c+1),f["r:id"]="rId"+(c+1),l[c])switch(l[c].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}n[n.length]=oe("sheet",null,f)}return n[n.length]="</sheets>",r&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(d){var p={name:d.Name};d.Comment&&(p.comment=d.Comment),d.Sheet!=null&&(p.localSheetId=""+d.Sheet),d.Hidden&&(p.hidden="1"),d.Ref&&(n[n.length]=oe("definedName",tn(d.Ref),p))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function d7(t,n){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Wd(t),r.name=hr(t),r}function p7(t,n){return n||(n=Xt(127)),n.write_shift(4,t.Hidden),n.write_shift(4,t.iTabID),Np(t.strRelID,n),qn(t.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function x7(t,n){var r={},i=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var l=n>8?hr(t):"";return l.length>0&&(r.CodeName=l),r.autoCompressPictures=!!(i&65536),r.backupFile=!!(i&64),r.checkCompatibility=!!(i&4096),r.date1904=!!(i&1),r.filterPrivacy=!!(i&8),r.hidePivotFieldList=!!(i&1024),r.promptedSolutions=!!(i&16),r.publishItems=!!(i&2048),r.refreshAllConnections=!!(i&262144),r.saveExternalLinkValues=!!(i&128),r.showBorderUnselectedTables=!!(i&4),r.showInkAnnotation=!!(i&32),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(i&32768),r.updateLinks=["userSet","never","always"][i>>8&3],r}function m7(t,n){n||(n=Xt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),n.write_shift(4,r),n.write_shift(4,0),c_(t&&t.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function g7(t,n,r){var i=t.l+n;t.l+=4,t.l+=1;var l=t.read_shift(4),c=cD(t),f=NF(t,0,r),d=Dp(t);t.l=i;var p={Name:c,Ptg:f};return l<268435455&&(p.Sheet=l),d&&(p.Comment=d),p}function y7(t,n){ee(t,143);for(var r=0;r!=n.SheetNames.length;++r){var i=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r]&&n.Workbook.Sheets[r].Hidden||0,l={Hidden:i,iTabID:r+1,strRelID:"rId"+(r+1),name:n.SheetNames[r]};ee(t,156,p7(l))}ee(t,144)}function v7(t,n){n||(n=Xt(127));for(var r=0;r!=4;++r)n.write_shift(4,0);return qn("SheetJS",n),qn(l0.version,n),qn(l0.version,n),qn("7262",n),n.length>n.l?n.slice(0,n.l):n}function _7(t,n){n||(n=Xt(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,t),n.write_shift(4,t);var r=120;return n.write_shift(1,r),n.length>n.l?n.slice(0,n.l):n}function b7(t,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var r=n.Workbook.Sheets,i=0,l=-1,c=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&l==-1?l=i:r[i].Hidden==1&&c==-1&&(c=i);c>l||(ee(t,135),ee(t,158,_7(l)),ee(t,136))}}function w7(t,n){var r=Er();return ee(r,131),ee(r,128,v7()),ee(r,153,m7(t.Workbook&&t.Workbook.WBProps||null)),b7(r,t),y7(r,t),ee(r,132),r.end()}function S7(t,n,r){return(n.slice(-4)===".bin"?w7:Z_)(t)}function E7(t,n,r,i,l){return(n.slice(-4)===".bin"?s7:W_)(t,r,i,l)}function T7(t,n,r){return(n.slice(-4)===".bin"?GN:M_)(t,r)}function A7(t,n,r){return(n.slice(-4)===".bin"?mN:k_)(t,r)}function D7(t,n,r){return(n.slice(-4)===".bin"?ik:j_)(t)}function N7(t){return(t.slice(-4)===".bin"?ZN:L_)()}function k7(t,n){var r=[];return t.Props&&r.push(TD(t.Props,n)),t.Custprops&&r.push(AD(t.Props,t.Custprops)),r.join("")}function F7(){return""}function C7(t,n){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(i,l){var c=[];c.push(oe("NumberFormat",null,{"ss:Format":tn(Dn[i.numFmtId])}));var f={"ss:ID":"s"+(21+l)};r.push(oe("Style",c.join(""),f))}),oe("Styles",r.join(""))}function Q_(t){return oe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Rp(t.Ref,{r:0,c:0})})}function R7(t){if(!((t||{}).Workbook||{}).Names)return"";for(var n=t.Workbook.Names,r=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==null&&(l.Name.match(/^_xlfn\./)||r.push(Q_(l)))}return oe("Names",r.join(""))}function M7(t,n,r,i){if(!t||!((i||{}).Workbook||{}).Names)return"";for(var l=i.Workbook.Names,c=[],f=0;f<l.length;++f){var d=l[f];d.Sheet==r&&(d.Name.match(/^_xlfn\./)||c.push(Q_(d)))}return c.join("")}function O7(t,n,r,i){if(!t)return"";var l=[];if(t["!margins"]&&(l.push("<PageSetup>"),t["!margins"].header&&l.push(oe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&l.push(oe("Footer",null,{"x:Margin":t["!margins"].footer})),l.push(oe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),l.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[r])if(i.Workbook.Sheets[r].Hidden)l.push(oe("Visible",i.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<r&&!(i.Workbook.Sheets[c]&&!i.Workbook.Sheets[c].Hidden);++c);c==r&&l.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&l.push("<DisplayRightToLeft/>"),t["!protect"]&&(l.push(rr("ProtectContents","True")),t["!protect"].objects&&l.push(rr("ProtectObjects","True")),t["!protect"].scenarios&&l.push(rr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?l.push(rr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&l.push(rr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){t["!protect"][f[0]]&&l.push("<"+f[1]+"/>")})),l.length==0?"":oe("WorksheetOptions",l.join(""),{xmlns:Lr.x})}function z7(t){return t.map(function(n){var r=I5(n.t||""),i=oe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",i,{"ss:Author":n.a})}).join("")}function L7(t,n,r,i,l,c,f){if(!t||t.v==null&&t.f==null)return"";var d={};if(t.f&&(d["ss:Formula"]="="+tn(Rp(t.f,f))),t.F&&t.F.slice(0,n.length)==n){var p=Wn(t.F.slice(n.length+1));d["ss:ArrayRange"]="RC:R"+(p.r==f.r?"":"["+(p.r-f.r)+"]")+"C"+(p.c==f.c?"":"["+(p.c-f.c)+"]")}if(t.l&&t.l.Target&&(d["ss:HRef"]=tn(t.l.Target),t.l.Tooltip&&(d["x:HRefScreenTip"]=tn(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=f.c||h[m].s.r!=f.r||(h[m].e.c>h[m].s.c&&(d["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(d["ss:MergeDown"]=h[m].e.r-h[m].s.r));var y="",v="";switch(t.t){case"z":if(!i.sheetStubs)return"";break;case"n":y="Number",v=String(t.v);break;case"b":y="Boolean",v=t.v?"1":"0";break;case"e":y="Error",v=fc[t.v];break;case"d":y="DateTime",v=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Dn[14]);break;case"s":y="String",v=j5(t.v||"");break}var w=Li(i.cellXfs,t,i);d["ss:StyleID"]="s"+(21+w),d["ss:Index"]=f.c+1;var S=t.v!=null?v:"",b=t.t=="z"?"":'<Data ss:Type="'+y+'">'+S+"</Data>";return(t.c||[]).length>0&&(b+=z7(t.c)),oe("Cell",b,d)}function B7(t,n){var r='<Row ss:Index="'+(t+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=R_(n.hpt)),n.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(r+=' ss:Hidden="1"')),r+">"}function j7(t,n,r,i){if(!t["!ref"])return"";var l=mn(t["!ref"]),c=t["!merges"]||[],f=0,d=[];t["!cols"]&&t["!cols"].forEach(function(E,A){Fp(E);var O=!!E.width,C=j0(A,E),U={"ss:Index":A+1};O&&(U["ss:Width"]=g0(C.width)),E.hidden&&(U["ss:Hidden"]="1"),d.push(oe("Column",null,U))});for(var p=Array.isArray(t),h=l.s.r;h<=l.e.r;++h){for(var m=[B7(h,(t["!rows"]||[])[h])],y=l.s.c;y<=l.e.c;++y){var v=!1;for(f=0;f!=c.length;++f)if(!(c[f].s.c>y)&&!(c[f].s.r>h)&&!(c[f].e.c<y)&&!(c[f].e.r<h)){(c[f].s.c!=y||c[f].s.r!=h)&&(v=!0);break}if(!v){var w={r:h,c:y},S=en(w),b=p?(t[h]||[])[y]:t[S];m.push(L7(b,S,t,n,r,i,w))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function I7(t,n,r){var i=[],l=r.SheetNames[t],c=r.Sheets[l],f=c?M7(c,n,t,r):"";return f.length>0&&i.push("<Names>"+f+"</Names>"),f=c?j7(c,n,t,r):"",f.length>0&&i.push("<Table>"+f+"</Table>"),i.push(O7(c,n,t,r)),i.join("")}function U7(t,n){n||(n={}),t.SSF||(t.SSF=Ar(Dn)),t.SSF&&(M0(),R0(t.SSF),n.revssf=O0(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF,n.cellXfs=[],Li(n.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(k7(t,n)),r.push(F7()),r.push(""),r.push("");for(var i=0;i<t.SheetNames.length;++i)r.push(oe("Worksheet",I7(i,n,t),{"ss:Name":tn(t.SheetNames[i])}));return r[2]=C7(t,n),r[3]=R7(t),Bn+oe("Workbook",r.join(""),{xmlns:Lr.ss,"xmlns:o":Lr.o,"xmlns:x":Lr.x,"xmlns:ss":Lr.ss,"xmlns:dt":Lr.dt,"xmlns:html":Lr.html})}var wd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H7(t,n){var r=[],i=[],l=[],c=0,f,d=My(Vy,"n"),p=My(Xy,"n");if(t.Props)for(f=ir(t.Props),c=0;c<f.length;++c)(Object.prototype.hasOwnProperty.call(d,f[c])?r:Object.prototype.hasOwnProperty.call(p,f[c])?i:l).push([f[c],t.Props[f[c]]]);if(t.Custprops)for(f=ir(t.Custprops),c=0;c<f.length;++c)Object.prototype.hasOwnProperty.call(t.Props||{},f[c])||(Object.prototype.hasOwnProperty.call(d,f[c])?r:Object.prototype.hasOwnProperty.call(p,f[c])?i:l).push([f[c],t.Custprops[f[c]]]);var h=[];for(c=0;c<l.length;++c)w_.indexOf(l[c][0])>-1||v_.indexOf(l[c][0])>-1||l[c][1]!=null&&h.push(l[c]);i.length&&cn.utils.cfb_add(n,"/SummaryInformation",Qy(i,wd.SI,p,Xy)),(r.length||h.length)&&cn.utils.cfb_add(n,"/DocumentSummaryInformation",Qy(r,wd.DSI,d,Vy,h.length?h:null,wd.UDI))}function $7(t,n){var r=n||{},i=cn.utils.cfb_new({root:"R"}),l="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":l="/Workbook",r.biff=8;break;case"biff5":l="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return cn.utils.cfb_add(i,l,J_(t,r)),r.biff==8&&(t.Props||t.Custprops)&&H7(t,i),r.biff==8&&t.vbaraw&&sk(i,cn.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),i}var G7={0:{f:VF},1:{f:tC},2:{f:_C},3:{f:oC},4:{f:aC},5:{f:mC},6:{f:TC},7:{f:hC},8:{f:RC},9:{f:CC},10:{f:kC},11:{f:FC},12:{f:nC},13:{f:wC},14:{f:fC},15:{f:sC},16:{f:yC},17:{f:DC},18:{f:pC},19:{f:Ap},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:g7},40:{},42:{},43:{f:TN},44:{f:SN},45:{f:NN},46:{f:FN},47:{f:kN},48:{},49:{f:nD},50:{},51:{f:VN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rN},62:{f:EC},63:{f:QN},64:{f:WC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:PC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:QF},148:{f:qF,p:16},151:{f:jC},152:{},153:{f:x7},154:{},155:{},156:{f:d7},157:{},158:{},159:{T:1,f:dN},160:{T:-1},161:{T:1,f:bs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PN},336:{T:-1},337:{f:qN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:IC},427:{f:UC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$C},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ZF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:LC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rk},633:{T:1},634:{T:-1},635:{T:1,f:ek},636:{T:-1},637:{f:sD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:l7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:qC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ce(t,n,r,i){var l=n;if(!isNaN(l)){var c=i||(r||[]).length||0,f=t.next(4);f.write_shift(2,l),f.write_shift(2,c),c>0&&Sp(r)&&t.push(r)}}function P7(t,n,r,i){var l=(r||[]).length||0;if(l<=8224)return ce(t,n,r,l);var c=n;if(!isNaN(c)){for(var f=r.parts||[],d=0,p=0,h=0;h+(f[d]||8224)<=8224;)h+=f[d]||8224,d++;var m=t.next(4);for(m.write_shift(2,c),m.write_shift(2,h),t.push(r.slice(p,p+h)),p+=h;p<l;){for(m=t.next(4),m.write_shift(2,60),h=0;h+(f[d]||8224)<=8224;)h+=f[d]||8224,d++;m.write_shift(2,h),t.push(r.slice(p,p+h)),p+=h}}}function hc(t,n,r){return t||(t=Xt(7)),t.write_shift(2,n),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Y7(t,n,r,i){var l=Xt(9);return hc(l,t,n),E_(r,i||"b",l),l}function V7(t,n,r){var i=Xt(8+2*r.length);return hc(i,t,n),i.write_shift(1,r.length),i.write_shift(r.length,r,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function X7(t,n,r,i){if(n.v!=null)switch(n.t){case"d":case"n":var l=n.t=="d"?Tr(yr(n.v)):n.v;l==(l|0)&&l>=0&&l<65536?ce(t,2,lN(r,i,l)):ce(t,3,sN(r,i,l));return;case"b":case"e":ce(t,5,Y7(r,i,n.v,n.t));return;case"s":case"str":ce(t,4,V7(r,i,(n.v||"").slice(0,255)));return}ce(t,1,hc(null,r,i))}function W7(t,n,r,i){var l=Array.isArray(n),c=mn(n["!ref"]||"A1"),f,d="",p=[];if(c.e.c>255||c.e.r>16383){if(i.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),f=Ln(c)}for(var h=c.s.r;h<=c.e.r;++h){d=ar(h);for(var m=c.s.c;m<=c.e.c;++m){h===c.s.r&&(p[m]=ur(m)),f=p[m]+d;var y=l?(n[h]||[])[m]:n[f];y&&X7(t,y,h,m)}}}function q7(t,n){for(var r=n||{},i=Er(),l=0,c=0;c<t.SheetNames.length;++c)t.SheetNames[c]==r.sheet&&(l=c);if(l==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ce(i,r.biff==4?1033:r.biff==3?521:9,kp(t,16,r)),W7(i,t.Sheets[t.SheetNames[l]],l,r),ce(i,10),i.end()}function K7(t,n,r){ce(t,49,GD({sz:12,name:"Arial"},r))}function Z7(t,n,r){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var l=i[0];l<=i[1];++l)n[l]!=null&&ce(t,1054,VD(l,n[l],r))})}function Q7(t,n){var r=Xt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ce(t,2151,r),r=Xt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),D_(mn(n["!ref"]||"A1"),r),r.write_shift(4,4),ce(t,2152,r)}function J7(t,n){for(var r=0;r<16;++r)ce(t,224,t2({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(i){ce(t,224,t2(i,0,n))})}function tR(t,n){for(var r=0;r<n["!links"].length;++r){var i=n["!links"][r];ce(t,440,tN(i)),i[1].Tooltip&&ce(t,2048,eN(i))}delete n["!links"]}function eR(t,n){if(n){var r=0;n.forEach(function(i,l){++r<=256&&i&&ce(t,125,aN(j0(l,i),l))})}}function nR(t,n,r,i,l){var c=16+Li(l.cellXfs,n,l);if(n.v==null&&!n.bf){ce(t,513,us(r,i,c));return}if(n.bf)ce(t,6,AF(n,r,i,l,c));else switch(n.t){case"d":case"n":var f=n.t=="d"?Tr(yr(n.v)):n.v;ce(t,515,KD(r,i,f,c));break;case"b":case"e":ce(t,517,qD(r,i,n.v,c,l,n.t));break;case"s":case"str":if(l.bookSST){var d=Op(l.Strings,n.v,l.revStrings);ce(t,253,PD(r,i,d,c))}else ce(t,516,YD(r,i,(n.v||"").slice(0,255),c,l));break;default:ce(t,513,us(r,i,c))}}function rR(t,n,r){var i=Er(),l=r.SheetNames[t],c=r.Sheets[l]||{},f=(r||{}).Workbook||{},d=(f.Sheets||[])[t]||{},p=Array.isArray(c),h=n.biff==8,m,y="",v=[],w=mn(c["!ref"]||"A1"),S=h?65536:16384;if(w.e.c>255||w.e.r>=S){if(n.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,S-1)}ce(i,2057,kp(r,16,n)),ce(i,13,Zr(1)),ce(i,12,Zr(100)),ce(i,15,gr(!0)),ce(i,17,gr(!1)),ce(i,16,fs(.001)),ce(i,95,gr(!0)),ce(i,42,gr(!1)),ce(i,43,gr(!1)),ce(i,130,Zr(1)),ce(i,128,WD()),ce(i,131,gr(!1)),ce(i,132,gr(!1)),h&&eR(i,c["!cols"]),ce(i,512,XD(w,n)),h&&(c["!links"]=[]);for(var b=w.s.r;b<=w.e.r;++b){y=ar(b);for(var E=w.s.c;E<=w.e.c;++E){b===w.s.r&&(v[E]=ur(E)),m=v[E]+y;var A=p?(c[b]||[])[E]:c[m];A&&(nR(i,A,b,E,n),h&&A.l&&c["!links"].push([m,A.l]))}}var O=d.CodeName||d.name||l;return h&&ce(i,574,$D((f.Views||[])[0])),h&&(c["!merges"]||[]).length&&ce(i,229,JD(c["!merges"])),h&&tR(i,c),ce(i,442,A_(O)),h&&Q7(i,c),ce(i,10),i.end()}function aR(t,n,r){var i=Er(),l=(t||{}).Workbook||{},c=l.Sheets||[],f=l.WBProps||{},d=r.biff==8,p=r.biff==5;if(ce(i,2057,kp(t,5,r)),r.bookType=="xla"&&ce(i,135),ce(i,225,d?Zr(1200):null),ce(i,193,kD(2)),p&&ce(i,191),p&&ce(i,192),ce(i,226),ce(i,92,jD("SheetJS",r)),ce(i,66,Zr(d?1200:1252)),d&&ce(i,353,Zr(0)),d&&ce(i,448),ce(i,317,iN(t.SheetNames.length)),d&&t.vbaraw&&ce(i,211),d&&t.vbaraw){var h=f.CodeName||"ThisWorkbook";ce(i,442,A_(h))}ce(i,156,Zr(17)),ce(i,25,gr(!1)),ce(i,18,gr(!1)),ce(i,19,Zr(0)),d&&ce(i,431,gr(!1)),d&&ce(i,444,Zr(0)),ce(i,61,HD()),ce(i,64,gr(!1)),ce(i,141,Zr(0)),ce(i,34,gr(c7(t)=="true")),ce(i,14,gr(!0)),d&&ce(i,439,gr(!1)),ce(i,218,Zr(0)),K7(i,t,r),Z7(i,t.SSF,r),J7(i,r),d&&ce(i,352,gr(!1));var m=i.end(),y=Er();d&&ce(y,140,nN()),d&&r.Strings&&P7(y,252,UD(r.Strings)),ce(y,10);var v=y.end(),w=Er(),S=0,b=0;for(b=0;b<t.SheetNames.length;++b)S+=(d?12:11)+(d?2:1)*t.SheetNames[b].length;var E=m.length+S+v.length;for(b=0;b<t.SheetNames.length;++b){var A=c[b]||{};ce(w,133,ID({pos:E,hs:A.Hidden||0,dt:0,name:t.SheetNames[b]},r)),E+=n[b].length}var O=w.end();if(S!=O.length)throw new Error("BS8 "+S+" != "+O.length);var C=[];return m.length&&C.push(m),O.length&&C.push(O),v.length&&C.push(v),nr(C)}function iR(t,n){var r=n||{},i=[];t&&!t.SSF&&(t.SSF=Ar(Dn)),t&&t.SSF&&(M0(),R0(t.SSF),r.revssf=O0(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,zp(r),r.cellXfs=[],Li(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var l=0;l<t.SheetNames.length;++l)i[i.length]=rR(l,r,t);return i.unshift(aR(t,i,r)),nr(i)}function J_(t,n){for(var r=0;r<=t.SheetNames.length;++r){var i=t.Sheets[t.SheetNames[r]];if(!(!i||!i["!ref"])){var l=Ir(i["!ref"]);l.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var c=n||{};switch(c.biff||2){case 8:case 5:return iR(t,n);case 4:case 3:case 2:return q7(t,n)}throw new Error("invalid type "+c.bookType+" for BIFF")}function sR(t,n,r,i){for(var l=t["!merges"]||[],c=[],f=n.s.c;f<=n.e.c;++f){for(var d=0,p=0,h=0;h<l.length;++h)if(!(l[h].s.r>r||l[h].s.c>f)&&!(l[h].e.r<r||l[h].e.c<f)){if(l[h].s.r<r||l[h].s.c<f){d=-1;break}d=l[h].e.r-l[h].s.r+1,p=l[h].e.c-l[h].s.c+1;break}if(!(d<0)){var m=en({r,c:f}),y=i.dense?(t[r]||[])[f]:t[m],v=y&&y.v!=null&&(y.h||B5(y.w||(ni(y),y.w)||""))||"",w={};d>1&&(w.rowspan=d),p>1&&(w.colspan=p),i.editable?v='<span contenteditable="true">'+v+"</span>":y&&(w["data-t"]=y&&y.t||"z",y.v!=null&&(w["data-v"]=y.v),y.z!=null&&(w["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+y.l.Target+'">'+v+"</a>")),w.id=(i.id||"sjs")+"-"+m,c.push(oe("td",v,w))}}var S="<tr>";return S+c.join("")+"</tr>"}var lR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',oR="</body></html>";function cR(t,n,r){var i=[];return i.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function tb(t,n){var r=n||{},i=r.header!=null?r.header:lR,l=r.footer!=null?r.footer:oR,c=[i],f=Ir(t["!ref"]);r.dense=Array.isArray(t),c.push(cR(t,f,r));for(var d=f.s.r;d<=f.e.r;++d)c.push(sR(t,f,d,r));return c.push("</table>"+l),c.join("")}function eb(t,n,r){var i=r||{},l=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Wn(i.origin):i.origin;l=f.r,c=f.c}var d=n.getElementsByTagName("tr"),p=Math.min(i.sheetRows||1e7,d.length),h={s:{r:0,c:0},e:{r:l,c}};if(t["!ref"]){var m=Ir(t["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),l==-1&&(h.e.r=l=m.e.r+1)}var y=[],v=0,w=t["!rows"]||(t["!rows"]=[]),S=0,b=0,E=0,A=0,O=0,C=0;for(t["!cols"]||(t["!cols"]=[]);S<d.length&&b<p;++S){var U=d[S];if(l2(U)){if(i.display)continue;w[b]={hidden:!0}}var B=U.children;for(E=A=0;E<B.length;++E){var V=B[E];if(!(i.display&&l2(V))){var k=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):H5(V.innerHTML),F=V.getAttribute("data-z")||V.getAttribute("z");for(v=0;v<y.length;++v){var T=y[v];T.s.c==A+c&&T.s.r<b+l&&b+l<=T.e.r&&(A=T.e.c+1-c,v=-1)}C=+V.getAttribute("colspan")||1,((O=+V.getAttribute("rowspan")||1)>1||C>1)&&y.push({s:{r:b+l,c:A+c},e:{r:b+l+(O||1)-1,c:A+c+(C||1)-1}});var N={t:"s",v:k},D=V.getAttribute("data-t")||V.getAttribute("t")||"";k!=null&&(k.length==0?N.t=D||"z":i.raw||k.trim().length==0||D=="s"||(k==="TRUE"?N={t:"b",v:!0}:k==="FALSE"?N={t:"b",v:!1}:isNaN(Za(k))?isNaN(Ko(k).getDate())||(N={t:"d",v:yr(k)},i.cellDates||(N={t:"n",v:Tr(N.v)}),N.z=i.dateNF||Dn[14]):N={t:"n",v:Za(k)})),N.z===void 0&&F!=null&&(N.z=F);var L="",K=V.getElementsByTagName("A");if(K&&K.length)for(var ft=0;ft<K.length&&!(K[ft].hasAttribute("href")&&(L=K[ft].getAttribute("href"),L.charAt(0)!="#"));++ft);L&&L.charAt(0)!="#"&&(N.l={Target:L}),i.dense?(t[b+l]||(t[b+l]=[]),t[b+l][A+c]=N):t[en({c:A+c,r:b+l})]=N,h.e.c<A+c&&(h.e.c=A+c),A+=C}}++b}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),h.e.r=Math.max(h.e.r,b-1+l),t["!ref"]=Ln(h),b>=p&&(t["!fullref"]=Ln((h.e.r=d.length-S+b-1+l,h))),t}function nb(t,n){var r=n||{},i=r.dense?[]:{};return eb(i,t,n)}function fR(t,n){return gs(nb(t,n),n)}function l2(t){var n="",r=uR(t);return r&&(n=r(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function uR(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hR=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Bn+n}}(),o2=function(){var t=function(c){return tn(c).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,i=function(c,f,d){var p=[];p.push('      <table:table table:name="'+tn(f.SheetNames[d])+`" table:style-name="ta1">
`);var h=0,m=0,y=Ir(c["!ref"]||"A1"),v=c["!merges"]||[],w=0,S=Array.isArray(c);if(c["!cols"])for(m=0;m<=y.e.c;++m)p.push("        <table:table-column"+(c["!cols"][m]?' table:style-name="co'+c["!cols"][m].ods+'"':"")+`></table:table-column>
`);var b="",E=c["!rows"]||[];for(h=0;h<y.s.r;++h)b=E[h]?' table:style-name="ro'+E[h].ods+'"':"",p.push("        <table:table-row"+b+`></table:table-row>
`);for(;h<=y.e.r;++h){for(b=E[h]?' table:style-name="ro'+E[h].ods+'"':"",p.push("        <table:table-row"+b+`>
`),m=0;m<y.s.c;++m)p.push(n);for(;m<=y.e.c;++m){var A=!1,O={},C="";for(w=0;w!=v.length;++w)if(!(v[w].s.c>m)&&!(v[w].s.r>h)&&!(v[w].e.c<m)&&!(v[w].e.r<h)){(v[w].s.c!=m||v[w].s.r!=h)&&(A=!0),O["table:number-columns-spanned"]=v[w].e.c-v[w].s.c+1,O["table:number-rows-spanned"]=v[w].e.r-v[w].s.r+1;break}if(A){p.push(r);continue}var U=en({r:h,c:m}),B=S?(c[h]||[])[m]:c[U];if(B&&B.f&&(O["table:formula"]=tn(RF(B.f)),B.F&&B.F.slice(0,U.length)==U)){var V=Ir(B.F);O["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,O["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!B){p.push(n);continue}switch(B.t){case"b":C=B.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=B.v?"true":"false";break;case"n":C=B.w||String(B.v||0),O["office:value-type"]="float",O["office:value"]=B.v||0;break;case"s":case"str":C=B.v==null?"":B.v,O["office:value-type"]="string";break;case"d":C=B.w||yr(B.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=yr(B.v).toISOString(),O["table:style-name"]="ce1";break;default:p.push(n);continue}var k=t(C);if(B.l&&B.l.Target){var F=B.l.Target;F=F.charAt(0)=="#"?"#"+MF(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),k=oe("text:a",k,{"xlink:href":F.replace(/&/g,"&amp;")})}p.push("          "+oe("table:table-cell",oe("text:p",k,{}),O)+`
`)}p.push(`        </table:table-row>
`)}return p.push(`      </table:table>
`),p.join("")},l=function(c,f){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var y=h["!cols"][m];if(y.width==null&&y.wpx==null&&y.wch==null)continue;Fp(y),y.ods=d;var v=h["!cols"][m].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),c.push(`  </style:style>
`),++d}}});var p=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=p;var y=h["!rows"][m].hpx+"px";c.push('  <style:style style:name="ro'+p+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),c.push(`  </style:style>
`),++p}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(f,d){var p=[Bn],h=Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(p.push("<office:document"+h+m+`>
`),p.push(g_().replace(/office:document-meta/g,"office:meta"))):p.push("<office:document-content"+h+`>
`),l(p,f),p.push(`  <office:body>
`),p.push(`    <office:spreadsheet>
`);for(var y=0;y!=f.SheetNames.length;++y)p.push(i(f.Sheets[f.SheetNames[y]],f,y));return p.push(`    </office:spreadsheet>
`),p.push(`  </office:body>
`),d.bookType=="fods"?p.push("</office:document>"):p.push("</office:document-content>"),p.join("")}}();function rb(t,n){if(n.bookType=="fods")return o2(t,n);var r=vp(),i="",l=[],c=[];return i="mimetype",Re(r,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Re(r,i,o2(t,n)),l.push([i,"text/xml"]),c.push([i,"ContentFile"]),i="styles.xml",Re(r,i,hR(t,n)),l.push([i,"text/xml"]),c.push([i,"StylesFile"]),i="meta.xml",Re(r,i,Bn+g_()),l.push([i,"text/xml"]),c.push([i,"MetadataFile"]),i="manifest.rdf",Re(r,i,ED(c)),l.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Re(r,i,wD(l)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _0(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function dR(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):oa(Zo(t))}function pR(t,n){t:for(var r=0;r<=t.length-n.length;++r){for(var i=0;i<n.length;++i)if(t[r+i]!=n[i])continue t;return!0}return!1}function Oi(t){var n=t.reduce(function(l,c){return l+c.length},0),r=new Uint8Array(n),i=0;return t.forEach(function(l){r.set(l,i),i+=l.length}),r}function xR(t,n,r){var i=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,l=r/Math.pow(10,i-6176);t[n+15]|=i>>7,t[n+14]|=(i&127)<<1;for(var c=0;l>=1;++c,l/=256)t[n+c]=l&255;t[n+15]|=r>=0?0:128}function Jo(t,n){var r=n?n[0]:0,i=t[r]&127;t:if(t[r++]>=128&&(i|=(t[r]&127)<<7,t[r++]<128||(i|=(t[r]&127)<<14,t[r++]<128)||(i|=(t[r]&127)<<21,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break t;return n&&(n[0]=r),i}function Qe(t){var n=new Uint8Array(7);n[0]=t&127;var r=1;t:if(t>127){if(n[r-1]|=128,n[r]=t>>7&127,++r,t<=16383||(n[r-1]|=128,n[r]=t>>14&127,++r,t<=2097151)||(n[r-1]|=128,n[r]=t>>21&127,++r,t<=268435455)||(n[r-1]|=128,n[r]=t/256>>>21&127,++r,t<=34359738367)||(n[r-1]|=128,n[r]=t/65536>>>21&127,++r,t<=4398046511103))break t;n[r-1]|=128,n[r]=t/16777216>>>21&127,++r}return n.slice(0,r)}function xl(t){var n=0,r=t[n]&127;t:if(t[n++]>=128){if(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128))break t;r|=(t[n]&127)<<28}return r}function Un(t){for(var n=[],r=[0];r[0]<t.length;){var i=r[0],l=Jo(t,r),c=l&7;l=Math.floor(l/8);var f=0,d;if(l==0)break;switch(c){case 0:{for(var p=r[0];t[r[0]++]>=128;);d=t.slice(p,r[0])}break;case 5:f=4,d=t.slice(r[0],r[0]+f),r[0]+=f;break;case 1:f=8,d=t.slice(r[0],r[0]+f),r[0]+=f;break;case 2:f=Jo(t,r),d=t.slice(r[0],r[0]+f),r[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(l," at offset ").concat(i))}var h={data:d,type:c};n[l]==null?n[l]=[h]:n[l].push(h)}return n}function tr(t){var n=[];return t.forEach(function(r,i){r.forEach(function(l){l.data&&(n.push(Qe(i*8+l.type)),l.type==2&&n.push(Qe(l.data.length)),n.push(l.data))})}),Oi(n)}function aa(t){for(var n,r=[],i=[0];i[0]<t.length;){var l=Jo(t,i),c=Un(t.slice(i[0],i[0]+l));i[0]+=l;var f={id:xl(c[1][0].data),messages:[]};c[2].forEach(function(d){var p=Un(d.data),h=xl(p[3][0].data);f.messages.push({meta:p,data:t.slice(i[0],i[0]+h)}),i[0]+=h}),(n=c[3])!=null&&n[0]&&(f.merge=xl(c[3][0].data)>>>0>0),r.push(f)}return r}function il(t){var n=[];return t.forEach(function(r){var i=[];i[1]=[{data:Qe(r.id),type:0}],i[2]=[],r.merge!=null&&(i[3]=[{data:Qe(+!!r.merge),type:0}]);var l=[];r.messages.forEach(function(f){l.push(f.data),f.meta[3]=[{type:0,data:Qe(f.data.length)}],i[2].push({data:tr(f.meta),type:2})});var c=tr(i);n.push(Qe(c.length)),n.push(c),l.forEach(function(f){return n.push(f)})}),Oi(n)}function mR(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],i=Jo(n,r),l=[];r[0]<n.length;){var c=n[r[0]]&3;if(c==0){var f=n[r[0]++]>>2;if(f<60)++f;else{var d=f-59;f=n[r[0]],d>1&&(f|=n[r[0]+1]<<8),d>2&&(f|=n[r[0]+2]<<16),d>3&&(f|=n[r[0]+3]<<24),f>>>=0,f++,r[0]+=d}l.push(n.slice(r[0],r[0]+f)),r[0]+=f;continue}else{var p=0,h=0;if(c==1?(h=(n[r[0]]>>2&7)+4,p=(n[r[0]++]&224)<<3,p|=n[r[0]++]):(h=(n[r[0]++]>>2)+1,c==2?(p=n[r[0]]|n[r[0]+1]<<8,r[0]+=2):(p=(n[r[0]]|n[r[0]+1]<<8|n[r[0]+2]<<16|n[r[0]+3]<<24)>>>0,r[0]+=4)),l=[Oi(l)],p==0)throw new Error("Invalid offset 0");if(p>l[0].length)throw new Error("Invalid offset beyond length");if(h>=p)for(l.push(l[0].slice(-p)),h-=p;h>=l[l.length-1].length;)l.push(l[l.length-1]),h-=l[l.length-1].length;l.push(l[0].slice(-p,-p+h))}}var m=Oi(l);if(m.length!=i)throw new Error("Unexpected length: ".concat(m.length," != ").concat(i));return m}function ia(t){for(var n=[],r=0;r<t.length;){var i=t[r++],l=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,n.push(mR(i,t.slice(r,r+l))),r+=l}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Oi(n)}function sl(t){for(var n=[],r=0;r<t.length;){var i=Math.min(t.length-r,268435455),l=new Uint8Array(4);n.push(l);var c=Qe(i),f=c.length;n.push(c),i<=60?(f++,n.push(new Uint8Array([i-1<<2]))):i<=256?(f+=2,n.push(new Uint8Array([240,i-1&255]))):i<=65536?(f+=3,n.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(f+=4,n.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(f+=5,n.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),n.push(t.slice(r,r+i)),f+=i,l[0]=0,l[1]=f&255,l[2]=f>>8&255,l[3]=f>>16&255,r+=i}return Oi(n)}function Sd(t,n){var r=new Uint8Array(32),i=_0(r),l=12,c=0;switch(r[0]=5,t.t){case"n":r[1]=2,xR(r,l,t.v),c|=1,l+=16;break;case"b":r[1]=6,i.setFloat64(l,t.v?1:0,!0),c|=2,l+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,i.setUint32(l,n.indexOf(t.v),!0),c|=8,l+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(8,c,!0),r.slice(0,l)}function Ed(t,n){var r=new Uint8Array(32),i=_0(r),l=12,c=0;switch(r[0]=3,t.t){case"n":r[2]=2,i.setFloat64(l,t.v,!0),c|=32,l+=8;break;case"b":r[2]=6,i.setFloat64(l,t.v?1:0,!0),c|=32,l+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,i.setUint32(l,n.indexOf(t.v),!0),c|=16,l+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(4,c,!0),r.slice(0,l)}function Di(t){var n=Un(t);return Jo(n[1][0].data)}function gR(t,n,r){var i,l,c,f;if(!((i=t[6])!=null&&i[0])||!((l=t[7])!=null&&l[0]))throw"Mutation only works on post-BNC storages!";var d=((f=(c=t[8])==null?void 0:c[0])==null?void 0:f.data)&&xl(t[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var p=0,h=_0(t[7][0].data),m=0,y=[],v=_0(t[4][0].data),w=0,S=[],b=0;b<n.length;++b){if(n[b]==null){h.setUint16(b*2,65535,!0),v.setUint16(b*2,65535);continue}h.setUint16(b*2,m,!0),v.setUint16(b*2,w,!0);var E,A;switch(typeof n[b]){case"string":E=Sd({t:"s",v:n[b]},r),A=Ed({t:"s",v:n[b]},r);break;case"number":E=Sd({t:"n",v:n[b]},r),A=Ed({t:"n",v:n[b]},r);break;case"boolean":E=Sd({t:"b",v:n[b]},r),A=Ed({t:"b",v:n[b]},r);break;default:throw new Error("Unsupported value "+n[b])}y.push(E),m+=E.length,S.push(A),w+=A.length,++p}for(t[2][0].data=Qe(p);b<t[7][0].data.length/2;++b)h.setUint16(b*2,65535,!0),v.setUint16(b*2,65535,!0);return t[6][0].data=Oi(y),t[3][0].data=Oi(S),p}function yR(t,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Ir(r["!ref"]);i.s.r=i.s.c=0;var l=!1;i.e.c>9&&(l=!0,i.e.c=9),i.e.r>49&&(l=!0,i.e.r=49),l&&console.error("The Numbers writer is currently limited to ".concat(Ln(i)));var c=b0(r,{range:i,header:1}),f=["~Sh33tJ5~"];c.forEach(function(Y){return Y.forEach(function(z){typeof z=="string"&&f.push(z)})});var d={},p=[],h=cn.read(n.numbers,{type:"base64"});h.FileIndex.map(function(Y,z){return[Y,h.FullPaths[z]]}).forEach(function(Y){var z=Y[0],W=Y[1];if(z.type==2&&z.name.match(/\.iwa/)){var tt=z.content,nt=ia(tt),j=aa(nt);j.forEach(function(q){p.push(q.id),d[q.id]={deps:[],location:W,type:xl(q.messages[0].meta[1][0].data)}})}}),p.sort(function(Y,z){return Y-z});var m=p.filter(function(Y){return Y>1}).map(function(Y){return[Y,Qe(Y)]});h.FileIndex.map(function(Y,z){return[Y,h.FullPaths[z]]}).forEach(function(Y){var z=Y[0];if(Y[1],!!z.name.match(/\.iwa/)){var W=aa(ia(z.content));W.forEach(function(tt){tt.messages.forEach(function(nt){m.forEach(function(j){tt.messages.some(function(q){return xl(q.meta[1][0].data)!=11006&&pR(q.data,j[1])})&&d[j[0]].deps.push(tt.id)})})})}});for(var y=cn.find(h,d[1].location),v=aa(ia(y.content)),w,S=0;S<v.length;++S){var b=v[S];b.id==1&&(w=b)}var E=Di(Un(w.messages[0].data)[1][0].data);for(y=cn.find(h,d[E].location),v=aa(ia(y.content)),S=0;S<v.length;++S)b=v[S],b.id==E&&(w=b);for(E=Di(Un(w.messages[0].data)[2][0].data),y=cn.find(h,d[E].location),v=aa(ia(y.content)),S=0;S<v.length;++S)b=v[S],b.id==E&&(w=b);for(E=Di(Un(w.messages[0].data)[2][0].data),y=cn.find(h,d[E].location),v=aa(ia(y.content)),S=0;S<v.length;++S)b=v[S],b.id==E&&(w=b);var A=Un(w.messages[0].data);{A[6][0].data=Qe(i.e.r+1),A[7][0].data=Qe(i.e.c+1);var O=Di(A[46][0].data),C=cn.find(h,d[O].location),U=aa(ia(C.content));{for(var B=0;B<U.length&&U[B].id!=O;++B);if(U[B].id!=O)throw"Bad ColumnRowUIDMapArchive";var V=Un(U[B].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var k=0;k<=i.e.c;++k){var F=[];F[1]=F[2]=[{type:0,data:Qe(k+420690)}],V[1].push({type:2,data:tr(F)}),V[2].push({type:0,data:Qe(k)}),V[3].push({type:0,data:Qe(k)})}V[4]=[],V[5]=[],V[6]=[];for(var T=0;T<=i.e.r;++T)F=[],F[1]=F[2]=[{type:0,data:Qe(T+726270)}],V[4].push({type:2,data:tr(F)}),V[5].push({type:0,data:Qe(T)}),V[6].push({type:0,data:Qe(T)});U[B].messages[0].data=tr(V)}C.content=sl(il(U)),C.size=C.content.length,delete A[46];var N=Un(A[4][0].data);{N[7][0].data=Qe(i.e.r+1);var D=Un(N[1][0].data),L=Di(D[2][0].data);C=cn.find(h,d[L].location),U=aa(ia(C.content));{if(U[0].id!=L)throw"Bad HeaderStorageBucket";var K=Un(U[0].messages[0].data);for(T=0;T<c.length;++T){var ft=Un(K[2][0].data);ft[1][0].data=Qe(T),ft[4][0].data=Qe(c[T].length),K[2][T]={type:K[2][0].type,data:tr(ft)}}U[0].messages[0].data=tr(K)}C.content=sl(il(U)),C.size=C.content.length;var dt=Di(N[2][0].data);C=cn.find(h,d[dt].location),U=aa(ia(C.content));{if(U[0].id!=dt)throw"Bad HeaderStorageBucket";for(K=Un(U[0].messages[0].data),k=0;k<=i.e.c;++k)ft=Un(K[2][0].data),ft[1][0].data=Qe(k),ft[4][0].data=Qe(i.e.r+1),K[2][k]={type:K[2][0].type,data:tr(ft)};U[0].messages[0].data=tr(K)}C.content=sl(il(U)),C.size=C.content.length;var J=Di(N[4][0].data);(function(){for(var Y=cn.find(h,d[J].location),z=aa(ia(Y.content)),W,tt=0;tt<z.length;++tt){var nt=z[tt];nt.id==J&&(W=nt)}var j=Un(W.messages[0].data);{j[3]=[];var q=[];f.forEach(function(vt,Zt){q[1]=[{type:0,data:Qe(Zt)}],q[2]=[{type:0,data:Qe(1)}],q[3]=[{type:2,data:dR(vt)}],j[3].push({type:2,data:tr(q)})})}W.messages[0].data=tr(j);var lt=il(z),Ct=sl(lt);Y.content=Ct,Y.size=Y.content.length})();var gt=Un(N[3][0].data);{var wt=gt[1][0];delete gt[2];var bt=Un(wt.data);{var P=Di(bt[2][0].data);(function(){for(var Y=cn.find(h,d[P].location),z=aa(ia(Y.content)),W,tt=0;tt<z.length;++tt){var nt=z[tt];nt.id==P&&(W=nt)}var j=Un(W.messages[0].data);{delete j[6],delete gt[7];var q=new Uint8Array(j[5][0].data);j[5]=[];for(var lt=0,Ct=0;Ct<=i.e.r;++Ct){var vt=Un(q);lt+=gR(vt,c[Ct],f),vt[1][0].data=Qe(Ct),j[5].push({data:tr(vt),type:2})}j[1]=[{type:0,data:Qe(i.e.c+1)}],j[2]=[{type:0,data:Qe(i.e.r+1)}],j[3]=[{type:0,data:Qe(lt)}],j[4]=[{type:0,data:Qe(i.e.r+1)}]}W.messages[0].data=tr(j);var Zt=il(z),Gt=sl(Zt);Y.content=Gt,Y.size=Y.content.length})()}wt.data=tr(bt)}N[3][0].data=tr(gt)}A[4][0].data=tr(N)}w.messages[0].data=tr(A);var I=il(v),R=sl(I);return y.content=R,y.size=y.content.length,h}function vR(t){return function(r){for(var i=0;i!=t.length;++i){var l=t[i];r[l[0]]===void 0&&(r[l[0]]=l[1]),l[2]==="n"&&(r[l[0]]=Number(r[l[0]]))}}}function zp(t){vR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function _R(t,n){return n.bookType=="ods"?rb(t,n):n.bookType=="numbers"?yR(t,n):n.bookType=="xlsb"?bR(t,n):wR(t,n)}function bR(t,n){cl=1024,t&&!t.SSF&&(t.SSF=Ar(Dn)),t&&t.SSF&&(M0(),R0(t.SSF),n.revssf=O0(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,$o?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var r=n.bookType=="xlsb"?"bin":"xml",i=I_.indexOf(n.bookType)>-1,l=p_();zp(n=n||{});var c=vp(),f="",d=0;if(n.cellXfs=[],Li(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),f="docProps/core.xml",Re(c,f,y_(t.Props,n)),l.coreprops.push(f),Je(n.rels,2,f,Pe.CORE_PROPS),f="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var p=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(t.SheetNames[h]);t.Props.SheetNames=p}for(t.Props.Worksheets=t.Props.SheetNames.length,Re(c,f,__(t.Props)),l.extprops.push(f),Je(n.rels,3,f,Pe.EXT_PROPS),t.Custprops!==t.Props&&ir(t.Custprops||{}).length>0&&(f="docProps/custom.xml",Re(c,f,b_(t.Custprops)),l.custprops.push(f),Je(n.rels,4,f,Pe.CUST_PROPS)),d=1;d<=t.SheetNames.length;++d){var m={"!id":{}},y=t.Sheets[t.SheetNames[d-1]],v=(y||{})["!type"]||"sheet";switch(v){case"chart":default:f="xl/worksheets/sheet"+d+"."+r,Re(c,f,E7(d-1,f,n,t,m)),l.sheets.push(f),Je(n.wbrels,-1,"worksheets/sheet"+d+"."+r,Pe.WS[0])}if(y){var w=y["!comments"],S=!1,b="";w&&w.length>0&&(b="xl/comments"+d+"."+r,Re(c,b,D7(w,b)),l.comments.push(b),Je(m,-1,"../comments"+d+"."+r,Pe.CMNT),S=!0),y["!legacy"]&&S&&Re(c,"xl/drawings/vmlDrawing"+d+".vml",B_(d,y["!comments"])),delete y["!comments"],delete y["!legacy"]}m["!id"].rId1&&Re(c,m_(f),dl(m))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+r,Re(c,f,A7(n.Strings,f,n)),l.strs.push(f),Je(n.wbrels,-1,"sharedStrings."+r,Pe.SST)),f="xl/workbook."+r,Re(c,f,S7(t,f)),l.workbooks.push(f),Je(n.rels,1,f,Pe.WB),f="xl/theme/theme1.xml",Re(c,f,z_(t.Themes,n)),l.themes.push(f),Je(n.wbrels,-1,"theme/theme1.xml",Pe.THEME),f="xl/styles."+r,Re(c,f,T7(t,f,n)),l.styles.push(f),Je(n.wbrels,-1,"styles."+r,Pe.STY),t.vbaraw&&i&&(f="xl/vbaProject.bin",Re(c,f,t.vbaraw),l.vba.push(f),Je(n.wbrels,-1,"vbaProject.bin",Pe.VBA)),f="xl/metadata."+r,Re(c,f,N7(f)),l.metadata.push(f),Je(n.wbrels,-1,"metadata."+r,Pe.XLMETA),Re(c,"[Content_Types].xml",x_(l,n)),Re(c,"_rels/.rels",dl(n.rels)),Re(c,"xl/_rels/workbook."+r+".rels",dl(n.wbrels)),delete n.revssf,delete n.ssf,c}function wR(t,n){cl=1024,t&&!t.SSF&&(t.SSF=Ar(Dn)),t&&t.SSF&&(M0(),R0(t.SSF),n.revssf=O0(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,$o?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var r="xml",i=I_.indexOf(n.bookType)>-1,l=p_();zp(n=n||{});var c=vp(),f="",d=0;if(n.cellXfs=[],Li(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),f="docProps/core.xml",Re(c,f,y_(t.Props,n)),l.coreprops.push(f),Je(n.rels,2,f,Pe.CORE_PROPS),f="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var p=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(t.SheetNames[h]);t.Props.SheetNames=p}t.Props.Worksheets=t.Props.SheetNames.length,Re(c,f,__(t.Props)),l.extprops.push(f),Je(n.rels,3,f,Pe.EXT_PROPS),t.Custprops!==t.Props&&ir(t.Custprops||{}).length>0&&(f="docProps/custom.xml",Re(c,f,b_(t.Custprops)),l.custprops.push(f),Je(n.rels,4,f,Pe.CUST_PROPS));var m=["SheetJ5"];for(n.tcid=0,d=1;d<=t.SheetNames.length;++d){var y={"!id":{}},v=t.Sheets[t.SheetNames[d-1]],w=(v||{})["!type"]||"sheet";switch(w){case"chart":default:f="xl/worksheets/sheet"+d+"."+r,Re(c,f,W_(d-1,n,t,y)),l.sheets.push(f),Je(n.wbrels,-1,"worksheets/sheet"+d+"."+r,Pe.WS[0])}if(v){var S=v["!comments"],b=!1,E="";if(S&&S.length>0){var A=!1;S.forEach(function(O){O[1].forEach(function(C){C.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+d+"."+r,Re(c,E,JN(S,m,n)),l.threadedcomments.push(E),Je(y,-1,"../threadedComments/threadedComment"+d+"."+r,Pe.TCMNT)),E="xl/comments"+d+"."+r,Re(c,E,j_(S)),l.comments.push(E),Je(y,-1,"../comments"+d+"."+r,Pe.CMNT),b=!0}v["!legacy"]&&b&&Re(c,"xl/drawings/vmlDrawing"+d+".vml",B_(d,v["!comments"])),delete v["!comments"],delete v["!legacy"]}y["!id"].rId1&&Re(c,m_(f),dl(y))}return n.Strings!=null&&n.Strings.length>0&&(f="xl/sharedStrings."+r,Re(c,f,k_(n.Strings,n)),l.strs.push(f),Je(n.wbrels,-1,"sharedStrings."+r,Pe.SST)),f="xl/workbook."+r,Re(c,f,Z_(t)),l.workbooks.push(f),Je(n.rels,1,f,Pe.WB),f="xl/theme/theme1.xml",Re(c,f,z_(t.Themes,n)),l.themes.push(f),Je(n.wbrels,-1,"theme/theme1.xml",Pe.THEME),f="xl/styles."+r,Re(c,f,M_(t,n)),l.styles.push(f),Je(n.wbrels,-1,"styles."+r,Pe.STY),t.vbaraw&&i&&(f="xl/vbaProject.bin",Re(c,f,t.vbaraw),l.vba.push(f),Je(n.wbrels,-1,"vbaProject.bin",Pe.VBA)),f="xl/metadata."+r,Re(c,f,L_()),l.metadata.push(f),Je(n.wbrels,-1,"metadata."+r,Pe.XLMETA),m.length>1&&(f="xl/persons/person.xml",Re(c,f,tk(m)),l.people.push(f),Je(n.wbrels,-1,"persons/person.xml",Pe.PEOPLE)),Re(c,"[Content_Types].xml",x_(l,n)),Re(c,"_rels/.rels",dl(n.rels)),Re(c,"xl/_rels/workbook."+r+".rels",dl(n.wbrels)),delete n.revssf,delete n.ssf,c}function SR(t,n){var r="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ei(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ab(t,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return oc(n.file,cn.write(t,{type:Xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return cn.write(t,n)}function ER(t,n){var r=Ar(n||{}),i=_R(t,r);return TR(i,r)}function TR(t,n){var r={},i=Xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(r.compression="DEFLATE"),n.password)r.type=i;else switch(n.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":r.type=i;break;default:throw new Error("Unrecognized type "+n.type)}var l=t.FullPaths?cn.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!n.compression}):t.generate(r);if(typeof Deno<"u"&&typeof l=="string"){if(n.type=="binary"||n.type=="base64")return l;l=new Uint8Array(C0(l))}return n.password&&typeof encrypt_agile<"u"?ab(encrypt_agile(l,n.password),n):n.type==="file"?oc(n.file,l):n.type=="string"?jo(l):l}function AR(t,n){var r=n||{},i=$7(t,r);return ab(i,r)}function ba(t,n,r){r||(r="");var i=r+t;switch(n.type){case"base64":return qo(Zo(i));case"binary":return Zo(i);case"string":return t;case"file":return oc(n.file,i,"utf8");case"buffer":return Xe?ri(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):ba(i,{type:"binary"}).split("").map(function(l){return l.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function DR(t,n){switch(n.type){case"base64":return qo(t);case"binary":return t;case"string":return t;case"file":return oc(n.file,t,"binary");case"buffer":return Xe?ri(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function zf(t,n){switch(n.type){case"string":case"base64":case"binary":for(var r="",i=0;i<t.length;++i)r+=String.fromCharCode(t[i]);return n.type=="base64"?qo(r):n.type=="string"?jo(r):r;case"file":return oc(n.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+n.type)}}function ib(t,n){e5(),h7(t);var r=Ar(n||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var i=ib(t,r);return r.type="array",C0(i)}var l=0;if(r.sheet&&(typeof r.sheet=="number"?l=r.sheet:l=t.SheetNames.indexOf(r.sheet),!t.SheetNames[l]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ba(U7(t,r),r);case"slk":case"sylk":return ba(cN.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"htm":case"html":return ba(tb(t.Sheets[t.SheetNames[l]],r),r);case"txt":return DR(sb(t.Sheets[t.SheetNames[l]],r),r);case"csv":return ba(Lp(t.Sheets[t.SheetNames[l]],r),r,"\uFEFF");case"dif":return ba(fN.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"dbf":return zf(oN.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"prn":return ba(uN.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"rtf":return ba(yN.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"eth":return ba(N_.from_sheet(t.Sheets[t.SheetNames[l]],r),r);case"fods":return ba(rb(t,r),r);case"wk1":return zf(e2.sheet_to_wk1(t.Sheets[t.SheetNames[l]],r),r);case"wk3":return zf(e2.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),zf(J_(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),AR(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ER(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function NR(t){if(!t.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=n[t.bookType]||t.bookType}}function Rn(t,n,r){var i={};return i.type="file",i.file=n,NR(i),ib(t,i)}function kR(t,n,r,i,l,c,f,d){var p=ar(r),h=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),y=!0,v=l===1?[]:{};if(l!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!f||t[r])for(var w=n.s.c;w<=n.e.c;++w){var S=f?t[r][w]:t[i[w]+p];if(S===void 0||S.t===void 0){if(h===void 0)continue;c[w]!=null&&(v[c[w]]=h);continue}var b=S.v;switch(S.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(c[w]!=null){if(b==null)if(S.t=="e"&&b===null)v[c[w]]=null;else if(h!==void 0)v[c[w]]=h;else if(m&&b===null)v[c[w]]=null;else continue;else v[c[w]]=m&&(S.t!=="n"||S.t==="n"&&d.rawNumbers!==!1)?b:ni(S,b,d);b!=null&&(y=!1)}}return{row:v,isempty:y}}function b0(t,n){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},i=0,l=1,c=[],f=0,d="",p={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},m=h.range!=null?h.range:t["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof m){case"string":p=mn(m);break;case"number":p=mn(t["!ref"]),p.s.r=m;break;default:p=m}i>0&&(l=0);var y=ar(p.s.r),v=[],w=[],S=0,b=0,E=Array.isArray(t),A=p.s.r,O=0,C={};E&&!t[A]&&(t[A]=[]);var U=h.skipHidden&&t["!cols"]||[],B=h.skipHidden&&t["!rows"]||[];for(O=p.s.c;O<=p.e.c;++O)if(!(U[O]||{}).hidden)switch(v[O]=ur(O),r=E?t[A][O]:t[v[O]+y],i){case 1:c[O]=O-p.s.c;break;case 2:c[O]=v[O];break;case 3:c[O]=h.header[O-p.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),d=f=ni(r,null,h),b=C[f]||0,!b)C[f]=1;else{do d=f+"_"+b++;while(C[d]);C[f]=b,C[d]=1}c[O]=d}for(A=p.s.r+l;A<=p.e.r;++A)if(!(B[A]||{}).hidden){var V=kR(t,p,A,v,i,c,E,h);(V.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(w[S++]=V.row)}return w.length=S,w}var c2=/"/g;function FR(t,n,r,i,l,c,f,d){for(var p=!0,h=[],m="",y=ar(r),v=n.s.c;v<=n.e.c;++v)if(i[v]){var w=d.dense?(t[r]||[])[v]:t[i[v]+y];if(w==null)m="";else if(w.v!=null){p=!1,m=""+(d.rawNumbers&&w.t=="n"?w.v:ni(w,null,d));for(var S=0,b=0;S!==m.length;++S)if((b=m.charCodeAt(S))===l||b===c||b===34||d.forceQuotes){m='"'+m.replace(c2,'""')+'"';break}m=="ID"&&(m='"ID"')}else w.f!=null&&!w.F?(p=!1,m="="+w.f,m.indexOf(",")>=0&&(m='"'+m.replace(c2,'""')+'"')):m="";h.push(m)}return d.blankrows===!1&&p?null:h.join(f)}function Lp(t,n){var r=[],i=n??{};if(t==null||t["!ref"]==null)return"";var l=mn(t["!ref"]),c=i.FS!==void 0?i.FS:",",f=c.charCodeAt(0),d=i.RS!==void 0?i.RS:`
`,p=d.charCodeAt(0),h=new RegExp((c=="|"?"\\|":c)+"+$"),m="",y=[];i.dense=Array.isArray(t);for(var v=i.skipHidden&&t["!cols"]||[],w=i.skipHidden&&t["!rows"]||[],S=l.s.c;S<=l.e.c;++S)(v[S]||{}).hidden||(y[S]=ur(S));for(var b=0,E=l.s.r;E<=l.e.r;++E)(w[E]||{}).hidden||(m=FR(t,l,E,y,f,p,c,i),m!=null&&(i.strip&&(m=m.replace(h,"")),(m||i.blankrows!==!1)&&r.push((b++?d:"")+m)));return delete i.dense,r.join("")}function sb(t,n){n||(n={}),n.FS="	",n.RS=`
`;var r=Lp(t,n);return r}function CR(t){var n="",r,i="";if(t==null||t["!ref"]==null)return[];var l=mn(t["!ref"]),c="",f=[],d,p=[],h=Array.isArray(t);for(d=l.s.c;d<=l.e.c;++d)f[d]=ur(d);for(var m=l.s.r;m<=l.e.r;++m)for(c=ar(m),d=l.s.c;d<=l.e.c;++d)if(n=f[d]+c,r=h?(t[m]||[])[d]:t[n],i="",r!==void 0){if(r.F!=null){if(n=r.F,!r.f)continue;i=r.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(r.f!=null)i=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}p[p.length]=n+"="+i}return p}function lb(t,n,r){var i=r||{},l=+!i.skipHeader,c=t||{},f=0,d=0;if(c&&i.origin!=null)if(typeof i.origin=="number")f=i.origin;else{var p=typeof i.origin=="string"?Wn(i.origin):i.origin;f=p.r,d=p.c}var h,m={s:{c:0,r:0},e:{c:d,r:f+n.length-1+l}};if(c["!ref"]){var y=mn(c["!ref"]);m.e.c=Math.max(m.e.c,y.e.c),m.e.r=Math.max(m.e.r,y.e.r),f==-1&&(f=y.e.r+1,m.e.r=f+n.length-1+l)}else f==-1&&(f=0,m.e.r=n.length-1+l);var v=i.header||[],w=0;n.forEach(function(b,E){ir(b).forEach(function(A){(w=v.indexOf(A))==-1&&(v[w=v.length]=A);var O=b[A],C="z",U="",B=en({c:d+w,r:f+E+l});h=tc(c,B),O&&typeof O=="object"&&!(O instanceof Date)?c[B]=O:(typeof O=="number"?C="n":typeof O=="boolean"?C="b":typeof O=="string"?C="s":O instanceof Date?(C="d",i.cellDates||(C="n",O=Tr(O)),U=i.dateNF||Dn[14]):O===null&&i.nullError&&(C="e",O=0),h?(h.t=C,h.v=O,delete h.w,delete h.R,U&&(h.z=U)):c[B]=h={t:C,v:O},U&&(h.z=U))})}),m.e.c=Math.max(m.e.c,d+v.length-1);var S=ar(f);if(l)for(w=0;w<v.length;++w)c[ur(w+d)+S]={t:"s",v:v[w]};return c["!ref"]=Ln(m),c}function RR(t,n){return lb(null,t,n)}function tc(t,n,r){if(typeof n=="string"){if(Array.isArray(t)){var i=Wn(n);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?tc(t,en(n)):tc(t,en({r:n,c:r||0}))}function MR(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var r=t.SheetNames.indexOf(n);if(r>-1)return r;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function OR(){return{SheetNames:[],Sheets:{}}}function zR(t,n,r,i){var l=1;if(!r)for(;l<=65535&&t.SheetNames.indexOf(r="Sheet"+l)!=-1;++l,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(r)>=0){var c=r.match(/(^.*?)(\d+)$/);l=c&&+c[2]||0;var f=c&&c[1]||r;for(++l;l<=65535&&t.SheetNames.indexOf(r=f+l)!=-1;++l);}if(K_(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=n,r}function LR(t,n,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=MR(t,n);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[i].Hidden=r}function BR(t,n){return t.z=n,t}function ob(t,n,r){return n?(t.l={Target:n},r&&(t.l.Tooltip=r)):delete t.l,t}function jR(t,n,r){return ob(t,"#"+n,r)}function IR(t,n,r){t.c||(t.c=[]),t.c.push({t:n,a:r||"SheetJS"})}function UR(t,n,r,i){for(var l=typeof n!="string"?n:mn(n),c=typeof n=="string"?n:Ln(n),f=l.s.r;f<=l.e.r;++f)for(var d=l.s.c;d<=l.e.c;++d){var p=tc(t,f,d);p.t="n",p.F=c,delete p.v,f==l.s.r&&d==l.s.c&&(p.f=r,i&&(p.D=!0))}return t}var ve={encode_col:ur,encode_row:ar,encode_cell:en,encode_range:Ln,decode_col:Tp,decode_row:Ep,split_cell:eD,decode_cell:Wn,decode_range:Ir,format_cell:ni,sheet_add_aoa:o_,sheet_add_json:lb,sheet_add_dom:eb,aoa_to_sheet:Dl,json_to_sheet:RR,table_to_sheet:nb,table_to_book:fR,sheet_to_csv:Lp,sheet_to_txt:sb,sheet_to_json:b0,sheet_to_html:tb,sheet_to_formulae:CR,sheet_to_row_object_array:b0,sheet_get_cell:tc,book_new:OR,book_append_sheet:zR,book_set_sheet_visibility:LR,cell_set_number_format:BR,cell_set_hyperlink:ob,cell_set_internal_link:jR,cell_add_comment:IR,sheet_set_array_formula:UR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function HR({width:t=600,height:n=600,mode:r,darkMode:i,selectedSeason:l,selectedSeq:c,onSelectSeq:f}){const d=Z.useRef(),p=Z.useRef(),[h,m]=nn(event,d.current),[y,v]=Z.useState([]);ms("%Y-%m-%d");const w=xs("%d.%m.%Y"),S="serif",b="36px",E="30px",A="26px",O="22px",C=500,U=k=>k&&typeof k=="string"?k.charAt(0).toUpperCase()+k.slice(1).toLowerCase():k,B=()=>{if(!y.length)return;const k=["Season","Density","Cort","testo","Mouse ID","Hair Sample ID","Sample Date","Life Repro Success","Recruitment","No. of Hair Samples","Hair Samples"],F=y.map(D=>[D.season,D.density.toFixed(2),D.cort.toFixed(2),D.testo??"",D.focal,D.Date_Sampled?w(D.Date_Sampled):"",D.Life_Repro_Success??"",D.Recruitment??"",D.hairIDs.length,D.hairIDs.length?D.hairIDs.join(", "):""]),T=[k.join(","),...F.map(D=>D.join(","))].join(`
`),N=new Blob([T],{type:"text/csv;charset=utf-8;"});Cn.saveAs(N,"brushed_data.csv")},V=()=>{if(!y.length)return;const k=ve.json_to_sheet(y.map(T=>({Season:T.season,Density:T.density.toFixed(2),Cort:T.cort.toFixed(2),testo:T.testo??"","Mouse ID":T.focal,"Hair Sample ID":T["External.ID2"]??"","Sample Date":T.Date_Sampled?w(T.Date_Sampled):"","Life Repro Success":T.Life_Repro_Success??"",Recruitment:T.Recruitment??"","No. of Hair Samples":T.hairIDs.length,"Hair Samples":T.hairIDs.length?T.hairIDs.join(", "):""}))),F=ve.book_new();ve.book_append_sheet(F,k,"Brushed"),Rn(F,"brushed_data.xlsx")};return Z.useEffect(()=>{const F=Ft(d.current).select("g.root");if(F.empty())return;const T=l??null;F.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const N=Ft(this).datum()?.season;return!T||N===T?.7:.1}),F.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?.3:.05}),F.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?1:.1}).attr("stroke-width",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?2.5:1})},[l]),Z.useEffect(()=>{const k=Ft(d.current).select("g.root");if(k.empty())return;k.selectAll(".dot").transition().duration(120).attr("r",T=>c!=null&&T.seq===c?9:4).attr("stroke-width",T=>c!=null&&T.seq===c?2.5:1),k.selectAll(".dot").filter(T=>c!=null&&T.seq===c).raise()},[c]),Z.useEffect(()=>{const k=Ft(p.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999"),F=(T,N={})=>N.decimals!=null?T!=null&&!isNaN(T)?T.toFixed(N.decimals):"":N.date&&T?w(T):T!=null&&T!==""?T:"";Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_corticosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",T=>(T.External_ID2=T["External.ID2"],delete T["External.ID2"],ne(T)))]).then(([T,N,D,L,K])=>{const ft=Ft(d.current);ft.selectAll("*").remove();const dt=new Map(D.filter(yt=>yt.focal_ID!=null).map(yt=>[String(yt.focal_ID).replace(/^'/,""),yt])),J=new Map;K.forEach(yt=>{if(!yt.focal_ID||yt.External_ID2==null)return;const Ut=String(yt.focal_ID).replace(/^'/,"");J.has(Ut)||J.set(Ut,new Set),J.get(Ut).add(String(yt.External_ID2))});const gt=new Map(Array.from(J.entries()).map(([yt,Ut])=>[yt,Array.from(Ut)])),wt=new Map(L.filter(yt=>yt.focal_ID!=null&&yt.Seq!=null).map(yt=>[String(yt.focal_ID).replace(/^'/,""),+yt.Seq]));let bt=T.map(yt=>{const Ut=String(yt.focal_ID).replace(/^'/,""),te=dt.get(Ut)||{};return J.get(Ut),{density:yt.Density,season:yt.Season,cort:yt["Cort_pg.mg"],focal:Ut,hair:yt["External.ID2"],Date_Sampled:te.Date_Sampled,Genetic_Sex:te.Genetic_Sex,AGD_weight:te.AGD_weight,AGD_tail:te.AGD_tail,testo:te["Testo_pg.mg_1"],Life_Repro_Success:te["life.repro.success"],Recruitment:te["recruitment.y.n"],hairIDs:gt.get(Ut)||[],seq:wt.get(Ut)??null}}),P=Array.from(rc(bt,yt=>{const Ut=yt[0].focal,te=Hn(yt,Bt=>Bt.cort);return{focal:yt[0].focal,density:yt[0].density,season:yt[0].season,cort:te,hairIDs:yt[0].hairIDs,Date_Sampled:yt[0].Date_Sampled,testo:yt[0].testo,Life_Repro_Success:yt[0].Life_Repro_Success,Recruitment:yt[0].Recruitment,seq:wt.get(Ut)??null}},yt=>yt.focal),([,yt])=>yt);const I=N.map(yt=>({density:yt.x,season:yt.group,predicted:yt.predicted,confLow:yt["conf.low"],confHigh:yt["conf.high"]})),R={top:40,right:20,bottom:100,left:120},Y=t-R.left-R.right,z=n-R.top-R.bottom;let W=_e(I,yt=>yt.density),tt=fe(I,yt=>yt.density);W=Math.min(W,_e(bt,yt=>yt.density)),tt=Math.max(tt,fe(bt,yt=>yt.density));const nt=Math.floor(W/100)*100,j=550,q=he().domain([nt,j]).range([0,Y]),lt=An(nt,j+1,100),Ct=Math.min(_e(bt,yt=>yt.cort),_e(I,yt=>yt.confLow)),vt=Math.max(fe(bt,yt=>yt.cort),fe(I,yt=>yt.confHigh)),Zt=125,Gt=180,Kt=Zt-Ct,Yt=vt-Gt,Et=z,Mt=Et*(Kt/(Kt+Yt)),Ot=Et*(Yt/(Kt+Yt)),Dt=he().domain([Ct,Zt,Gt,vt]).range([z,z-Mt,z-Mt,z-Mt-Ot]),ie=[...An(Math.ceil(Ct/20)*20,Zt,20),...An(Gt,Math.floor(vt/20)*20+1,20)],xe=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);ft.attr("width",t).attr("height",n);const ue=ft.append("g").attr("class","root").attr("transform",`translate(${R.left},${R.top})`);ft.append("text").attr("x",20).attr("y",R.top/2+5).attr("text-anchor","middle").style("font-family",S).style("font-size",b).attr("text-anchor","start").text("B"),ue.append("g").attr("transform",`translate(0,${z})`).call(Ie(q).tickValues(lt).tickFormat(Me("d"))).selectAll("text").style("font-family",S).style("font-size",O).style("font-weight",C),ue.append("g").call(Se(Dt).tickValues(ie).tickFormat(yt=>yt)).selectAll("text").style("font-family",S).style("font-size",O).style("font-weight",C),ue.selectAll(".domain, .tick line").attr("stroke","black");const ge=Dt(Zt)+2,ut=6;[-3,3].forEach(yt=>{ue.append("line").attr("x1",-ut).attr("x2",ut).attr("y1",ge+yt).attr("y2",ge+yt+6).attr("stroke","black").attr("stroke-width",1)}),ue.append("g").attr("class","grid").call(Se(Dt).tickSizeInner(-Y).tickSizeOuter(0).tickFormat("")).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),ue.append("text").attr("x",Y/2).attr("y",z+55).attr("text-anchor","middle").style("font-family",S).append("tspan").style("font-size",E).text("Density").append("tspan").attr("x",Y/2).attr("y",z+80).style("font-size",A).text("(No. of adults)"),ue.append("text").attr("transform","rotate(-90)").attr("x",-z/2).attr("y",-90).attr("text-anchor","middle").style("font-family",S).append("tspan").style("font-size",E).text("Corticosterone").append("tspan").attr("x",-z/2).attr("dy","1.2em").style("font-size",A).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(yt=>{const Ut=I.filter(te=>te.season===yt);ue.append("path").datum(Ut).attr("class",`ribbon season-${yt}`).attr("fill",xe(yt)).attr("fill-opacity",.3).attr("d",_n().x(te=>q(te.density)).y0(te=>Dt(te.confLow)).y1(te=>Dt(te.confHigh)).curve(ke)),ue.append("path").datum(Ut).attr("class",`line season-${yt}`).attr("fill","none").attr("stroke",xe(yt)).attr("stroke-width",2).attr("d",gn().x(te=>q(te.density)).y(te=>Dt(te.predicted)).curve(ke))});const ct=100;function pt(yt){const Ut=yt.currentTarget,te=parseFloat(Ut.getAttribute("r"))||4,Bt=+Ut.getAttribute("cx"),At=+Ut.getAttribute("cy"),Pt=p.current,Tt=Pt.getBoundingClientRect(),ae=Tt.width,pe=Tt.height,be=R.left+Bt,Ee=R.top+At,Le=t-(be+ct+te+ae);let pn=be-(ct+te+ae)>=Le||be>R.left+Y/2?be-(ae+ct+te):be+(ct+te),$n=Ee-pe-8;$n<0&&($n=Ee+8),pn=Math.max(0,Math.min(pn,t-ae)),$n=Math.max(0,Math.min($n,n-pe)),Ft(Pt).style("left",`${pn}px`).style("top",`${$n}px`)}const G=p.current,{offsetWidth:st,offsetHeight:St}=G,xt=(j-nt)*.05,mt=ue.append("g").attr("class","dots").selectAll("circle").data(P,yt=>yt.focal).join(yt=>yt.append("circle").attr("class","dot").attr("r",4).attr("cx",Ut=>q(Ut.density)+(Math.random()-.5)*xt).attr("cy",Ut=>Dt(Ut.cort)).attr("fill",Ut=>xe(Ut.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",Ut=>Ut.seq??"").style("cursor","pointer").on("click",(Ut,te)=>{f&&(f(c===te.seq?null:te.seq),Ut.stopPropagation())}));if(r==="hover"&&mt.style("cursor","pointer").on("mouseover",(yt,Ut)=>{k.html(`Testosterone: <strong>${F(Ut.testo||"-")}</strong><br/>Corticosterone: <strong>${F(Ut.cort.toFixed(2))}</strong><br/>Density: <strong>${F(Ut.density.toFixed(0))}</strong><br/>Season: <strong>${F(Ut.season)}</strong><br/>Offspring: <strong>${F(Ut.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${F(String(Ut.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse:  <strong>${F(Ut.hairIDs.length)}</strong><br/>Hair id:  <strong> ${Ut.hairIDs.length?Ut.hairIDs.join(", "):""}</strong><br/>`),pt(yt),k.transition().duration(100).style("opacity",.9)}).on("mousemove",pt).on("mouseout",()=>{k.transition().duration(100).style("opacity",0)}),r==="brush"){const yt=Fn().extent([[0,0],[Y,z]]).on("end",({selection:Ut})=>{if(!Ut)return v([]);const[[te,Bt],[At,Pt]]=Ut,Tt=bt.filter(pe=>{const be=q(pe.density),Ee=Dt(pe.cort);return te<=be&&be<=At&&Bt<=Ee&&Ee<=Pt}),ae=Array.from(new Map(Tt.map(pe=>[pe.focal,pe])).values());v(ae)});ue.append("g").call(yt).lower()}}),Ft(d.current).selectAll("*").remove()},[t,n,r]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:`relative transition-colors duration-300 ${i?"bg-black":"bg-white"}`,style:{width:t,height:n},children:[_.jsx("svg",{ref:d,width:t,height:n}),_.jsx("div",{ref:p})]}),r==="brush"&&y.length>0&&_.jsxs("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:B,className:"px-4 py-2 bg-white dark:bg-black text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:V,className:"px-4 py-2 bg-white dark:bg-black text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","testo","Mouse ID","Sample Date","Life Repro Success","Recruitment","No. of Hair Samples","Hair Samples"].map(k=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:k},k))})}),_.jsx("tbody",{children:y.map((k,F)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.cort.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.Date_Sampled?w(k.Date_Sampled):""}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.Life_Repro_Success}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:U(k.Recruitment)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.hairIDs.join(", ")})]},F))})]})]})]})}function $R({width:t=600,height:n=600,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c}){const f=Z.useRef(),d=Z.useRef(),[p,h]=nn(event,f.current),[m,y]=Z.useState([]);ms("%Y-%m-%d");const v=xs("%d.%m.%Y"),w=()=>{if(!m.length)return;const k=["AGD.tail","Offspring"],F=m.map(N=>[N.x.toFixed(2),N.y]),T=[k.join(","),...F.map(N=>N.join(","))].join(`
`);Cn.saveAs(new Blob([T],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},S=()=>{if(!m.length)return;const k=ve.json_to_sheet(m.map(T=>({"AGD.tail":T.x.toFixed(2),Offspring:T.y}))),F=ve.book_new();ve.book_append_sheet(F,k,"Brushed Data"),Rn(F,"lrs_brushed_data.xlsx")},b="serif",E="36px",A="30px",O="26px",C="22px",U=500,B=k=>k&&typeof k=="string"?k.charAt(0).toUpperCase()+k.slice(1).toLowerCase():k,V=(k,F={})=>F.decimals!=null?k!=null&&!isNaN(k)?k.toFixed(F.decimals):"":F.date&&k?v(k):k!=null&&k!==""?k:"";return Z.useEffect(()=>{const F=Ft(f.current).select("g.root");if(F.empty())return;const T=i??null;F.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const N=Ft(this).datum()?.season;return!T||N===T?.7:.1}),F.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?.3:.05}),F.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?1:.1}).attr("stroke-width",function(){const N=Ft(this).attr("class").split(" ").find(D=>D.startsWith("season-"))?.replace("season-","");return!T||N===T?2.5:1})},[i]),Z.useEffect(()=>{const k=Ft(f.current).select("g.root");if(k.empty())return;k.selectAll(".dot").transition().duration(120).attr("r",T=>l!=null&&T.seq===l?9:4).attr("stroke-width",T=>l!=null&&T.seq===l?2.5:1),k.selectAll(".dot").filter(T=>l!=null&&T.seq===l).raise()},[l]),Z.useEffect(()=>{const k=Ft(d.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone.csv",ne)]).then(([F,T,N,D,L,K])=>{const ft=Ft(f.current);ft.selectAll("*").remove();const dt=new Map(N.filter(rt=>rt.focal_ID!=null).map(rt=>[String(rt.focal_ID).replace(/^'/,""),rt])),J=new Map(Array.from(Ea(K.filter(rt=>rt.focal_ID!=null),rt=>String(rt.focal_ID).replace(/^'/,"")),([rt,ct])=>[rt,Hn(ct,pt=>pt["Cort_pg.mg"])])),gt=new Map(Array.from(Ea(D.filter(rt=>rt.focal_ID!=null),rt=>String(rt.focal_ID).replace(/^'/,"")),([rt,ct])=>[rt,Array.from(new Set(ct.map(pt=>String(pt["External.ID2"])).filter(pt=>pt!=null&&pt!=="")))])),wt=new Map(L.filter(rt=>rt.focal_ID!=null&&rt.Seq!=null).map(rt=>[String(rt.focal_ID).replace(/^'/,""),+rt.Seq]));let bt=F.map(rt=>{const ct=String(rt.focal_ID).replace(/^'/,""),pt=dt.get(ct)||{},G=gt.get(ct)||[];return{density:rt.Density,season:rt.Season,testo:rt["Testo_pg.mg"],focal:ct,Date_Sampled:pt.Date_Sampled,Genetic_Sex:pt.Genetic_Sex,AGD_weight:pt.AGD_weight,AGD_tail:pt.AGD_tail,Testo:pt["Testo_pg.mg_1"],Life_Repro_Success:pt["life.repro.success"],Recruitment:pt["recruitment.y.n"],hairIDs:G,seq:wt.get(ct)??null,cort:J.get(ct)??null}});const P=T.map(rt=>({density:rt.density,season:rt.season,predicted:rt.predicted,confLow:rt["conf.low"],confHigh:rt["conf.high"]})),I={top:40,right:20,bottom:100,left:120},R=t-I.left-I.right,Y=n-I.top-I.bottom;bt.map(rt=>rt.density).concat(P.map(rt=>rt.density));let z=_e(P,rt=>rt.density),W=fe(P,rt=>rt.density);z=Math.min(z,_e(bt,rt=>rt.density)),W=Math.max(W,fe(bt,rt=>rt.density));const tt=Math.floor(z/100)*100,nt=550,j=he().domain([tt,nt]).range([0,R]),q=An(tt,nt+1,100),lt=bt.map(rt=>rt.testo).concat(P.map(rt=>rt.confLow),P.map(rt=>rt.confHigh)),Ct=wn(lt),vt=Math.floor(Ct[0]),Zt=Math.ceil(Ct[1]),Gt=An(vt,Zt+1,1),Kt=he().domain(Ct).range([Y,0]).nice(),Yt=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);ft.attr("width",t).attr("height",n);const Et=ft.append("g").attr("class","root").attr("transform",`translate(${I.left},${I.top})`);ft.append("text").attr("x",20).attr("y",I.top/2+5).attr("text-anchor","middle").style("font-family",b).style("font-size",E).attr("text-anchor","start").text("A"),Et.append("g").attr("transform",`translate(0,${Y})`).call(Ie(j).tickValues(q).tickFormat(Me("d"))).selectAll("text").style("font-family",b).style("font-size",C).style("font-weight",U),Et.append("g").call(Se(Kt).tickValues(Gt).tickFormat(Me("d"))).selectAll("text").style("font-family",b).style("font-size",C).style("font-weight",U),Et.selectAll(".domain, .tick line").attr("stroke","black"),Et.append("g").attr("class","grid").call(Se(Kt).tickSizeInner(-R).tickSizeOuter(0).tickFormat("")).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Et.append("text").attr("x",R/2).attr("y",Y+55).attr("text-anchor","middle").style("font-family",b).append("tspan").style("font-size",A).text("Density").append("tspan").attr("x",R/2).attr("y",Y+80).style("font-size",O).text("(No. of adults)"),Et.append("text").attr("transform","rotate(-90)").attr("x",-Y/2).attr("y",-90).attr("text-anchor","middle").style("font-family",b).append("tspan").style("font-size",A).text("Testosterone").append("tspan").attr("x",-Y/2).attr("dy","1.2em").style("font-size",O).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(rt=>{const ct=P.filter(pt=>pt.season===rt);Et.append("path").datum(ct).attr("class",`ribbon season-${rt}`).attr("fill",Yt(rt)).attr("fill-opacity",.3).attr("d",_n().x(pt=>j(pt.density)).y0(pt=>Kt(pt.confLow)).y1(pt=>Kt(pt.confHigh)).curve(ke)),Et.append("path").datum(ct).attr("class",`line season-${rt}`).attr("fill","none").attr("stroke",Yt(rt)).attr("stroke-width",2).attr("d",gn().x(pt=>j(pt.density)).y(pt=>Kt(pt.predicted)).curve(ke))});const Ot=100;function Dt(rt){const ct=rt.currentTarget,pt=parseFloat(ct.getAttribute("r"))||4,G=+ct.getAttribute("cx"),st=+ct.getAttribute("cy"),St=d.current,xt=St.getBoundingClientRect(),mt=xt.width,yt=xt.height,Ut=I.left+G,te=I.top+st,Bt=t-(Ut+Ot+pt+mt);let Tt=Ut-(Ot+pt+mt)>=Bt||Ut>I.left+R/2?Ut-(mt+Ot+pt):Ut+(Ot+pt),ae=te-yt-8;ae<0&&(ae=te+8),Tt=Math.max(0,Math.min(Tt,t-mt)),ae=Math.max(0,Math.min(ae,n-yt)),Ft(St).style("left",`${Tt}px`).style("top",`${ae}px`)}const ie=d.current,{offsetWidth:xe,offsetHeight:ue}=ie,ge=(nt-tt)*.05,ut=Et.append("g").attr("class","dots").selectAll("circle").data(bt,rt=>`${rt.focal}-${rt.run}`).join(rt=>rt.append("circle").attr("class","dot").attr("r",4).attr("cx",ct=>j(ct.density)+(Math.random()-.5)*ge).attr("cy",ct=>Kt(ct.testo)).attr("fill",ct=>Yt(ct.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",ct=>ct.seq??"").style("cursor","pointer").on("click",(ct,pt)=>{c&&(c(l===pt.seq?null:pt.seq),ct.stopPropagation())}));if(r==="hover"&&ut.style("cursor","pointer").on("mouseover",(rt,ct)=>{k.html(`Testosterone: <strong>${V(ct.testo||"-")}</strong><br/>Corticosterone: <strong>${V(ct.cort?.toFixed(2))}</strong><br/>Density: <strong>${V(ct.density.toFixed(0))}</strong><br/>Season: <strong>${V(ct.season)}</strong><br/>Offspring: <strong>${V(ct.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${V(String(ct.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse: <strong>${V(ct.hairIDs.length)}</strong><br/>Hair id: <strong>${ct.hairIDs.length?ct.hairIDs.join(", "):""}</strong>`),Dt(rt),k.transition().duration(100).style("opacity",.9)}).on("mousemove",Dt).on("mouseout",()=>{k.transition().duration(100).style("opacity",0)}),r==="brush"){const rt=Fn().extent([[0,0],[R,Y]]).on("end",({selection:ct})=>{if(!ct)return y([]);const[[pt,G],[st,St]]=ct;y(bt.filter(xt=>{const mt=j(xt.density),yt=Kt(xt.testo);return pt<=mt&&mt<=st&&G<=yt&&yt<=St}))});Et.append("g").call(rt).lower()}}),Ft(f.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{children:_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:f}),_.jsx("div",{ref:d})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&m.length>0&&_.jsxs("div",{className:"ml-0 max-h-[600px] overflow-y-auto",children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:S,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","Testosterone (pg/mg hair)","Mouse ID","Sample Date","Life Reproduction Success","Recruitment","No. of Hair Samples","Hair Samples"].map(k=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:k},k))})}),_.jsx("tbody",{children:m.map((k,F)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.density.toFixed(0)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.cort}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.Testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V(k.Date_Sampled,{date:!0})}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V(k.Life_Repro_Success)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V(B(k.Recruitment))}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:k.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V(k.hairIDs.length?k.hairIDs.join(", "):"")})]},F))})]})]})})]})})}function GR({width:t=600,height:n=600,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c}){const f=Z.useRef(),d=Z.useRef(),[p,h]=nn(event,f.current),[m,y]=Z.useState([]),[v,w]=Z.useState("tail"),S=(F,T={})=>T.decimals!=null?F!=null&&!isNaN(F)?F.toFixed(T.decimals):"":T.date&&F?formatDate(F):F!=null&&F!==""?F:"",b=()=>{if(!m.length)return;const F=["AGD.tail","Offspring"],T=m.map(D=>[D.x.toFixed(2),D.y]),N=[F.join(","),...T.map(D=>D.join(","))].join(`
`);Cn.saveAs(new Blob([N],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},E=()=>{if(!m.length)return;const F=ve.json_to_sheet(m.map(N=>({"AGD.tail":N.x.toFixed(2),Offspring:N.y}))),T=ve.book_new();ve.book_append_sheet(T,F,"Brushed Data"),Rn(T,"lrs_brushed_data.xlsx")},A="serif",O="36px",C="14px",U="30px",B="26px",V="22px",k=500;return Z.useEffect(()=>{const T=Ft(f.current).select("g.root");if(T.empty())return;const N=i?String(i).trim().toLowerCase():null;T.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const D=Ft(this).datum()?.season;return!N||D===N?.7:.1}),T.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?.3:.05}),T.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?1:.1}).attr("stroke-width",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?2.5:1}),N&&T.selectAll(".dot").filter(D=>D.season===N).raise()},[i]),Z.useEffect(()=>{const F=Ft(f.current).attr("class","root").select("g.root");if(F.empty())return;const T=i??null;F.selectAll(".dot").transition().duration(120).attr("r",D=>T&&D.season===T?9:4).attr("stroke-width",D=>T&&D.season===T?2.5:1),F.selectAll(".dot").filter(D=>l!=null&&D.seq===l).raise()},[l]),Z.useEffect(()=>{const F=Ft(f.current).attr("width",t).attr("height",n).style("background","white").style("font-family",A),T=Ft(d.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size",C).style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("z-index","9999").style("text-align","left"),N=`/fetal-programming-for-female-masculinization/data/observed_agd_${v}.csv`,D=`/fetal-programming-for-female-masculinization/data/predicted_agd_${v}.csv`;Promise.all([Jt(N,ne),Jt(D,ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",L=>(L.External_ID2=L["External.ID2"],delete L["External.ID2"],ne(L))),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([L,K,ft,dt,J])=>{F.selectAll(".chart-title").remove(),F.selectAll("g.root").remove(),F.selectAll("foreignObject#metric-fo").remove();const gt=new Map(J.filter(pt=>pt.focal_ID!=null).map(pt=>[String(pt.focal_ID).replace(/^'/,""),pt])),wt=new Map;dt.forEach(pt=>{if(!pt.focal_ID||pt.External_ID2==null)return;const G=String(pt.focal_ID).replace(/^'/,"");wt.has(G)||wt.set(G,new Set),wt.get(G).add(String(pt.External_ID2))});const bt=new Map(Array.from(wt.entries()).map(([pt,G])=>[pt,Array.from(G)])),P=new Map(ft.filter(pt=>pt.focal_ID!=null&&pt.Seq!=null).map(pt=>[String(pt.focal_ID).replace(/^'/,""),+pt.Seq]));let I=L.filter(pt=>pt["Season.DOB"]!=null&&pt[`AGD.${v}`]!=null).map(pt=>{const G=String(pt.focal_ID).replace(/^'/,"");return gt.get(G),wt.get(G),{season:pt["Season.DOB"].trim().toLowerCase(),density:pt["Density.DOB"],agd:pt[`AGD.${v}`],focal:G,hair:pt["External.ID2"],hairIDs:bt.get(G)||[],seq:P.get(G)??null}});const R=K.filter(pt=>(v==="tail"?pt.group!=null:pt.season!=null)&&pt.predicted!=null).map(pt=>({season:(v==="tail"?pt.group:pt.season).trim().toLowerCase(),density:v==="tail"?pt.x:pt.density,predicted:pt.predicted,confLow:pt["conf.low"],confHigh:pt["conf.high"]})),Y={top:50,right:20,bottom:100,left:120},z=t-Y.left-Y.right,W=n-Y.top-Y.bottom,tt=["spring","summer","autumn","winter"],nt=wn(I,pt=>pt.density),j=_e([_e(I,pt=>pt.agd),_e(R,pt=>pt.confLow)]),q=fe([fe(I,pt=>pt.agd),fe(R,pt=>pt.confHigh)]),lt=Math.max(fe(I,pt=>pt.density)??0,fe(R,pt=>pt.density)??0),Ct=Math.ceil(lt/100)*100||0,vt=he().domain([0,Ct]).range([0,z]),Zt=An(0,Ct+1,100),Gt=he().domain([j,q]).nice().range([W,0]),Kt=pa().domain(tt).range(["#009E73","#F0E442","#D55E00","#0072B2"]);F.append("text").attr("x",20).attr("y",Y.top/2).attr("text-anchor","middle").style("font-family",A).style("font-size",O).attr("text-anchor","start").text("C");const Yt=F.append("g").attr("class","root").attr("transform",`translate(${Y.left},${Y.top})`),Et=Gt.ticks();fe(Et);const Mt=Yt.append("g").attr("class","y-grid").call(Se(Gt).tickSize(-z).tickFormat(""));Mt.select(".domain").remove(),Mt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3);const Ot=Gt.domain()[1];Mt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Mt.selectAll("g.tick").filter(pt=>pt===Ot).select("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Yt.append("g").attr("transform",`translate(0,${W})`).call(Ie(vt).tickValues(Zt).tickFormat(pt=>pt===Ct?"":Me("d")(pt))).selectAll("text").style("font-family",A).style("font-size",V).style("font-weight",k),Yt.append("g").call(Se(Gt)).selectAll("text").style("font-family",A).style("font-size",V).style("font-weight",k),Yt.append("text").attr("class","x-axis-title").attr("x",z/2).attr("y",W+55).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",U).text("Density").append("tspan").attr("x",z/2).attr("y",W+80).style("font-size",B).text("(No. of adults)"),Yt.append("text").attr("transform","rotate(-90)").attr("x",-W/2).attr("y",-90).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",U).text("Masculinization index").append("tspan").attr("x",-W/2).attr("dy","1.2em").style("font-size",B).text("(Length corrected AGD)"),tt.forEach(pt=>{const G=R.filter(st=>st.season===pt);Yt.append("path").datum(G).attr("data-season",pt).attr("class",`ribbon season-${pt}`).attr("d",_n().x(st=>vt(st.density)).y0(st=>Gt(st.confLow)).y1(st=>Gt(st.confHigh)).curve(ke)).attr("fill",Kt(pt)).attr("fill-opacity",.3),Yt.append("path").datum(G).attr("data-season",pt).attr("class",`line season-${pt}`).attr("fill","none").attr("stroke",Kt(pt)).attr("stroke-width",2).attr("d",gn().x(st=>vt(st.density)).y(st=>Gt(st.predicted)).curve(ke))});const Dt=100;function ie(pt){const G=pt.currentTarget,st=parseFloat(G.getAttribute("r"))||4,St=+G.getAttribute("cx"),xt=+G.getAttribute("cy"),mt=d.current,yt=mt.getBoundingClientRect(),Ut=yt.width,te=yt.height,Bt=Y.left+St,At=Y.top+xt,Pt=t-(Bt+Dt+st+Ut);let pe=Bt-(Dt+st+Ut)>=Pt||Bt>Y.left+innerWidth/2?Bt-(Ut+Dt+st):Bt+(Dt+st),be=At-te-8;be<0&&(be=At+8),pe=Math.max(0,Math.min(pe,t-Ut)),be=Math.max(0,Math.min(be,n-te)),Ft(mt).style("left",`${pe}px`).style("top",`${be}px`)}const xe=d.current,{offsetWidth:ue,offsetHeight:ge}=xe,ut=Yt.append("g").attr("class","dots"),rt=(nt[1]-nt[0])*.05;ut.selectAll("circle").data(I).enter().append("circle").attr("class","dot").attr("cx",pt=>vt(pt.density)+(Math.random()-.5)*rt).attr("cy",pt=>Gt(pt.agd)).attr("r",4).attr("stroke","white").attr("stroke-width",1).style("cursor","pointer").attr("fill",pt=>Kt(pt.season)).attr("fill-opacity",.6).on("click",(pt,G)=>{c&&(c(l===G.seq?null:G.seq),pt.stopPropagation())});const ct=ut.selectAll("circle");ct.on("mouseover",null).on("mouseout",null),Yt.selectAll(".brush").remove(),y([]),r==="hover"?ct.on("mouseover",(pt,G)=>{const st=G.season.charAt(0).toUpperCase()+G.season.slice(1);T.html(`Season: <strong>${st}</strong><br/>Density: <strong>${G.density}</strong><br/>${v==="tail"?"Length corrected AGD":"Weight corrected AGD"}: <strong>${G.agd.toFixed(2)}</strong><br/>Mouse id: <strong>${S(String(G.seq).replace(/^'/,""))}</strong><br/>`),ie(pt),T.transition().duration(100).style("opacity",.9)}).on("mousemove",ie).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}):Yt.append("g").attr("class","brush").call(Fn().extent([[0,0],[z,W]]).on("end",({selection:pt})=>{if(!pt)return y([]);const[[G,st],[St,xt]]=pt;y(I.filter(mt=>{const yt=vt(mt.density),Ut=Gt(mt.agd);return G<=yt&&yt<=St&&st<=Ut&&Ut<=xt}))})),Yt.selectAll(".ribbon, .line").raise()})},[t,n,r,v]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:f}),_.jsx("div",{ref:d})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&m.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:b,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)",`AGD ${v}`].map(F=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:F},F))})}),_.jsx("tbody",{children:m.map((F,T)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.agd.toFixed(2)})]},T))})]})]})})]})}function PR({width:t=600,height:n=500,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),[d,p]=nn(event,c.current),h="motherCort",[m,y]=Z.useState([]),v=D=>String(D??"").trim().replace(/^'+/,""),w=()=>{if(!m.length)return;const D=["AGD.tail","Offspring"],L=m.map(ft=>[ft.x.toFixed(2),ft.y]),K=[D.join(","),...L.map(ft=>ft.join(","))].join(`
`);Cn.saveAs(new Blob([K],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},S=()=>{if(!m.length)return;const D=ve.json_to_sheet(m.map(K=>({"AGD.tail":K.x.toFixed(2),Offspring:K.y}))),L=ve.book_new();ve.book_append_sheet(L,D,"Brushed Data"),Rn(L,"lrs_brushed_data.xlsx")},b="lightgray",E="gray",A="gray",O="serif",C="36px",U="30px",B="26px",V="22px",k=500,F={top:40,right:20,bottom:100,left:120},T=t-F.left-F.right,N=n-F.top-F.bottom;return Z.useEffect(()=>{const D=L=>L?.seq??L?.mouseID??L?.focal??L?.id;Ft(c.current).selectAll("circle").transition().duration(100).attr("r",L=>D(L)===i?8:4)},[i]),Z.useEffect(()=>{const D=Ft(c.current).attr("width",t).attr("height",n).style("background","white").style("font-family",O);D.selectAll("*").remove();const L=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999").style("text-align","left");D.append("text").attr("x",20).attr("y",F.top/2+5).attr("text-anchor","middle").style("font-family",O).style("font-size",C).attr("text-anchor","start").text("E"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",dt=>{const J=dt["External.ID2"]??dt.External_ID2??dt["LC.MS.run"];return dt.External_ID2=J==null?null:String(J).trim(),dt.focal_ID=v(dt.focal_ID),ne(dt)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([dt,J,gt,wt,bt])=>{new Map(bt.filter(G=>G.focal_ID!=null).map(G=>[String(G.focal_ID).replace(/^'/,""),G]));const P=new Map;gt.forEach(G=>{const st=v(G.focal_ID),St=G.External_ID2==null?null:String(G.External_ID2).trim();!st||!St||(P.has(st)||P.set(st,new Set),P.get(st).add(St))});const I=new Map(Array.from(P.entries()).map(([G,st])=>[G,Array.from(st)])),R=new Map(wt.filter(G=>G.focal_ID!=null&&G.Seq!=null).map(G=>[v(G.focal_ID),+G.Seq]));let Y=dt.map((G,st)=>{const St=v(G.focal_ID),xt=I.get(St)??[],mt=St;return{id:st,x:+G.motherCort,y:+G["AGD.tail"],focal:St,mouseID:mt,hair:G["External.ID2"],hairIDs:xt,seq:R.get(St)??null}}).filter(G=>isFinite(G.x)&&isFinite(G.y));const z=J.map(G=>({x:+G[h],predicted:+G.predicted,confLow:+G["conf.low"],confHigh:+G["conf.high"]})).filter(G=>!isNaN(G.x)&&!isNaN(G.predicted)),W=Y.map(G=>G.x).concat(z.map(G=>G.x)),tt=Y.map(G=>G.y).concat(z.map(G=>G.confLow)).concat(z.map(G=>G.confHigh)),nt=_e(W),j=fe(W),q=_e(tt),lt=fe(tt),Ct=he().domain([nt,j]).nice().range([0,T]),vt=he().domain([q,lt]).nice().range([N,0]),Zt=D.append("g").attr("transform",`translate(${F.left},${F.top})`),Gt=vt.ticks();fe(Gt);const Kt=Zt.append("g").attr("class","y-grid").call(Se(vt).tickSize(-T).tickFormat(""));Kt.select(".domain").remove(),Kt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Yt=vt.domain()[1];Kt.selectAll("g.tick").filter(G=>G===Yt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),Zt.append("g").attr("transform",`translate(0,${N})`).call(Ie(Ct)).style("font-family",O).style("font-size",V).style("font-weight",k).append("text").attr("fill","black").attr("class","axis-label").attr("x",T/2).attr("y",F.bottom-40).attr("fill","black").attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Maternal corticosterone").append("tspan").attr("x",T/2).attr("y",F.bottom-15).style("font-size",B).text("(pg/mg hair)"),Zt.append("g").call(Se(vt)).style("font-family",O).style("font-size",V).style("font-weight",k).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-N/2).attr("y",-90).attr("fill","black").style("font-family",O).style("font-size",U).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-N/2).attr("dy","1.2em").style("font-size",B).text("(AGD.tail)"),Zt.append("path").datum(z.sort((G,st)=>G.x-st.x)).attr("d",_n().x(G=>Ct(G.x)).y0(G=>vt(G.confLow)).y1(G=>vt(G.confHigh)).curve(ke)).attr("fill",b).attr("fill-opacity",.3),Zt.append("path").datum(z.sort((G,st)=>G.x-st.x)).attr("d",gn().x(G=>Ct(G.x)).y(G=>vt(G.predicted)).curve(ke)).attr("fill","none").attr("stroke",A).attr("stroke-width",2);const Mt=100;function Ot(G){const st=G.currentTarget,St=parseFloat(st.getAttribute("r"))||4,xt=+st.getAttribute("cx"),mt=+st.getAttribute("cy"),yt=f.current,Ut=yt.getBoundingClientRect(),te=Ut.width,Bt=Ut.height,At=F.left+xt,Pt=F.top+mt,Tt=t-(At+Mt+St+te);let be=At-(Mt+St+te)>=Tt||At>F.left+innerWidth/2?At-(te+Mt+St):At+(Mt+St),Ee=Pt-Bt-8;Ee<0&&(Ee=Pt+8),be=Math.max(0,Math.min(be,t-te)),Ee=Math.max(0,Math.min(Ee,n-Bt)),Ft(yt).style("left",`${be}px`).style("top",`${Ee}px`)}const Dt=f.current,{offsetWidth:ie,offsetHeight:xe}=Dt,ue=-.025,ge=-.025,ut=We(2025);un.source(ut)(-ue,ue),un.source(ut)(-ge,ge);function rt(G,st,St){return(We(G*1000003+St)()*2-1)*st}const ct=G=>G?.seq??G?.mouseID??G?.focal??G?.id,pt=Zt.append("g").selectAll("circle.point").data(Y,G=>ct(G)).join("circle").attr("class","point").attr("cx",G=>Ct(G.x+rt(ct(G),ue,11))).attr("cy",G=>vt(G.y+rt(ct(G),ge,17))).attr("r",G=>ct(G)===i?10:4).attr("fill",E).attr("opacity",.8).style("cursor","pointer").on("click",(G,st)=>l(ct(st)));r==="hover"&&pt.on("mouseover",(G,st)=>{const[St,xt]=nn(G,D.node()),mt=Array.isArray(st.hairIDs)?st.hairIDs:[];L.html(`Mat.testosterone: <strong>${st.testo.toFixed(2)}</strong><br/>Mat. corticosterone: <strong> ${st.x.toFixed(2)}
                  )}</strong><br/>AGD.tail: <strong>${st.y.toFixed(2)}</strong><br/>Mouse id (seq): <strong>${st.seq??"-"}</strong><br/>Hair samples / mouse: <strong>${mt.length}</strong><br/>Hair IDs: <strong>${mt.length?mt.join(", "):"-"}</strong>`),Ot(G),L.transition().duration(100).style("opacity",.9)}).on("mousemove",Ot(e)).on("mouseout",()=>{L.transition().duration(100).style("opacity",0)}),r==="brush"?Zt.append("g").attr("class","brush").call(Fn().extent([[0,0],[T,N]]).on("end",({selection:G})=>{if(!G)return y([]);const[[st,St],[xt,mt]]=G,yt=Y.filter(Ut=>{const te=Ct(Ut.x),Bt=vt(Ut.y);return te>=st&&te<=xt&&Bt>=St&&Bt<=mt});y(yt)})):(Zt.selectAll(".brush").remove(),y([]))}).catch(dt=>console.error("Error loading data:",dt))},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f,style:{position:"absolute",pointerEvents:"none",opacity:0,background:"white",padding:"6px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"12px",boxShadow:"0 1px 4px rgba(0,0,0,0.2)"}})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&m.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:S,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal corticosterone (pg/mg hair)","Masculinization index (AGD corrected for tail)"].map(D=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:D},D))})}),_.jsx("tbody",{children:m.map((D,L)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.y.toFixed(2)})]},L))})]})]})})]})}function YR({width:t=600,height:n=500,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),[d,p]=nn(event,c.current),[h,m]=Z.useState([]),y=F=>String(F??"").trim().replace(/^'+/,""),v=()=>{if(!h.length)return;const F=["Maternal Testo","AGD.tail","Maternal Cort"],T=h.map(D=>[D.x.toFixed(2),D.y.toFixed(2),D.cort.toFixed(2)]),N=[F.join(","),...T.map(D=>D.join(","))].join(`
`);Cn.saveAs(new Blob([N],{type:"text/csv"}),"F_brushed.csv")},w=()=>{if(!h.length)return;const F=ve.json_to_sheet(h.map(N=>({"Maternal Testo":N.x.toFixed(2),"AGD.tail":N.y.toFixed(2),"Maternal Cort":N.cort.toFixed(2)}))),T=ve.book_new();ve.book_append_sheet(T,F,"Brushed"),Rn(T,"F_brushed.xlsx")},S="gray",b="serif",E="36px",A="30px",O="26px",C="22px",U=500,B={top:40,right:20,bottom:100,left:140},V=t-B.left-B.right,k=n-B.top-B.bottom;return Z.useEffect(()=>{const F=T=>T?.seq??T?.mouseID??T?.focal??T?.id;Ft(c.current).selectAll("circle.point").transition().duration(100).attr("r",T=>F(T)===i?10:4)},[i]),Z.useEffect(()=>{const F=Ft(c.current).attr("width",t).attr("height",n).style("background","white");F.selectAll("*").remove();const T=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("z-index","9999").style("text-align","left");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",N=>{const D=N["External.ID2"]??N.External_ID2??N["LC.MS.run"];return N.External_ID2=D==null?null:String(D).trim(),N.focal_ID=y(N.focal_ID),ne(N)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([N,D,L,K,ft,dt])=>{const J=new Map(dt.filter(ut=>ut.focal_ID!=null).map(ut=>[String(ut.focal_ID).replace(/^'/,""),ut])),gt=new Map;K.forEach(ut=>{const rt=y(ut.focal_ID),ct=ut.External_ID2==null?null:String(ut.External_ID2).trim();!rt||!ct||(gt.has(rt)||gt.set(rt,new Set),gt.get(rt).add(ct))});const wt=new Map(Array.from(gt.entries()).map(([ut,rt])=>[ut,Array.from(rt)])),bt=new Map(ft.filter(ut=>ut.focal_ID!=null&&ut.Seq!=null).map(ut=>[y(ut.focal_ID),+ut.Seq]));let P=N.map((ut,rt)=>{const ct=y(ut.focal_ID);J.get(ct);const pt=wt.get(ct)??[],G=y(ut.focal_ID),st=+ut.motherTesto,St=+D[rt].motherCort;return{id:rt,x:st,y:+ut["AGD.tail"],cort:St,focal:ct,mouseID:G,hair:ut["External.ID2"],hairIDs:pt,seq:bt.get(ct)??null}}).filter(ut=>isFinite(ut.x)&&!isNaN(ut.y)&&!isNaN(ut.cort));const I=L.map(ut=>({x:+ut.motherTesto,predicted:+ut.predicted,confLow:+ut["conf.low"],confHigh:+ut["conf.high"]})).filter(ut=>!isNaN(ut.x)),R=P.map(ut=>ut.x).concat(I.map(ut=>ut.x)),Y=P.map(ut=>ut.y).concat(I.map(ut=>ut.confLow)).concat(I.map(ut=>ut.confHigh)),z=P.map(ut=>ut.cort),W=he().domain(wn(R)).nice().range([0,V]),tt=he().domain(wn(Y)).nice().range([k,0]);N0(xp).domain(wn(z));const nt=F.append("g").attr("transform",`translate(${B.left},${B.top})`);F.append("text").attr("x",20).attr("y",B.top/2+5).attr("text-anchor","middle").style("font-family",b).style("font-size",E).attr("text-anchor","start").text("D");const j=tt.ticks();fe(j);const q=nt.append("g").attr("class","y-grid").call(Se(tt).tickSize(-V).tickFormat(""));q.select(".domain").remove(),q.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const lt=tt.domain()[1];q.selectAll("g.tick").filter(ut=>ut===lt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),nt.append("g").attr("transform",`translate(0,${k})`).call(Ie(W)).style("font-family",b).style("font-size",C).style("font-weight",U).append("text").attr("class","axis-label").attr("x",V/2).attr("y",B.bottom-40).attr("fill","black").attr("text-anchor","middle").style("font-family",b).append("tspan").style("font-size",A).text("Maternal testosterone").append("tspan").attr("x",V/2).attr("y",B.bottom-15).style("font-size",O).text("(pg/mg hair)"),nt.append("g").call(Se(tt)).style("font-family",b).style("font-size",C).style("font-weight",U).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-k/2).attr("y",-110).attr("fill","black").style("font-family",b).style("font-size",A).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-k/2).attr("dy","1.2em").style("font-size",O).text("(AGD.tail)"),nt.append("path").datum(I.sort((ut,rt)=>ut.x-rt.x)).attr("d",_n().x(ut=>W(ut.x)).y0(ut=>tt(ut.confLow)).y1(ut=>tt(ut.confHigh)).curve(ke)).attr("fill","#ddd").attr("opacity",.4),nt.append("path").datum(I.sort((ut,rt)=>ut.x-rt.x)).attr("d",gn().x(ut=>W(ut.x)).y(ut=>tt(ut.predicted)).curve(ke)).attr("stroke","#888").attr("fill","none").attr("stroke-width",2);const Zt=100;function Gt(ut){const rt=ut.currentTarget,ct=parseFloat(rt.getAttribute("r"))||4,pt=+rt.getAttribute("cx"),G=+rt.getAttribute("cy"),st=f.current,St=st.getBoundingClientRect(),xt=St.width,mt=St.height,yt=B.left+pt,Ut=B.top+G,te=t-(yt+Zt+ct+xt);let Pt=yt-(Zt+ct+xt)>=te||yt>B.left+V/2?yt-(xt+Zt+ct):yt+(Zt+ct),Tt=Ut-mt-8;Tt<0&&(Tt=Ut+8),Pt=Math.max(0,Math.min(Pt,t-xt)),Tt=Math.max(0,Math.min(Tt,n-mt)),Ft(st).style("left",`${Pt}px`).style("top",`${Tt}px`)}function Kt(){l(null),T.transition().duration(100).style("opacity",0)}const Yt=f.current,{offsetWidth:Et,offsetHeight:Mt}=Yt,Ot=-.025,Dt=-.025,ie=We(2025);un.source(ie)(-Ot,Ot),un.source(ie)(-Dt,Dt);function xe(ut,rt,ct){return(We(ut*1000003+ct)()*2-1)*rt}nt.on("dblclick",()=>Kt());const ue=ut=>ut?.seq??ut?.mouseID??ut?.focal??ut?.id,ge=nt.append("g").selectAll("circle.point").data(P,ut=>ue(ut)).join("circle").attr("class","point").attr("cx",ut=>W(ut.x+xe(ue(ut),Ot,11))).attr("cy",ut=>tt(ut.y+xe(ue(ut),Dt,17))).attr("r",ut=>ue(ut)===i?10:4).attr("fill",S).attr("opacity",.8).style("cursor","pointer").on("click",(ut,rt)=>l(ue(rt))).on("dblclick",(ut,rt)=>{i===ue(rt)&&(ut.stopPropagation(),Kt())});r==="hover"&&ge.on("mouseover",(ut,rt)=>{const ct=Array.isArray(rt.hairIDs)?rt.hairIDs:[];T.html(`Mat.testosterone: <strong>${rt.x.toFixed(2)}</strong><br/>Mat. corticosterone: <strong>${rt.cort.toFixed(2)}</strong><br/>AGD.tail: <strong>${rt.y.toFixed(2)}</strong><br/>Mouse id (original): <strong>${rt.mouseID}</strong><br/>Mouse id: <strong>${rt.seq??"-"}</strong><br/>Hair samples / mouse: <strong>${rt.hairIDs.length}</strong><br/>Hair IDs: <strong>${ct.length?ct.join(", "):"-"}</strong><br/>`),Gt(event),T.transition().duration(100).style("opacity",.9)}).on("mousemove",ut=>Gt(ut)).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}),r==="brush"&&nt.append("g").call(Fn().extent([[0,0],[V,k]]).on("end",({selection:ut})=>{if(!ut)return m([]);const[[rt,ct],[pt,G]]=ut,st=P.filter(St=>{const xt=W(St.x),mt=tt(St.y);return xt>=rt&&xt<=pt&&mt>=ct&&mt<=G});Array.from(new Set(st.map(St=>`${St.x}|${St.y}|${St.cort}`))).map(St=>{const[xt,mt,yt]=St.split("|").map(Number);return{x:xt,y:mt,cort:yt}}),m(st)}))}).catch(console.error)},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f})]}),r==="brush"&&h.length>0&&_.jsxs("div",{className:"w-56 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:v,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal Testo","AGD.tail","Maternal Cort"].map(F=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:F},F))})}),_.jsx("tbody",{children:h.map((F,T)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.y.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.cort.toFixed(2)})]},T))})]})]})]})}function VR({width:t=1900,height:n=600,mode:r}){const i=Z.useRef(),l=Z.useRef(),c="agd_tail",[f,d]=Z.useState([]),p=()=>{if(!f.length)return;const U=["AGD.tail","Offspring"],B=f.map(k=>[k.x.toFixed(2),k.y]),V=[U.join(","),...B.map(k=>k.join(","))].join(`
`);Cn.saveAs(new Blob([V],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},h=()=>{if(!f.length)return;const U=ve.json_to_sheet(f.map(V=>({"AGD.tail":V.x.toFixed(2),Offspring:V.y}))),B=ve.book_new();ve.book_append_sheet(B,U,"Brushed Data"),Rn(B,"lrs_brushed_data.xlsx")},m="lightgray",y="gray",v="gray",w="serif",S="36px",b="30px",E="26px",A="22px",O=500,C={top:40};return Z.useEffect(()=>{const U=Ft(i.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif").style("font-size","16px");U.selectAll("*").remove(),U.append("text").attr("x",40).attr("y",C.top/2+5).attr("text-anchor","middle").style("font-family",w).style("font-size",S).attr("text-anchor","start").text("A"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail.csv",ne)]).then(([k,F])=>{const T=k.map(Dt=>({x:+Dt["AGD.tail"],y:+Dt["life.repro.success"]})).filter(Dt=>!isNaN(Dt.x)&&!isNaN(Dt.y)),N=F.map(Dt=>({x:+Dt[c],predicted:+Dt.predicted,confLow:+Dt["conf.low"],confHigh:+Dt["conf.high"]})).filter(Dt=>!isNaN(Dt.x)&&!isNaN(Dt.predicted)),D={top:40,right:20,bottom:100,left:120},L=t-D.left-D.right,K=n-D.top-D.bottom,ft=T.map(Dt=>Dt.x).concat(N.map(Dt=>Dt.x)),dt=T.map(Dt=>Dt.y).concat(N.map(Dt=>Dt.confLow)).concat(N.map(Dt=>Dt.confHigh)),J=fe(dt),gt=Math.ceil(J/10)*10,wt=he().domain([_e(ft),fe(ft)]).nice().range([0,L]),bt=he().domain([-.5,gt]).nice().range([K,0]),P=U.append("g").attr("transform",`translate(${D.left},${D.top})`);An(10,gt+1,10);const I=bt.ticks();fe(I);const R=P.append("g").attr("class","y-grid").call(Se(bt).tickSize(-L).tickFormat(""));R.select(".domain").remove(),R.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Y=bt.domain()[1];R.selectAll("g.tick").filter(Dt=>Dt===Y).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const z=1e-6,W=(Dt,ie)=>Math.abs(Dt-ie)<z,tt=(Dt,ie)=>Dt.some(xe=>W(xe,ie))?Dt:[...Dt,ie],nt=wt.domain()[1],j=bt.domain()[1],lt=tt([-1,0,1,2],nt),Ct=Me(".0f"),vt=[0,10,20,30];P.append("g").attr("transform",`translate(0,${K})`).call(Ie(wt).tickValues(lt).tickFormat(Dt=>W(Dt,nt)?"":Ct(Dt)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10)).selectAll("text").style("font-family",w).style("font-size",A).style("font-weight",O),P.append("text").attr("class","x-axis-title").attr("x",L/2).attr("y",K+95).attr("text-anchor","middle").style("font-family",w).append("tspan").style("font-size",b).text("Masculinization index").append("tspan").attr("x",L/2).attr("y",K+140).style("font-size",E).text("(AGD.tail)"),P.append("g").call(Se(bt).tickValues(tt(vt,j)).tickFormat(Dt=>W(Dt,j)?"":Dt)).style("font-family",w).style("font-size",A).style("font-weight",O).append("text").attr("transform","rotate(-90)").attr("x",-K/2).attr("y",-80).attr("fill","black").attr("text-anchor","middle").style("font-size",b).text("Offspring"),P.append("path").datum(N.sort((Dt,ie)=>Dt.x-ie.x)).attr("d",_n().x(Dt=>wt(Dt.x)).y0(Dt=>bt(Dt.confLow)).y1(Dt=>bt(Dt.confHigh)).curve(ke)).attr("fill",m).attr("fill-opacity",.3),P.append("path").datum(N.sort((Dt,ie)=>Dt.x-ie.x)).attr("d",gn().x(Dt=>wt(Dt.x)).y(Dt=>bt(Dt.predicted)).curve(ke)).attr("fill","none").attr("stroke",v).attr("stroke-width",2);const Gt=Ft(l.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999"),Kt=-.05,Yt=.55,Et=We(2025),Mt=un.source(Et)(-Kt,Kt),Ot=un.source(Et)(-Yt,Yt);P.append("g").selectAll("circle").data(T.map(Dt=>({...Dt,_jx:Mt(),_jy:Ot()}))).enter().append("circle").attr("cx",Dt=>wt(Dt.x+Dt._jx)).attr("cy",Dt=>bt(Dt.y+Dt._jy)).attr("r",3).attr("fill",y).attr("fill-opacity",.6),r==="brush"?P.append("g").attr("class","brush").call(Fn().extent([[0,0],[L,K]]).on("end",({selection:Dt})=>{if(!Dt)return d([]);const[[ie,xe],[ue,ge]]=Dt,ut=T.filter(rt=>{const ct=wt(rt.x),pt=bt(rt.y);return ct>=ie&&ct<=ue&&pt>=xe&&pt<=ge});d(ut)})):(P.selectAll(".brush").remove(),d([])),Ft(i.current).selectAll("circle").on("mouseover",(Dt,ie)=>{const[xe,ue]=nn(Dt,U.node());Ft(l.current).html(`Masculinization index(AGD.tail): <strong> ${ie.x.toFixed(2)}</strong><br/>Offspring: <strong>${ie.y}</strong>`);const ge=Gt.node(),ut=ge.getBoundingClientRect().height;Gt.style("left",`${xe+D.left-ge.getBoundingClientRect().width/2}px`).style("top",`${ue+D.top-ut-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>Ft(l.current).transition().duration(100).style("opacity",0))}).catch(k=>console.error("Error loading data:",k))},[t,n,r]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:i}),_.jsx("div",{})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&f.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:p,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:h,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Masculinization index (AGD.tail)","Lifetime reproductive success (Offspring)"].map(U=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:U},U))})}),_.jsx("tbody",{children:f.map((U,B)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:U.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:U.y})]},B))})]})]})})]})}function XR({width:t=1e3,height:n=660,brushRange:r=null}){const i=Z.useRef(),l=Z.useRef(),c=Z.useRef(null),f={top:40,right:100,bottom:120,left:120},d=t-f.left-f.right,p=n-f.top-f.bottom,h="/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",m="/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail_by_density.csv",y="serif",v="36px",w="30px",S="26px",b="22px",E=500;return Z.useEffect(()=>{const A=c.current;if(!A)return;const O=V=>V.attr("r",3).attr("stroke","none").attr("stroke-width",null).attr("fill-opacity",.6).style("filter",null);if(r==null){A.interrupt().transition().duration(150),O(A);return}const[C,U]=r??[-1/0,1/0],B=V=>Number.isFinite(V.density)&&V.density>=C&&V.density<=U;A.interrupt().transition().duration(180).attr("r",V=>B(V)?5:3).attr("stroke",V=>B(V)?"#111":"none").attr("stroke-width",V=>B(V)?1:null).attr("fill-opacity",V=>B(V)?.95:.15).style("filter",V=>B(V)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),A.filter(B).raise()},[r]),Z.useEffect(()=>{const A=Ft(i.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif");A.selectAll("*").remove(),A.append("text").attr("x",40).attr("y",f.top/2+5).attr("text-anchor","middle").style("font-family",y).style("font-size",v).attr("text-anchor","start").text("B"),Promise.all([Jt(h,ne),Jt(m,ne)]).then(([O,C])=>{const U=We(.42),B=O.map((z,W)=>{const tt=+z["Density.DOB"],nt=+z["AGD.tail"],j=+z["life.repro.success"],q=p*.01,lt=p*.02,Ct=(U()-.5)*(j===0?lt:q);return{density:tt,x:nt,y:j,jy:Ct,_key:`${W}|${tt}|${nt}|${j}`}}),V=C.map(z=>({density:z.density,x:+z.agd_tail,pred:+z.predicted,lo:+z["conf.low"],hi:+z["conf.high"]})),k=Array.from(new Set(V.map(z=>z.density))),F=[100,200,300,400,500],T=["#440154","#3b528b","#21918c","#5ec962","#fde725"],N=he().domain(F).range(T).interpolate(Tl),D=B.map(z=>z.x).concat(V.map(z=>z.x)),L=B.map(z=>z.y).concat(V.map(z=>z.lo)).concat(V.map(z=>z.hi)),K=he().domain(wn(D)).nice().range([0,d]),ft=he().domain([-1e-4,Math.ceil(fe(L)/10)*10]).nice().range([p,0]),dt=A.append("g").attr("transform",`translate(${f.left},${f.top})`),J=ft.ticks();fe(J);const gt=dt.append("g").attr("class","y-grid").call(Se(ft).tickSize(-d).tickFormat(""));gt.select(".domain").remove(),gt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const wt=ft.domain()[1];gt.selectAll("g.tick").filter(z=>z===wt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),dt.append("g").attr("transform",`translate(0,${p})`).call(Ie(K).ticks(4)).style("font-family",y).style("font-size",b).style("font-weight",E).append("text").attr("x",d/2).attr("y",40).attr("text-anchor","middle").style("font-size",S).text("Masculinization index (AGD.tail)"),dt.append("g").call(Se(ft).ticks(4)).style("font-family",y).style("font-size",b).style("font-weight",E);const bt=dt.append("text").attr("class","axis-label").attr("x",d/2).attr("y",p+f.bottom-70).attr("text-anchor","middle").style("font-weight",E).style("font-family",y);bt.append("tspan").attr("x",d/2).attr("dy",10).style("font-size",w).style("font-family",y).text("Masculinization index"),bt.append("tspan").attr("x",d/2).attr("dy","1.2em").style("font-size",S).text("(AGD.tail)"),dt.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-p/2).attr("y",-80).attr("text-anchor","middle").style("font-family",y).style("font-size",w).text("Offspring");const P=dt.append("g").selectAll("circle").data(B,z=>z._key).join("circle").attr("cx",z=>K(z.x)).attr("cy",z=>ft(z.y)+z.jy).attr("r",3).attr("fill",z=>N(z.density)).attr("fill-opacity",.6);c.current=P;const I=_n().x(z=>K(z.x)).y0(z=>ft(z.lo)).y1(z=>ft(z.hi)).curve(ke),R=gn().x(z=>K(z.x)).y(z=>ft(z.pred)).curve(ke);k.forEach(z=>{const W=V.filter(tt=>tt.density===z).sort((tt,nt)=>tt.x-nt.x);dt.append("path").datum(W).attr("fill",N(z)).attr("fill-opacity",.3).attr("d",I),dt.append("path").datum(W).attr("stroke",N(z)).attr("stroke-width",2).attr("fill","none").attr("d",R)});const Y=Ft(l.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)");dt.selectAll("circle").on("mouseover",(z,W)=>{const[tt,nt]=nn(z,A.node());Y.html(`Masculinization index(AGD.tail): <strong> ${W.x.toFixed(2)}</strong><br/>Offspring: <strong>${W.y}</strong>`);const j=Y.node(),q=j.getBoundingClientRect().height;Y.style("left",`${tt+f.left-j.getBoundingClientRect().width/2}px`).style("top",`${nt+f.top-q-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>Y.transition().duration(100).style("opacity",0))}).catch(O=>console.error(O))},[t,n]),_.jsx("div",{className:"relative",style:{width:t,height:n},children:_.jsx("svg",{ref:i})})}function WR({width:t=1e3,height:n=710,mode:r,brushRange:i=null}){const l=Z.useRef(),c=Z.useRef(),f=Z.useRef(null),[d,p]=Z.useState([]),h="serif",m="38px",y="34px",v="30px",w="22px",S=500,b={top:40,right:100,bottom:120,left:120},E=t-b.left-b.right,A=n-b.top-b.bottom,O=()=>{if(!d.length)return;const B=["Density","AGD.tail","Recruitment","AGD.weight","Density Group"],V=d.map(T=>[T.density.toFixed(2),T.agd.toFixed(2),T.recruitment===1?"Yes":T.recruitment===0?"No":T.recruitment,T.weight.toFixed(2),T.group]),k=[B.join(","),...V.map(T=>T.join(","))].join(`
`),F=new Blob([k],{type:"text/csv;charset=utf-8;"});Cn.saveAs(F,"agd_brushed_data.csv")},C=()=>{if(!d.length)return;const B=ve.json_to_sheet(d.map(k=>({Density:k.density.toFixed(2),"AGD.tail":k.agd.toFixed(2),Recruitment:k.recruitment===1?"Yes":k.recruitment===0?"No":k.recruitment,"AGD.weight":k.weight.toFixed(2),"Density Group":k.group}))),V=ve.book_new();ve.book_append_sheet(V,B,"Brushed Data"),Rn(V,"agd_brushed_data.xlsx")};Z.useEffect(()=>{const B=f.current;if(!B)return;const V=N=>N.attr("r",3).attr("stroke",null).attr("stroke-width",null).attr("fill-opacity",.25).style("filter",null);if(i==null){B.interrupt().transition().duration(150),V(B);return}const[k,F]=i??[-1/0,1/0],T=N=>Number.isFinite(N.density)&&N.density>=k&&N.density<=F;B.interrupt().transition().duration(180).attr("r",N=>T(N)?6:3).attr("stroke",N=>T(N)?"#111":null).attr("stroke-width",N=>T(N)?1.5:null).attr("fill-opacity",N=>T(N)?.95:.15).style("filter",N=>T(N)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),B.filter(T).raise()},[i]),Z.useEffect(()=>{const B=Ft(l.current).attr("width",t).attr("height",n).style("background","white").style("font-family",h).style("overflow","visible");B.selectAll("*").remove();const V=Ft(c.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");B.append("text").attr("x",40).attr("y",b.top/2).attr("text-anchor","middle").style("font-family",h).style("font-size",m).attr("text-anchor","start").text("C"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_recruitment.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_recruitment.csv",ne)]).then(([k,F])=>{const T=We(.42),N=k.map((Mt,Ot)=>{const Dt=+Mt["AGD.tail"],ie=+Mt.recruitment,xe=+Mt["AGD.weight"],ue=Mt["Density.DOB"],ge=+ue,ut=Number.isFinite(ge)?ge:+Mt.density||+Mt.group,rt=(T()-.5)*A*.13;return{x:Dt,y:ie,weight:xe,group:ue,density:ut,jy:rt,_key:`${Ot}|${Dt}|${ie}|${ut}`}}).filter(Mt=>Number.isFinite(Mt.x)&&Number.isFinite(Mt.y)),D=F.map(Mt=>({x:+Mt.agd_tail,predicted:+Mt.predicted,confLow:+Mt["conf.low"],confHigh:+Mt["conf.high"],group:Mt.density})).filter(Mt=>Number.isFinite(Mt.x)&&Number.isFinite(Mt.predicted)),L=Array.from(new Set(D.map(Mt=>Mt.group))),ft=B.append("defs").append("linearGradient").attr("id","viridisGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),dt=["#440154","#3b528b","#21918c","#5ec962","#fde725"],J=[0,500],gt=["#440154","#3b528b","#21918c","#5ec962","#fde725"],wt=he().domain(An(0,1+1e-9,1/(gt.length-1)).map(Mt=>J[0]+Mt*(J[1]-J[0]))).range(gt).interpolate(Tl),bt=[...N.map(Mt=>Mt.x),...D.map(Mt=>Mt.x)],P=he().domain(wn(bt)).nice().range([0,E]),I=he().domain([-.1,1.1]).nice().range([A,0]),R=B.append("g").attr("transform",`translate(${b.left},${b.top})`),Y=1e-6,z=(Mt,Ot)=>Math.abs(Mt-Ot)<Y,W=(Mt,Ot)=>Mt.some(Dt=>z(Dt,Ot))?Mt:[...Mt,Ot],tt=P.domain()[1],nt=I.domain()[1],q=W([-1,0,1,2],tt),Ct=W([0,.4,.8],nt),vt=Me(".0f"),Zt=Me(".1f"),Gt=Ie(P).tickValues(q).tickFormat(Mt=>z(Mt,tt)?"":vt(Mt)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10);R.append("g").attr("transform",`translate(0,${A})`).call(Gt).call(Mt=>Mt.selectAll(".domain, .tick line").attr("stroke","#000")).call(Mt=>Mt.selectAll(".tick text").attr("font-size",w));const Kt=R.append("text").attr("class","axis-label").attr("x",E/2).attr("y",A+b.bottom-60).attr("text-anchor","middle");Kt.append("tspan").attr("x",E/2).attr("dy",10).style("font-size",y).style("font-weight",S).style("font-family",h).text("Masculinization index"),Kt.append("tspan").attr("x",E/2).attr("dy","1.2em").style("font-size",v).text("(AGD.tail)");const Yt=Se(I).tickValues(Ct).tickFormat(Mt=>z(Mt,nt)?"":Zt(Mt)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10);R.append("g").call(Yt).call(Mt=>Mt.selectAll(".domain, .tick line").attr("stroke","#000")).call(Mt=>Mt.selectAll(".tick text").attr("font-size",w)),R.append("g").attr("class","grid").call(Se(I).tickValues([0,.4,.8]).tickSize(-E).tickFormat("")).call(Mt=>Mt.select(".domain").remove()).call(Mt=>Mt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3)).lower(),R.append("text").attr("class","y-axis-title").attr("transform","rotate(-90)").attr("x",-A/2).attr("y",-80).attr("text-anchor","middle").style("font-size",y).style("font-family",h).text("Recruitment probability"),L.forEach(Mt=>{const Ot=D.filter(Dt=>Dt.group===Mt).sort((Dt,ie)=>Dt.x-ie.x);R.append("path").datum(Ot).attr("d",_n().x(Dt=>P(Dt.x)).y0(Dt=>I(Dt.confLow)).y1(Dt=>I(Dt.confHigh)).curve(ke)).attr("fill",wt(Mt)).attr("fill-opacity",.3),R.append("path").datum(Ot).attr("d",gn().x(Dt=>P(Dt.x)).y(Dt=>I(Dt.predicted)).curve(ke)).attr("stroke",wt(Mt)).attr("stroke-width",2).attr("fill","none")});const Et=R.append("g").attr("class","dots").selectAll("circle").data(N,Mt=>Mt._key).join("circle").attr("cx",Mt=>P(Mt.x)).attr("cy",Mt=>I(Mt.y)+Mt.jy).attr("r",3).attr("fill",Mt=>wt(Mt.density)).attr("fill-opacity",.25);f.current=Et,r==="hover"?Et.on("mouseover",(Mt,Ot)=>{const[Dt,ie]=nn(Mt,l.current);V.html(`Masculinization index(AGD.tail): <strong>${Ot.x.toFixed(2)}</strong><br/>Masculinization index(AGD weight):<strong> ${Ot.weight.toFixed(2)}</strong><br/>Recruitment: ${Ot.y===1?"Yes":Ot.y===0?"No":Ot.y.toFixed(2)}`).style("left",`${Dt+b.left+10}px`).style("top",`${ie+b.top-30}px`).transition().duration(100).style("opacity",.9).attr("r",6).attr("stroke-width",2)}).on("mouseout",()=>V.transition().duration(100).style("opacity",0)):r==="brush"&&R.append("g").attr("class","brush").call(Fn().extent([[0,0],[E,A]]).on("end",({selection:Mt})=>{if(!Mt){p([]);return}const[[Ot,Dt],[ie,xe]]=Mt,ge=N.filter(ut=>{const rt=P(ut.x),ct=I(ut.y);return rt>=Ot&&rt<=ie&&ct>=Dt&&ct<=xe}).map(ut=>({density:ut.x,agd:ut.x,recruitment:ut.y,weight:ut.weight,group:ut.group}));p(ge)})),dt.forEach((Mt,Ot)=>{ft.append("stop").attr("offset",`${Ot/(dt.length-1)*100}%`).attr("stop-color",Mt)})})},[t,n,r]);const U=["Recruitment probability","Masculinization index (AGD.tail)","AGD weight","Recruitment","Group"];return _.jsxs("div",{className:"flex space-x-4",children:[_.jsx("div",{className:"relative",style:{width:t,height:n},children:_.jsx("svg",{ref:l})}),_.jsx("div",{className:"max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&d.length>0&&_.jsxs("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex space-x-2",children:[_.jsx("button",{onClick:O,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:C,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:U.map(B=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs text-left",children:B},B))})}),_.jsx("tbody",{children:d.map((B,V)=>_.jsxs("tr",{className:"odd:bg-gray-50",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.agd.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.weight.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.recruitment===1?"Yes":B.recruitment===0?"No":B.recruitment}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.group})]},V))})]})]})})]})}function qR({width:t=400,barHeight:n=20,margins:r={top:0,right:0,bottom:30,left:20},domain:i=[0,500],colors:l=["#440154","#3b528b","#21918c","#5ec962","#fde725"],title:c="Density",gradientId:f="viridisGradient",onBrush:d=()=>{}}){const p=Z.useRef(),h=Z.useRef(d);return Z.useEffect(()=>{h.current=d},[d]),Z.useEffect(()=>{const m=t-r.left-r.right,y=n,v=r.top+y+r.bottom,w=Ft(p.current).attr("width",t).attr("height",v).style("overflow","visible");w.selectAll("*").remove();const b=w.append("defs").append("linearGradient").attr("id",f).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");l.forEach((B,V)=>{b.append("stop").attr("offset",`${100*V/(l.length-1)}%`).attr("stop-color",B)});const E=w.append("g").attr("transform",`translate(${r.left},${r.top})`);E.append("rect").attr("width",m).attr("height",y).style("fill",`url(#${f})`).style("stroke","#000");const A=he().domain(i).range([0,m]),O=Ie(A).ticks(l.length).tickFormat(Me("d"));E.append("g").attr("transform",`translate(0,${y})`).call(O).selectAll("text").style("font-size","14px"),E.append("text").attr("x",0).attr("y",-10).attr("text-anchor","start").style("font-size","17px").style("font-weight","bold").text(c);const C=ov().extent([[0,0],[m,y]]).on("end",B=>{if(!B.selection){h.current(null);return}const[V,k]=B.selection.map(A.invert);h.current([V,k])}),U=E.append("g").attr("class","brush").call(C);U.selectAll(".selection").attr("stroke","#444").attr("stroke-width",2).attr("fill","rgba(0,0,0,0.2)"),U.selectAll(".handle").attr("fill","#444")},[t,n,r.left,r.right,r.top,r.bottom,i.toString(),l.toString(),f,c]),_.jsx("svg",{ref:p})}const KR=Z.memo(qR),cb="/fetal-programming-for-female-masculinization/image/IMG_1208.png",fb="/fetal-programming-for-female-masculinization/image/IMG_1219.png",ub=["Spring","Summer","Autumn","Winter"],ZR=pa().domain(ub).range(["#009E73","#F0E442","#D55E00","#0072B2"]);function Bp({selected:t,onChange:n}){return _.jsxs("div",{className:"flex flex-wrap gap-4 items-center ml-5  mt-4 font-serif",children:[_.jsx("span",{className:"font-serif text-2xl font-semibold",children:"Season:"}),ub.map(r=>{const i=t===r;return _.jsxs("button",{onClick:()=>n(i?null:r),className:`flex items-center gap-2 px-2 py-1 rounded
                ${i?"ring-2 ring-gray-800 dark:ring-gray-200":""}`,title:r,children:[_.jsx("span",{className:"inline-block w-4 h-4 rounded-sm",style:{background:ZR(r)}}),_.jsx("span",{className:"text-2xl font-medium",children:r})]},r)}),t&&_.jsx("button",{onClick:()=>n(null),className:"text-lg underline",children:"Reset"})]})}function QR(){const[t,n]=Z.useState(null),[r,i]=Z.useState(null),[l,c]=Z.useState(null);return _.jsx(_.Fragment,{children:_.jsxs("div",{className:"fixed top-40 -mt-20 left-10 right-10 bottom-0 h-full overflow-y-auto p-0 text-black dark:text-white transition-colors duration-300",children:[_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[" ",_.jsxs("div",{className:"mb-0",children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 1: Pup body measures."}),_.jsx("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:_.jsxs("div",{className:"grid grid-cols-4 gap-40 mb-2",children:[_.jsx(W6,{}),_.jsx(q6,{}),_.jsx(K6,{}),_.jsxs("div",{className:"flex flex-col gap-0 ml-20 ",children:[_.jsxs("figure",{className:"relative w-[220px]",children:[_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/IMG_1208.png",alt:"Measuring anogenital distance with calipers",width:220,height:360,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-3xl font-serif",children:"D"})]}),_.jsxs("figure",{className:"relative w-[220px]",children:[_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/IMG_1219.png",alt:"Tail length measurement with ruler",width:220,height:360,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-3xl font-serif",children:"E"})]})]})]})})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[_.jsxs("div",{className:"mb-5",children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 2: Preconditions of the fetal programming hypothesis."}),_.jsx("div",{className:"mb-5",children:_.jsx(Bp,{})}),_.jsx("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:_.jsxs("div",{className:"grid grid-cols-3 gap-0 mb-0",children:[_.jsx($R,{}),_.jsx("div",{className:"-ml-5",children:_.jsx(HR,{})}),_.jsx("div",{className:"-ml-10",children:_.jsx(GR,{})})]})})]}),_.jsx("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:_.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-5 mr-20",children:[_.jsx(YR,{hoveredId:t,onHover:n}),_.jsx(PR,{hoveredId:t,onHover:n}),_.jsxs("figure",{className:"relative w-[600px] ml-10 -mt-2",children:[_.jsx("img",{src:"/fetal-programming-for-female-masculinization/image/barn_1.jpeg",alt:"Right",className:"w-[100%] object-cover justify-self-start"}),_.jsx("figcaption",{className:"absolute top-0 left-2 text-4xl font-serif",children:"F"})]})]})})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 mb-40 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 3: Effects of masculinization on lifetime reproductive success and recruitment."}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx(VR,{}),_.jsxs("div",{className:"grid grid-cols-2 gap-5 mt-6",children:[_.jsx(XR,{}),_.jsx("div",{className:"transform scale-[0.9] -mt-7",children:_.jsx(WR,{})})]}),_.jsx("div",{className:"ml-10",children:_.jsx(KR,{})})]})]})]})})}const JR=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=600,height:r=520,margin:i={top:120,right:0,bottom:120,left:180}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="50px",p="44px",h="38px",m="36px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,j=>j.tail),fe(S,j=>j.tail)]).nice().range([E,0]),U=he().domain([_e(S,j=>j.weight),fe(S,j=>j.weight)]).nice().range([0,b]),B=1e-6,V=(j,q)=>Math.abs(j-q)<B,k=(j,q)=>j.some(lt=>V(lt,q))?j:[...j,q],F=U.domain()[1],T=C.domain()[1],N=[3,6,9],D=[30,40,50,60];O.append("g").call(Se(C).tickValues(k(D,T)).tickFormat(j=>V(j,T)?"":j).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues(k(N,F)).tickFormat(j=>V(j,F)?"":Me("d")(j)).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const ft=A.append("text").attr("x",i.left+b/2).attr("y",r-15).attr("text-anchor","middle").style("font-family",f);ft.append("tspan").style("font-size",p).text("Weight "),ft.append("tspan").style("font-size",h).text("(g)");const dt=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);dt.append("tspan").style("font-size",p).text("Tail length "),dt.append("tspan").attr("x",-265).attr("dy","1.2em").style("font-size",h).text("(mm)");const J=We(2025),gt=un.source(J)(-8,8);O.selectAll("circle").data(S.map(j=>({...j,jx:gt()}))).enter().append("circle").attr("cx",j=>U(j.weight)+j.jx).attr("cy",j=>C(j.tail)+j.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(j,q)=>{v.html(`Tail: ${q.tail} mm<br/>Weight: ${q.weight} g`).style("visibility","visible")}).on("mousemove",j=>{v.style("top",j.offsetY+"px").style("left",j.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const wt=S.map(j=>j.weight),bt=S.map(j=>j.tail),{slope:P,intercept:I}=w(wt,bt),R=_e(wt),Y=fe(wt),z=I+P*R,W=I+P*Y;O.append("line").attr("x1",U(R)).attr("y1",C(z)).attr("x2",U(Y)).attr("y2",C(W)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-170).attr("y",i.top/2-120).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("A");const tt=wt.map(j=>I+P*j),nt=Hn(bt);Te(bt.map((j,q)=>(j-tt[q])**2)),Te(bt.map(j=>(j-nt)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},tM=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=600,height:r=520,margin:i={top:120,right:0,bottom:120,left:180}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="50px",p="44px",h="38px",m="36px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,I=>I.anogenitalDistance),fe(S,I=>I.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,I=>I.tail),fe(S,I=>I.tail)]).nice().range([0,b]),B=O.append("g").call(Se(C).tickValues([2,3,4,5,6]).tickSizeOuter(0).tickFormat(Me("d")).tickPadding(10)),V=O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues([30,40,50,60]).tickFormat(Me("d")).tickSizeOuter(0).tickPadding(10));B.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),V.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const k=A.append("text").attr("x",i.left+b/2).attr("y",r-15).attr("text-anchor","middle").style("font-family",f);k.append("tspan").style("font-size",p).text("Tail length "),k.append("tspan").style("font-size",h).text("(mm)");const F=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);F.append("tspan").style("font-size",p).text("Anogenital distance "),F.append("tspan").attr("x",-265).attr("dy","1.2em").style("font-size",h).text("(mm)");const T=We(2025),N=un.source(T)(-8,8);O.selectAll("circle").data(S.map(I=>({...I,jx:N()}))).enter().append("circle").attr("cx",I=>U(I.tail)+I.jx).attr("cy",I=>C(I.anogenitalDistance)+I.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(I,R)=>{v.html(`Tail: ${R.anogenitalDistance} mm<br/>Weight: ${R.tail} g`).style("visibility","visible")}).on("mousemove",I=>{v.style("top",I.offsetY+"px").style("left",I.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const D=S.map(I=>I.tail),L=S.map(I=>I.anogenitalDistance),{slope:K,intercept:ft}=w(D,L),dt=_e(D),J=fe(D),gt=ft+K*dt,wt=ft+K*J;O.append("line").attr("x1",U(dt)).attr("y1",C(gt)).attr("x2",U(J)).attr("y2",C(wt)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-170).attr("y",i.top/2-130).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("B");const bt=D.map(I=>ft+K*I),P=Hn(L);Te(L.map((I,R)=>(I-bt[R])**2)),Te(L.map(I=>(I-P)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},eM=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=600,height:r=520,margin:i={top:120,right:0,bottom:120,left:180}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="50px",p="44px",h="38px",m="36px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,j=>j.anogenitalDistance),fe(S,j=>j.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,j=>j.weight),fe(S,j=>j.weight)]).nice().range([0,b]),B=1e-6,V=(j,q)=>Math.abs(j-q)<B,k=(j,q)=>j.some(lt=>V(lt,q))?j:[...j,q],F=U.domain()[1],T=C.domain()[1],N=[3,6,9],D=[2,3,4,5,6],L=O.append("g").call(Se(C).tickValues(k(D,T)).tickFormat(Me("d")).tickSizeOuter(0).tickPadding(10));O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues(k(N,F)).tickFormat(j=>V(j,F)?"":Me("d")(j)).tickSizeOuter(0).tickPadding(10)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),L.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const ft=A.append("text").attr("x",i.left+b/2).attr("y",r-15).attr("text-anchor","middle").style("font-family",f);ft.append("tspan").style("font-size",p).text("Weight "),ft.append("tspan").style("font-size",h).text("(g)");const dt=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);dt.append("tspan").style("font-size",p).text("Anogenital distance "),dt.append("tspan").attr("x",-265).attr("dy","1.2em").style("font-size",h).text("(mm)");const J=We(2025),gt=un.source(J)(-8,8);O.selectAll("circle").data(S.map(j=>({...j,jx:gt()}))).enter().append("circle").attr("cx",j=>U(j.weight)+j.jx).attr("cy",j=>C(j.anogenitalDistance)+j.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(j,q)=>{v.html(`Tail: ${q.anogenitalDistance} mm<br/>Weight: ${q.weight} g`).style("visibility","visible")}).on("mousemove",j=>{v.style("top",j.offsetY+"px").style("left",j.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const wt=S.map(j=>j.weight),bt=S.map(j=>j.anogenitalDistance),{slope:P,intercept:I}=w(wt,bt),R=_e(wt),Y=fe(wt),z=I+P*R,W=I+P*Y;O.append("line").attr("x1",U(R)).attr("y1",C(z)).attr("x2",U(Y)).attr("y2",C(W)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-170).attr("y",i.top/2-130).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("C");const tt=wt.map(j=>I+P*j),nt=Hn(bt);Te(bt.map((j,q)=>(j-tt[q])**2)),Te(bt.map(j=>(j-nt)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})};function nM({width:t=1100,height:n=900,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c,selectedHairIDs:f=new Set,onSelectHairIDs:d}){const p=Z.useRef(),h=Z.useRef(),m=Z.useRef(l),[y,v]=nn(event,p.current),[w,S]=Z.useState([]);ms("%Y-%m-%d");const b=xs("%d.%m.%Y");Z.useRef(null);const E=()=>{if(!w.length)return;const N=["AGD.tail","Offspring"],D=w.map(K=>[K.x.toFixed(2),K.y]),L=[N.join(","),...D.map(K=>K.join(","))].join(`
`);Cn.saveAs(new Blob([L],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},A=()=>{if(!w.length)return;const N=ve.json_to_sheet(w.map(L=>({"AGD.tail":L.x.toFixed(2),Offspring:L.y}))),D=ve.book_new();ve.book_append_sheet(D,N,"Brushed Data"),Rn(D,"lrs_brushed_data.xlsx")},O="serif",C="50px",U="44px",B="38px",V="36px",k=500,F=N=>N&&typeof N=="string"?N.charAt(0).toUpperCase()+N.slice(1).toLowerCase():N,T=(N,D={})=>D.decimals!=null?N!=null&&!isNaN(N)?N.toFixed(D.decimals):"":D.date&&N?b(N):N!=null&&N!==""?N:"";return Z.useEffect(()=>{m.current=l;const D=Ft(p.current).select("g.root");if(D.empty())return;const L=i??null;D.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const K=Ft(this).datum()?.season;return!L||K===L?.7:.1}),D.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?.3:.05}),D.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?1:.1}).attr("stroke-width",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?2.5:1})},[i]),Z.useEffect(()=>{m.current=l;const N=Ft(p.current).select("g.root");if(N.empty())return;const D=N.selectAll(".dot"),L=f&&f.size>0,K=dt=>L&&Array.isArray(dt)&&dt.some(J=>f.has(String(J))),ft=dt=>l!=null&&dt.seq===l||K(dt.hairIDs);D.interrupt(),D.filter(ft).transition().duration(140).attr("r",dt=>l!=null&&dt.seq===l?20:8).attr("stroke-width",dt=>l!=null&&dt.seq===l?2.5:1),D.filter(dt=>!ft(dt)).attr("r",8).attr("stroke-width",1),D.filter(dt=>l!=null&&dt.seq===l).raise()},[f,l]),Z.useEffect(()=>{const N=Ft(h.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","24px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone_backup.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_corticosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",D=>(D.External_ID2=D["External.ID2"],delete D["External.ID2"],ne(D))),Jt("/fetal-programming-for-female-masculinization/data/observed_testosterone.csv",ne)]).then(([D,L,K,ft,dt,J])=>{const gt=Ft(p.current);gt.selectAll("*").remove();const wt=new Map(K.filter(At=>At.focal_ID!=null).map(At=>[String(At.focal_ID).replace(/^'/,""),At])),bt=new Map(Array.from(Ea(J.filter(At=>At.focal_ID!=null),At=>String(At.focal_ID).replace(/^'/,"")),([At,Pt])=>[At,Hn(Pt,Tt=>Tt["Testo_pg.mg"])])),P=rc(J.filter(At=>At.focal_ID!=null&&At.Season!=null),At=>Hn(At,Pt=>Pt["Testo_pg.mg"]),At=>String(At.focal_ID).replace(/^'/,""),At=>At.Season),I=new Map(Array.from(Ea(dt.filter(At=>At.focal_ID!=null),At=>String(At.focal_ID).replace(/^'/,"")),([At,Pt])=>[At,Array.from(new Set(Pt.map(Tt=>String(Tt.External_ID2)).filter(Tt=>Tt!=null&&Tt!=="")))])),R=new Map(ft.filter(At=>At.focal_ID!=null&&At.Seq!=null).map(At=>[String(At.focal_ID).replace(/^'/,""),+At.Seq]));let Y=D.map(At=>{const Pt=String(At.focal_ID).replace(/^'/,""),Tt=wt.get(Pt)||{},ae=I.get(Pt)||[];return{density:Number(At.Density)||0,season:At.Season,cort:At["Cort_pg.mg"],focal:Pt,Date_Sampled:Tt.Date_Sampled,Genetic_Sex:Tt.Genetic_Sex,AGD_weight:Tt.AGD_weight,AGD_tail:Tt.AGD_tail,Testo:Tt["Testo_pg.mg_1"],Life_Repro_Success:Tt["life.repro.success"],Recruitment:Tt["recruitment.y.n"],hairIDs:ae,seq:R.get(Pt)??null,testo:bt.get(Pt)??null,testoSeasonal:(P.get(Pt)&&P.get(Pt).get(At.Season))??null}});Y=Y.filter(At=>isFinite(At.density)&&isFinite(At.cort));const z=L.map(At=>({density:At.x,season:At.group,predicted:At.predicted,confLow:At["conf.low"],confHigh:At["conf.high"]})),W={top:120,right:20,bottom:180,left:180},tt=t-W.left-W.right,nt=n-W.top-W.bottom;Y.map(At=>At.density).concat(z.map(At=>At.density));const j=[...Y.map(At=>+At.density).filter(Number.isFinite),...z.map(At=>+At.density).filter(Number.isFinite)],q=j.length?_e(j):0;j.length&&fe(j);const lt=Math.floor(q/100)*100,Ct=550,vt=he().domain([lt,Ct]).range([0,tt]),Zt=An(lt,Ct+1,100),Gt=Y.map(At=>+At.cort).filter(Number.isFinite),Kt=z.length?[...z.map(At=>+At.confLow).filter(Number.isFinite),...z.map(At=>+At.confHigh).filter(Number.isFinite)]:[],Yt=[...Gt,...Kt];Yt.length&&wn(Yt);const Et=Math.min(_e(Y,At=>At.cort),_e(z,At=>At.confLow)),Mt=Math.max(fe(Y,At=>At.cort),fe(z,At=>At.confHigh)),Ot=125,Dt=180,ie=Ot-Et,xe=Mt-Dt,ue=nt,ge=ue*(ie/(ie+xe)),ut=ue*(xe/(ie+xe)),rt=he().domain([Et,Ot,Dt,Mt]).range([nt,nt-ge,nt-ge,nt-ge-ut]),ct=[...An(Math.ceil(Et/20)*20,Ot,20),...An(Dt,Math.floor(Mt/20)*20+1,20)],pt=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);gt.attr("width",t).attr("height",n);const G=gt.append("g").attr("class","root").attr("transform",`translate(${W.left},${W.top})`);gt.append("text").attr("x",10).attr("y",W.top/2).attr("text-anchor","middle").style("font-family",O).style("font-size",C).attr("text-anchor","start").text("B"),G.append("g").attr("transform",`translate(0,${nt})`).call(Ie(vt).tickValues(Zt).tickFormat(Me("d")).tickPadding(10)).selectAll("text").style("font-family",O).style("font-size",V).style("font-weight",k),G.append("g").call(Se(rt).tickValues(ct).tickFormat(Me("d")).tickPadding(10)).selectAll("text").style("font-family",O).style("font-size",V).style("font-weight",k),G.selectAll(".domain, .tick line").attr("stroke","black"),G.append("g").attr("class","grid").call(Se(rt).tickSizeInner(-tt).tickSizeOuter(0).tickFormat("")).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),G.append("text").attr("x",tt/2).attr("y",nt+100).attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Density").append("tspan").attr("x",tt/2).attr("y",nt+145).style("font-size",B).text("(No. of adults)"),G.append("text").attr("transform","rotate(-90)").attr("x",-nt/2).attr("y",-135).attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Corticosterone").append("tspan").attr("x",-nt/2).attr("dy","1.2em").style("font-size",B).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(At=>{const Pt=z.filter(Tt=>Tt.season===At);G.append("path").datum(Pt).attr("class",`ribbon season-${At}`).attr("fill",pt(At)).attr("fill-opacity",.3).attr("d",_n().x(Tt=>vt(Tt.density)).y0(Tt=>rt(Tt.confLow)).y1(Tt=>rt(Tt.confHigh)).curve(ke)),G.append("path").datum(Pt).attr("class",`line season-${At}`).attr("fill","none").attr("stroke",pt(At)).attr("stroke-width",2).attr("d",gn().x(Tt=>vt(Tt.density)).y(Tt=>rt(Tt.predicted)).curve(ke))});const St=100;function xt(At){const Pt=At.currentTarget,Tt=parseFloat(Pt.getAttribute("r"))||8,ae=+Pt.getAttribute("cx"),pe=+Pt.getAttribute("cy"),be=h.current,Ee=be.getBoundingClientRect(),Le=Ee.width,Ue=Ee.height,$e=W.left+ae,pn=W.top+pe,$n=t-($e+St+Tt+Le);let qe=$e-(St+Tt+Le)>=$n||$e>W.left+tt/2?$e-(Le+St+Tt):$e+(St+Tt),pr=pn-Ue-8;pr<0&&(pr=pn+8),qe=Math.max(0,Math.min(qe,t-Le)),pr=Math.max(0,Math.min(pr,n-Ue)),Ft(be).style("left",`${qe}px`).style("top",`${pr}px`)}const mt=h.current,{offsetWidth:yt,offsetHeight:Ut}=mt,te=Number.isFinite(Ct-lt)?(Ct-lt)*.05:0,Bt=G.append("g").attr("class","dots").selectAll("circle").data(Y,At=>At.seq??At.focal).join(At=>At.append("circle").attr("class","dot").attr("r",8).attr("cx",Pt=>vt(Pt.density)+(Math.random()-.5)*te).attr("cy",Pt=>rt(Pt.cort)).attr("fill",Pt=>pt(Pt.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",Pt=>Pt.seq??"").style("cursor","pointer").on("click",(Pt,Tt)=>{if(Pt.currentTarget,!c)return;const ae=m.current===Tt.seq;c(ae?null:Tt.seq),d?.(ae?[]:Tt.hairIDs||[]),Pt.stopPropagation()}));if(r==="hover"&&Bt.style("cursor","pointer").on("mouseover",(At,Pt)=>{N.html(`Testosterone: <strong>${T(Pt.testoSeasonal!=null?Pt.testoSeasonal.toFixed(2):"")}</strong><br/>Corticosterone: <strong>${T(Pt.cort?.toFixed(2))}</strong><br/>Density: <strong>${T(Pt.density.toFixed(0))}</strong><br/>Season: <strong>${T(Pt.season)}</strong><br/>Offspring: <strong>${T(Pt.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${T(String(Pt.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse: <strong>${T(Pt.hairIDs.length)}</strong><br/>Hair id: <strong>${Pt.hairIDs.length?Pt.hairIDs.join(", "):""}</strong>`),xt(At),N.transition().duration(100).style("opacity",.9)}).on("mousemove",xt).on("mouseout",()=>{N.transition().duration(100).style("opacity",0)}),r==="brush"){const At=Fn().extent([[0,0],[tt,nt]]).on("end",({selection:Pt})=>{if(!Pt)return S([]);const[[Tt,ae],[pe,be]]=Pt;S(Y.filter(Ee=>{const Le=vt(Ee.density),Ue=rt(Ee.cort);return Tt<=Le&&Le<=pe&&ae<=Ue&&Ue<=be}))});G.append("g").call(At).lower()}}),Ft(p.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{children:_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:p}),_.jsx("div",{ref:h})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&w.length>0&&_.jsxs("div",{className:"ml-0 max-h-[600px] overflow-y-auto",children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:A,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","Testosterone (pg/mg hair)","Mouse ID","Sample Date","Life Reproduction Success","Recruitment","No. of Hair Samples","Hair Samples"].map(N=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:N},N))})}),_.jsx("tbody",{children:w.map((N,D)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.density.toFixed(0)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.cort}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.Testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.Date_Sampled,{date:!0})}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.Life_Repro_Success)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(F(N.Recruitment))}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.hairIDs.length?N.hairIDs.join(", "):"")})]},D))})]})]})})]})})}function rM({width:t=1100,height:n=900,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c,selectedHairIDs:f=new Set,onSelectHairIDs:d}){const p=Z.useRef(),h=Z.useRef(),m=Z.useRef(l),[y,v]=nn(event,p.current),[w,S]=Z.useState([]);ms("%Y-%m-%d");const b=xs("%d.%m.%Y"),E=()=>{if(!w.length)return;const N=["AGD.tail","Offspring"],D=w.map(K=>[K.x.toFixed(2),K.y]),L=[N.join(","),...D.map(K=>K.join(","))].join(`
`);Cn.saveAs(new Blob([L],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},A=()=>{if(!w.length)return;const N=ve.json_to_sheet(w.map(L=>({"AGD.tail":L.x.toFixed(2),Offspring:L.y}))),D=ve.book_new();ve.book_append_sheet(D,N,"Brushed Data"),Rn(D,"lrs_brushed_data.xlsx")},O="serif",C="50px",U="44px",B="38px",V="36px",k=500,F=N=>N&&typeof N=="string"?N.charAt(0).toUpperCase()+N.slice(1).toLowerCase():N,T=(N,D={})=>D.decimals!=null?N!=null&&!isNaN(N)?N.toFixed(D.decimals):"":D.date&&N?b(N):N!=null&&N!==""?N:"";return Z.useEffect(()=>{m.current=l;const D=Ft(p.current).select("g.root");if(D.empty())return;const L=i??null;D.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const K=Ft(this).datum()?.season;return!L||K===L?.7:.1}),D.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?.3:.05}),D.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?1:.1}).attr("stroke-width",function(){const K=Ft(this).attr("class").split(" ").find(ft=>ft.startsWith("season-"))?.replace("season-","");return!L||K===L?2.5:1})},[i]),Z.useEffect(()=>{m.current=l;const N=Ft(p.current).select("g.root");if(N.empty())return;const D=N.selectAll(".dot"),L=f&&f.size>0,K=ft=>L&&Array.isArray(ft)&&ft.some(dt=>f.has(String(dt)));D.transition().duration(120).attr("r",ft=>{const dt=K(ft.hairIDs),J=l!=null&&ft.seq===l;return dt||J?20:8}).attr("stroke-width",ft=>l!=null&&ft.seq===l?2.5:1),N.selectAll(".dot").filter(ft=>l!=null&&ft.seq===l).raise()},[f,l]),Z.useEffect(()=>{const N=Ft(h.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","24px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone.csv",ne)]).then(([D,L,K,ft,dt,J])=>{const gt=Ft(p.current);gt.selectAll("*").remove();const wt=new Map(K.filter(st=>st.focal_ID!=null).map(st=>[String(st.focal_ID).replace(/^'/,""),st])),bt=new Map(Array.from(Ea(J.filter(st=>st.focal_ID!=null),st=>String(st.focal_ID).replace(/^'/,"")),([st,St])=>[st,Hn(St,xt=>xt["Cort_pg.mg"])])),P=rc(J.filter(st=>st.focal_ID!=null&&st.Season!=null),st=>Hn(st,St=>St["Cort_pg.mg"]),st=>String(st.focal_ID).replace(/^'/,""),st=>st.Season),I=new Map(Array.from(Ea(ft.filter(st=>st.focal_ID!=null),st=>String(st.focal_ID).replace(/^'/,"")),([st,St])=>[st,Array.from(new Set(St.map(xt=>String(xt["External.ID2"])).filter(xt=>xt!=null&&xt!=="")))])),R=new Map(dt.filter(st=>st.focal_ID!=null&&st.Seq!=null).map(st=>[String(st.focal_ID).replace(/^'/,""),+st.Seq]));let Y=D.map(st=>{const St=String(st.focal_ID).replace(/^'/,""),xt=wt.get(St)||{},mt=I.get(St)||[];return{density:st.Density,season:st.Season,testo:st["Testo_pg.mg"],focal:St,Date_Sampled:xt.Date_Sampled,Genetic_Sex:xt.Genetic_Sex,AGD_weight:xt.AGD_weight,AGD_tail:xt.AGD_tail,Testo:xt["Testo_pg.mg_1"],Life_Repro_Success:xt["life.repro.success"],Recruitment:xt["recruitment.y.n"],hairIDs:mt,seq:R.get(St)??null,cort:bt.get(St)??null,cortSeasonal:(P.get(St)&&P.get(St).get(st.Season))??null}});const z=L.map(st=>({density:st.density,season:st.season,predicted:st.predicted,confLow:st["conf.low"],confHigh:st["conf.high"]})),W={top:120,right:20,bottom:180,left:180},tt=t-W.left-W.right,nt=n-W.top-W.bottom;Y.map(st=>st.density).concat(z.map(st=>st.density));let j=_e(z,st=>st.density),q=fe(z,st=>st.density);j=Math.min(j,_e(Y,st=>st.density)),q=Math.max(q,fe(Y,st=>st.density));const lt=Math.floor(j/100)*100,Ct=550,vt=he().domain([lt,Ct]).range([0,tt]),Zt=An(lt,Ct+1,100),Gt=Y.map(st=>st.testo).concat(z.map(st=>st.confLow),z.map(st=>st.confHigh)),Kt=wn(Gt),Yt=Math.floor(Kt[0]),Et=Math.ceil(Kt[1]),Mt=An(Yt,Et+1,1),Ot=he().domain(Kt).range([nt,0]).nice(),Dt=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);gt.attr("width",t).attr("height",n);const ie=gt.append("g").attr("class","root").attr("transform",`translate(${W.left},${W.top})`);gt.append("text").attr("x",10).attr("y",W.top/2).attr("text-anchor","middle").style("font-family",O).style("font-size",C).attr("text-anchor","start").text("A"),ie.append("g").attr("transform",`translate(0,${nt})`).call(Ie(vt).tickValues(Zt).tickFormat(Me("d")).tickPadding(10)).selectAll("text").style("font-family",O).style("font-size",V).style("font-weight",k),ie.append("g").call(Se(Ot).tickValues(Mt).tickFormat(Me("d")).tickPadding(10)).selectAll("text").style("font-family",O).style("font-size",V).style("font-weight",k),ie.selectAll(".domain, .tick line").attr("stroke","black"),ie.append("g").attr("class","grid").call(Se(Ot).tickSizeInner(-tt).tickSizeOuter(0).tickFormat("").tickPadding(10)).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),ie.append("text").attr("x",tt/2).attr("y",nt+100).attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Density").append("tspan").attr("x",tt/2).attr("y",nt+145).style("font-size",B).text("(No. of adults)"),ie.append("text").attr("transform","rotate(-90)").attr("x",-nt/2).attr("y",-135).attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Testosterone").append("tspan").attr("x",-nt/2).attr("dy","1.2em").style("font-size",B).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(st=>{const St=z.filter(xt=>xt.season===st);ie.append("path").datum(St).attr("class",`ribbon season-${st}`).attr("fill",Dt(st)).attr("fill-opacity",.3).attr("d",_n().x(xt=>vt(xt.density)).y0(xt=>Ot(xt.confLow)).y1(xt=>Ot(xt.confHigh)).curve(ke)),ie.append("path").datum(St).attr("class",`line season-${st}`).attr("fill","none").attr("stroke",Dt(st)).attr("stroke-width",2).attr("d",gn().x(xt=>vt(xt.density)).y(xt=>Ot(xt.predicted)).curve(ke))});const ue=100;function ge(st){const St=st.currentTarget,xt=parseFloat(St.getAttribute("r"))||8,mt=+St.getAttribute("cx"),yt=+St.getAttribute("cy"),Ut=h.current,te=Ut.getBoundingClientRect(),Bt=te.width,At=te.height,Pt=W.left+mt,Tt=W.top+yt,ae=t-(Pt+ue+xt+Bt);let Ee=Pt-(ue+xt+Bt)>=ae||Pt>W.left+tt/2?Pt-(Bt+ue+xt):Pt+(ue+xt),Le=Tt-At-8;Le<0&&(Le=Tt+8),Ee=Math.max(0,Math.min(Ee,t-Bt)),Le=Math.max(0,Math.min(Le,n-At)),Ft(Ut).style("left",`${Ee}px`).style("top",`${Le}px`)}const ut=h.current,{offsetWidth:rt,offsetHeight:ct}=ut,pt=(Ct-lt)*.05,G=ie.append("g").attr("class","dots").selectAll("circle").data(Y,st=>`${st.focal}-${st.run}`).join(st=>st.append("circle").attr("class","dot").attr("r",8).attr("cx",St=>vt(St.density)+(Math.random()-.5)*pt).attr("cy",St=>Ot(St.testo)).attr("fill",St=>Dt(St.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",St=>St.seq??"").style("cursor","pointer").on("click",(St,xt)=>{const mt=St.currentTarget;if(console.log("datum:",xt),console.log("dataset:",mt.dataset),!c)return;const yt=m.current===xt.seq;c(yt?null:xt.seq),d?.(yt?[]:xt.hairIDs||[]),St.stopPropagation()}));if(r==="hover"&&G.style("cursor","pointer").on("mouseover",(st,St)=>{N.html(`Testosterone: <strong>${T(St.testo||"-")}</strong><br/>Corticosterone: <strong>${T(St.cortSeasonal!=null?St.cortSeasonal.toFixed(2):"")}</strong><br/>Density: <strong>${T(St.density.toFixed(0))}</strong><br/>Season: <strong>${T(St.season)}</strong><br/>Offspring: <strong>${T(St.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${T(String(St.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse: <strong>${T(St.hairIDs.length)}</strong><br/>Hair id: <strong>${St.hairIDs.length?St.hairIDs.join(", "):""}</strong>`),ge(st),N.transition().duration(100).style("opacity",.9)}).on("mousemove",ge).on("mouseout",()=>{N.transition().duration(100).style("opacity",0)}),r==="brush"){const st=Fn().extent([[0,0],[tt,nt]]).on("end",({selection:St})=>{if(!St)return S([]);const[[xt,mt],[yt,Ut]]=St;S(Y.filter(te=>{const Bt=vt(te.density),At=Ot(te.testo);return xt<=Bt&&Bt<=yt&&mt<=At&&At<=Ut}))});ie.append("g").call(st).lower()}}),Ft(p.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{children:_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:p}),_.jsx("div",{ref:h})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&w.length>0&&_.jsxs("div",{className:"ml-0 max-h-[600px] overflow-y-auto",children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:A,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","Testosterone (pg/mg hair)","Mouse ID","Sample Date","Life Reproduction Success","Recruitment","No. of Hair Samples","Hair Samples"].map(N=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:N},N))})}),_.jsx("tbody",{children:w.map((N,D)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.density.toFixed(0)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.cort}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.Testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.Date_Sampled,{date:!0})}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.Life_Repro_Success)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(F(N.Recruitment))}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:N.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T(N.hairIDs.length?N.hairIDs.join(", "):"")})]},D))})]})]})})]})})}function aM({width:t=2225,height:n=900,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c,selectedHairIDs:f=new Set,onSelectHairIDs:d}){const p=Z.useRef(),h=Z.useRef(),m=Z.useRef(l),[y,v]=nn(event,p.current),[w,S]=Z.useState([]),[b,E]=Z.useState("tail"),A=(D,L={})=>L.decimals!=null?D!=null&&!isNaN(D)?D.toFixed(L.decimals):"":L.date&&D?formatDate(D):D!=null&&D!==""?D:"",O=()=>{if(!w.length)return;const D=["AGD.tail","Offspring"],L=w.map(ft=>[ft.x.toFixed(2),ft.y]),K=[D.join(","),...L.map(ft=>ft.join(","))].join(`
`);Cn.saveAs(new Blob([K],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},C=()=>{if(!w.length)return;const D=ve.json_to_sheet(w.map(K=>({"AGD.tail":K.x.toFixed(2),Offspring:K.y}))),L=ve.book_new();ve.book_append_sheet(L,D,"Brushed Data"),Rn(L,"lrs_brushed_data.xlsx")},U="serif",B="50px",V="24px",k="44px",F="38px",T="36px",N=500;return Z.useEffect(()=>{m.current=l;const L=Ft(p.current).select("g.root");if(L.empty())return;const K=i?String(i).trim().toLowerCase():null;L.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const ft=Ft(this).datum()?.season;return!K||ft===K?.7:.1}),L.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const ft=Ft(this).attr("class").split(" ").find(dt=>dt.startsWith("season-"))?.replace("season-","");return!K||ft===K?.3:.05}),L.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const ft=Ft(this).attr("class").split(" ").find(dt=>dt.startsWith("season-"))?.replace("season-","");return!K||ft===K?1:.1}).attr("stroke-width",function(){const ft=Ft(this).attr("class").split(" ").find(dt=>dt.startsWith("season-"))?.replace("season-","");return!K||ft===K?2.5:1}),K&&L.selectAll(".dot").filter(ft=>ft.season===K).raise()},[i]),Z.useEffect(()=>{m.current=l;const D=Ft(p.current).select("g.root");if(D.empty())return;const L=D.selectAll(".dot"),K=f&&f.size>0,ft=J=>K&&Array.isArray(J)&&J.some(gt=>f.has(String(gt))),dt=J=>l!=null&&J.seq===l||ft(J.hairIDs);L.interrupt(),L.filter(dt).transition().duration(140).attr("r",J=>l!=null&&J.seq===l?20:8).attr("stroke-width",J=>l!=null&&J.seq===l?2.5:1),L.filter(J=>!dt(J)).attr("r",8).attr("stroke-width",1),L.filter(J=>l!=null&&J.seq===l).raise()},[f,l]),Z.useEffect(()=>{const D=Ft(p.current).attr("width",t).attr("height",n).style("background","white").style("font-family",U),L=Ft(h.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size",V).style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("z-index","9999").style("text-align","left"),K=`/fetal-programming-for-female-masculinization/data/observed_agd_${b}.csv`,ft=`/fetal-programming-for-female-masculinization/data/predicted_agd_${b}.csv`;Promise.all([Jt(K,ne),Jt(ft,ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",dt=>(dt.External_ID2=dt["External.ID2"],delete dt["External.ID2"],ne(dt))),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([dt,J,gt,wt,bt])=>{D.selectAll(".chart-title").remove(),D.selectAll("g.root").remove(),D.selectAll("foreignObject#metric-fo").remove();const P=new Map(bt.filter(Tt=>Tt.focal_ID!=null).map(Tt=>[String(Tt.focal_ID).replace(/^'/,""),Tt])),I=new Map;wt.forEach(Tt=>{if(!Tt.focal_ID||Tt.External_ID2==null)return;const ae=String(Tt.focal_ID).replace(/^'/,"");I.has(ae)||I.set(ae,new Set),I.get(ae).add(String(Tt.External_ID2))});const R=new Map(Array.from(I.entries()).map(([Tt,ae])=>[Tt,Array.from(ae)])),Y=new Map;wt.forEach(Tt=>{Tt.External_ID2!=null&&Tt.Age!=null&&!Number.isNaN(Tt.Age)&&Y.set(String(Tt.External_ID2),+Tt.Age)});const z=new Map(Array.from(R.entries()).map(([Tt,ae])=>[Tt,ae.map(pe=>Y.get(String(pe))).filter(pe=>pe!=null&&!Number.isNaN(pe))])),W=new Map(gt.filter(Tt=>Tt.focal_ID!=null&&Tt.Seq!=null).map(Tt=>[String(Tt.focal_ID).replace(/^'/,""),+Tt.Seq]));let tt=dt.filter(Tt=>Tt["Season.DOB"]!=null&&Tt[`AGD.${b}`]!=null).map(Tt=>{const ae=String(Tt.focal_ID).replace(/^'/,"");P.get(ae),I.get(ae);const pe=z.get(ae)||[];return{season:Tt["Season.DOB"].trim().toLowerCase(),density:Tt["Density.DOB"],agd:Tt[`AGD.${b}`],focal:ae,hair:Tt["External.ID2"],hairAges:pe,hairIDs:R.get(ae)||[],seq:W.get(ae)??null}});const nt=J.filter(Tt=>(b==="tail"?Tt.group!=null:Tt.season!=null)&&Tt.predicted!=null).map(Tt=>({season:(b==="tail"?Tt.group:Tt.season).trim().toLowerCase(),density:b==="tail"?Tt.x:Tt.density,predicted:Tt.predicted,confLow:Tt["conf.low"],confHigh:Tt["conf.high"]})),j={top:120,right:20,bottom:180,left:180},q=t-j.left-j.right,lt=n-j.top-j.bottom,Ct=["spring","summer","autumn","winter"],vt=wn(tt,Tt=>Tt.density),Zt=_e([_e(tt,Tt=>Tt.agd),_e(nt,Tt=>Tt.confLow)]),Gt=fe([fe(tt,Tt=>Tt.agd),fe(nt,Tt=>Tt.confHigh)]),Kt=he().domain([0,550]).range([0,q]),Yt=he().domain([Zt,Gt]).nice().range([lt,0]),Et=pa().domain(Ct).range(["#009E73","#F0E442","#D55E00","#0072B2"]);D.append("text").attr("x",20).attr("y",j.top/2).attr("text-anchor","middle").style("font-family",U).style("font-size",B).attr("text-anchor","start").text("C");const Mt=D.append("g").attr("transform",`translate(${j.left-180}, ${j.top+lt/2+150}) rotate(-90)`),Ot=400,Dt=260,ie=50;Mt.append("foreignObject").attr("id","metric-fo").attr("width",Ot).attr("height",parseInt(k)+ie).attr("x",0).attr("y",0).attr("overflow","visible").style("overflow","visible").append("xhtml:div").attr("xmlns","http://www.w3.org/1999/xhtml").style("display","flex").style("flex-direction","column").style("justify-content","center").style("align-items","flex-start").html(`
          <span style="
            font-family: ${U};
            font-size: ${k};
          ">
            Masculinization index
          </span>
          <select id="metric-select" style="
            width: ${Dt}px;
            height: ${ie}px;         
            line-height: ${ie}px;    
            padding: 0;                          
            box-sizing: border-box;          
            font-family: ${U};
            font-size: ${F};
            margin-left: 80px;
                    margin-top: -10px;
            vertical-align: middle;
            font-size:36px;
          ">
            <option value="tail"   ${b==="tail"?"selected":""}>(AGD.tail)</option>
            <option value="weight" ${b==="weight"?"selected":""}>(AGD.weight)</option>
          </select>
        `),Ft(p.current).select("#metric-select").on("change",Tt=>E(Tt.target.value));const xe=D.append("g").attr("class","root").attr("transform",`translate(${j.left},${j.top})`),ue=Yt.ticks();fe(ue);const ge=xe.append("g").attr("class","y-grid").call(Se(Yt).tickSize(-q).tickFormat(""));ge.select(".domain").remove(),ge.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3);const ut=Yt.domain()[1];ge.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),ge.selectAll("g.tick").filter(Tt=>Tt===ut).select("line").attr("stroke","#ccc").attr("stroke-opacity",.3);const rt=1e-6,ct=(Tt,ae)=>Math.abs(Tt-ae)<rt,pt=Kt.domain()[1],G=Kt.ticks();G.some(Tt=>ct(Tt,pt))||G.push(pt);const st=Ie(Kt).tickValues(G).tickFormat(Tt=>ct(Tt,pt)?"":Me("~g")(Tt)).tickPadding(10);xe.append("g").attr("transform",`translate(0,${lt})`).call(st).selectAll("text").style("font-family",U).style("font-size",T).style("font-weight",N),xe.append("g").call(Se(Yt).tickPadding(10)).selectAll("text").style("font-family",U).style("font-size",T).style("font-weight",N),xe.append("text").attr("class","x-axis-title").attr("x",q/2).attr("y",lt+100).attr("text-anchor","middle").style("font-family",U).append("tspan").style("font-size",k).text("Density").append("tspan").attr("x",q/2).attr("y",lt+145).style("font-size",F).text("(No. of adults)"),Ct.forEach(Tt=>{const ae=nt.filter(pe=>pe.season===Tt);xe.append("path").datum(ae).attr("data-season",Tt).attr("class",`ribbon season-${Tt}`).attr("d",_n().x(pe=>Kt(pe.density)).y0(pe=>Yt(pe.confLow)).y1(pe=>Yt(pe.confHigh)).curve(ke)).attr("fill",Et(Tt)).attr("fill-opacity",.3),xe.append("path").datum(ae).attr("data-season",Tt).attr("class",`line season-${Tt}`).attr("fill","none").attr("stroke",Et(Tt)).attr("stroke-width",2).attr("d",gn().x(pe=>Kt(pe.density)).y(pe=>Yt(pe.predicted)).curve(ke))});const xt=100;function mt(Tt){const ae=Tt.currentTarget,pe=parseFloat(ae.getAttribute("r"))||8,be=+ae.getAttribute("cx"),Ee=+ae.getAttribute("cy"),Le=h.current,Ue=Le.getBoundingClientRect(),$e=Ue.width,pn=Ue.height,$n=j.left+be,dr=j.top+Ee,xn=t-($n+xt+pe+$e);let ka=$n-(xt+pe+$e)>=xn||$n>j.left+innerWidth/2?$n-($e+xt+pe):$n+(xt+pe),Fa=dr-pn-8;Fa<0&&(Fa=dr+8),ka=Math.max(0,Math.min(ka,t-$e)),Fa=Math.max(0,Math.min(Fa,n-pn)),Ft(Le).style("left",`${ka}px`).style("top",`${Fa}px`)}const yt=h.current,{offsetWidth:Ut,offsetHeight:te}=yt,Bt=xe.append("g").attr("class","dots"),At=(vt[1]-vt[0])*.05;Bt.selectAll("circle").data(tt,Tt=>Tt.seq??Tt.focal).enter().append("circle").attr("class","dot").attr("cx",Tt=>Kt(Tt.density)+(Math.random()-.5)*At).attr("cy",Tt=>Yt(Tt.agd)).attr("r",8).attr("stroke","white").attr("stroke-width",1).style("cursor","pointer").attr("fill",Tt=>Et(Tt.season)).attr("fill-opacity",.6).style("cursor","pointer").on("click",(Tt,ae)=>{if(!c)return;const pe=m.current===ae.seq;c(pe?null:ae.seq),d?.(pe?[]:ae.hairIDs||[]),Tt.stopPropagation()});const Pt=Bt.selectAll("circle");Pt.on("mouseover",null).on("mouseout",null),xe.selectAll(".brush").remove(),S([]),r==="hover"?Pt.on("mouseover",(Tt,ae)=>{const pe=ae.season.charAt(0).toUpperCase()+ae.season.slice(1),be=ae.hairAges||[],Ee=be.length?be.map(Ue=>Number.isFinite(Ue)?Ue:null).filter(Ue=>Ue!=null).join(", "):"",Le=[ae.hairIDs?.length?`Hair samples / mouse: <strong>${ae.hairIDs.length}</strong>`:"",ae.hairIDs?.length?`Hair id: <strong>${ae.hairIDs.join(", ")}</strong>`:"",Ee?`Age (days): <strong>${Ee}</strong>`:""].filter(Boolean).join("<br/>");L.html(`Season: <strong>${pe}</strong><br/>Density: <strong>${ae.density}</strong><br/>${b==="tail"?"AGD.tail":"AGD.weight"}: <strong>${ae.agd.toFixed(2)}</strong><br/>`+(Le?`Mouse id: <strong>${A(String(ae.seq).replace(/^'/,""))}</strong><br/>`:`Mouse id: <strong>${A(String(ae.seq).replace(/^'/,""))}</strong>`)+(Le?`${Le}`:"")),mt(Tt),L.transition().duration(100).style("opacity",.9)}).on("mousemove",mt).on("mouseout",()=>{L.transition().duration(100).style("opacity",0)}):xe.append("g").attr("class","brush").call(Fn().extent([[0,0],[q,lt]]).on("end",({selection:Tt})=>{if(!Tt)return S([]);const[[ae,pe],[be,Ee]]=Tt,Le=tt.filter(Ue=>{const $e=Kt(Ue.density),pn=Yt(Ue.agd);return ae<=$e&&$e<=be&&pe<=pn&&pn<=Ee});S(Le)}))})},[t,n,r,b]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:p}),_.jsx("div",{ref:h})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&w.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:O,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:C,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)",`AGD ${b}`].map(D=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:D},D))})}),_.jsx("tbody",{children:w.map((D,L)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.agd.toFixed(2)})]},L))})]})]})})]})}function iM({width:t=1100,height:n=900,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),d=Z.useRef(i),[p,h]=nn(event,c.current),m="motherCort",[y,v]=Z.useState([]),w=L=>String(L??"").trim().replace(/^'+/,""),S=()=>{if(!y.length)return;const L=["AGD.tail","Offspring"],K=y.map(dt=>[dt.x.toFixed(2),dt.y]),ft=[L.join(","),...K.map(dt=>dt.join(","))].join(`
`);Cn.saveAs(new Blob([ft],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},b=()=>{if(!y.length)return;const L=ve.json_to_sheet(y.map(ft=>({"AGD.tail":ft.x.toFixed(2),Offspring:ft.y}))),K=ve.book_new();ve.book_append_sheet(K,L,"Brushed Data"),Rn(K,"lrs_brushed_data.xlsx")},E="lightgray",A="gray",O="gray",C="serif",U="50px",B="44px",V="38px",k="36px",F=500,T={top:120,right:40,bottom:180,left:180},N=t-T.left-T.right,D=n-T.top-T.bottom;return Z.useEffect(()=>{d.current=i;const L=K=>K?.seq??K?.mouseID??K?.focal??K?.id;Ft(c.current).selectAll("circle").transition().duration(100).attr("r",K=>L(K)===i?20:8).attr("stroke",K=>L(K)===i?"black":"gray")},[i]),Z.useEffect(()=>{const L=Ft(c.current).attr("width",t).attr("height",n).style("background","white").style("font-family",C);L.selectAll("*").remove();const K=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","24px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999").style("text-align","left");L.append("text").attr("x",20).attr("y",T.top/2-20).attr("text-anchor","middle").style("font-family",C).style("font-size",U).attr("text-anchor","start").text("E"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",J=>{const gt=J["External.ID2"]??J.External_ID2??J["LC.MS.run"];return J.External_ID2=gt==null?null:String(gt).trim(),J.focal_ID=w(J.focal_ID),ne(J)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([J,gt,wt,bt,P,I])=>{new Map(I.filter(mt=>mt.focal_ID!=null).map(mt=>[String(mt.focal_ID).replace(/^'/,""),mt]));const R=new Map;bt.forEach(mt=>{const yt=w(mt.focal_ID),Ut=mt.External_ID2==null?null:String(mt.External_ID2).trim();!yt||!Ut||(R.has(yt)||R.set(yt,new Set),R.get(yt).add(Ut))});const Y=new Map(Array.from(R.entries()).map(([mt,yt])=>[mt,Array.from(yt)])),z=new Map(P.filter(mt=>mt.focal_ID!=null&&mt.Seq!=null).map(mt=>[w(mt.focal_ID),+mt.Seq])),W=mt=>{const yt=+mt;return Number.isFinite(yt)?yt:NaN},tt=new Map(wt.map(mt=>{const yt=w(mt.focal_ID??mt.focal??mt.id),Ut=mt.motherTesto??mt.maternalTesto??mt.mother_testo??mt.maternal_testosterone,te=W(Ut);return[yt,te]}));let nt=J.map((mt,yt)=>{const Ut=w(mt.focal_ID??mt.focal??mt.mouseID??mt.id),te=Y.get(Ut)??[],Bt=Ut,At=tt.get(Ut)??null;return{id:yt,x:Number.isFinite(+mt.motherCort)?+mt.motherCort:null,y:Number.isFinite(+mt["AGD.tail"])?+mt["AGD.tail"]:null,testo:At,focal:Ut,mouseID:Bt,hair:mt["External.ID2"],hairIDs:te,seq:z.get(Ut)??null}}).filter(mt=>Number.isFinite(mt.x)&&Number.isFinite(mt.y));const j=gt.map(mt=>({x:+mt[m],predicted:+mt.predicted,confLow:+mt["conf.low"],confHigh:+mt["conf.high"]})).filter(mt=>!isNaN(mt.x)&&!isNaN(mt.predicted)),q=nt.map(mt=>mt.x).concat(j.map(mt=>mt.x)),lt=nt.map(mt=>mt.y).concat(j.map(mt=>mt.confLow)).concat(j.map(mt=>mt.confHigh)),Ct=_e(q),vt=fe(q),Zt=_e(lt),Gt=fe(lt),Kt=he().domain([Ct,vt]).nice().range([0,N]),Yt=he().domain([Zt,Gt]).nice().range([D,0]),Et=L.append("g").attr("transform",`translate(${T.left},${T.top-10})`),Mt=Yt.ticks();fe(Mt);const Ot=Et.append("g").attr("class","y-grid").call(Se(Yt).tickSize(-N).tickFormat(""));Ot.select(".domain").remove(),Ot.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Dt=Yt.domain()[1];Ot.selectAll("g.tick").filter(mt=>mt===Dt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),Et.append("g").attr("transform",`translate(0,${D})`).call(Ie(Kt).tickPadding(10)).style("font-family",C).style("font-size",k).style("font-weight",F).append("text").attr("fill","black").attr("class","axis-label").attr("x",N/2).attr("y",T.bottom-70).attr("fill","black").attr("text-anchor","middle").style("font-family",C).append("tspan").style("font-size",B).text("Maternal corticosterone").append("tspan").attr("x",N/2).attr("y",T.bottom-30).style("font-size",V).text("(pg/mg hair)"),Et.append("g").call(Se(Yt).tickPadding(10)).style("font-family",C).style("font-size",k).style("font-weight",F).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-D/2).attr("y",-130).attr("fill","black").style("font-family",C).style("font-size",B).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-D/2).attr("dy","1.2em").style("font-size",V).text("(AGD.tail)"),Et.append("path").datum(j.sort((mt,yt)=>mt.x-yt.x)).attr("d",_n().x(mt=>Kt(mt.x)).y0(mt=>Yt(mt.confLow)).y1(mt=>Yt(mt.confHigh)).curve(ke)).attr("fill",E).attr("fill-opacity",.3),Et.append("path").datum(j.sort((mt,yt)=>mt.x-yt.x)).attr("d",gn().x(mt=>Kt(mt.x)).y(mt=>Yt(mt.predicted)).curve(ke)).attr("fill","none").attr("stroke",O).attr("stroke-width",2);const xe=100;function ue(mt){const yt=mt.currentTarget,Ut=parseFloat(yt.getAttribute("r"))||8,te=+yt.getAttribute("cx"),Bt=+yt.getAttribute("cy"),At=f.current,Pt=At.getBoundingClientRect(),Tt=Pt.width,ae=Pt.height,pe=T.left+te,be=T.top+Bt,Ee=t-(pe+xe+Ut+Tt);let $e=pe-(xe+Ut+Tt)>=Ee||pe>T.left+innerWidth/2?pe-(Tt+xe+Ut):pe+(xe+Ut),pn=be-ae-8;pn<0&&(pn=be+8),$e=Math.max(0,Math.min($e,t-Tt)),pn=Math.max(0,Math.min(pn,n-ae)),Ft(At).style("left",`${$e}px`).style("top",`${pn}px`)}const ge=f.current,{offsetWidth:ut,offsetHeight:rt}=ge,ct=-.025,pt=-.025,G=We(2025);un.source(G)(-ct,ct),un.source(G)(-pt,pt);function st(mt,yt,Ut){return(We(mt*1000003+Ut)()*2-1)*yt}const St=mt=>mt?.seq??mt?.mouseID??mt?.focal??mt?.id,xt=Et.append("g").selectAll("circle.point").data(nt,mt=>St(mt)).join("circle").attr("class","point").attr("cx",mt=>Kt(mt.x+st(St(mt),ct,11))).attr("cy",mt=>Yt(mt.y+st(St(mt),pt,17))).attr("r",mt=>St(mt)===i?20:8).attr("fill",A).attr("opacity",.8).style("cursor","pointer").on("click",(mt,yt)=>{const Ut=St(yt),te=d.current===Ut;l(te?null:Ut),mt.stopPropagation()});r==="hover"&&xt.on("mouseover",(mt,yt)=>{const[Ut,te]=nn(mt,L.node());Array.isArray(yt.hairIDs)&&yt.hairIDs,K.html(`Mat.testosterone: <strong>${yt.testo.toFixed(2)}</strong><br/>Mat.corticosterone: <strong> ${yt.x.toFixed(2)}
                  </strong><br/>AGD.tail: <strong>${yt.y.toFixed(2)}</strong><br/>`),ue(mt),K.transition().duration(100).style("opacity",.9)}).on("mousemove",ue(e)).on("mouseout",()=>{K.transition().duration(100).style("opacity",0)}),r==="brush"?Et.append("g").attr("class","brush").call(Fn().extent([[0,0],[N,D]]).on("end",({selection:mt})=>{if(!mt)return v([]);const[[yt,Ut],[te,Bt]]=mt,At=nt.filter(Pt=>{const Tt=Kt(Pt.x),ae=Yt(Pt.y);return Tt>=yt&&Tt<=te&&ae>=Ut&&ae<=Bt});v(At)})):(Et.selectAll(".brush").remove(),v([]))}).catch(J=>console.error("Error loading data:",J))},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f,style:{position:"absolute",pointerEvents:"none",opacity:0,background:"white",padding:"6px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"12px",boxShadow:"0 1px 4px rgba(0,0,0,0.2)"}})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&y.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:S,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:b,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal corticosterone (pg/mg hair)","Masculinization index (AGD corrected for tail)"].map(L=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:L},L))})}),_.jsx("tbody",{children:y.map((L,K)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.y.toFixed(2)})]},K))})]})]})})]})}function sM({width:t=1100,height:n=900,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),d=Z.useRef(i),[p,h]=nn(event,c.current),[m,y]=Z.useState([]),v=T=>String(T??"").trim().replace(/^'+/,""),w=()=>{if(!m.length)return;const T=["Maternal Testo","AGD.tail","Maternal Cort"],N=m.map(L=>[L.x.toFixed(2),L.y.toFixed(2),L.cort.toFixed(2)]),D=[T.join(","),...N.map(L=>L.join(","))].join(`
`);Cn.saveAs(new Blob([D],{type:"text/csv"}),"F_brushed.csv")},S=()=>{if(!m.length)return;const T=ve.json_to_sheet(m.map(D=>({"Maternal Testo":D.x.toFixed(2),"AGD.tail":D.y.toFixed(2),"Maternal Cort":D.cort.toFixed(2)}))),N=ve.book_new();ve.book_append_sheet(N,T,"Brushed"),Rn(N,"F_brushed.xlsx")},b="gray",E="serif",A="50px",O="44px",C="38px",U="36px",B=500,V={top:120,right:40,bottom:180,left:180},k=t-V.left-V.right,F=n-V.top-V.bottom;return Z.useEffect(()=>{d.current=i;const T=N=>N?.seq??N?.mouseID??N?.focal??N?.id;Ft(c.current).selectAll("circle.point").transition().duration(100).attr("r",N=>T(N)===i?20:8).attr("stroke",N=>T(N)===i?"black":"gray")},[i]),Z.useEffect(()=>{const T=Ft(c.current).attr("width",t).attr("height",n).style("background","white");T.selectAll("*").remove();const N=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","24px").style("z-index","9999").style("text-align","left");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",D=>{const L=D["External.ID2"]??D.External_ID2??D["LC.MS.run"];return D.External_ID2=L==null?null:String(L).trim(),D.focal_ID=v(D.focal_ID),ne(D)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([D,L,K,ft,dt,J])=>{const gt=new Map(J.filter(rt=>rt.focal_ID!=null).map(rt=>[String(rt.focal_ID).replace(/^'/,""),rt])),wt=new Map;ft.forEach(rt=>{const ct=v(rt.focal_ID),pt=rt.External_ID2==null?null:String(rt.External_ID2).trim();!ct||!pt||(wt.has(ct)||wt.set(ct,new Set),wt.get(ct).add(pt))});const bt=new Map(Array.from(wt.entries()).map(([rt,ct])=>[rt,Array.from(ct)])),P=new Map(dt.filter(rt=>rt.focal_ID!=null&&rt.Seq!=null).map(rt=>[v(rt.focal_ID),+rt.Seq]));let I=D.map((rt,ct)=>{const pt=v(rt.focal_ID);gt.get(pt);const G=bt.get(pt)??[],st=v(rt.focal_ID),St=+rt.motherTesto,xt=+L[ct].motherCort;return{id:ct,x:St,y:+rt["AGD.tail"],cort:xt,focal:pt,mouseID:st,hair:rt["External.ID2"],hairIDs:G,seq:P.get(pt)??null}}).filter(rt=>isFinite(rt.x)&&!isNaN(rt.y)&&!isNaN(rt.cort));const R=K.map(rt=>({x:+rt.motherTesto,predicted:+rt.predicted,confLow:+rt["conf.low"],confHigh:+rt["conf.high"]})).filter(rt=>!isNaN(rt.x)),Y=I.map(rt=>rt.x).concat(R.map(rt=>rt.x)),z=I.map(rt=>rt.y).concat(R.map(rt=>rt.confLow)).concat(R.map(rt=>rt.confHigh)),W=I.map(rt=>rt.cort),tt=he().domain(wn(Y)).nice().range([0,k]),nt=he().domain(wn(z)).nice().range([F,0]);N0(xp).domain(wn(W));const j=T.append("g").attr("transform",`translate(${V.left},${V.top-10})`);T.append("text").attr("x",20).attr("y",V.top/2-20).attr("text-anchor","middle").style("font-family",E).style("font-size",A).attr("text-anchor","start").text("D");const q=nt.ticks();fe(q);const lt=j.append("g").attr("class","y-grid").call(Se(nt).tickSize(-k).tickFormat(""));lt.select(".domain").remove(),lt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Ct=nt.domain()[1];lt.selectAll("g.tick").filter(rt=>rt===Ct).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),j.append("g").attr("transform",`translate(0,${F})`).call(Ie(tt).tickPadding(10)).style("font-family",E).style("font-size",U).style("font-weight",B).append("text").attr("class","axis-label").attr("x",k/2).attr("y",V.bottom-70).attr("fill","black").attr("text-anchor","middle").style("font-family",E).append("tspan").style("font-size",O).text("Maternal testosterone").append("tspan").attr("x",k/2).attr("y",V.bottom-30).style("font-size",C).text("(pg/mg hair)"),j.append("g").call(Se(nt).tickPadding(10)).style("font-family",E).style("font-size",U).style("font-weight",B).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-F/2).attr("y",-130).attr("fill","black").style("font-family",E).style("font-size",O).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-F/2).attr("dy","1.2em").style("font-size",C).text("(AGD.tail)"),j.append("path").datum(R.sort((rt,ct)=>rt.x-ct.x)).attr("d",_n().x(rt=>tt(rt.x)).y0(rt=>nt(rt.confLow)).y1(rt=>nt(rt.confHigh)).curve(ke)).attr("fill","#ddd").attr("opacity",.4),j.append("path").datum(R.sort((rt,ct)=>rt.x-ct.x)).attr("d",gn().x(rt=>tt(rt.x)).y(rt=>nt(rt.predicted)).curve(ke)).attr("stroke","#888").attr("fill","none").attr("stroke-width",2);const Gt=100;function Kt(rt){const ct=rt.currentTarget,pt=parseFloat(ct.getAttribute("r"))||8,G=+ct.getAttribute("cx"),st=+ct.getAttribute("cy"),St=f.current,xt=St.getBoundingClientRect(),mt=xt.width,yt=xt.height,Ut=V.left+G,te=V.top+st,Bt=t-(Ut+Gt+pt+mt);let Tt=Ut-(Gt+pt+mt)>=Bt||Ut>V.left+k/2?Ut-(mt+Gt+pt):Ut+(Gt+pt),ae=te-yt-8;ae<0&&(ae=te+8),Tt=Math.max(0,Math.min(Tt,t-mt)),ae=Math.max(0,Math.min(ae,n-yt)),Ft(St).style("left",`${Tt}px`).style("top",`${ae}px`)}function Yt(){l(null),N.transition().duration(100).style("opacity",0)}const Et=f.current,{offsetWidth:Mt,offsetHeight:Ot}=Et,Dt=-.025,ie=-.025,xe=We(2025);un.source(xe)(-Dt,Dt),un.source(xe)(-ie,ie);function ue(rt,ct,pt){return(We(rt*1000003+pt)()*2-1)*ct}j.on("dblclick",()=>Yt());const ge=rt=>rt?.seq??rt?.mouseID??rt?.focal??rt?.id,ut=j.append("g").selectAll("circle.point").data(I,rt=>ge(rt)).join("circle").attr("class","point").attr("cx",rt=>tt(rt.x+ue(ge(rt),Dt,11))).attr("cy",rt=>nt(rt.y+ue(ge(rt),ie,17))).attr("r",rt=>ge(rt)===i?20:8).attr("stroke",rt=>ge(rt)===i?"black":"gray").attr("fill",b).attr("opacity",.8).style("cursor","pointer").on("click",(rt,ct)=>{const pt=ge(ct),G=d.current===pt;l(G?null:pt),rt.stopPropagation()});r==="hover"&&ut.on("mouseover",(rt,ct)=>{Array.isArray(ct.hairIDs)&&ct.hairIDs,N.html(`Mat.testosterone: <strong>${ct.x.toFixed(2)}</strong><br/>Mat.corticosterone: <strong>${ct.cort.toFixed(2)}</strong><br/>AGD.tail: <strong>${ct.y.toFixed(2)}</strong><br/>`),Kt(event),N.transition().duration(100).style("opacity",.9)}).on("mousemove",rt=>Kt(rt)).on("mouseout",()=>{N.transition().duration(100).style("opacity",0)}),r==="brush"&&j.append("g").call(Fn().extent([[0,0],[k,F]]).on("end",({selection:rt})=>{if(!rt)return y([]);const[[ct,pt],[G,st]]=rt,St=I.filter(xt=>{const mt=tt(xt.x),yt=nt(xt.y);return mt>=ct&&mt<=G&&yt>=pt&&yt<=st});Array.from(new Set(St.map(xt=>`${xt.x}|${xt.y}|${xt.cort}`))).map(xt=>{const[mt,yt,Ut]=xt.split("|").map(Number);return{x:mt,y:yt,cort:Ut}}),y(St)}))}).catch(console.error)},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f})]}),r==="brush"&&m.length>0&&_.jsxs("div",{className:"w-56 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:S,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal Testo","AGD.tail","Maternal Cort"].map(T=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:T},T))})}),_.jsx("tbody",{children:m.map((T,N)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.y.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.cort.toFixed(2)})]},N))})]})]})]})}function lM({width:t=2225,height:n=900,mode:r}){const i=Z.useRef(),l=Z.useRef(),c="agd_tail",[f,d]=Z.useState([]),p=()=>{if(!f.length)return;const V=["AGD.tail","Offspring"],k=f.map(T=>[T.x.toFixed(2),T.y]),F=[V.join(","),...k.map(T=>T.join(","))].join(`
`);Cn.saveAs(new Blob([F],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},h=()=>{if(!f.length)return;const V=ve.json_to_sheet(f.map(F=>({"AGD.tail":F.x.toFixed(2),Offspring:F.y}))),k=ve.book_new();ve.book_append_sheet(k,V,"Brushed Data"),Rn(k,"lrs_brushed_data.xlsx")},m="lightgray",y="gray",v="gray",w="serif",S="50px",b="42px",E="34px",A="36px",O=500,C={top:120,right:80,bottom:180,left:120},U=t-C.left-C.right,B=n-C.top-C.bottom;return Z.useEffect(()=>{const V=Ft(i.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif").style("font-size","16px");V.selectAll("*").remove(),V.append("text").attr("x",20).attr("y",C.top/2+10).attr("text-anchor","middle").style("font-family",w).style("font-size",S).attr("text-anchor","start").text("A"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail.csv",ne)]).then(([T,N])=>{const D=T.map(Ot=>({x:+Ot["AGD.tail"],y:+Ot["life.repro.success"]})).filter(Ot=>!isNaN(Ot.x)&&!isNaN(Ot.y)),L=N.map(Ot=>({x:+Ot[c],predicted:+Ot.predicted,confLow:+Ot["conf.low"],confHigh:+Ot["conf.high"]})).filter(Ot=>!isNaN(Ot.x)&&!isNaN(Ot.predicted)),K=D.map(Ot=>Ot.x).concat(L.map(Ot=>Ot.x)),ft=D.map(Ot=>Ot.y).concat(L.map(Ot=>Ot.confLow)).concat(L.map(Ot=>Ot.confHigh)),dt=fe(ft),J=Math.ceil(dt/10)*10,gt=he().domain([_e(K),fe(K)]).nice().range([0,U]),wt=he().domain([-.5,J]).nice().range([B,0]),bt=V.append("g").attr("transform",`translate(${C.left+50},${C.top})`);An(10,J+1,10);const P=wt.ticks();fe(P);const I=bt.append("g").attr("class","y-grid").call(Se(wt).tickSize(-U).tickFormat(()=>""));I.select(".domain").remove(),I.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const R=wt.domain()[1];I.selectAll("g.tick").filter(Ot=>Ot===R).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Y=1e-6,z=(Ot,Dt)=>Math.abs(Ot-Dt)<Y,W=(Ot,Dt)=>Ot.some(ie=>z(ie,Dt))?Ot:[...Ot,Dt],tt=gt.domain()[1],nt=wt.domain()[1],q=W([-1,0,1,2],tt),lt=Me(".0f"),Ct=[0,10,20,30];bt.append("g").attr("transform",`translate(0,${B})`).call(Ie(gt).tickValues(q).tickFormat(Ot=>z(Ot,tt)?"":lt(Ot)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10)).selectAll("text").style("font-family",w).style("font-size",A).style("font-weight",O),bt.append("text").attr("class","x-axis-title").attr("x",U/2).attr("y",B+95).attr("text-anchor","middle").style("font-family",w).append("tspan").style("font-size",b).text("Masculinization index").append("tspan").attr("x",U/2).attr("y",B+140).style("font-size",E).text("(AGD.tail)"),bt.append("g").call(Se(wt).tickValues(W(Ct,nt)).tickFormat(Ot=>z(Ot,nt)?"":Ot)).style("font-family",w).style("font-size",A).style("font-weight",O).append("text").attr("transform","rotate(-90)").attr("x",-B/2).attr("y",-120).attr("fill","black").attr("text-anchor","middle").style("font-size",b).text("Offspring"),bt.append("path").datum(L.sort((Ot,Dt)=>Ot.x-Dt.x)).attr("d",_n().x(Ot=>gt(Ot.x)).y0(Ot=>wt(Ot.confLow)).y1(Ot=>wt(Ot.confHigh)).curve(ke)).attr("fill",m).attr("fill-opacity",.3),bt.append("path").datum(L.sort((Ot,Dt)=>Ot.x-Dt.x)).attr("d",gn().x(Ot=>gt(Ot.x)).y(Ot=>wt(Ot.predicted)).curve(ke)).attr("fill","none").attr("stroke",v).attr("stroke-width",2);const Zt=Ft(l.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999"),Gt=-.05,Kt=.55,Yt=We(2025),Et=un.source(Yt)(-Gt,Gt),Mt=un.source(Yt)(-Kt,Kt);bt.append("g").selectAll("circle").data(D.map(Ot=>({...Ot,_jx:Et(),_jy:Mt()}))).enter().append("circle").attr("cx",Ot=>gt(Ot.x+Ot._jx)).attr("cy",Ot=>wt(Ot.y+Ot._jy)).attr("r",8).attr("fill",y).attr("fill-opacity",.6),r==="brush"?bt.append("g").attr("class","brush").call(Fn().extent([[0,0],[U,B]]).on("end",({selection:Ot})=>{if(!Ot)return d([]);const[[Dt,ie],[xe,ue]]=Ot,ge=D.filter(ut=>{const rt=gt(ut.x),ct=wt(ut.y);return rt>=Dt&&rt<=xe&&ct>=ie&&ct<=ue});d(ge)})):(bt.selectAll(".brush").remove(),d([])),Ft(i.current).selectAll("circle").on("mouseover",(Ot,Dt)=>{const[ie,xe]=nn(Ot,V.node());Ft(l.current).html(`Masculinization index(AGD.tail): <strong> ${Dt.x.toFixed(2)}</strong><br/>Offspring: <strong>${Dt.y}</strong>`);const ue=Zt.node(),ge=ue.getBoundingClientRect().height;Zt.style("left",`${ie+C.left-ue.getBoundingClientRect().width/2}px`).style("top",`${xe+C.top-ge-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>Ft(l.current).transition().duration(100).style("opacity",0))}).catch(T=>console.error("Error loading data:",T))},[t,n,r]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:i}),_.jsx("div",{})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&f.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:p,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:h,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Masculinization index (AGD.tail)","Lifetime reproductive success (Offspring)"].map(V=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:V},V))})}),_.jsx("tbody",{children:f.map((V,k)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:V.y})]},k))})]})]})})]})}function oM({width:t=1100,height:n=660,brushRange:r=null,seasonFilter:i=[]}){const l=Z.useRef(),c=Z.useRef(),f=Z.useRef(null),d=Z.useRef([]),p={top:80,right:20,bottom:150,left:160},h=t-p.left-p.right,m=n-p.top-p.bottom,y="/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",v="/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail_by_density.csv",w="serif",S="50px",b="42px",E="34px",A="36px",O=500,C=["Spring","Summer","Autumn","Winter"],U=k=>{const F=(k??"").toString().trim().toLowerCase();return F.startsWith("spr")?"Spring":F.startsWith("sum")?"Summer":F.startsWith("aut")||F.startsWith("fal")?"Autumn":F.startsWith("win")?"Winter":null},B=new Set((Array.isArray(i)?i:Array.from(i||[])).map(U).filter(Boolean)),V=B.size===C.length||B.size===0;return Z.useEffect(()=>{const k=f.current;if(!k)return;const F=L=>L.attr("r",5).attr("stroke","none").attr("stroke-width",null).attr("fill-opacity",.6).style("filter",null);if(r==null){k.interrupt().transition().duration(150),F(k);return}const[T,N]=r??[-1/0,1/0],D=L=>Number.isFinite(L.density)&&L.density>=T&&L.density<=N;k.interrupt().transition().duration(180).attr("r",L=>D(L)?10:5).attr("stroke",L=>D(L)?"#111":"none").attr("stroke-width",L=>D(L)?1:null).attr("fill-opacity",L=>D(L)?.95:.15).style("filter",L=>D(L)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),k.filter(D).raise()},[r]),Z.useEffect(()=>{const k=Ft(l.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif");k.selectAll("*").remove(),k.append("text").attr("x",20).attr("y",p.top/2).attr("text-anchor","start").style("font-family",w).style("font-size",S).text("B"),Promise.all([Jt(y,ne),Jt(v,ne)]).then(([F,T])=>{const N=We(.42),D=q=>U(q["Season.DOB"]??q["season.dob"]??q.season??q.Season??q.season_obs??q.seasonality??q.season_of_conception??q.Seasonality),L=F.map((q,lt)=>{const Ct=+q["Density.DOB"],vt=+q["AGD.tail"],Zt=+q["life.repro.success"],Gt=m*.01,Kt=m*.02,Yt=(N()-.5)*(Zt===0?Kt:Gt);return{density:Ct,x:vt,y:Zt,jy:Yt,season:D(q),_key:`${lt}|${Ct}|${vt}|${Zt}`}});d.current=L;const K=T.map(q=>({density:q.density,x:+q.agd_tail,pred:+q.predicted,lo:+q["conf.low"],hi:+q["conf.high"]})),ft=Array.from(new Set(K.map(q=>q.density))),dt=[100,200,300,400,500],J=["#440154","#3b528b","#21918c","#5ec962","#fde725"],gt=he().domain(dt).range(J).interpolate(Tl),wt=L.map(q=>q.x).concat(K.map(q=>q.x)),bt=L.map(q=>q.y).concat(K.map(q=>q.lo)).concat(K.map(q=>q.hi)),P=he().domain(wn(wt)).nice().range([0,h]),I=he().domain([-1e-4,Math.ceil(fe(bt)/10)*10]).nice().range([m,0]),R=k.append("g").attr("transform",`translate(${p.left},${p.top})`),Y=R.append("g").attr("class","y-grid").call(Se(I).tickSize(-h).tickFormat(""));Y.select(".domain").remove(),Y.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2),R.append("g").attr("transform",`translate(0,${m})`).call(Ie(P).ticks(4)).style("font-family",w).style("font-size",A).style("font-weight",O).append("text").attr("x",h/2).attr("y",40).attr("text-anchor","middle").style("font-size",E).text("Masculinization index (AGD.tail)"),R.append("g").call(Se(I).ticks(4)).style("font-family",w).style("font-size",A).style("font-weight",O);const z=R.append("text").attr("class","axis-label").attr("x",h/2).attr("y",m+p.bottom-70).attr("text-anchor","middle").style("font-weight",O).style("font-family",w);z.append("tspan").attr("x",h/2).attr("dy",10).style("font-size",b).text("Masculinization index"),z.append("tspan").attr("x",h/2).attr("dy","1.2em").style("font-size",E).text("(AGD.tail)"),R.append("text").attr("class","axis-label").attr("transform",`translate(-100, ${m/2}) rotate(-90)`).attr("text-anchor","middle").style("font-family",w).style("font-size",b).text("Offspring");const W=R.append("g").selectAll("circle").data(L,q=>q._key).join("circle").attr("cx",q=>P(q.x)).attr("cy",q=>I(q.y)+q.jy).attr("r",5).attr("fill",q=>gt(q.density)).attr("fill-opacity",.6);f.current=W;const tt=_n().x(q=>P(q.x)).y0(q=>I(q.lo)).y1(q=>I(q.hi)).curve(ke),nt=gn().x(q=>P(q.x)).y(q=>I(q.pred)).curve(ke);ft.forEach(q=>{const lt=K.filter(Ct=>Ct.density===q).sort((Ct,vt)=>Ct.x-vt.x);R.append("path").datum(lt).attr("fill",gt(q)).attr("fill-opacity",.3).attr("d",tt),R.append("path").datum(lt).attr("stroke",gt(q)).attr("stroke-width",2).attr("fill","none").attr("d",nt)});const j=Ft(c.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)");console.log("Unique seasons in chart:",new Set(d.current.map(q=>q.season))),R.selectAll("circle").on("mouseover",(q,lt)=>{const[Ct,vt]=nn(q,k.node());j.html(`Masculinization index(AGD.tail): <strong>${lt.x.toFixed(2)}</strong><br/>Offspring: <strong>${lt.y}</strong>${lt.season?`<br/>Season: <strong>${lt.season}</strong>`:""}`);const Zt=j.node(),Gt=Zt.getBoundingClientRect().height;j.style("left",`${Ct+p.left-Zt.getBoundingClientRect().width/2}px`).style("top",`${vt+p.top-Gt-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>j.transition().duration(100).style("opacity",0))}).catch(F=>console.error(F))},[t,n]),Z.useEffect(()=>{const k=f.current;if(!k)return;const F=T=>V||T.season&&B.has(T.season);k.style("display",T=>F(T)?null:"none")},[i,B.size,V]),_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:l}),_.jsx("div",{ref:c})]})}function cM({width:t=1100,height:n=710,mode:r,brushRange:i=null,seasonFilter:l=[]}){const c=Z.useRef(),f=Z.useRef(),d=Z.useRef(null);Z.useRef([]);const[p,h]=Z.useState([]),m="serif",y="50px",v="46px",w="48px",S="38px",b="36px",E=500,A={top:80,right:20,bottom:150,left:200},O=t-A.left-A.right,C=n-A.top-A.bottom,U=["Spring","Summer","Autumn","Winter"],B=L=>{const K=(L??"").toString().trim().toLowerCase();return K.startsWith("spr")?"Spring":K.startsWith("sum")?"Summer":K.startsWith("aut")||K.startsWith("fal")?"Autumn":K.startsWith("win")?"Winter":null},V=new Set((Array.isArray(l)?l:Array.from(l||[])).map(B).filter(Boolean)),k=V.size===U.length||V.size===0,F=L=>k||L.season&&V.has(L.season),T=()=>{if(!p.length)return;const L=["Density","AGD.tail","Recruitment","AGD.weight","Density Group"],K=p.map(J=>[J.density.toFixed(2),J.agd.toFixed(2),J.recruitment===1?"Yes":J.recruitment===0?"No":J.recruitment,J.weight.toFixed(2),J.group]),ft=[L.join(","),...K.map(J=>J.join(","))].join(`
`),dt=new Blob([ft],{type:"text/csv;charset=utf-8;"});Cn.saveAs(dt,"agd_brushed_data.csv")},N=()=>{if(!p.length)return;const L=ve.json_to_sheet(p.map(ft=>({Density:ft.density.toFixed(2),"AGD.tail":ft.agd.toFixed(2),Recruitment:ft.recruitment===1?"Yes":ft.recruitment===0?"No":ft.recruitment,"AGD.weight":ft.weight.toFixed(2),"Density Group":ft.group}))),K=ve.book_new();ve.book_append_sheet(K,L,"Brushed Data"),Rn(K,"agd_brushed_data.xlsx")};Z.useEffect(()=>{const L=d.current;if(!L)return;const K=5,ft=.9,dt=10,J=.95,gt=.15,wt=R=>R.attr("r",K).attr("fill-opacity",ft).attr("stroke",null).attr("stroke-width",null).style("filter",null);if(i==null){L.interrupt().transition().duration(150).call(wt);return}const[bt,P]=i??[-1/0,1/0],I=R=>Number.isFinite(R.density)&&R.density>=bt&&R.density<=P;L.interrupt().transition().duration(180).attr("r",R=>I(R)?dt:K).attr("stroke",R=>I(R)?"#111":null).attr("stroke-width",R=>I(R)?1.5:null).attr("fill-opacity",R=>I(R)?J:gt).style("filter",R=>I(R)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),L.filter(I).raise()},[i]),Z.useEffect(()=>{const L=Ft(c.current).attr("width",t).attr("height",n).style("background","white").style("font-family",m).style("overflow","visible");L.selectAll("*").remove();const K=Ft(f.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");L.append("text").attr("x",5).attr("y",A.top/2).attr("text-anchor","middle").style("font-family",m).style("font-size",y).attr("text-anchor","start").text("C"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_recruitment.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_recruitment.csv",ne)]).then(([ft,dt])=>{const J=We(.42),gt=ft.map((ct,pt)=>{const G=+ct["AGD.tail"],st=+ct.recruitment,St=+ct["AGD.weight"],xt=ct["Density.DOB"],mt=+xt,yt=Number.isFinite(mt)?mt:+ct.density||+ct.group,Ut=B(ct["Season.DOB"]??ct["season.dob"]??ct.season??ct.Season??ct.season_obs??ct.seasonality??ct.season_of_conception??ct.Seasonality)||null,te=(J()-.5)*C*.13;return{x:G,y:st,weight:St,group:xt,density:yt,jy:te,season:Ut,_key:`${pt}|${G}|${st}|${yt}`}}).filter(ct=>Number.isFinite(ct.x)&&Number.isFinite(ct.y)),wt=dt.map(ct=>({x:+ct.agd_tail,predicted:+ct.predicted,confLow:+ct["conf.low"],confHigh:+ct["conf.high"],group:ct.density})).filter(ct=>Number.isFinite(ct.x)&&Number.isFinite(ct.predicted)),bt=Array.from(new Set(wt.map(ct=>ct.group))),I=L.append("defs").append("linearGradient").attr("id","viridisGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),R=["#440154","#3b528b","#21918c","#5ec962","#fde725"],Y=[0,500],z=["#440154","#3b528b","#21918c","#5ec962","#fde725"],W=he().domain(An(0,1+1e-9,1/(z.length-1)).map(ct=>Y[0]+ct*(Y[1]-Y[0]))).range(z).interpolate(Tl),tt=[...gt.map(ct=>ct.x),...wt.map(ct=>ct.x)],nt=he().domain(wn(tt)).nice().range([0,O]),j=he().domain([-.1,1.1]).nice().range([C,0]),q=L.append("g").attr("transform",`translate(${A.left},${A.top})`),lt=1e-6,Ct=(ct,pt)=>Math.abs(ct-pt)<lt,vt=(ct,pt)=>ct.some(G=>Ct(G,pt))?ct:[...ct,pt],Zt=nt.domain()[1],Gt=j.domain()[1],Yt=vt([-1,0,1,2],Zt),Mt=vt([0,.4,.8],Gt),Ot=Me(".0f"),Dt=Me(".1f"),ie=Ie(nt).tickValues(Yt).tickFormat(ct=>Ct(ct,Zt)?"":Ot(ct)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10);q.append("g").attr("transform",`translate(0,${C})`).call(ie).call(ct=>ct.selectAll(".domain, .tick line").attr("stroke","#000")).call(ct=>ct.selectAll(".tick text").attr("font-size",b));const xe=q.append("text").attr("class","axis-label").attr("x",O/2).attr("y",C+A.bottom-60).attr("text-anchor","middle");xe.append("tspan").attr("x",O/2).attr("dy",10).style("font-size",w).style("font-weight",E).style("font-family",m).text("Masculinization index"),xe.append("tspan").attr("x",O/2).attr("dy","1.2em").style("font-size",S).text("(AGD.tail)");const ue=Se(j).tickValues(Mt).tickFormat(ct=>Ct(ct,Gt)?"":Dt(ct)).tickSizeInner(6).tickSizeOuter(0).tickPadding(10);q.append("g").call(ue).call(ct=>ct.selectAll(".domain, .tick line").attr("stroke","#000")).call(ct=>ct.selectAll(".tick text").attr("font-size",b)),q.append("g").attr("class","grid").call(Se(j).tickValues([0,.4,.8]).tickSize(-O).tickFormat("")).call(ct=>ct.select(".domain").remove()).call(ct=>ct.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3)).lower(),q.append("text").attr("class","y-axis-title").attr("transform",`translate(-160, ${C/2}) rotate(-90)`).attr("text-anchor","middle").style("font-size",v).style("font-family",m).text("Recruitment probability"),bt.forEach(ct=>{const pt=wt.filter(G=>G.group===ct).sort((G,st)=>G.x-st.x);q.append("path").datum(pt).attr("d",_n().x(G=>nt(G.x)).y0(G=>j(G.confLow)).y1(G=>j(G.confHigh)).curve(ke)).attr("fill",W(ct)).attr("fill-opacity",.3),q.append("path").datum(pt).attr("d",gn().x(G=>nt(G.x)).y(G=>j(G.predicted)).curve(ke)).attr("stroke",W(ct)).attr("stroke-width",2).attr("fill","none")});const rt=q.append("g").attr("class","dots").selectAll("circle").data(gt,ct=>ct._key).join("circle").attr("cx",ct=>nt(ct.x)).attr("cy",ct=>j(ct.y)+ct.jy).attr("r",5).attr("fill",ct=>W(ct.density)).attr("fill-opacity",.9);d.current=rt,r==="hover"?rt.on("mouseover",(ct,pt)=>{const[G,st]=nn(ct,c.current);K.html(`Masculinization index(AGD.tail): <strong>${pt.x.toFixed(2)}</strong><br/>Masculinization index(AGD weight):<strong> ${pt.weight.toFixed(2)}</strong><br/>Recruitment: ${pt.y===1?"Yes":pt.y===0?"No":pt.y.toFixed(2)}`).style("left",`${G+A.left+10}px`).style("top",`${st+A.top-30}px`).transition().duration(100).attr("r",5).attr("stroke-width",2)}).on("mouseout",()=>K.transition().duration(100).style("opacity",0)):r==="brush"&&q.append("g").attr("class","brush").call(Fn().extent([[0,0],[O,C]]).on("end",({selection:ct})=>{if(!ct){h([]);return}const[[pt,G],[st,St]]=ct,mt=gt.filter(yt=>{const Ut=nt(yt.x),te=j(yt.y);return F(yt)&&Ut>=pt&&Ut<=st&&te>=G&&te<=St}).map(yt=>({density:yt.x,agd:yt.x,recruitment:yt.y,weight:yt.weight,group:yt.group}));h(mt)})),R.forEach((ct,pt)=>{I.append("stop").attr("offset",`${pt/(R.length-1)*100}%`).attr("stop-color",ct)})})},[t,n,r]),Z.useEffect(()=>{const L=d.current;L&&L.style("display",K=>F(K)?null:"none")},[l,V.size,k]);const D=["Recruitment probability","Masculinization index (AGD.tail)","AGD weight","Recruitment","Group"];return _.jsxs("div",{className:"flex space-x-4",children:[_.jsx("div",{className:"relative",style:{width:t,height:n},children:_.jsx("svg",{ref:c})}),_.jsx("div",{className:"max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&p.length>0&&_.jsxs("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex space-x-2",children:[_.jsx("button",{onClick:T,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:N,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:D.map(L=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs text-left",children:L},L))})}),_.jsx("tbody",{children:p.map((L,K)=>_.jsxs("tr",{className:"odd:bg-gray-50",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.agd.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.weight.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.recruitment===1?"Yes":L.recruitment===0?"No":L.recruitment}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:L.group})]},K))})]})]})})]})}function fM({width:t=600,barHeight:n=40,margins:r={top:30,right:0,bottom:30,left:20},domain:i=[0,500],colors:l=["#440154","#3b528b","#21918c","#5ec962","#fde725"],title:c="Density",gradientId:f="viridisGradient",onBrush:d=()=>{}}){const p=Z.useRef(),h=Z.useRef(d);return Z.useEffect(()=>{h.current=d},[d]),Z.useEffect(()=>{const m=t-r.left-r.right,y=n,v=r.top+y+r.bottom,w=Ft(p.current).attr("width",t).attr("height",v).style("overflow","visible");w.selectAll("*").remove();const b=w.append("defs").append("linearGradient").attr("id",f).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");l.forEach((B,V)=>{b.append("stop").attr("offset",`${100*V/(l.length-1)}%`).attr("stop-color",B)});const E=w.append("g").attr("transform",`translate(${r.left},${r.top})`);E.append("rect").attr("width",m).attr("height",y).style("fill",`url(#${f})`).style("stroke","#000");const A=he().domain(i).range([0,m]),O=Ie(A).ticks(l.length).tickFormat(Me("d"));E.append("g").attr("transform",`translate(0,${y})`).call(O).selectAll("text").style("font-size","20px"),E.append("text").attr("x",0).attr("y",-10).attr("text-anchor","start").style("font-size","24px").style("font-weight","bold").text(c);const C=ov().extent([[0,0],[m,y]]).on("end",B=>{if(!B.selection){h.current(null);return}const[V,k]=B.selection.map(A.invert);h.current([V,k])}),U=E.append("g").attr("class","brush").call(C);U.selectAll(".selection").attr("stroke","#444").attr("stroke-width",2).attr("fill","rgba(0,0,0,0.2)"),U.selectAll(".handle").attr("fill","#444")},[t,n,r.left,r.right,r.top,r.bottom,i.toString(),l.toString(),f,c]),_.jsx("svg",{ref:p})}const hb=Z.memo(fM),Lf=["Spring","Summer","Autumn","Winter"];function uM({value:t,onChange:n,className:r=""}){const i=t??new Set(Lf),l=i.size===Lf.length,c=()=>{n(new Set(l?[]:Lf))},f=d=>{const p=new Set(i);p.has(d)?p.delete(d):p.add(d),n(p)};return _.jsxs("fieldset",{className:`flex items-center w-2/3 gap-8 flex-wrap px-4 py-3 bg-white dark:bg-gray-800 ${r}`,children:[_.jsx("legend",{className:"text-2xl text-left font-bold pr-2",children:"Season"}),_.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer text-xl",children:[_.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-400",checked:l,onChange:c}),_.jsx("span",{children:"All seasons"})]}),Lf.map(d=>_.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer text-xl",children:[_.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-400",checked:i.has(d),onChange:()=>f(d)}),_.jsx("span",{children:d})]},d))]})}function hM(){const t=["Spring","Summer","Autumn","Winter"],[n,r]=Z.useState("hover"),[i,l]=Z.useState(null),[c,f]=Z.useState([0,500]),[d,p]=Z.useState(null),[h,m]=Z.useState(null),[y,v]=Z.useState(new Set(t)),[w,S]=Z.useState(new Set),b=(O,C)=>O.size===C.size&&[...O].every(U=>C.has(U)),E=O=>{const C=new Set((O??[]).map(String));S(U=>b(U,C)?new Set:C)},A=Z.useCallback(O=>{f(O)},[]);return _.jsx(_.Fragment,{children:_.jsxs("div",{className:"fixed top-40 -mt-20 left-10 right-10 bottom-0 h-full overflow-y-auto p-0 text-black dark:text-white transition-colors duration-300",children:[_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[3000px] mx-auto mb-8",style:{zoom:.7},children:[" ",_.jsxs("div",{className:"mb-0",children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-bold mb-5",children:"Fig. 1: Pup body measures."}),_.jsx("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:_.jsxs("div",{className:"grid grid-cols-4 gap-80 mb-2",children:[_.jsx(JR,{}),_.jsx(tM,{}),_.jsx(eM,{}),_.jsxs("div",{className:"flex flex-col gap-0 ml-0 ",children:[_.jsxs("figure",{className:"relative w-[250px]",children:[_.jsx("img",{src:cb,alt:"Measuring anogenital distance with calipers",width:250,height:300,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-5xl font-serif",children:"D"})]}),_.jsxs("figure",{className:"relative w-[250px]",children:[_.jsx("img",{src:fb,alt:"Tail length measurement with ruler",width:250,height:300,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-5xl font-serif",children:"E"})]})]})]})})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[3000px] mx-auto mb-8",style:{zoom:.7},children:[_.jsxs("div",{className:"mb-5",children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-bold mb-5",children:"Fig. 2: Preconditions of the fetal programming hypothesis."}),_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mb-5",children:"Hover on each data point to see the details. Click a data point to select the same mouse across plots A, B and C (click again to clear)."}),_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mb-0",children:"Interactive Legend: Click on a season in the legend to highlight the corresponding data points."}),_.jsx("div",{className:"mb-5",children:_.jsx(Bp,{selected:d,onChange:p})}),_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mb-5",children:"Seasonality differs between plots A–B and C because hair samples were collected from adults, whereas anogenital distance (AGD) in plot C was measured in pups. For some individuals, we have either hair hormone data or pup measures, not both."}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-semibold mb-5",children:"Adult female hormones"}),_.jsxs("div",{className:"grid grid-cols-2 gap-0 mb-0",children:[_.jsx(rM,{mode:n,selectedSeason:d,selectedSeq:h,onSelectSeq:m,selectedHairIDs:w,onSelectHairIDs:E}),_.jsx(nM,{mode:n,selectedSeason:d,selectedSeq:h,onSelectSeq:m,selectedHairIDs:w,onSelectHairIDs:E})]})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 mb-5",children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-semibold mb-5",children:"Pup masculinization"}),_.jsx(aM,{mode:n,selectedSeason:d,selectedSeq:h,onSelectSeq:m,selectedHairIDs:w,onSelectHairIDs:E})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-semibold mb-0",children:"Maternal hormones"}),_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mt-5 mb-5",children:"Click a data point to select the same mouse across plots D and E (click again to clear)."}),_.jsxs("div",{className:"grid grid-cols-2 gap-5 mt-5 mb-5",children:[_.jsx(sM,{mode:n,hoveredId:i,onHover:l}),_.jsx(iM,{mode:n,hoveredId:i,onHover:l})]})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 mb-40 max-w-[3000px] mx-auto mb-8",style:{zoom:.7},children:[_.jsx("p",{className:"text-left ml-5 text-4xl font-bold mb-5",children:"Fig. 3: Effects of masculinization on lifetime reproductive success and recruitment."}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx(lM,{mode:n}),_.jsxs("div",{className:"grid grid-cols-2 gap-5 mt-6",children:[_.jsx(oM,{mode:n,brushRange:c,seasonFilter:[...y]}),_.jsx("div",{className:"transform scale-[0.9] -mt-7",children:_.jsx(cM,{mode:n,brushRange:c,seasonFilter:[...y]})})]}),_.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-2 items-start",children:[_.jsxs("div",{className:"min-w-0 -mr-20",children:[_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mb-5",children:"Select season(s) to filter data points."}),_.jsx("div",{className:"ml-1",children:_.jsx(uM,{value:y,onChange:v})})]}),_.jsxs("div",{className:"min-w-0 -ml-60",children:[_.jsx("p",{className:"text-left ml-5 text-2xl text-gray mb-5",children:"Click and drag the color gradient to highlight a range."}),_.jsx(hb,{onBrush:A})]})]})]})]})]})})}const dM=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="30px",p="24px",h="20px",m="16px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,I=>I.tail),fe(S,I=>I.tail)]).nice().range([E,0]),U=he().domain([_e(S,I=>I.weight),fe(S,I=>I.weight)]).nice().range([0,b]);O.append("g").call(Se(C).tickValues([30,40,50,60]).tickSizeOuter(0)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues([3,6,9]).tickFormat(Me("d")).tickSizeOuter(0)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const k=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);k.append("tspan").style("font-size",p).text("Weight "),k.append("tspan").style("font-size",h).text("(g)");const F=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);F.append("tspan").style("font-size",p).text("Tail length "),F.append("tspan").style("font-size",h).text("(mm)");const T=We(2025),N=un.source(T)(-8,8);O.selectAll("circle").data(S.map(I=>({...I,jx:N()}))).enter().append("circle").attr("cx",I=>U(I.weight)+I.jx).attr("cy",I=>C(I.tail)+I.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(I,R)=>{v.html(`Tail: ${R.tail} mm<br/>Weight: ${R.weight} g`).style("visibility","visible")}).on("mousemove",I=>{v.style("top",I.offsetY+"px").style("left",I.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const D=S.map(I=>I.weight),L=S.map(I=>I.tail),{slope:K,intercept:ft}=w(D,L),dt=_e(D),J=fe(D),gt=ft+K*dt,wt=ft+K*J;O.append("line").attr("x1",U(dt)).attr("y1",C(gt)).attr("x2",U(J)).attr("y2",C(wt)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("A");const bt=D.map(I=>ft+K*I),P=Hn(L);Te(L.map((I,R)=>(I-bt[R])**2)),Te(L.map(I=>(I-P)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},pM=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="30px",p="24px",h="20px",m="16px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,I=>I.anogenitalDistance),fe(S,I=>I.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,I=>I.tail),fe(S,I=>I.tail)]).nice().range([0,b]),B=O.append("g").call(Se(C).tickValues([2,3,4,5,6]).tickSizeOuter(0).tickFormat(Me("d"))),V=O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues([30,40,50,60]).tickFormat(Me("d")).tickSizeOuter(0));B.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),V.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const k=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);k.append("tspan").style("font-size",p).text("Tail length "),k.append("tspan").style("font-size",h).text("(mm)");const F=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);F.append("tspan").style("font-size",p).text("Anogenital distance "),F.append("tspan").style("font-size",h).text("(mm)");const T=We(2025),N=un.source(T)(-8,8);O.selectAll("circle").data(S.map(I=>({...I,jx:N()}))).enter().append("circle").attr("cx",I=>U(I.tail)+I.jx).attr("cy",I=>C(I.anogenitalDistance)+I.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(I,R)=>{v.html(`Tail: ${R.anogenitalDistance} mm<br/>Weight: ${R.tail} g`).style("visibility","visible")}).on("mousemove",I=>{v.style("top",I.offsetY+"px").style("left",I.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const D=S.map(I=>I.tail),L=S.map(I=>I.anogenitalDistance),{slope:K,intercept:ft}=w(D,L),dt=_e(D),J=fe(D),gt=ft+K*dt,wt=ft+K*J;O.append("line").attr("x1",U(dt)).attr("y1",C(gt)).attr("x2",U(J)).attr("y2",C(wt)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("B");const bt=D.map(I=>ft+K*I),P=Hn(L);Te(L.map((I,R)=>(I-bt[R])**2)),Te(L.map(I=>(I-P)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})},xM=({dataUrl:t="/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",width:n=500,height:r=500,margin:i={top:60,right:0,bottom:80,left:120}})=>{const l=Z.useRef(null),c=Z.useRef(null),f="serif",d="30px",p="24px",h="20px",m="16px",y=500;return Z.useEffect(()=>{const v=Ft(c.current).style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #ccc").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("z-index",10);Jt(t,S=>({anogenitalDistance:+S.AGD_day13,weight:+S.AGD_weight,tail:+S.AGD_tail_length})).then(S=>{const b=n-i.left-i.right,E=r-i.top-i.bottom,A=Ft(l.current);A.selectAll("*").remove();const O=A.append("g").attr("transform",`translate(${i.left},${i.top})`),C=he().domain([_e(S,I=>I.anogenitalDistance),fe(S,I=>I.anogenitalDistance)]).nice().range([E,0]),U=he().domain([_e(S,I=>I.weight),fe(S,I=>I.weight)]).nice().range([0,b]),B=O.append("g").call(Se(C).tickValues([2,3,4,5,6]).tickSizeOuter(0).tickFormat(Me("d")));O.append("g").attr("transform",`translate(0,${E})`).call(Ie(U).tickValues([3,6,9]).tickFormat(Me("d")).tickSizeOuter(0)).selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f),B.selectAll(".tick text").style("font-size",m).style("font-weight",y).style("font-family",f);const k=A.append("text").attr("x",i.left+b/2).attr("y",r-20).attr("text-anchor","middle").style("font-family",f);k.append("tspan").style("font-size",p).text("Weight "),k.append("tspan").style("font-size",h).text("(g)");const F=A.append("text").attr("transform","rotate(-90)").attr("x",-(i.top+E/2)).attr("y",40).attr("text-anchor","middle").style("font-family",f);F.append("tspan").style("font-size",p).text("Anogenital distance "),F.append("tspan").style("font-size",h).text("(mm)");const T=We(2025),N=un.source(T)(-8,8);O.selectAll("circle").data(S.map(I=>({...I,jx:N()}))).enter().append("circle").attr("cx",I=>U(I.weight)+I.jx).attr("cy",I=>C(I.anogenitalDistance)+I.jx).attr("r",3).attr("fill","grey").attr("opacity",.6).on("mouseover",(I,R)=>{v.html(`Tail: ${R.anogenitalDistance} mm<br/>Weight: ${R.weight} g`).style("visibility","visible")}).on("mousemove",I=>{v.style("top",I.offsetY+"px").style("left",I.offsetX+"px")}).on("mouseout",()=>v.style("visibility","hidden"));const D=S.map(I=>I.weight),L=S.map(I=>I.anogenitalDistance),{slope:K,intercept:ft}=w(D,L),dt=_e(D),J=fe(D),gt=ft+K*dt,wt=ft+K*J;O.append("line").attr("x1",U(dt)).attr("y1",C(gt)).attr("x2",U(J)).attr("y2",C(wt)).attr("stroke","black").attr("stroke-width",2),O.append("text").attr("x",-100).attr("y",i.top/2-60).attr("text-anchor","middle").style("font-family",f).style("font-size",d).attr("text-anchor","start").text("C");const bt=D.map(I=>ft+K*I),P=Hn(L);Te(L.map((I,R)=>(I-bt[R])**2)),Te(L.map(I=>(I-P)**2)),O.append("text").attr("x",b-8).attr("y",E-36).attr("text-anchor","end").style("font-family",f).style("font-size",p)});function w(S,b){const E=S.length,A=Te(S),O=Te(b),C=Te(S.map((k,F)=>k*b[F])),U=Te(S.map(k=>k*k)),B=(E*C-A*O)/(E*U-A*A),V=(O-B*A)/E;return{slope:B,intercept:V}}},[t,n,r,i]),_.jsx("div",{style:{position:"relative"},children:_.jsx("svg",{ref:l,width:n,height:r})})};function mM({width:t=990,height:n=600,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c,selectedHairIDs:f=new Set,onSelectHairIDs:d}){const p=Z.useRef(),h=Z.useRef(),[m,y]=nn(event,p.current),[v,w]=Z.useState([]);ms("%Y-%m-%d");const S=xs("%d.%m.%Y");Z.useRef(null);const b=()=>{if(!v.length)return;const T=["AGD.tail","Offspring"],N=v.map(L=>[L.x.toFixed(2),L.y]),D=[T.join(","),...N.map(L=>L.join(","))].join(`
`);Cn.saveAs(new Blob([D],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},E=()=>{if(!v.length)return;const T=ve.json_to_sheet(v.map(D=>({"AGD.tail":D.x.toFixed(2),Offspring:D.y}))),N=ve.book_new();ve.book_append_sheet(N,T,"Brushed Data"),Rn(N,"lrs_brushed_data.xlsx")},A="serif",O="30px",C="24px",U="20px",B="16px",V=500,k=T=>T&&typeof T=="string"?T.charAt(0).toUpperCase()+T.slice(1).toLowerCase():T,F=(T,N={})=>N.decimals!=null?T!=null&&!isNaN(T)?T.toFixed(N.decimals):"":N.date&&T?S(T):T!=null&&T!==""?T:"";return Z.useEffect(()=>{const N=Ft(p.current).select("g.root");if(N.empty())return;const D=i??null;N.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const L=Ft(this).datum()?.season;return!D||L===D?.7:.1}),N.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?.3:.05}),N.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?1:.1}).attr("stroke-width",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?2.5:1})},[i]),Z.useEffect(()=>{const T=Ft(p.current).select("g.root");if(T.empty())return;const N=T.selectAll(".dot"),D=f&&f.size>0,L=ft=>D&&Array.isArray(ft)&&ft.some(dt=>f.has(String(dt))),K=ft=>l!=null&&ft.seq===l||L(ft.hairIDs);N.interrupt(),N.filter(K).transition().duration(140).attr("r",ft=>l!=null&&ft.seq===l?10:4).attr("stroke-width",ft=>l!=null&&ft.seq===l?2.5:1),N.filter(ft=>!K(ft)).attr("r",4).attr("stroke-width",1),N.filter(ft=>l!=null&&ft.seq===l).raise()},[f,l]),Z.useEffect(()=>{const T=Ft(h.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone_backup.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_corticosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",N=>(N.External_ID2=N["External.ID2"],delete N["External.ID2"],ne(N))),Jt("/fetal-programming-for-female-masculinization/data/observed_testosterone.csv",ne)]).then(([N,D,L,K,ft,dt])=>{const J=Ft(p.current);J.selectAll("*").remove();const gt=new Map(L.filter(Bt=>Bt.focal_ID!=null).map(Bt=>[String(Bt.focal_ID).replace(/^'/,""),Bt])),wt=new Map(Array.from(Ea(dt.filter(Bt=>Bt.focal_ID!=null),Bt=>String(Bt.focal_ID).replace(/^'/,"")),([Bt,At])=>[Bt,Hn(At,Pt=>Pt["Testo_pg.mg"])])),bt=rc(dt.filter(Bt=>Bt.focal_ID!=null&&Bt.Season!=null),Bt=>Hn(Bt,At=>At["Testo_pg.mg"]),Bt=>String(Bt.focal_ID).replace(/^'/,""),Bt=>Bt.Season),P=new Map(Array.from(Ea(ft.filter(Bt=>Bt.focal_ID!=null),Bt=>String(Bt.focal_ID).replace(/^'/,"")),([Bt,At])=>[Bt,Array.from(new Set(At.map(Pt=>String(Pt.External_ID2)).filter(Pt=>Pt!=null&&Pt!=="")))])),I=new Map(K.filter(Bt=>Bt.focal_ID!=null&&Bt.Seq!=null).map(Bt=>[String(Bt.focal_ID).replace(/^'/,""),+Bt.Seq]));let R=N.map(Bt=>{const At=String(Bt.focal_ID).replace(/^'/,""),Pt=gt.get(At)||{},Tt=P.get(At)||[];return{density:Number(Bt.Density)||0,season:Bt.Season,cort:Bt["Cort_pg.mg"],focal:At,Date_Sampled:Pt.Date_Sampled,Genetic_Sex:Pt.Genetic_Sex,AGD_weight:Pt.AGD_weight,AGD_tail:Pt.AGD_tail,Testo:Pt["Testo_pg.mg_1"],Life_Repro_Success:Pt["life.repro.success"],Recruitment:Pt["recruitment.y.n"],hairIDs:Tt,seq:I.get(At)??null,testo:wt.get(At)??null,testoSeasonal:(bt.get(At)&&bt.get(At).get(Bt.Season))??null}});R=R.filter(Bt=>isFinite(Bt.density)&&isFinite(Bt.cort));const Y=D.map(Bt=>({density:Bt.x,season:Bt.group,predicted:Bt.predicted,confLow:Bt["conf.low"],confHigh:Bt["conf.high"]})),z={top:40,right:20,bottom:100,left:120},W=t-z.left-z.right,tt=n-z.top-z.bottom;R.map(Bt=>Bt.density).concat(Y.map(Bt=>Bt.density));const nt=[...R.map(Bt=>+Bt.density).filter(Number.isFinite),...Y.map(Bt=>+Bt.density).filter(Number.isFinite)],j=nt.length?_e(nt):0;nt.length&&fe(nt);const q=Math.floor(j/100)*100,lt=550,Ct=he().domain([q,lt]).range([0,W]),vt=An(q,lt+1,100),Zt=R.map(Bt=>+Bt.cort).filter(Number.isFinite),Gt=Y.length?[...Y.map(Bt=>+Bt.confLow).filter(Number.isFinite),...Y.map(Bt=>+Bt.confHigh).filter(Number.isFinite)]:[],Kt=[...Zt,...Gt];Kt.length&&wn(Kt);const Yt=Math.min(_e(R,Bt=>Bt.cort),_e(Y,Bt=>Bt.confLow)),Et=Math.max(fe(R,Bt=>Bt.cort),fe(Y,Bt=>Bt.confHigh)),Mt=125,Ot=180,Dt=Mt-Yt,ie=Et-Ot,xe=tt,ue=xe*(Dt/(Dt+ie)),ge=xe*(ie/(Dt+ie)),ut=he().domain([Yt,Mt,Ot,Et]).range([tt,tt-ue,tt-ue,tt-ue-ge]),rt=[...An(Math.ceil(Yt/20)*20,Mt,20),...An(Ot,Math.floor(Et/20)*20+1,20)],ct=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);J.attr("width",t).attr("height",n);const pt=J.append("g").attr("class","root").attr("transform",`translate(${z.left},${z.top})`);J.append("text").attr("x",20).attr("y",z.top/2).attr("text-anchor","middle").style("font-family",A).style("font-size",O).attr("text-anchor","start").text("B"),pt.append("g").attr("transform",`translate(0,${tt})`).call(Ie(Ct).tickValues(vt).tickFormat(Me("d"))).selectAll("text").style("font-family",A).style("font-size",B).style("font-weight",V),pt.append("g").call(Se(ut).tickValues(rt).tickFormat(Me("d"))).selectAll("text").style("font-family",A).style("font-size",B).style("font-weight",V),pt.selectAll(".domain, .tick line").attr("stroke","black"),pt.append("g").attr("class","grid").call(Se(ut).tickSizeInner(-W).tickSizeOuter(0).tickFormat("")).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),pt.append("text").attr("x",W/2).attr("y",tt+55).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",C).text("Density").append("tspan").attr("x",W/2).attr("y",tt+80).style("font-size",U).text("(No. of adults)"),pt.append("text").attr("transform","rotate(-90)").attr("x",-tt/2).attr("y",-75).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",C).text("Corticosterone").append("tspan").attr("x",-tt/2).attr("dy","1.2em").style("font-size",U).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(Bt=>{const At=Y.filter(Pt=>Pt.season===Bt);pt.append("path").datum(At).attr("class",`ribbon season-${Bt}`).attr("fill",ct(Bt)).attr("fill-opacity",.3).attr("d",_n().x(Pt=>Ct(Pt.density)).y0(Pt=>ut(Pt.confLow)).y1(Pt=>ut(Pt.confHigh)).curve(ke)),pt.append("path").datum(At).attr("class",`line season-${Bt}`).attr("fill","none").attr("stroke",ct(Bt)).attr("stroke-width",2).attr("d",gn().x(Pt=>Ct(Pt.density)).y(Pt=>ut(Pt.predicted)).curve(ke))});const st=100;function St(Bt){const At=Bt.currentTarget,Pt=parseFloat(At.getAttribute("r"))||4,Tt=+At.getAttribute("cx"),ae=+At.getAttribute("cy"),pe=h.current,be=pe.getBoundingClientRect(),Ee=be.width,Le=be.height,Ue=z.left+Tt,$e=z.top+ae,pn=t-(Ue+st+Pt+Ee);let xn=Ue-(st+Pt+Ee)>=pn||Ue>z.left+W/2?Ue-(Ee+st+Pt):Ue+(st+Pt),qe=$e-Le-8;qe<0&&(qe=$e+8),xn=Math.max(0,Math.min(xn,t-Ee)),qe=Math.max(0,Math.min(qe,n-Le)),Ft(pe).style("left",`${xn}px`).style("top",`${qe}px`)}const xt=h.current,{offsetWidth:mt,offsetHeight:yt}=xt,Ut=Number.isFinite(lt-q)?(lt-q)*.05:0,te=pt.append("g").attr("class","dots").selectAll("circle").data(R,Bt=>Bt.seq??Bt.focal).join(Bt=>Bt.append("circle").attr("class","dot").attr("r",4).attr("cx",At=>Ct(At.density)+(Math.random()-.5)*Ut).attr("cy",At=>ut(At.cort)).attr("fill",At=>ct(At.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",At=>At.seq??"").style("cursor","pointer").on("click",(At,Pt)=>{At.currentTarget,c&&(c(l===Pt.seq?null:Pt.seq),d?.(Pt.hairIDs||[]),At.stopPropagation())}));if(r==="hover"&&te.style("cursor","pointer").on("mouseover",(Bt,At)=>{T.html(`Testosterone: <strong>${F(At.testoSeasonal!=null?At.testoSeasonal.toFixed(2):"")}</strong><br/>Corticosterone: <strong>${F(At.cort?.toFixed(2))}</strong><br/>Density: <strong>${F(At.density.toFixed(0))}</strong><br/>Season: <strong>${F(At.season)}</strong><br/>Offspring: <strong>${F(At.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${F(String(At.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse: <strong>${F(At.hairIDs.length)}</strong><br/>Hair id: <strong>${At.hairIDs.length?At.hairIDs.join(", "):""}</strong>`),St(Bt),T.transition().duration(100).style("opacity",.9)}).on("mousemove",St).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}),r==="brush"){const Bt=Fn().extent([[0,0],[W,tt]]).on("end",({selection:At})=>{if(!At)return w([]);const[[Pt,Tt],[ae,pe]]=At;w(R.filter(be=>{const Ee=Ct(be.density),Le=ut(be.cort);return Pt<=Ee&&Ee<=ae&&Tt<=Le&&Le<=pe}))});pt.append("g").call(Bt).lower()}}),Ft(p.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{children:_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:p}),_.jsx("div",{ref:h})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&v.length>0&&_.jsxs("div",{className:"ml-0 max-h-[600px] overflow-y-auto",children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:b,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","Testosterone (pg/mg hair)","Mouse ID","Sample Date","Life Reproduction Success","Recruitment","No. of Hair Samples","Hair Samples"].map(T=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:T},T))})}),_.jsx("tbody",{children:v.map((T,N)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.density.toFixed(0)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.cort}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.Testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.Date_Sampled,{date:!0})}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.Life_Repro_Success)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(k(T.Recruitment))}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.hairIDs.length?T.hairIDs.join(", "):"")})]},N))})]})]})})]})})}function gM({width:t=990,height:n=600,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c,selectedHairIDs:f=new Set,onSelectHairIDs:d}){const p=Z.useRef(),h=Z.useRef(),[m,y]=nn(event,p.current),[v,w]=Z.useState([]);ms("%Y-%m-%d");const S=xs("%d.%m.%Y"),b=()=>{if(!v.length)return;const T=["AGD.tail","Offspring"],N=v.map(L=>[L.x.toFixed(2),L.y]),D=[T.join(","),...N.map(L=>L.join(","))].join(`
`);Cn.saveAs(new Blob([D],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},E=()=>{if(!v.length)return;const T=ve.json_to_sheet(v.map(D=>({"AGD.tail":D.x.toFixed(2),Offspring:D.y}))),N=ve.book_new();ve.book_append_sheet(N,T,"Brushed Data"),Rn(N,"lrs_brushed_data.xlsx")},A="serif",O="30px",C="24px",U="20px",B="16px",V=500,k=T=>T&&typeof T=="string"?T.charAt(0).toUpperCase()+T.slice(1).toLowerCase():T,F=(T,N={})=>N.decimals!=null?T!=null&&!isNaN(T)?T.toFixed(N.decimals):"":N.date&&T?S(T):T!=null&&T!==""?T:"";return Z.useEffect(()=>{const N=Ft(p.current).select("g.root");if(N.empty())return;const D=i??null;N.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const L=Ft(this).datum()?.season;return!D||L===D?.7:.1}),N.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?.3:.05}),N.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?1:.1}).attr("stroke-width",function(){const L=Ft(this).attr("class").split(" ").find(K=>K.startsWith("season-"))?.replace("season-","");return!D||L===D?2.5:1})},[i]),Z.useEffect(()=>{const T=Ft(p.current).select("g.root");if(T.empty())return;const N=T.selectAll(".dot"),D=f&&f.size>0,L=K=>D&&Array.isArray(K)&&K.some(ft=>f.has(String(ft)));N.transition().duration(120).attr("r",K=>{const ft=L(K.hairIDs),dt=l!=null&&K.seq===l;return ft||dt?10:4}).attr("stroke-width",K=>l!=null&&K.seq===l?2.5:1),T.selectAll(".dot").filter(K=>l!=null&&K.seq===l).raise()},[f,l]),Z.useEffect(()=>{const T=Ft(h.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_testosterone.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_corticosterone.csv",ne)]).then(([N,D,L,K,ft,dt])=>{const J=Ft(p.current);J.selectAll("*").remove();const gt=new Map(L.filter(G=>G.focal_ID!=null).map(G=>[String(G.focal_ID).replace(/^'/,""),G])),wt=new Map(Array.from(Ea(dt.filter(G=>G.focal_ID!=null),G=>String(G.focal_ID).replace(/^'/,"")),([G,st])=>[G,Hn(st,St=>St["Cort_pg.mg"])])),bt=rc(dt.filter(G=>G.focal_ID!=null&&G.Season!=null),G=>Hn(G,st=>st["Cort_pg.mg"]),G=>String(G.focal_ID).replace(/^'/,""),G=>G.Season),P=new Map(Array.from(Ea(K.filter(G=>G.focal_ID!=null),G=>String(G.focal_ID).replace(/^'/,"")),([G,st])=>[G,Array.from(new Set(st.map(St=>String(St["External.ID2"])).filter(St=>St!=null&&St!=="")))])),I=new Map(ft.filter(G=>G.focal_ID!=null&&G.Seq!=null).map(G=>[String(G.focal_ID).replace(/^'/,""),+G.Seq]));let R=N.map(G=>{const st=String(G.focal_ID).replace(/^'/,""),St=gt.get(st)||{},xt=P.get(st)||[];return{density:G.Density,season:G.Season,testo:G["Testo_pg.mg"],focal:st,Date_Sampled:St.Date_Sampled,Genetic_Sex:St.Genetic_Sex,AGD_weight:St.AGD_weight,AGD_tail:St.AGD_tail,Testo:St["Testo_pg.mg_1"],Life_Repro_Success:St["life.repro.success"],Recruitment:St["recruitment.y.n"],hairIDs:xt,seq:I.get(st)??null,cort:wt.get(st)??null,cortSeasonal:(bt.get(st)&&bt.get(st).get(G.Season))??null}});const Y=D.map(G=>({density:G.density,season:G.season,predicted:G.predicted,confLow:G["conf.low"],confHigh:G["conf.high"]})),z={top:40,right:20,bottom:100,left:120},W=t-z.left-z.right,tt=n-z.top-z.bottom;R.map(G=>G.density).concat(Y.map(G=>G.density));let nt=_e(Y,G=>G.density),j=fe(Y,G=>G.density);nt=Math.min(nt,_e(R,G=>G.density)),j=Math.max(j,fe(R,G=>G.density));const q=Math.floor(nt/100)*100,lt=550,Ct=he().domain([q,lt]).range([0,W]),vt=An(q,lt+1,100),Zt=R.map(G=>G.testo).concat(Y.map(G=>G.confLow),Y.map(G=>G.confHigh)),Gt=wn(Zt),Kt=Math.floor(Gt[0]),Yt=Math.ceil(Gt[1]),Et=An(Kt,Yt+1,1),Mt=he().domain(Gt).range([tt,0]).nice(),Ot=pa().domain(["Spring","Summer","Autumn","Winter"]).range(["#009E73","#F0E442","#D55E00","#0072B2"]);J.attr("width",t).attr("height",n);const Dt=J.append("g").attr("class","root").attr("transform",`translate(${z.left},${z.top})`);J.append("text").attr("x",20).attr("y",z.top/2).attr("text-anchor","middle").style("font-family",A).style("font-size",O).attr("text-anchor","start").text("A"),Dt.append("g").attr("transform",`translate(0,${tt})`).call(Ie(Ct).tickValues(vt).tickFormat(Me("d"))).selectAll("text").style("font-family",A).style("font-size",B).style("font-weight",V),Dt.append("g").call(Se(Mt).tickValues(Et).tickFormat(Me("d"))).selectAll("text").style("font-family",A).style("font-size",B).style("font-weight",V),Dt.selectAll(".domain, .tick line").attr("stroke","black"),Dt.append("g").attr("class","grid").call(Se(Mt).tickSizeInner(-W).tickSizeOuter(0).tickFormat("")).lower().selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Dt.append("text").attr("x",W/2).attr("y",tt+55).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",C).text("Density").append("tspan").attr("x",W/2).attr("y",tt+80).style("font-size",U).text("(No. of adults)"),Dt.append("text").attr("transform","rotate(-90)").attr("x",-tt/2).attr("y",-75).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",C).text("Testosterone").append("tspan").attr("x",-tt/2).attr("dy","1.2em").style("font-size",U).text("(pg/mg hair)"),["Spring","Summer","Autumn","Winter"].forEach(G=>{const st=Y.filter(St=>St.season===G);Dt.append("path").datum(st).attr("class",`ribbon season-${G}`).attr("fill",Ot(G)).attr("fill-opacity",.3).attr("d",_n().x(St=>Ct(St.density)).y0(St=>Mt(St.confLow)).y1(St=>Mt(St.confHigh)).curve(ke)),Dt.append("path").datum(st).attr("class",`line season-${G}`).attr("fill","none").attr("stroke",Ot(G)).attr("stroke-width",2).attr("d",gn().x(St=>Ct(St.density)).y(St=>Mt(St.predicted)).curve(ke))});const xe=100;function ue(G){const st=G.currentTarget,St=parseFloat(st.getAttribute("r"))||4,xt=+st.getAttribute("cx"),mt=+st.getAttribute("cy"),yt=h.current,Ut=yt.getBoundingClientRect(),te=Ut.width,Bt=Ut.height,At=z.left+xt,Pt=z.top+mt,Tt=t-(At+xe+St+te);let be=At-(xe+St+te)>=Tt||At>z.left+W/2?At-(te+xe+St):At+(xe+St),Ee=Pt-Bt-8;Ee<0&&(Ee=Pt+8),be=Math.max(0,Math.min(be,t-te)),Ee=Math.max(0,Math.min(Ee,n-Bt)),Ft(yt).style("left",`${be}px`).style("top",`${Ee}px`)}const ge=h.current,{offsetWidth:ut,offsetHeight:rt}=ge,ct=(lt-q)*.05,pt=Dt.append("g").attr("class","dots").selectAll("circle").data(R,G=>`${G.focal}-${G.run}`).join(G=>G.append("circle").attr("class","dot").attr("r",4).attr("cx",st=>Ct(st.density)+(Math.random()-.5)*ct).attr("cy",st=>Mt(st.testo)).attr("fill",st=>Ot(st.season)).attr("fill-opacity",.8).attr("stroke","white").attr("stroke-width",1).attr("data-seq",st=>st.seq??"").style("cursor","pointer").on("click",(st,St)=>{const xt=st.currentTarget;console.log("datum:",St),console.log("dataset:",xt.dataset),c&&(c(l===St.seq?null:St.seq),d?.(St.hairIDs||[]),st.stopPropagation())}));if(r==="hover"&&pt.style("cursor","pointer").on("mouseover",(G,st)=>{T.html(`Testosterone: <strong>${F(st.testo||"-")}</strong><br/>Corticosterone: <strong>${F(st.cortSeasonal!=null?st.cortSeasonal.toFixed(2):"")}</strong><br/>Density: <strong>${F(st.density.toFixed(0))}</strong><br/>Season: <strong>${F(st.season)}</strong><br/>Offspring: <strong>${F(st.Life_Repro_Success||"-")}</strong><br/>Mouse id: <strong>${F(String(st.seq).replace(/^'/,""))}</strong><br/>Hair samples / mouse: <strong>${F(st.hairIDs.length)}</strong><br/>Hair id: <strong>${st.hairIDs.length?st.hairIDs.join(", "):""}</strong>`),ue(G),T.transition().duration(100).style("opacity",.9)}).on("mousemove",ue).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}),r==="brush"){const G=Fn().extent([[0,0],[W,tt]]).on("end",({selection:st})=>{if(!st)return w([]);const[[St,xt],[mt,yt]]=st;w(R.filter(Ut=>{const te=Ct(Ut.density),Bt=Mt(Ut.testo);return St<=te&&te<=mt&&xt<=Bt&&Bt<=yt}))});Dt.append("g").call(G).lower()}}),Ft(p.current).selectAll("*").remove()},[t,n,r]),_.jsx("div",{children:_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:p}),_.jsx("div",{ref:h})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&v.length>0&&_.jsxs("div",{className:"ml-0 max-h-[600px] overflow-y-auto",children:[_.jsxs("div",{style:{marginBottom:8,display:"flex",gap:8},children:[_.jsx("button",{onClick:b,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)","Corticosterone (pg/mg hair)","Testosterone (pg/mg hair)","Mouse ID","Sample Date","Life Reproduction Success","Recruitment","No. of Hair Samples","Hair Samples"].map(T=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50 dark:bg-gray-800",children:T},T))})}),_.jsx("tbody",{children:v.map((T,N)=>_.jsxs("tr",{className:"even:bg-gray-100 dark:even:bg-gray-900",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.density.toFixed(0)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.cort}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.Testo}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.focal}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.Date_Sampled,{date:!0})}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.Life_Repro_Success)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(k(T.Recruitment))}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:T.hairIDs.length}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F(T.hairIDs.length?T.hairIDs.join(", "):"")})]},N))})]})]})})]})})}function yM({width:t=1980,height:n=600,mode:r,selectedSeason:i,selectedSeq:l,onSelectSeq:c}){const f=Z.useRef(),d=Z.useRef(),[p,h]=nn(event,f.current),[m,y]=Z.useState([]),[v,w]=Z.useState("tail"),S=(F,T={})=>T.decimals!=null?F!=null&&!isNaN(F)?F.toFixed(T.decimals):"":T.date&&F?formatDate(F):F!=null&&F!==""?F:"",b=()=>{if(!m.length)return;const F=["AGD.tail","Offspring"],T=m.map(D=>[D.x.toFixed(2),D.y]),N=[F.join(","),...T.map(D=>D.join(","))].join(`
`);Cn.saveAs(new Blob([N],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},E=()=>{if(!m.length)return;const F=ve.json_to_sheet(m.map(N=>({"AGD.tail":N.x.toFixed(2),Offspring:N.y}))),T=ve.book_new();ve.book_append_sheet(T,F,"Brushed Data"),Rn(T,"lrs_brushed_data.xlsx")},A="serif",O="30px",C="14px",U="24px",B="20px",V="16px",k=500;return Z.useEffect(()=>{const T=Ft(f.current).select("g.root");if(T.empty())return;const N=i?String(i).trim().toLowerCase():null;T.selectAll(".dot").transition().duration(150).attr("fill-opacity",function(){const D=Ft(this).datum()?.season;return!N||D===N?.7:.1}),T.selectAll(".ribbon").transition().duration(150).attr("fill-opacity",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?.3:.05}),T.selectAll(".line").transition().duration(150).attr("stroke-opacity",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?1:.1}).attr("stroke-width",function(){const D=Ft(this).attr("class").split(" ").find(L=>L.startsWith("season-"))?.replace("season-","");return!N||D===N?2.5:1}),N&&T.selectAll(".dot").filter(D=>D.season===N).raise()},[i]),Z.useEffect(()=>{const F=Ft(f.current).attr("class","root").select("g.root");if(F.empty())return;const T=i??null;F.selectAll(".dot").transition().duration(120).attr("r",D=>T&&D.season===T?9:4).attr("stroke-width",D=>T&&D.season===T?2.5:1),F.selectAll(".dot").filter(D=>l!=null&&D.seq===l).raise()},[l]),Z.useEffect(()=>{const F=Ft(f.current).attr("width",t).attr("height",n).style("background","white").style("font-family",A),T=Ft(d.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size",C).style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("z-index","9999").style("text-align","left"),N=`/fetal-programming-for-female-masculinization/data/observed_agd_${v}.csv`,D=`/fetal-programming-for-female-masculinization/data/predicted_agd_${v}.csv`;Promise.all([Jt(N,ne),Jt(D,ne),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",L=>(L.External_ID2=L["External.ID2"],delete L["External.ID2"],ne(L))),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([L,K,ft,dt,J])=>{F.selectAll(".chart-title").remove(),F.selectAll("g.root").remove(),F.selectAll("foreignObject#metric-fo").remove();const gt=new Map(J.filter(G=>G.focal_ID!=null).map(G=>[String(G.focal_ID).replace(/^'/,""),G])),wt=new Map;dt.forEach(G=>{if(!G.focal_ID||G.External_ID2==null)return;const st=String(G.focal_ID).replace(/^'/,"");wt.has(st)||wt.set(st,new Set),wt.get(st).add(String(G.External_ID2))});const bt=new Map(Array.from(wt.entries()).map(([G,st])=>[G,Array.from(st)])),P=new Map(ft.filter(G=>G.focal_ID!=null&&G.Seq!=null).map(G=>[String(G.focal_ID).replace(/^'/,""),+G.Seq]));let I=L.filter(G=>G["Season.DOB"]!=null&&G[`AGD.${v}`]!=null).map(G=>{const st=String(G.focal_ID).replace(/^'/,"");return gt.get(st),wt.get(st),{season:G["Season.DOB"].trim().toLowerCase(),density:G["Density.DOB"],agd:G[`AGD.${v}`],focal:st,hair:G["External.ID2"],hairIDs:bt.get(st)||[],seq:P.get(st)??null}});const R=K.filter(G=>(v==="tail"?G.group!=null:G.season!=null)&&G.predicted!=null).map(G=>({season:(v==="tail"?G.group:G.season).trim().toLowerCase(),density:v==="tail"?G.x:G.density,predicted:G.predicted,confLow:G["conf.low"],confHigh:G["conf.high"]})),Y={top:50,right:20,bottom:100,left:120},z=t-Y.left-Y.right,W=n-Y.top-Y.bottom,tt=["spring","summer","autumn","winter"],nt=wn(I,G=>G.density),j=_e([_e(I,G=>G.agd),_e(R,G=>G.confLow)]),q=fe([fe(I,G=>G.agd),fe(R,G=>G.confHigh)]),lt=he().domain([0,550]).range([0,z]),Ct=he().domain([j,q]).nice().range([W,0]),vt=pa().domain(tt).range(["#009E73","#F0E442","#D55E00","#0072B2"]);F.append("text").attr("x",20).attr("y",Y.top/2).attr("text-anchor","middle").style("font-family",A).style("font-size",O).attr("text-anchor","start").text("C");const Zt=F.append("g").attr("transform",`translate(${Y.left-120}, ${Y.top+W/2+150}) rotate(-90)`),Gt=220,Kt=140,Yt=20;Zt.append("foreignObject").attr("id","metric-fo").attr("width",Gt).attr("height",parseInt(U)+Yt).attr("x",2).attr("y",0).attr("overflow","visible").style("overflow","visible").append("xhtml:div").attr("xmlns","http://www.w3.org/1999/xhtml").style("display","flex").style("flex-direction","column").style("justify-content","center").style("align-items","flex-start").html(`
          <span style="
            font-family: ${A};
            font-size: ${U};
            margin-bottom: 0px;
          ">
            Masculinization index
          </span>
          <select id="metric-select" style="
            width: ${Kt}px;
            height: ${Yt}px;         
            line-height: ${Yt}px;    
            padding: 0;                          
            box-sizing: border-box;          
            font-family: ${A};
            font-size: ${B};
            margin-left: 40px;
            vertical-align: middle;
          ">
            <option value="tail"   ${v==="tail"?"selected":""}>(AGD.tail)</option>
            <option value="weight" ${v==="weight"?"selected":""}>(Weight corrected AGD)</option>
          </select>
        `),Ft(f.current).select("#metric-select").on("change",G=>w(G.target.value));const Et=F.append("g").attr("class","root").attr("transform",`translate(${Y.left},${Y.top})`),Mt=Ct.ticks();fe(Mt);const Ot=Et.append("g").attr("class","y-grid").call(Se(Ct).tickSize(-z).tickFormat(""));Ot.select(".domain").remove(),Ot.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3);const Dt=Ct.domain()[1];Ot.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Ot.selectAll("g.tick").filter(G=>G===Dt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.3),Et.append("g").attr("transform",`translate(0,${W})`).call(Ie(lt)).selectAll("text").style("font-family",A).style("font-size",V).style("font-weight",k),Et.append("g").call(Se(Ct)).selectAll("text").style("font-family",A).style("font-size",V).style("font-weight",k),Et.append("text").attr("class","x-axis-title").attr("x",z/2).attr("y",W+55).attr("text-anchor","middle").style("font-family",A).append("tspan").style("font-size",U).text("Density").append("tspan").attr("x",z/2).attr("y",W+80).style("font-size",B).text("(No. of adults)"),tt.forEach(G=>{const st=R.filter(St=>St.season===G);Et.append("path").datum(st).attr("data-season",G).attr("class",`ribbon season-${G}`).attr("d",_n().x(St=>lt(St.density)).y0(St=>Ct(St.confLow)).y1(St=>Ct(St.confHigh)).curve(ke)).attr("fill",vt(G)).attr("fill-opacity",.3),Et.append("path").datum(st).attr("data-season",G).attr("class",`line season-${G}`).attr("fill","none").attr("stroke",vt(G)).attr("stroke-width",2).attr("d",gn().x(St=>lt(St.density)).y(St=>Ct(St.predicted)).curve(ke))});const ie=100;function xe(G){const st=G.currentTarget,St=parseFloat(st.getAttribute("r"))||4,xt=+st.getAttribute("cx"),mt=+st.getAttribute("cy"),yt=d.current,Ut=yt.getBoundingClientRect(),te=Ut.width,Bt=Ut.height,At=Y.left+xt,Pt=Y.top+mt,Tt=t-(At+ie+St+te);let be=At-(ie+St+te)>=Tt||At>Y.left+innerWidth/2?At-(te+ie+St):At+(ie+St),Ee=Pt-Bt-8;Ee<0&&(Ee=Pt+8),be=Math.max(0,Math.min(be,t-te)),Ee=Math.max(0,Math.min(Ee,n-Bt)),Ft(yt).style("left",`${be}px`).style("top",`${Ee}px`)}const ue=d.current,{offsetWidth:ge,offsetHeight:ut}=ue,rt=Et.append("g").attr("class","dots"),ct=(nt[1]-nt[0])*.05;rt.selectAll("circle").data(I).enter().append("circle").attr("class","dot").attr("cx",G=>lt(G.density)+(Math.random()-.5)*ct).attr("cy",G=>Ct(G.agd)).attr("r",4).attr("stroke","white").attr("stroke-width",1).style("cursor","pointer").attr("fill",G=>vt(G.season)).attr("fill-opacity",.6).on("click",(G,st)=>{c&&(c(l===st.seq?null:st.seq),G.stopPropagation())});const pt=rt.selectAll("circle");pt.on("mouseover",null).on("mouseout",null),Et.selectAll(".brush").remove(),y([]),r==="hover"?pt.on("mouseover",(G,st)=>{const St=st.season.charAt(0).toUpperCase()+st.season.slice(1);T.html(`Season: <strong>${St}</strong><br/>Density: <strong>${st.density}</strong><br/>${v==="tail"?"AGD.tail":"AGD.weight"}: <strong>${st.agd.toFixed(2)}</strong><br/>Mouse id: <strong>${S(String(st.seq).replace(/^'/,""))}</strong><br/>`),xe(G),T.transition().duration(100).style("opacity",.9)}).on("mousemove",xe).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}):Et.append("g").attr("class","brush").call(Fn().extent([[0,0],[z,W]]).on("end",({selection:G})=>{if(!G)return y([]);const[[st,St],[xt,mt]]=G,yt=I.filter(Ut=>{const te=lt(Ut.density),Bt=Ct(Ut.agd);return st<=te&&te<=xt&&St<=Bt&&Bt<=mt});y(yt)}))})},[t,n,r,v]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:f}),_.jsx("div",{ref:d})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&m.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:b,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:E,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Season","Density (No. of adults)",`AGD ${v}`].map(F=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:F},F))})}),_.jsx("tbody",{children:m.map((F,T)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.season}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.agd.toFixed(2)})]},T))})]})]})})]})}function vM({width:t=1e3,height:n=500,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),[d,p]=nn(event,c.current),h="motherCort",[m,y]=Z.useState([]),v=D=>String(D??"").trim().replace(/^'+/,""),w=()=>{if(!m.length)return;const D=["AGD.tail","Offspring"],L=m.map(ft=>[ft.x.toFixed(2),ft.y]),K=[D.join(","),...L.map(ft=>ft.join(","))].join(`
`);Cn.saveAs(new Blob([K],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},S=()=>{if(!m.length)return;const D=ve.json_to_sheet(m.map(K=>({"AGD.tail":K.x.toFixed(2),Offspring:K.y}))),L=ve.book_new();ve.book_append_sheet(L,D,"Brushed Data"),Rn(L,"lrs_brushed_data.xlsx")},b="lightgray",E="gray",A="gray",O="serif",C="30px",U="24px",B="20px",V="16px",k=500,F={top:40,right:20,bottom:100,left:120},T=t-F.left-F.right,N=n-F.top-F.bottom;return Z.useEffect(()=>{const D=L=>L?.seq??L?.mouseID??L?.focal??L?.id;Ft(c.current).selectAll("circle").transition().duration(100).attr("r",L=>D(L)===i?8:4)},[i]),Z.useEffect(()=>{const D=Ft(c.current).attr("width",t).attr("height",n).style("background","white").style("font-family",O);D.selectAll("*").remove();const L=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999").style("text-align","left");D.append("text").attr("x",20).attr("y",F.top/2+5).attr("text-anchor","middle").style("font-family",O).style("font-size",C).attr("text-anchor","start").text("E"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",dt=>{const J=dt["External.ID2"]??dt.External_ID2??dt["LC.MS.run"];return dt.External_ID2=J==null?null:String(J).trim(),dt.focal_ID=v(dt.focal_ID),ne(dt)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([dt,J,gt,wt,bt,P])=>{new Map(P.filter(xt=>xt.focal_ID!=null).map(xt=>[String(xt.focal_ID).replace(/^'/,""),xt]));const I=new Map;wt.forEach(xt=>{const mt=v(xt.focal_ID),yt=xt.External_ID2==null?null:String(xt.External_ID2).trim();!mt||!yt||(I.has(mt)||I.set(mt,new Set),I.get(mt).add(yt))});const R=new Map(Array.from(I.entries()).map(([xt,mt])=>[xt,Array.from(mt)])),Y=new Map(bt.filter(xt=>xt.focal_ID!=null&&xt.Seq!=null).map(xt=>[v(xt.focal_ID),+xt.Seq])),z=xt=>{const mt=+xt;return Number.isFinite(mt)?mt:NaN},W=new Map(gt.map(xt=>{const mt=v(xt.focal_ID??xt.focal??xt.id),yt=xt.motherTesto??xt.maternalTesto??xt.mother_testo??xt.maternal_testosterone,Ut=z(yt);return[mt,Ut]}));let tt=dt.map((xt,mt)=>{const yt=v(xt.focal_ID??xt.focal??xt.mouseID??xt.id),Ut=R.get(yt)??[],te=yt,Bt=W.get(yt)??null;return{id:mt,x:Number.isFinite(+xt.motherCort)?+xt.motherCort:null,y:Number.isFinite(+xt["AGD.tail"])?+xt["AGD.tail"]:null,testo:Bt,focal:yt,mouseID:te,hair:xt["External.ID2"],hairIDs:Ut,seq:Y.get(yt)??null}}).filter(xt=>Number.isFinite(xt.x)&&Number.isFinite(xt.y));const nt=J.map(xt=>({x:+xt[h],predicted:+xt.predicted,confLow:+xt["conf.low"],confHigh:+xt["conf.high"]})).filter(xt=>!isNaN(xt.x)&&!isNaN(xt.predicted)),j=tt.map(xt=>xt.x).concat(nt.map(xt=>xt.x)),q=tt.map(xt=>xt.y).concat(nt.map(xt=>xt.confLow)).concat(nt.map(xt=>xt.confHigh)),lt=_e(j),Ct=fe(j),vt=_e(q),Zt=fe(q),Gt=he().domain([lt,Ct]).nice().range([0,T]),Kt=he().domain([vt,Zt]).nice().range([N,0]),Yt=D.append("g").attr("transform",`translate(${F.left},${F.top})`),Et=Kt.ticks();fe(Et);const Mt=Yt.append("g").attr("class","y-grid").call(Se(Kt).tickSize(-T).tickFormat(""));Mt.select(".domain").remove(),Mt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Ot=Kt.domain()[1];Mt.selectAll("g.tick").filter(xt=>xt===Ot).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),Yt.append("g").attr("transform",`translate(0,${N})`).call(Ie(Gt)).style("font-family",O).style("font-size",V).style("font-weight",k).append("text").attr("fill","black").attr("class","axis-label").attr("x",T/2).attr("y",F.bottom-40).attr("fill","black").attr("text-anchor","middle").style("font-family",O).append("tspan").style("font-size",U).text("Maternal corticosterone").append("tspan").attr("x",T/2).attr("y",F.bottom-15).style("font-size",B).text("(pg/mg hair)"),Yt.append("g").call(Se(Kt)).style("font-family",O).style("font-size",V).style("font-weight",k).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-N/2).attr("y",-90).attr("fill","black").style("font-family",O).style("font-size",U).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-N/2).attr("dy","1.2em").style("font-size",B).text("(AGD.tail)"),Yt.append("path").datum(nt.sort((xt,mt)=>xt.x-mt.x)).attr("d",_n().x(xt=>Gt(xt.x)).y0(xt=>Kt(xt.confLow)).y1(xt=>Kt(xt.confHigh)).curve(ke)).attr("fill",b).attr("fill-opacity",.3),Yt.append("path").datum(nt.sort((xt,mt)=>xt.x-mt.x)).attr("d",gn().x(xt=>Gt(xt.x)).y(xt=>Kt(xt.predicted)).curve(ke)).attr("fill","none").attr("stroke",A).attr("stroke-width",2);const ie=100;function xe(xt){const mt=xt.currentTarget,yt=parseFloat(mt.getAttribute("r"))||4,Ut=+mt.getAttribute("cx"),te=+mt.getAttribute("cy"),Bt=f.current,At=Bt.getBoundingClientRect(),Pt=At.width,Tt=At.height,ae=F.left+Ut,pe=F.top+te,be=t-(ae+ie+yt+Pt);let Ue=ae-(ie+yt+Pt)>=be||ae>F.left+innerWidth/2?ae-(Pt+ie+yt):ae+(ie+yt),$e=pe-Tt-8;$e<0&&($e=pe+8),Ue=Math.max(0,Math.min(Ue,t-Pt)),$e=Math.max(0,Math.min($e,n-Tt)),Ft(Bt).style("left",`${Ue}px`).style("top",`${$e}px`)}const ue=f.current,{offsetWidth:ge,offsetHeight:ut}=ue,rt=-.025,ct=-.025,pt=We(2025);un.source(pt)(-rt,rt),un.source(pt)(-ct,ct);function G(xt,mt,yt){return(We(xt*1000003+yt)()*2-1)*mt}const st=xt=>xt?.seq??xt?.mouseID??xt?.focal??xt?.id,St=Yt.append("g").selectAll("circle.point").data(tt,xt=>st(xt)).join("circle").attr("class","point").attr("cx",xt=>Gt(xt.x+G(st(xt),rt,11))).attr("cy",xt=>Kt(xt.y+G(st(xt),ct,17))).attr("r",xt=>st(xt)===i?10:4).attr("fill",E).attr("opacity",.8).style("cursor","pointer").on("click",(xt,mt)=>l(st(mt)));r==="hover"&&St.on("mouseover",(xt,mt)=>{const[yt,Ut]=nn(xt,D.node());Array.isArray(mt.hairIDs)&&mt.hairIDs,L.html(`Mat.testosterone: <strong>${mt.testo.toFixed(2)}</strong><br/>Mat.corticosterone: <strong> ${mt.x.toFixed(2)}
                  </strong><br/>AGD.tail: <strong>${mt.y.toFixed(2)}</strong><br/>`),xe(xt),L.transition().duration(100).style("opacity",.9)}).on("mousemove",xe(e)).on("mouseout",()=>{L.transition().duration(100).style("opacity",0)}),r==="brush"?Yt.append("g").attr("class","brush").call(Fn().extent([[0,0],[T,N]]).on("end",({selection:xt})=>{if(!xt)return y([]);const[[mt,yt],[Ut,te]]=xt,Bt=tt.filter(At=>{const Pt=Gt(At.x),Tt=Kt(At.y);return Pt>=mt&&Pt<=Ut&&Tt>=yt&&Tt<=te});y(Bt)})):(Yt.selectAll(".brush").remove(),y([]))}).catch(dt=>console.error("Error loading data:",dt))},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f,style:{position:"absolute",pointerEvents:"none",opacity:0,background:"white",padding:"6px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"12px",boxShadow:"0 1px 4px rgba(0,0,0,0.2)"}})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&m.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:S,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal corticosterone (pg/mg hair)","Masculinization index (AGD corrected for tail)"].map(D=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:D},D))})}),_.jsx("tbody",{children:m.map((D,L)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:D.y.toFixed(2)})]},L))})]})]})})]})}function _M({width:t=1e3,height:n=500,mode:r,hoveredId:i,onHover:l=()=>{}}){const c=Z.useRef(),f=Z.useRef(),[d,p]=nn(event,c.current),[h,m]=Z.useState([]),y=F=>String(F??"").trim().replace(/^'+/,""),v=()=>{if(!h.length)return;const F=["Maternal Testo","AGD.tail","Maternal Cort"],T=h.map(D=>[D.x.toFixed(2),D.y.toFixed(2),D.cort.toFixed(2)]),N=[F.join(","),...T.map(D=>D.join(","))].join(`
`);Cn.saveAs(new Blob([N],{type:"text/csv"}),"F_brushed.csv")},w=()=>{if(!h.length)return;const F=ve.json_to_sheet(h.map(N=>({"Maternal Testo":N.x.toFixed(2),"AGD.tail":N.y.toFixed(2),"Maternal Cort":N.cort.toFixed(2)}))),T=ve.book_new();ve.book_append_sheet(T,F,"Brushed"),Rn(T,"F_brushed.xlsx")},S="gray",b="serif",E="30px",A="24px",O="20px",C="16px",U=500,B={top:40,right:20,bottom:100,left:140},V=t-B.left-B.right,k=n-B.top-B.bottom;return Z.useEffect(()=>{const F=T=>T?.seq??T?.mouseID??T?.focal??T?.id;Ft(c.current).selectAll("circle.point").transition().duration(100).attr("r",T=>F(T)===i?10:4)},[i]),Z.useEffect(()=>{const F=Ft(c.current).attr("width",t).attr("height",n).style("background","white");F.selectAll("*").remove();const T=Ft(f.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("z-index","9999").style("text-align","left");Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/observed_agd_tail_motherCort.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_agd_tail_motherTesto.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/Barn-Hormones_20250613.csv",N=>{const D=N["External.ID2"]??N.External_ID2??N["LC.MS.run"];return N.External_ID2=D==null?null:String(D).trim(),N.focal_ID=y(N.focal_ID),ne(N)}),Jt("/fetal-programming-for-female-masculinization/data/mouse_id_seq.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/path_table_20250613.csv",ne)]).then(([N,D,L,K,ft,dt])=>{const J=new Map(dt.filter(ut=>ut.focal_ID!=null).map(ut=>[String(ut.focal_ID).replace(/^'/,""),ut])),gt=new Map;K.forEach(ut=>{const rt=y(ut.focal_ID),ct=ut.External_ID2==null?null:String(ut.External_ID2).trim();!rt||!ct||(gt.has(rt)||gt.set(rt,new Set),gt.get(rt).add(ct))});const wt=new Map(Array.from(gt.entries()).map(([ut,rt])=>[ut,Array.from(rt)])),bt=new Map(ft.filter(ut=>ut.focal_ID!=null&&ut.Seq!=null).map(ut=>[y(ut.focal_ID),+ut.Seq]));let P=N.map((ut,rt)=>{const ct=y(ut.focal_ID);J.get(ct);const pt=wt.get(ct)??[],G=y(ut.focal_ID),st=+ut.motherTesto,St=+D[rt].motherCort;return{id:rt,x:st,y:+ut["AGD.tail"],cort:St,focal:ct,mouseID:G,hair:ut["External.ID2"],hairIDs:pt,seq:bt.get(ct)??null}}).filter(ut=>isFinite(ut.x)&&!isNaN(ut.y)&&!isNaN(ut.cort));const I=L.map(ut=>({x:+ut.motherTesto,predicted:+ut.predicted,confLow:+ut["conf.low"],confHigh:+ut["conf.high"]})).filter(ut=>!isNaN(ut.x)),R=P.map(ut=>ut.x).concat(I.map(ut=>ut.x)),Y=P.map(ut=>ut.y).concat(I.map(ut=>ut.confLow)).concat(I.map(ut=>ut.confHigh)),z=P.map(ut=>ut.cort),W=he().domain(wn(R)).nice().range([0,V]),tt=he().domain(wn(Y)).nice().range([k,0]);N0(xp).domain(wn(z));const nt=F.append("g").attr("transform",`translate(${B.left},${B.top})`);F.append("text").attr("x",20).attr("y",B.top/2+5).attr("text-anchor","middle").style("font-family",b).style("font-size",E).attr("text-anchor","start").text("D");const j=tt.ticks();fe(j);const q=nt.append("g").attr("class","y-grid").call(Se(tt).tickSize(-V).tickFormat(""));q.select(".domain").remove(),q.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const lt=tt.domain()[1];q.selectAll("g.tick").filter(ut=>ut===lt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),nt.append("g").attr("transform",`translate(0,${k})`).call(Ie(W)).style("font-family",b).style("font-size",C).style("font-weight",U).append("text").attr("class","axis-label").attr("x",V/2).attr("y",B.bottom-40).attr("fill","black").attr("text-anchor","middle").style("font-family",b).append("tspan").style("font-size",A).text("Maternal testosterone").append("tspan").attr("x",V/2).attr("y",B.bottom-15).style("font-size",O).text("(pg/mg hair)"),nt.append("g").call(Se(tt)).style("font-family",b).style("font-size",C).style("font-weight",U).append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-k/2).attr("y",-110).attr("fill","black").style("font-family",b).style("font-size",A).attr("text-anchor","middle").text("Masculinization index").append("tspan").attr("x",-k/2).attr("dy","1.2em").style("font-size",O).text("(AGD.tail)"),nt.append("path").datum(I.sort((ut,rt)=>ut.x-rt.x)).attr("d",_n().x(ut=>W(ut.x)).y0(ut=>tt(ut.confLow)).y1(ut=>tt(ut.confHigh)).curve(ke)).attr("fill","#ddd").attr("opacity",.4),nt.append("path").datum(I.sort((ut,rt)=>ut.x-rt.x)).attr("d",gn().x(ut=>W(ut.x)).y(ut=>tt(ut.predicted)).curve(ke)).attr("stroke","#888").attr("fill","none").attr("stroke-width",2);const Zt=100;function Gt(ut){const rt=ut.currentTarget,ct=parseFloat(rt.getAttribute("r"))||4,pt=+rt.getAttribute("cx"),G=+rt.getAttribute("cy"),st=f.current,St=st.getBoundingClientRect(),xt=St.width,mt=St.height,yt=B.left+pt,Ut=B.top+G,te=t-(yt+Zt+ct+xt);let Pt=yt-(Zt+ct+xt)>=te||yt>B.left+V/2?yt-(xt+Zt+ct):yt+(Zt+ct),Tt=Ut-mt-8;Tt<0&&(Tt=Ut+8),Pt=Math.max(0,Math.min(Pt,t-xt)),Tt=Math.max(0,Math.min(Tt,n-mt)),Ft(st).style("left",`${Pt}px`).style("top",`${Tt}px`)}function Kt(){l(null),T.transition().duration(100).style("opacity",0)}const Yt=f.current,{offsetWidth:Et,offsetHeight:Mt}=Yt,Ot=-.025,Dt=-.025,ie=We(2025);un.source(ie)(-Ot,Ot),un.source(ie)(-Dt,Dt);function xe(ut,rt,ct){return(We(ut*1000003+ct)()*2-1)*rt}nt.on("dblclick",()=>Kt());const ue=ut=>ut?.seq??ut?.mouseID??ut?.focal??ut?.id,ge=nt.append("g").selectAll("circle.point").data(P,ut=>ue(ut)).join("circle").attr("class","point").attr("cx",ut=>W(ut.x+xe(ue(ut),Ot,11))).attr("cy",ut=>tt(ut.y+xe(ue(ut),Dt,17))).attr("r",ut=>ue(ut)===i?10:4).attr("fill",S).attr("opacity",.8).style("cursor","pointer").on("click",(ut,rt)=>l(ue(rt))).on("dblclick",(ut,rt)=>{i===ue(rt)&&(ut.stopPropagation(),Kt())});r==="hover"&&ge.on("mouseover",(ut,rt)=>{Array.isArray(rt.hairIDs)&&rt.hairIDs,T.html(`Mat.testosterone: <strong>${rt.x.toFixed(2)}</strong><br/>Mat.corticosterone: <strong>${rt.cort.toFixed(2)}</strong><br/>AGD.tail: <strong>${rt.y.toFixed(2)}</strong><br/>`),Gt(event),T.transition().duration(100).style("opacity",.9)}).on("mousemove",ut=>Gt(ut)).on("mouseout",()=>{T.transition().duration(100).style("opacity",0)}),r==="brush"&&nt.append("g").call(Fn().extent([[0,0],[V,k]]).on("end",({selection:ut})=>{if(!ut)return m([]);const[[rt,ct],[pt,G]]=ut,st=P.filter(St=>{const xt=W(St.x),mt=tt(St.y);return xt>=rt&&xt<=pt&&mt>=ct&&mt<=G});Array.from(new Set(st.map(St=>`${St.x}|${St.y}|${St.cort}`))).map(St=>{const[xt,mt,yt]=St.split("|").map(Number);return{x:xt,y:mt,cort:yt}}),m(st)}))}).catch(console.error)},[t,n,r,l]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:c}),_.jsx("div",{ref:f})]}),r==="brush"&&h.length>0&&_.jsxs("div",{className:"w-56 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:v,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:w,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Maternal Testo","AGD.tail","Maternal Cort"].map(F=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:F},F))})}),_.jsx("tbody",{children:h.map((F,T)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.y.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:F.cort.toFixed(2)})]},T))})]})]})]})}function bM({width:t=1990,height:n=600,mode:r}){const i=Z.useRef(),l=Z.useRef(),c="agd_tail",[f,d]=Z.useState([]),p=()=>{if(!f.length)return;const U=["AGD.tail","Offspring"],B=f.map(k=>[k.x.toFixed(2),k.y]),V=[U.join(","),...B.map(k=>k.join(","))].join(`
`);Cn.saveAs(new Blob([V],{type:"text/csv;charset=utf-8;"}),"lrs_brushed_data.csv")},h=()=>{if(!f.length)return;const U=ve.json_to_sheet(f.map(V=>({"AGD.tail":V.x.toFixed(2),Offspring:V.y}))),B=ve.book_new();ve.book_append_sheet(B,U,"Brushed Data"),Rn(B,"lrs_brushed_data.xlsx")},m="lightgray",y="gray",v="gray",w="serif",S="30px",b="24px",E="20px",A="16px",O=500,C={top:40};return Z.useEffect(()=>{const U=Ft(i.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif").style("font-size","16px");U.selectAll("*").remove(),U.append("text").attr("x",40).attr("y",C.top/2).attr("text-anchor","middle").style("font-family",w).style("font-size",S).attr("text-anchor","start").text("A"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail.csv",ne)]).then(([k,F])=>{const T=k.map(lt=>({x:+lt["AGD.tail"],y:+lt["life.repro.success"]})).filter(lt=>!isNaN(lt.x)&&!isNaN(lt.y)),N=F.map(lt=>({x:+lt[c],predicted:+lt.predicted,confLow:+lt["conf.low"],confHigh:+lt["conf.high"]})).filter(lt=>!isNaN(lt.x)&&!isNaN(lt.predicted)),D={top:40,right:20,bottom:100,left:120},L=t-D.left-D.right,K=n-D.top-D.bottom,ft=T.map(lt=>lt.x).concat(N.map(lt=>lt.x)),dt=T.map(lt=>lt.y).concat(N.map(lt=>lt.confLow)).concat(N.map(lt=>lt.confHigh)),J=fe(dt),gt=Math.ceil(J/10)*10,wt=he().domain([_e(ft),fe(ft)]).nice().range([0,L]),bt=he().domain([-.5,gt]).nice().range([K,0]),P=U.append("g").attr("transform",`translate(${D.left},${D.top})`);An(10,gt+1,10);const I=bt.ticks();fe(I);const R=P.append("g").attr("class","y-grid").call(Se(bt).tickSize(-L).tickFormat(""));R.select(".domain").remove(),R.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const Y=bt.domain()[1];R.selectAll("g.tick").filter(lt=>lt===Y).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),P.append("g").attr("transform",`translate(0,${K})`).call(Ie(wt).tickValues([-1,0,1,2]).tickFormat(Me(".0f")).tickSizeInner(6).tickSizeOuter(0).tickPadding(10)).style("font-family",w).style("font-size",A).style("font-weight",O),P.append("text").attr("class","x-axis-title").attr("x",L/2).attr("y",K+65).attr("text-anchor","middle").style("font-family",w).append("tspan").style("font-size",b).text("Masculinization index").append("tspan").attr("x",L/2).attr("y",K+90).style("font-size",E).text("(AGD.tail)"),P.append("g").call(Se(bt).tickValues([0,10,20,30])).style("font-family",w).style("font-size",A).style("font-weight",O).append("text").attr("transform","rotate(-90)").attr("x",-K/2).attr("y",-70).attr("fill","black").attr("text-anchor","middle").style("font-size",b).text("Offspring"),P.append("path").datum(N.sort((lt,Ct)=>lt.x-Ct.x)).attr("d",_n().x(lt=>wt(lt.x)).y0(lt=>bt(lt.confLow)).y1(lt=>bt(lt.confHigh)).curve(ke)).attr("fill",m).attr("fill-opacity",.3),P.append("path").datum(N.sort((lt,Ct)=>lt.x-Ct.x)).attr("d",gn().x(lt=>wt(lt.x)).y(lt=>bt(lt.predicted)).curve(ke)).attr("fill","none").attr("stroke",v).attr("stroke-width",2);const z=Ft(l.current).style("position","absolute").style("min-width","180px").style("max-width","360px").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999"),W=-.05,tt=.55,nt=We(2025),j=un.source(nt)(-W,W),q=un.source(nt)(-tt,tt);P.append("g").selectAll("circle").data(T.map(lt=>({...lt,_jx:j(),_jy:q()}))).enter().append("circle").attr("cx",lt=>wt(lt.x+lt._jx)).attr("cy",lt=>bt(lt.y+lt._jy)).attr("r",3).attr("fill",y).attr("fill-opacity",.6),r==="brush"?P.append("g").attr("class","brush").call(Fn().extent([[0,0],[L,K]]).on("end",({selection:lt})=>{if(!lt)return d([]);const[[Ct,vt],[Zt,Gt]]=lt,Kt=T.filter(Yt=>{const Et=wt(Yt.x),Mt=bt(Yt.y);return Et>=Ct&&Et<=Zt&&Mt>=vt&&Mt<=Gt});d(Kt)})):(P.selectAll(".brush").remove(),d([])),Ft(i.current).selectAll("circle").on("mouseover",(lt,Ct)=>{const[vt,Zt]=nn(lt,U.node());Ft(l.current).html(`Masculinization index(AGD.tail): <strong> ${Ct.x.toFixed(2)}</strong><br/>Offspring: <strong>${Ct.y}</strong>`);const Gt=z.node(),Kt=Gt.getBoundingClientRect().height;z.style("left",`${vt+D.left-Gt.getBoundingClientRect().width/2}px`).style("top",`${Zt+D.top-Kt-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>Ft(l.current).transition().duration(100).style("opacity",0))}).catch(k=>console.error("Error loading data:",k))},[t,n,r]),_.jsxs("div",{className:"flex space-x-4",children:[_.jsxs("div",{className:"relative",style:{width:t,height:n},children:[_.jsx("svg",{ref:i}),_.jsx("div",{})]}),_.jsx("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&f.length>0&&_.jsxs("div",{className:"w-60 p-2 overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex gap-2",children:[_.jsx("button",{onClick:p,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:h,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:["Masculinization index (AGD.tail)","Lifetime reproductive success (Offspring)"].map(U=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs bg-gray-50",children:U},U))})}),_.jsx("tbody",{children:f.map((U,B)=>_.jsxs("tr",{className:"even:bg-gray-100",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:U.x.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:U.y})]},B))})]})]})})]})}function wM({width:t=990,height:n=660,brushRange:r=null}){const i=Z.useRef(),l=Z.useRef(),c=Z.useRef(null),f={top:40,right:0,bottom:120,left:120},d=t-f.left-f.right,p=n-f.top-f.bottom,h="/fetal-programming-for-female-masculinization/data/observed_lrs_agd_tail.csv",m="/fetal-programming-for-female-masculinization/data/predicted_lrs_agd_tail_by_density.csv",y="serif",v="30px",w="24px",S="20px",b="16px",E=500;return Z.useEffect(()=>{const A=c.current;if(!A)return;const O=V=>V.attr("r",3).attr("stroke","none").attr("stroke-width",null).attr("fill-opacity",.6).style("filter",null);if(r==null){A.interrupt().transition().duration(150),O(A);return}const[C,U]=r??[-1/0,1/0],B=V=>Number.isFinite(V.density)&&V.density>=C&&V.density<=U;A.interrupt().transition().duration(180).attr("r",V=>B(V)?5:3).attr("stroke",V=>B(V)?"#111":"none").attr("stroke-width",V=>B(V)?1:null).attr("fill-opacity",V=>B(V)?.95:.15).style("filter",V=>B(V)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),A.filter(B).raise()},[r]),Z.useEffect(()=>{const A=Ft(i.current).attr("width",t).attr("height",n).style("background","white").style("font-family","sans-serif");A.selectAll("*").remove(),A.append("text").attr("x",40).attr("y",f.top/2).attr("text-anchor","middle").style("font-family",y).style("font-size",v).attr("text-anchor","start").text("B"),Promise.all([Jt(h,ne),Jt(m,ne)]).then(([O,C])=>{const U=We(.42),B=O.map((z,W)=>{const tt=+z["Density.DOB"],nt=+z["AGD.tail"],j=+z["life.repro.success"],q=p*.01,lt=p*.02,Ct=(U()-.5)*(j===0?lt:q);return{density:tt,x:nt,y:j,jy:Ct,_key:`${W}|${tt}|${nt}|${j}`}}),V=C.map(z=>({density:z.density,x:+z.agd_tail,pred:+z.predicted,lo:+z["conf.low"],hi:+z["conf.high"]})),k=Array.from(new Set(V.map(z=>z.density))),F=[100,200,300,400,500],T=["#440154","#3b528b","#21918c","#5ec962","#fde725"],N=he().domain(F).range(T).interpolate(Tl),D=B.map(z=>z.x).concat(V.map(z=>z.x)),L=B.map(z=>z.y).concat(V.map(z=>z.lo)).concat(V.map(z=>z.hi)),K=he().domain(wn(D)).nice().range([0,d]),ft=he().domain([-1e-4,Math.ceil(fe(L)/10)*10]).nice().range([p,0]),dt=A.append("g").attr("transform",`translate(${f.left},${f.top})`),J=ft.ticks();fe(J);const gt=dt.append("g").attr("class","y-grid").call(Se(ft).tickSize(-d).tickFormat(""));gt.select(".domain").remove(),gt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.2);const wt=ft.domain()[1];gt.selectAll("g.tick").filter(z=>z===wt).select("line").attr("stroke","#ccc").attr("stroke-opacity",.2),dt.append("g").attr("transform",`translate(0,${p})`).call(Ie(K).ticks(4)).style("font-family",y).style("font-size",b).style("font-weight",E).append("text").attr("x",d/2).attr("y",40).attr("text-anchor","middle").style("font-size",S).text("Masculinization index (AGD.tail)"),dt.append("g").call(Se(ft).ticks(4)).style("font-family",y).style("font-size",b).style("font-weight",E);const bt=dt.append("text").attr("class","axis-label").attr("x",d/2).attr("y",p+f.bottom-70).attr("text-anchor","middle").style("font-weight",E).style("font-family",y);bt.append("tspan").attr("x",d/2).attr("dy",10).style("font-size",w).style("font-family",y).text("Masculinization index"),bt.append("tspan").attr("x",d/2).attr("dy","1.2em").style("font-size",S).text("(AGD.tail)"),dt.append("text").attr("class","axis-label").attr("transform",`translate(-60, ${p/2}) rotate(-90)`).attr("text-anchor","middle").style("font-family",y).style("font-size",w).text("Offspring");const P=dt.append("g").selectAll("circle").data(B,z=>z._key).join("circle").attr("cx",z=>K(z.x)).attr("cy",z=>ft(z.y)+z.jy).attr("r",3).attr("fill",z=>N(z.density)).attr("fill-opacity",.6);c.current=P;const I=_n().x(z=>K(z.x)).y0(z=>ft(z.lo)).y1(z=>ft(z.hi)).curve(ke),R=gn().x(z=>K(z.x)).y(z=>ft(z.pred)).curve(ke);k.forEach(z=>{const W=V.filter(tt=>tt.density===z).sort((tt,nt)=>tt.x-nt.x);dt.append("path").datum(W).attr("fill",N(z)).attr("fill-opacity",.3).attr("d",I),dt.append("path").datum(W).attr("stroke",N(z)).attr("stroke-width",2).attr("fill","none").attr("d",R)});const Y=Ft(l.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)");dt.selectAll("circle").on("mouseover",(z,W)=>{const[tt,nt]=nn(z,A.node());Y.html(`Masculinization index(AGD.tail): <strong> ${W.x.toFixed(2)}</strong><br/>Offspring: <strong>${W.y}</strong>`);const j=Y.node(),q=j.getBoundingClientRect().height;Y.style("left",`${tt+f.left-j.getBoundingClientRect().width/2}px`).style("top",`${nt+f.top-q-8}px`).transition().duration(100).style("opacity",.9)}).on("mouseout",()=>Y.transition().duration(100).style("opacity",0))}).catch(O=>console.error(O))},[t,n]),_.jsx("div",{className:"relative",style:{width:t,height:n},children:_.jsx("svg",{ref:i})})}function SM({width:t=990,height:n=710,mode:r,brushRange:i=null}){const l=Z.useRef(),c=Z.useRef(),f=Z.useRef(null),[d,p]=Z.useState([]),h="serif",m="30px",y="28px",v="22px",w="18px",S=500,b={top:40,right:0,bottom:120,left:80},E=t-b.left-b.right,A=n-b.top-b.bottom,O=()=>{if(!d.length)return;const B=["Density","AGD.tail","Recruitment","AGD.weight","Density Group"],V=d.map(T=>[T.density.toFixed(2),T.agd.toFixed(2),T.recruitment===1?"Yes":T.recruitment===0?"No":T.recruitment,T.weight.toFixed(2),T.group]),k=[B.join(","),...V.map(T=>T.join(","))].join(`
`),F=new Blob([k],{type:"text/csv;charset=utf-8;"});Cn.saveAs(F,"agd_brushed_data.csv")},C=()=>{if(!d.length)return;const B=ve.json_to_sheet(d.map(k=>({Density:k.density.toFixed(2),"AGD.tail":k.agd.toFixed(2),Recruitment:k.recruitment===1?"Yes":k.recruitment===0?"No":k.recruitment,"AGD.weight":k.weight.toFixed(2),"Density Group":k.group}))),V=ve.book_new();ve.book_append_sheet(V,B,"Brushed Data"),Rn(V,"agd_brushed_data.xlsx")};Z.useEffect(()=>{const B=f.current;if(!B)return;const V=N=>N.attr("r",3).attr("stroke",null).attr("stroke-width",null).attr("fill-opacity",.25).style("filter",null);if(i==null){B.interrupt().transition().duration(150),V(B);return}const[k,F]=i??[-1/0,1/0],T=N=>Number.isFinite(N.density)&&N.density>=k&&N.density<=F;B.interrupt().transition().duration(180).attr("r",N=>T(N)?6:3).attr("stroke",N=>T(N)?"#111":null).attr("stroke-width",N=>T(N)?1.5:null).attr("fill-opacity",N=>T(N)?.95:.15).style("filter",N=>T(N)?"drop-shadow(0 1px 3px rgba(0,0,0,.35))":null),B.filter(T).raise()},[i]),Z.useEffect(()=>{const B=Ft(l.current).attr("width",t).attr("height",n).style("background","white").style("font-family",h).style("overflow","visible");B.selectAll("*").remove();const V=Ft(c.current).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background","white").style("padding","6px").style("border","1px solid #ccc").style("border-radius","4px").style("font-size","12px").style("box-shadow","0 1px 4px rgba(0,0,0,0.2)").style("text-align","left").style("z-index","9999");B.append("text").attr("x",40).attr("y",b.top/2).attr("text-anchor","middle").style("font-family",h).style("font-size",m).attr("text-anchor","start").text("C"),Promise.all([Jt("/fetal-programming-for-female-masculinization/data/observed_recruitment.csv",ne),Jt("/fetal-programming-for-female-masculinization/data/predicted_recruitment.csv",ne)]).then(([k,F])=>{const T=We(.42),N=k.map((nt,j)=>{const q=+nt["AGD.tail"],lt=+nt.recruitment,Ct=+nt["AGD.weight"],vt=nt["Density.DOB"],Zt=+vt,Gt=Number.isFinite(Zt)?Zt:+nt.density||+nt.group,Kt=(T()-.5)*A*.13;return{x:q,y:lt,weight:Ct,group:vt,density:Gt,jy:Kt,_key:`${j}|${q}|${lt}|${Gt}`}}).filter(nt=>Number.isFinite(nt.x)&&Number.isFinite(nt.y)),D=F.map(nt=>({x:+nt.agd_tail,predicted:+nt.predicted,confLow:+nt["conf.low"],confHigh:+nt["conf.high"],group:nt.density})).filter(nt=>Number.isFinite(nt.x)&&Number.isFinite(nt.predicted)),L=Array.from(new Set(D.map(nt=>nt.group))),ft=B.append("defs").append("linearGradient").attr("id","viridisGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),dt=["#440154","#3b528b","#21918c","#5ec962","#fde725"],J=[0,500],gt=["#440154","#3b528b","#21918c","#5ec962","#fde725"],wt=he().domain(An(0,1+1e-9,1/(gt.length-1)).map(nt=>J[0]+nt*(J[1]-J[0]))).range(gt).interpolate(Tl),bt=[...N.map(nt=>nt.x),...D.map(nt=>nt.x)],P=he().domain(wn(bt)).nice().range([0,E]),I=he().domain([-.1,1.1]).nice().range([A,0]),R=B.append("g").attr("transform",`translate(${b.left},${b.top})`),Y=Ie(P).tickValues([-1,0,1,2]).tickFormat(Me(".0f")).tickSizeInner(6).tickSizeOuter(0).tickPadding(10);R.append("g").attr("transform",`translate(0,${A})`).call(Y).call(nt=>nt.selectAll(".domain, .tick line").attr("stroke","#000")).call(nt=>nt.selectAll(".tick text").attr("font-size",w));const z=R.append("text").attr("class","axis-label").attr("x",E/2).attr("y",A+b.bottom-60).attr("text-anchor","middle");z.append("tspan").attr("x",E/2).attr("dy",10).style("font-size",y).style("font-weight",S).style("font-family",h).text("Masculinization index"),z.append("tspan").attr("x",E/2).attr("dy","1.2em").style("font-size",v).text("(AGD.tail)");const W=Se(I).tickValues([0,.4,.8]).tickFormat(Me(".1f")).tickSizeInner(0).tickSizeOuter(0).tickPadding(10);R.append("g").call(W).call(nt=>nt.selectAll(".domain, .tick line").attr("stroke","#000")).call(nt=>nt.selectAll(".tick text").attr("font-size",w)),R.append("g").attr("class","grid").call(Se(I).tickValues([0,.4,.8]).tickSize(-E).tickFormat("")).call(nt=>nt.select(".domain").remove()).call(nt=>nt.selectAll("line").attr("stroke","#ccc").attr("stroke-opacity",.3)).lower(),R.append("text").attr("class","y-axis-title").attr("transform",`translate(-40, ${A/2}) rotate(-90)`).attr("text-anchor","middle").style("font-size",y).style("font-family",h).text("Recruitment probability"),L.forEach(nt=>{const j=D.filter(q=>q.group===nt).sort((q,lt)=>q.x-lt.x);R.append("path").datum(j).attr("d",_n().x(q=>P(q.x)).y0(q=>I(q.confLow)).y1(q=>I(q.confHigh)).curve(ke)).attr("fill",wt(nt)).attr("fill-opacity",.3),R.append("path").datum(j).attr("d",gn().x(q=>P(q.x)).y(q=>I(q.predicted)).curve(ke)).attr("stroke",wt(nt)).attr("stroke-width",2).attr("fill","none")});const tt=R.append("g").attr("class","dots").selectAll("circle").data(N,nt=>nt._key).join("circle").attr("cx",nt=>P(nt.x)).attr("cy",nt=>I(nt.y)+nt.jy).attr("r",3).attr("fill",nt=>wt(nt.density)).attr("fill-opacity",.25);f.current=tt,r==="hover"?tt.on("mouseover",(nt,j)=>{const[q,lt]=nn(nt,l.current);V.html(`Masculinization index(AGD.tail): <strong>${j.x.toFixed(2)}</strong><br/>Masculinization index(AGD weight):<strong> ${j.weight.toFixed(2)}</strong><br/>Recruitment: ${j.y===1?"Yes":j.y===0?"No":j.y.toFixed(2)}`).style("left",`${q+b.left+10}px`).style("top",`${lt+b.top-30}px`).transition().duration(100).style("opacity",.9).attr("r",6).attr("stroke-width",2)}).on("mouseout",()=>V.transition().duration(100).style("opacity",0)):r==="brush"&&R.append("g").attr("class","brush").call(Fn().extent([[0,0],[E,A]]).on("end",({selection:nt})=>{if(!nt){p([]);return}const[[j,q],[lt,Ct]]=nt,Zt=N.filter(Gt=>{const Kt=P(Gt.x),Yt=I(Gt.y);return Kt>=j&&Kt<=lt&&Yt>=q&&Yt<=Ct}).map(Gt=>({density:Gt.x,agd:Gt.x,recruitment:Gt.y,weight:Gt.weight,group:Gt.group}));p(Zt)})),dt.forEach((nt,j)=>{ft.append("stop").attr("offset",`${j/(dt.length-1)*100}%`).attr("stop-color",nt)})})},[t,n,r]);const U=["Recruitment probability","Masculinization index (AGD.tail)","AGD weight","Recruitment","Group"];return _.jsxs("div",{className:"flex space-x-4",children:[_.jsx("div",{className:"relative",style:{width:t,height:n},children:_.jsx("svg",{ref:l})}),_.jsx("div",{className:"max-h-[600px] overflow-y-auto",style:{height:n},children:r==="brush"&&d.length>0&&_.jsxs("div",{className:"ml-4 max-h-[600px] overflow-y-auto",style:{height:n},children:[_.jsxs("div",{className:"mb-2 flex space-x-2",children:[_.jsx("button",{onClick:O,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export CSV"}),_.jsx("button",{onClick:C,className:"px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-md hover:bg-gray-100 transition-shadow shadow-sm font-serif text-sm",children:"Export Excel"})]}),_.jsxs("table",{className:"border-collapse w-full",children:[_.jsx("thead",{children:_.jsx("tr",{children:U.map(B=>_.jsx("th",{className:"border border-gray-300 p-1 font-serif text-xs text-left",children:B},B))})}),_.jsx("tbody",{children:d.map((B,V)=>_.jsxs("tr",{className:"odd:bg-gray-50",children:[_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.density.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.agd.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.weight.toFixed(2)}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.recruitment===1?"Yes":B.recruitment===0?"No":B.recruitment}),_.jsx("td",{className:"border border-gray-300 p-1 text-xs",children:B.group})]},V))})]})]})})]})}function EM(){const[t,n]=Z.useState("hover"),[r,i]=Z.useState(null),[l,c]=Z.useState([0,500]),[f,d]=Z.useState(null),[p,h]=Z.useState(null),[m,y]=Z.useState(new Set),v=(b,E)=>b.size===E.size&&[...b].every(A=>E.has(A)),w=b=>{const E=new Set((b??[]).map(String));y(A=>v(A,E)?new Set:E)},S=Z.useCallback(b=>{c(b)},[]);return _.jsx(_.Fragment,{children:_.jsxs("div",{className:"fixed top-40 -mt-20 left-10 right-10 bottom-0 h-full overflow-y-auto p-0 text-black dark:text-white transition-colors duration-300",children:[_.jsx("div",{className:"-mt-2 w-max mx-auto",style:{zoom:.8},children:_.jsx(X6,{mode:t,onModeChange:n})}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[" ",_.jsxs("div",{className:"mb-0",children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 1: Pup body measures."}),_.jsx("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:_.jsxs("div",{className:"grid grid-cols-4 gap-40 mb-2",children:[_.jsx(dM,{}),_.jsx(pM,{}),_.jsx(xM,{}),_.jsxs("div",{className:"flex flex-col gap-0 ml-20 ",children:[_.jsxs("figure",{className:"relative w-[220px]",children:[_.jsx("img",{src:cb,alt:"Measuring anogenital distance with calipers",width:220,height:360,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-3xl font-serif",children:"D"})]}),_.jsxs("figure",{className:"relative w-[220px]",children:[_.jsx("img",{src:fb,alt:"Tail length measurement with ruler",width:220,height:360,className:"block"}),_.jsx("figcaption",{className:"absolute top-2 left-2 text-3xl font-serif",children:"E"})]})]})]})})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[_.jsxs("div",{className:"mb-5",children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 2: Preconditions of the fetal programming hypothesis."}),_.jsx("div",{className:"mb-5",children:_.jsx(Bp,{selected:f,onChange:d})}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx("p",{className:"text-left ml-5 text-xl font-semibold mb-5",children:"Adult female hormones"}),_.jsxs("div",{className:"grid grid-cols-2 gap-0 mb-0",children:[_.jsx(gM,{mode:t,selectedSeason:f,selectedSeq:p,onSelectSeq:h,selectedHairIDs:m,onSelectHairIDs:w}),_.jsx(mM,{mode:t,selectedSeason:f,selectedSeq:p,onSelectSeq:h,selectedHairIDs:m,onSelectHairIDs:w})]})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 mb-5",children:[_.jsx("p",{className:"text-left ml-5 text-xl font-semibold mb-5",children:"Pup masculinization"}),_.jsx(yM,{mode:t,selectedSeason:f,selectedSeq:p,onSelectSeq:h})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx("p",{className:"text-left ml-5 text-xl font-semibold mb-0",children:"Maternal hormones"}),_.jsxs("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[_.jsx(_M,{mode:t,hoveredId:r,onHover:i}),_.jsx(vM,{mode:t,hoveredId:r,onHover:i})]})]})]}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6 mb-40 max-w-[2100px] mx-auto mb-8",style:{zoom:.7},children:[_.jsx("p",{className:"text-left ml-5 text-2xl font-bold mb-5",children:"Fig. 3: Effects of masculinization on lifetime reproductive success and recruitment."}),_.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-lg p-6",children:[_.jsx(bM,{mode:t}),_.jsxs("div",{className:"grid grid-cols-2 gap-5 mt-6",children:[_.jsx(wM,{mode:t,brushRange:l}),_.jsx("div",{className:"transform scale-[0.9] -mt-7",children:_.jsx(SM,{mode:t,brushRange:l})})]}),_.jsx("div",{className:"mt-6",children:_.jsx(hb,{onBrush:S})})]})]})]})})}function TM({darkMode:t,setDarkMode:n}){return Z.useEffect(()=>{t?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[t]),_.jsxs("div",{className:"flex flex-col items-center text-xs md:text-sm",children:[_.jsx("div",{onClick:()=>n(!t),className:"relative w-14 h-7 bg-transparent border-2 border-white rounded-full cursor-pointer flex items-center px-1 transition-all duration-300",children:_.jsx("div",{className:`absolute top-1/2 transform -translate-y-1/2 w-6 h-6 bg-white rounded-full flex items-center justify-center transition-all duration-300 ${t?"right-1":"left-1"}`,children:t?_.jsx("svg",{className:"w-3 h-3 text-black",fill:"currentColor",viewBox:"0 0 20 20",children:_.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})}):_.jsxs("svg",{className:"w-3 h-3 text-black",fill:"currentColor",viewBox:"0 0 20 20",children:[_.jsx("path",{d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm5.657 3.343a1 1 0 10-1.414-1.414l-.707.707a1 1 0 101.414 1.414l.707-.707zM18 9a1 1 0 110 2h-1a1 1 0 110-2h1zM14.95 14.95a1 1 0 10-1.414 1.414l.707.707a1 1 0 101.414-1.414l-.707-.707zM10 17a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zm-4.95-2.05a1 1 0 10-1.414 1.414l.707.707a1 1 0 101.414-1.414l-.707-.707zM4 9a1 1 0 110 2H3a1 1 0 110-2h1zm1.343-5.657a1 1 0 00-1.414 1.414l.707.707a1 1 0 101.414-1.414l-.707-.707z"}),_.jsx("path",{d:"M10 6a4 4 0 100 8 4 4 0 000-8z"})]})})}),_.jsx("span",{className:`mt-1 text-[0.6rem] tracking-wide block w-[70px] text-center transition-colors duration-300 ${t?"text-white":"text-black"}`,children:t?"DARK MODE":"LIGHT MODE"})]})}function AM({darkMode:t,setDarkMode:n}){const[r,i]=Z.useState(!1),l=[{name:"Intro",to:"/",end:!0},{name:"Figures: Print",to:"/figures_print"},{name:"Figures: Charts",to:"/figures_charts"},{name:"Data Exploration",to:"/data_exploration"}],c=Z.useMemo(()=>({header:t?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900",border:t?"border-gray-800":"border-gray-200",inactive:t?"text-gray-300 hover:text-white":"text-gray-700 hover:text-gray-900",activeText:t?"text-rose-300":"text-rose-600",activeBorder:t?"border-rose-300":"border-rose-600",brandGradient:t?"bg-gradient-to-r from-rose-300 via-gray-100 to-cyan-300":"bg-gradient-to-r from-rose-700 via-gray-900 to-cyan-700"}),[t]),f="uppercase tracking-widest text-xs md:text-sm px-2 py-1 border-b-2 border-transparent transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-500",d=p=>[f,p?`${c.activeText} ${c.activeBorder}`.concat(" ","border-b-2"):c.inactive].join(" ");return _.jsx("header",{className:`${c.header} fixed inset-x-0 top-0 z-50 transition-colors duration-300 antialiased`,children:_.jsxs("div",{className:`flex items-center justify-between px-6 py-3 md:py-2 border-b ${c.border}`,children:[_.jsx("div",{className:"text-xl md:text-2xl font-semibold leading-none tracking-tight",style:{fontFamily:"'Playfair Display','Source Serif Pro', ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif"},children:_.jsx("span",{className:`inline-block text-transparent bg-clip-text ${c.brandGradient}`,children:"Female Masculinization in House Mice"})}),_.jsxs("nav",{className:"flex items-center space-x-6","aria-label":"Primary",children:[l.map(p=>_.jsx(T2,{to:p.to,end:p.end,className:({isActive:h})=>d(h),style:{fontFamily:"'Inter','IBM Plex Sans','Helvetica Neue', Arial, ui-sans-serif, system-ui"},children:p.name},p.name)),_.jsx(TM,{darkMode:t,setDarkMode:n})]})]})})}function DM(){const[t,n]=Z.useState(()=>window.matchMedia("(prefers-color-scheme: dark)").matches);return Z.useEffect(()=>{const r=window.matchMedia("(prefers-color-scheme: dark)"),i=l=>n(l.matches);return r.addEventListener("change",i),()=>r.removeEventListener("change",i)},[]),Z.useEffect(()=>{document.documentElement.classList.toggle("dark",t)},[t]),_.jsxs("div",{className:"min-h-screen bg-white text-black dark:bg-black dark:text-white transition-colors duration-300",children:[_.jsx(AM,{darkMode:t,setDarkMode:n}),_.jsx("main",{className:"pt-24 px-6 bg-white dark:bg-black transition-colors duration-300",children:_.jsxs(gS,{children:[_.jsx(Ni,{path:"/",element:_.jsx(qS,{})}),_.jsx(Ni,{path:"/figures",element:_.jsx(Fg,{to:"/figures_print",replace:!0})}),_.jsx(Ni,{path:"/figures_print",element:_.jsx(KS,{})}),_.jsx(Ni,{path:"/figures_charts",element:_.jsx(QR,{})}),_.jsx(Ni,{path:"/data_exploration",element:_.jsx(hM,{})}),_.jsx(Ni,{path:"/data_exploration_detailed",element:_.jsx(EM,{})}),_.jsx(Ni,{path:"*",element:_.jsx(Fg,{to:"/",replace:!0})})]})})]})}Dw.createRoot(document.getElementById("root")).render(_.jsx(US,{basename:"/fetal-programming-for-female-masculinization",children:_.jsx(DM,{})}));
